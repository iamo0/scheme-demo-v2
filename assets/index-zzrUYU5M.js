var rm=Object.defineProperty;var nm=(t,e,r)=>e in t?rm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var St=(t,e,r)=>(nm(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const f of i)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function r(i){const f={};return i.integrity&&(f.integrity=i.integrity),i.referrerPolicy&&(f.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?f.credentials="include":i.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function n(i){if(i.ep)return;i.ep=!0;const f=r(i);fetch(i.href,f)}})();function im(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var j0={exports:{}},ol={},U0={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=Symbol.for("react.element"),sm=Symbol.for("react.portal"),am=Symbol.for("react.fragment"),om=Symbol.for("react.strict_mode"),lm=Symbol.for("react.profiler"),cm=Symbol.for("react.provider"),um=Symbol.for("react.context"),fm=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),dm=Symbol.for("react.memo"),pm=Symbol.for("react.lazy"),Bf=Symbol.iterator;function gm(t){return t===null||typeof t!="object"?null:(t=Bf&&t[Bf]||t["@@iterator"],typeof t=="function"?t:null)}var W0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z0=Object.assign,X0={};function us(t,e,r){this.props=t,this.context=e,this.refs=X0,this.updater=r||W0}us.prototype.isReactComponent={};us.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};us.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function H0(){}H0.prototype=us.prototype;function mu(t,e,r){this.props=t,this.context=e,this.refs=X0,this.updater=r||W0}var vu=mu.prototype=new H0;vu.constructor=mu;z0(vu,us.prototype);vu.isPureReactComponent=!0;var jf=Array.isArray,Y0=Object.prototype.hasOwnProperty,xu={current:null},V0={key:!0,ref:!0,__self:!0,__source:!0};function G0(t,e,r){var n,i={},f=null,m=null;if(e!=null)for(n in e.ref!==void 0&&(m=e.ref),e.key!==void 0&&(f=""+e.key),e)Y0.call(e,n)&&!V0.hasOwnProperty(n)&&(i[n]=e[n]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var s=Array(c),u=0;u<c;u++)s[u]=arguments[u+2];i.children=s}if(t&&t.defaultProps)for(n in c=t.defaultProps,c)i[n]===void 0&&(i[n]=c[n]);return{$$typeof:Ca,type:t,key:f,ref:m,props:i,_owner:xu.current}}function mm(t,e){return{$$typeof:Ca,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function yu(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ca}function vm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Uf=/\/+/g;function Ml(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vm(""+t.key):e.toString(36)}function co(t,e,r,n,i){var f=typeof t;(f==="undefined"||f==="boolean")&&(t=null);var m=!1;if(t===null)m=!0;else switch(f){case"string":case"number":m=!0;break;case"object":switch(t.$$typeof){case Ca:case sm:m=!0}}if(m)return m=t,i=i(m),t=n===""?"."+Ml(m,0):n,jf(i)?(r="",t!=null&&(r=t.replace(Uf,"$&/")+"/"),co(i,e,r,"",function(u){return u})):i!=null&&(yu(i)&&(i=mm(i,r+(!i.key||m&&m.key===i.key?"":(""+i.key).replace(Uf,"$&/")+"/")+t)),e.push(i)),1;if(m=0,n=n===""?".":n+":",jf(t))for(var c=0;c<t.length;c++){f=t[c];var s=n+Ml(f,c);m+=co(f,e,r,s,i)}else if(s=gm(t),typeof s=="function")for(t=s.call(t),c=0;!(f=t.next()).done;)f=f.value,s=n+Ml(f,c++),m+=co(f,e,r,s,i);else if(f==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return m}function Na(t,e,r){if(t==null)return t;var n=[],i=0;return co(t,n,"","",function(f){return e.call(r,f,i++)}),n}function xm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},uo={transition:null},ym={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:uo,ReactCurrentOwner:xu};je.Children={map:Na,forEach:function(t,e,r){Na(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Na(t,function(){e++}),e},toArray:function(t){return Na(t,function(e){return e})||[]},only:function(t){if(!yu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};je.Component=us;je.Fragment=am;je.Profiler=lm;je.PureComponent=mu;je.StrictMode=om;je.Suspense=hm;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ym;je.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=z0({},t.props),i=t.key,f=t.ref,m=t._owner;if(e!=null){if(e.ref!==void 0&&(f=e.ref,m=xu.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(s in e)Y0.call(e,s)&&!V0.hasOwnProperty(s)&&(n[s]=e[s]===void 0&&c!==void 0?c[s]:e[s])}var s=arguments.length-2;if(s===1)n.children=r;else if(1<s){c=Array(s);for(var u=0;u<s;u++)c[u]=arguments[u+2];n.children=c}return{$$typeof:Ca,type:t.type,key:i,ref:f,props:n,_owner:m}};je.createContext=function(t){return t={$$typeof:um,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:cm,_context:t},t.Consumer=t};je.createElement=G0;je.createFactory=function(t){var e=G0.bind(null,t);return e.type=t,e};je.createRef=function(){return{current:null}};je.forwardRef=function(t){return{$$typeof:fm,render:t}};je.isValidElement=yu;je.lazy=function(t){return{$$typeof:pm,_payload:{_status:-1,_result:t},_init:xm}};je.memo=function(t,e){return{$$typeof:dm,type:t,compare:e===void 0?null:e}};je.startTransition=function(t){var e=uo.transition;uo.transition={};try{t()}finally{uo.transition=e}};je.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};je.useCallback=function(t,e){return qt.current.useCallback(t,e)};je.useContext=function(t){return qt.current.useContext(t)};je.useDebugValue=function(){};je.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};je.useEffect=function(t,e){return qt.current.useEffect(t,e)};je.useId=function(){return qt.current.useId()};je.useImperativeHandle=function(t,e,r){return qt.current.useImperativeHandle(t,e,r)};je.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};je.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};je.useMemo=function(t,e){return qt.current.useMemo(t,e)};je.useReducer=function(t,e,r){return qt.current.useReducer(t,e,r)};je.useRef=function(t){return qt.current.useRef(t)};je.useState=function(t){return qt.current.useState(t)};je.useSyncExternalStore=function(t,e,r){return qt.current.useSyncExternalStore(t,e,r)};je.useTransition=function(){return qt.current.useTransition()};je.version="18.2.0";U0.exports=je;var Ae=U0.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _m=Ae,wm=Symbol.for("react.element"),Sm=Symbol.for("react.fragment"),Cm=Object.prototype.hasOwnProperty,Tm=_m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Em={key:!0,ref:!0,__self:!0,__source:!0};function $0(t,e,r){var n,i={},f=null,m=null;r!==void 0&&(f=""+r),e.key!==void 0&&(f=""+e.key),e.ref!==void 0&&(m=e.ref);for(n in e)Cm.call(e,n)&&!Em.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:wm,type:t,key:f,ref:m,props:i,_owner:Tm.current}}ol.Fragment=Sm;ol.jsx=$0;ol.jsxs=$0;j0.exports=ol;var Ce=j0.exports,xc={},K0={exports:{}},xr={},Q0={exports:{}},q0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,k){var D=q.length;q.push(k);e:for(;0<D;){var L=D-1>>>1,E=q[L];if(0<i(E,k))q[L]=k,q[D]=E,D=L;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var k=q[0],D=q.pop();if(D!==k){q[0]=D;e:for(var L=0,E=q.length,b=E>>>1;L<b;){var A=2*(L+1)-1,T=q[A],R=A+1,z=q[R];if(0>i(T,D))R<E&&0>i(z,T)?(q[L]=z,q[R]=D,L=R):(q[L]=T,q[A]=D,L=A);else if(R<E&&0>i(z,D))q[L]=z,q[R]=D,L=R;else break e}}return k}function i(q,k){var D=q.sortIndex-k.sortIndex;return D!==0?D:q.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;t.unstable_now=function(){return f.now()}}else{var m=Date,c=m.now();t.unstable_now=function(){return m.now()-c}}var s=[],u=[],d=1,l=null,o=3,a=!1,h=!1,g=!1,p=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(q){for(var k=r(u);k!==null;){if(k.callback===null)n(u);else if(k.startTime<=q)n(u),k.sortIndex=k.expirationTime,e(s,k);else break;k=r(u)}}function _(q){if(g=!1,y(q),!h)if(r(s)!==null)h=!0,J(w);else{var k=r(u);k!==null&&oe(_,k.startTime-q)}}function w(q,k){h=!1,g&&(g=!1,v(O),O=-1),a=!0;var D=o;try{for(y(k),l=r(s);l!==null&&(!(l.expirationTime>k)||q&&!W());){var L=l.callback;if(typeof L=="function"){l.callback=null,o=l.priorityLevel;var E=L(l.expirationTime<=k);k=t.unstable_now(),typeof E=="function"?l.callback=E:l===r(s)&&n(s),y(k)}else n(s);l=r(s)}if(l!==null)var b=!0;else{var A=r(u);A!==null&&oe(_,A.startTime-k),b=!1}return b}finally{l=null,o=D,a=!1}}var C=!1,S=null,O=-1,F=5,N=-1;function W(){return!(t.unstable_now()-N<F)}function X(){if(S!==null){var q=t.unstable_now();N=q;var k=!0;try{k=S(!0,q)}finally{k?Q():(C=!1,S=null)}}else C=!1}var Q;if(typeof x=="function")Q=function(){x(X)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ne=ae.port2;ae.port1.onmessage=X,Q=function(){ne.postMessage(null)}}else Q=function(){p(X,0)};function J(q){S=q,C||(C=!0,Q())}function oe(q,k){O=p(function(){q(t.unstable_now())},k)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){h||a||(h=!0,J(w))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return o},t.unstable_getFirstCallbackNode=function(){return r(s)},t.unstable_next=function(q){switch(o){case 1:case 2:case 3:var k=3;break;default:k=o}var D=o;o=k;try{return q()}finally{o=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,k){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var D=o;o=q;try{return k()}finally{o=D}},t.unstable_scheduleCallback=function(q,k,D){var L=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?L+D:L):D=L,q){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=D+E,q={id:d++,callback:k,priorityLevel:q,startTime:D,expirationTime:E,sortIndex:-1},D>L?(q.sortIndex=D,e(u,q),r(s)===null&&q===r(u)&&(g?(v(O),O=-1):g=!0,oe(_,D-L))):(q.sortIndex=E,e(s,q),h||a||(h=!0,J(w))),q},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(q){var k=o;return function(){var D=o;o=k;try{return q.apply(this,arguments)}finally{o=D}}}})(q0);Q0.exports=q0;var Om=Q0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0=Ae,mr=Om;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z0=new Set,ea={};function _i(t,e){rs(t,e),rs(t+"Capture",e)}function rs(t,e){for(ea[t]=e,t=0;t<e.length;t++)Z0.add(e[t])}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yc=Object.prototype.hasOwnProperty,Am=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wf={},zf={};function km(t){return yc.call(zf,t)?!0:yc.call(Wf,t)?!1:Am.test(t)?zf[t]=!0:(Wf[t]=!0,!1)}function Pm(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Fm(t,e,r,n){if(e===null||typeof e>"u"||Pm(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(t,e,r,n,i,f,m){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=f,this.removeEmptyString=m}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lt[t]=new Jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lt[e]=new Jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lt[t]=new Jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lt[t]=new Jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lt[t]=new Jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lt[t]=new Jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lt[t]=new Jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lt[t]=new Jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lt[t]=new Jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var _u=/[\-:]([a-z])/g;function wu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_u,wu);Lt[e]=new Jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_u,wu);Lt[e]=new Jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_u,wu);Lt[e]=new Jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Su(t,e,r,n){var i=Lt.hasOwnProperty(e)?Lt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Fm(e,r,i,n)&&(r=null),n||i===null?km(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var _n=J0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ba=Symbol.for("react.element"),Ri=Symbol.for("react.portal"),Mi=Symbol.for("react.fragment"),Cu=Symbol.for("react.strict_mode"),_c=Symbol.for("react.profiler"),ed=Symbol.for("react.provider"),td=Symbol.for("react.context"),Tu=Symbol.for("react.forward_ref"),wc=Symbol.for("react.suspense"),Sc=Symbol.for("react.suspense_list"),Eu=Symbol.for("react.memo"),On=Symbol.for("react.lazy"),rd=Symbol.for("react.offscreen"),Xf=Symbol.iterator;function ws(t){return t===null||typeof t!="object"?null:(t=Xf&&t[Xf]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Ll;function Ds(t){if(Ll===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Ll=e&&e[1]||""}return`
`+Ll+t}var Il=!1;function Nl(t,e){if(!t||Il)return"";Il=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),f=n.stack.split(`
`),m=i.length-1,c=f.length-1;1<=m&&0<=c&&i[m]!==f[c];)c--;for(;1<=m&&0<=c;m--,c--)if(i[m]!==f[c]){if(m!==1||c!==1)do if(m--,c--,0>c||i[m]!==f[c]){var s=`
`+i[m].replace(" at new "," at ");return t.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",t.displayName)),s}while(1<=m&&0<=c);break}}}finally{Il=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ds(t):""}function Dm(t){switch(t.tag){case 5:return Ds(t.type);case 16:return Ds("Lazy");case 13:return Ds("Suspense");case 19:return Ds("SuspenseList");case 0:case 2:case 15:return t=Nl(t.type,!1),t;case 11:return t=Nl(t.type.render,!1),t;case 1:return t=Nl(t.type,!0),t;default:return""}}function Cc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Mi:return"Fragment";case Ri:return"Portal";case _c:return"Profiler";case Cu:return"StrictMode";case wc:return"Suspense";case Sc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case td:return(t.displayName||"Context")+".Consumer";case ed:return(t._context.displayName||"Context")+".Provider";case Tu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Eu:return e=t.displayName||null,e!==null?e:Cc(t.type)||"Memo";case On:e=t._payload,t=t._init;try{return Cc(t(e))}catch{}}return null}function bm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cc(e);case 8:return e===Cu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function nd(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Rm(t){var e=nd(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,f=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(m){n=""+m,f.call(this,m)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(m){n=""+m},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ja(t){t._valueTracker||(t._valueTracker=Rm(t))}function id(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=nd(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function So(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tc(t,e){var r=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Hf(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=zn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sd(t,e){e=e.checked,e!=null&&Su(t,"checked",e,!1)}function Ec(t,e){sd(t,e);var r=zn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Oc(t,e.type,r):e.hasOwnProperty("defaultValue")&&Oc(t,e.type,zn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Yf(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Oc(t,e,r){(e!=="number"||So(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var bs=Array.isArray;function Vi(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+zn(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ac(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vf(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ye(92));if(bs(r)){if(1<r.length)throw Error(ye(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:zn(r)}}function ad(t,e){var r=zn(e.value),n=zn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Gf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function od(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?od(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ua,ld=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ua=Ua||document.createElement("div"),Ua.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ua.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ta(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Is={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mm=["Webkit","ms","Moz","O"];Object.keys(Is).forEach(function(t){Mm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Is[e]=Is[t]})});function cd(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Is.hasOwnProperty(t)&&Is[t]?(""+e).trim():e+"px"}function ud(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=cd(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Lm=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pc(t,e){if(e){if(Lm[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function Fc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dc=null;function Ou(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var bc=null,Gi=null,$i=null;function $f(t){if(t=Oa(t)){if(typeof bc!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=hl(e),bc(t.stateNode,t.type,e))}}function fd(t){Gi?$i?$i.push(t):$i=[t]:Gi=t}function hd(){if(Gi){var t=Gi,e=$i;if($i=Gi=null,$f(t),e)for(t=0;t<e.length;t++)$f(e[t])}}function dd(t,e){return t(e)}function pd(){}var Bl=!1;function gd(t,e,r){if(Bl)return t(e,r);Bl=!0;try{return dd(t,e,r)}finally{Bl=!1,(Gi!==null||$i!==null)&&(pd(),hd())}}function ra(t,e){var r=t.stateNode;if(r===null)return null;var n=hl(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ye(231,e,typeof r));return r}var Rc=!1;if(pn)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){Rc=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{Rc=!1}function Im(t,e,r,n,i,f,m,c,s){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var Ns=!1,Co=null,To=!1,Mc=null,Nm={onError:function(t){Ns=!0,Co=t}};function Bm(t,e,r,n,i,f,m,c,s){Ns=!1,Co=null,Im.apply(Nm,arguments)}function jm(t,e,r,n,i,f,m,c,s){if(Bm.apply(this,arguments),Ns){if(Ns){var u=Co;Ns=!1,Co=null}else throw Error(ye(198));To||(To=!0,Mc=u)}}function wi(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function md(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Kf(t){if(wi(t)!==t)throw Error(ye(188))}function Um(t){var e=t.alternate;if(!e){if(e=wi(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var f=i.alternate;if(f===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===f.child){for(f=i.child;f;){if(f===r)return Kf(i),t;if(f===n)return Kf(i),e;f=f.sibling}throw Error(ye(188))}if(r.return!==n.return)r=i,n=f;else{for(var m=!1,c=i.child;c;){if(c===r){m=!0,r=i,n=f;break}if(c===n){m=!0,n=i,r=f;break}c=c.sibling}if(!m){for(c=f.child;c;){if(c===r){m=!0,r=f,n=i;break}if(c===n){m=!0,n=f,r=i;break}c=c.sibling}if(!m)throw Error(ye(189))}}if(r.alternate!==n)throw Error(ye(190))}if(r.tag!==3)throw Error(ye(188));return r.stateNode.current===r?t:e}function vd(t){return t=Um(t),t!==null?xd(t):null}function xd(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=xd(t);if(e!==null)return e;t=t.sibling}return null}var yd=mr.unstable_scheduleCallback,Qf=mr.unstable_cancelCallback,Wm=mr.unstable_shouldYield,zm=mr.unstable_requestPaint,dt=mr.unstable_now,Xm=mr.unstable_getCurrentPriorityLevel,Au=mr.unstable_ImmediatePriority,_d=mr.unstable_UserBlockingPriority,Eo=mr.unstable_NormalPriority,Hm=mr.unstable_LowPriority,wd=mr.unstable_IdlePriority,ll=null,Kr=null;function Ym(t){if(Kr&&typeof Kr.onCommitFiberRoot=="function")try{Kr.onCommitFiberRoot(ll,t,void 0,(t.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:$m,Vm=Math.log,Gm=Math.LN2;function $m(t){return t>>>=0,t===0?32:31-(Vm(t)/Gm|0)|0}var Wa=64,za=4194304;function Rs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Oo(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,f=t.pingedLanes,m=r&268435455;if(m!==0){var c=m&~i;c!==0?n=Rs(c):(f&=m,f!==0&&(n=Rs(f)))}else m=r&~i,m!==0?n=Rs(m):f!==0&&(n=Rs(f));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,f=e&-e,i>=f||i===16&&(f&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Nr(e),i=1<<r,n|=t[r],e&=~i;return n}function Km(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qm(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,f=t.pendingLanes;0<f;){var m=31-Nr(f),c=1<<m,s=i[m];s===-1?(!(c&r)||c&n)&&(i[m]=Km(c,e)):s<=e&&(t.expiredLanes|=c),f&=~c}}function Lc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Sd(){var t=Wa;return Wa<<=1,!(Wa&4194240)&&(Wa=64),t}function jl(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ta(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nr(e),t[e]=r}function qm(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Nr(r),f=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~f}}function ku(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Nr(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ge=0;function Cd(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Td,Pu,Ed,Od,Ad,Ic=!1,Xa=[],Mn=null,Ln=null,In=null,na=new Map,ia=new Map,kn=[],Jm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qf(t,e){switch(t){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Ln=null;break;case"mouseover":case"mouseout":In=null;break;case"pointerover":case"pointerout":na.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(e.pointerId)}}function Cs(t,e,r,n,i,f){return t===null||t.nativeEvent!==f?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:f,targetContainers:[i]},e!==null&&(e=Oa(e),e!==null&&Pu(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Zm(t,e,r,n,i){switch(e){case"focusin":return Mn=Cs(Mn,t,e,r,n,i),!0;case"dragenter":return Ln=Cs(Ln,t,e,r,n,i),!0;case"mouseover":return In=Cs(In,t,e,r,n,i),!0;case"pointerover":var f=i.pointerId;return na.set(f,Cs(na.get(f)||null,t,e,r,n,i)),!0;case"gotpointercapture":return f=i.pointerId,ia.set(f,Cs(ia.get(f)||null,t,e,r,n,i)),!0}return!1}function kd(t){var e=ii(t.target);if(e!==null){var r=wi(e);if(r!==null){if(e=r.tag,e===13){if(e=md(r),e!==null){t.blockedOn=e,Ad(t.priority,function(){Ed(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Nc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Dc=n,r.target.dispatchEvent(n),Dc=null}else return e=Oa(r),e!==null&&Pu(e),t.blockedOn=r,!1;e.shift()}return!0}function Jf(t,e,r){fo(t)&&r.delete(e)}function ev(){Ic=!1,Mn!==null&&fo(Mn)&&(Mn=null),Ln!==null&&fo(Ln)&&(Ln=null),In!==null&&fo(In)&&(In=null),na.forEach(Jf),ia.forEach(Jf)}function Ts(t,e){t.blockedOn===e&&(t.blockedOn=null,Ic||(Ic=!0,mr.unstable_scheduleCallback(mr.unstable_NormalPriority,ev)))}function sa(t){function e(i){return Ts(i,t)}if(0<Xa.length){Ts(Xa[0],t);for(var r=1;r<Xa.length;r++){var n=Xa[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Mn!==null&&Ts(Mn,t),Ln!==null&&Ts(Ln,t),In!==null&&Ts(In,t),na.forEach(e),ia.forEach(e),r=0;r<kn.length;r++)n=kn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<kn.length&&(r=kn[0],r.blockedOn===null);)kd(r),r.blockedOn===null&&kn.shift()}var Ki=_n.ReactCurrentBatchConfig,Ao=!0;function tv(t,e,r,n){var i=Ge,f=Ki.transition;Ki.transition=null;try{Ge=1,Fu(t,e,r,n)}finally{Ge=i,Ki.transition=f}}function rv(t,e,r,n){var i=Ge,f=Ki.transition;Ki.transition=null;try{Ge=4,Fu(t,e,r,n)}finally{Ge=i,Ki.transition=f}}function Fu(t,e,r,n){if(Ao){var i=Nc(t,e,r,n);if(i===null)Kl(t,e,n,ko,r),qf(t,n);else if(Zm(i,t,e,r,n))n.stopPropagation();else if(qf(t,n),e&4&&-1<Jm.indexOf(t)){for(;i!==null;){var f=Oa(i);if(f!==null&&Td(f),f=Nc(t,e,r,n),f===null&&Kl(t,e,n,ko,r),f===i)break;i=f}i!==null&&n.stopPropagation()}else Kl(t,e,n,null,r)}}var ko=null;function Nc(t,e,r,n){if(ko=null,t=Ou(n),t=ii(t),t!==null)if(e=wi(t),e===null)t=null;else if(r=e.tag,r===13){if(t=md(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ko=t,null}function Pd(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xm()){case Au:return 1;case _d:return 4;case Eo:case Hm:return 16;case wd:return 536870912;default:return 16}default:return 16}}var Fn=null,Du=null,ho=null;function Fd(){if(ho)return ho;var t,e=Du,r=e.length,n,i="value"in Fn?Fn.value:Fn.textContent,f=i.length;for(t=0;t<r&&e[t]===i[t];t++);var m=r-t;for(n=1;n<=m&&e[r-n]===i[f-n];n++);return ho=i.slice(t,1<n?1-n:void 0)}function po(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ha(){return!0}function Zf(){return!1}function yr(t){function e(r,n,i,f,m){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=f,this.target=m,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(f):f[c]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Ha:Zf,this.isPropagationStopped=Zf,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),e}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bu=yr(fs),Ea=lt({},fs,{view:0,detail:0}),nv=yr(Ea),Ul,Wl,Es,cl=lt({},Ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ru,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Es&&(Es&&t.type==="mousemove"?(Ul=t.screenX-Es.screenX,Wl=t.screenY-Es.screenY):Wl=Ul=0,Es=t),Ul)},movementY:function(t){return"movementY"in t?t.movementY:Wl}}),eh=yr(cl),iv=lt({},cl,{dataTransfer:0}),sv=yr(iv),av=lt({},Ea,{relatedTarget:0}),zl=yr(av),ov=lt({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),lv=yr(ov),cv=lt({},fs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uv=yr(cv),fv=lt({},fs,{data:0}),th=yr(fv),hv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=pv[t])?!!e[t]:!1}function Ru(){return gv}var mv=lt({},Ea,{key:function(t){if(t.key){var e=hv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=po(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ru,charCode:function(t){return t.type==="keypress"?po(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?po(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vv=yr(mv),xv=lt({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rh=yr(xv),yv=lt({},Ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ru}),_v=yr(yv),wv=lt({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sv=yr(wv),Cv=lt({},cl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Tv=yr(Cv),Ev=[9,13,27,32],Mu=pn&&"CompositionEvent"in window,Bs=null;pn&&"documentMode"in document&&(Bs=document.documentMode);var Ov=pn&&"TextEvent"in window&&!Bs,Dd=pn&&(!Mu||Bs&&8<Bs&&11>=Bs),nh=" ",ih=!1;function bd(t,e){switch(t){case"keyup":return Ev.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Li=!1;function Av(t,e){switch(t){case"compositionend":return Rd(e);case"keypress":return e.which!==32?null:(ih=!0,nh);case"textInput":return t=e.data,t===nh&&ih?null:t;default:return null}}function kv(t,e){if(Li)return t==="compositionend"||!Mu&&bd(t,e)?(t=Fd(),ho=Du=Fn=null,Li=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Dd&&e.locale!=="ko"?null:e.data;default:return null}}var Pv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Pv[t.type]:e==="textarea"}function Md(t,e,r,n){fd(n),e=Po(e,"onChange"),0<e.length&&(r=new bu("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var js=null,aa=null;function Fv(t){Yd(t,0)}function ul(t){var e=Bi(t);if(id(e))return t}function Dv(t,e){if(t==="change")return e}var Ld=!1;if(pn){var Xl;if(pn){var Hl="oninput"in document;if(!Hl){var ah=document.createElement("div");ah.setAttribute("oninput","return;"),Hl=typeof ah.oninput=="function"}Xl=Hl}else Xl=!1;Ld=Xl&&(!document.documentMode||9<document.documentMode)}function oh(){js&&(js.detachEvent("onpropertychange",Id),aa=js=null)}function Id(t){if(t.propertyName==="value"&&ul(aa)){var e=[];Md(e,aa,t,Ou(t)),gd(Fv,e)}}function bv(t,e,r){t==="focusin"?(oh(),js=e,aa=r,js.attachEvent("onpropertychange",Id)):t==="focusout"&&oh()}function Rv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ul(aa)}function Mv(t,e){if(t==="click")return ul(e)}function Lv(t,e){if(t==="input"||t==="change")return ul(e)}function Iv(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wr=typeof Object.is=="function"?Object.is:Iv;function oa(t,e){if(Wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!yc.call(e,i)||!Wr(t[i],e[i]))return!1}return!0}function lh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ch(t,e){var r=lh(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lh(r)}}function Nd(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Nd(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Bd(){for(var t=window,e=So();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=So(t.document)}return e}function Lu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Nv(t){var e=Bd(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Nd(r.ownerDocument.documentElement,r)){if(n!==null&&Lu(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,f=Math.min(n.start,i);n=n.end===void 0?f:Math.min(n.end,i),!t.extend&&f>n&&(i=n,n=f,f=i),i=ch(r,f);var m=ch(r,n);i&&m&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==m.node||t.focusOffset!==m.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),f>n?(t.addRange(e),t.extend(m.node,m.offset)):(e.setEnd(m.node,m.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Bv=pn&&"documentMode"in document&&11>=document.documentMode,Ii=null,Bc=null,Us=null,jc=!1;function uh(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;jc||Ii==null||Ii!==So(n)||(n=Ii,"selectionStart"in n&&Lu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Us&&oa(Us,n)||(Us=n,n=Po(Bc,"onSelect"),0<n.length&&(e=new bu("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ii)))}function Ya(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ni={animationend:Ya("Animation","AnimationEnd"),animationiteration:Ya("Animation","AnimationIteration"),animationstart:Ya("Animation","AnimationStart"),transitionend:Ya("Transition","TransitionEnd")},Yl={},jd={};pn&&(jd=document.createElement("div").style,"AnimationEvent"in window||(delete Ni.animationend.animation,delete Ni.animationiteration.animation,delete Ni.animationstart.animation),"TransitionEvent"in window||delete Ni.transitionend.transition);function fl(t){if(Yl[t])return Yl[t];if(!Ni[t])return t;var e=Ni[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in jd)return Yl[t]=e[r];return t}var Ud=fl("animationend"),Wd=fl("animationiteration"),zd=fl("animationstart"),Xd=fl("transitionend"),Hd=new Map,fh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gn(t,e){Hd.set(t,e),_i(e,[t])}for(var Vl=0;Vl<fh.length;Vl++){var Gl=fh[Vl],jv=Gl.toLowerCase(),Uv=Gl[0].toUpperCase()+Gl.slice(1);Gn(jv,"on"+Uv)}Gn(Ud,"onAnimationEnd");Gn(Wd,"onAnimationIteration");Gn(zd,"onAnimationStart");Gn("dblclick","onDoubleClick");Gn("focusin","onFocus");Gn("focusout","onBlur");Gn(Xd,"onTransitionEnd");rs("onMouseEnter",["mouseout","mouseover"]);rs("onMouseLeave",["mouseout","mouseover"]);rs("onPointerEnter",["pointerout","pointerover"]);rs("onPointerLeave",["pointerout","pointerover"]);_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_i("onBeforeInput",["compositionend","keypress","textInput","paste"]);_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function hh(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,jm(n,e,void 0,t),t.currentTarget=null}function Yd(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var f=void 0;if(e)for(var m=n.length-1;0<=m;m--){var c=n[m],s=c.instance,u=c.currentTarget;if(c=c.listener,s!==f&&i.isPropagationStopped())break e;hh(i,c,u),f=s}else for(m=0;m<n.length;m++){if(c=n[m],s=c.instance,u=c.currentTarget,c=c.listener,s!==f&&i.isPropagationStopped())break e;hh(i,c,u),f=s}}}if(To)throw t=Mc,To=!1,Mc=null,t}function Je(t,e){var r=e[Hc];r===void 0&&(r=e[Hc]=new Set);var n=t+"__bubble";r.has(n)||(Vd(e,t,2,!1),r.add(n))}function $l(t,e,r){var n=0;e&&(n|=4),Vd(r,t,n,e)}var Va="_reactListening"+Math.random().toString(36).slice(2);function la(t){if(!t[Va]){t[Va]=!0,Z0.forEach(function(r){r!=="selectionchange"&&(Wv.has(r)||$l(r,!1,t),$l(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Va]||(e[Va]=!0,$l("selectionchange",!1,e))}}function Vd(t,e,r,n){switch(Pd(e)){case 1:var i=tv;break;case 4:i=rv;break;default:i=Fu}r=i.bind(null,e,r,t),i=void 0,!Rc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Kl(t,e,r,n,i){var f=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var m=n.tag;if(m===3||m===4){var c=n.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(m===4)for(m=n.return;m!==null;){var s=m.tag;if((s===3||s===4)&&(s=m.stateNode.containerInfo,s===i||s.nodeType===8&&s.parentNode===i))return;m=m.return}for(;c!==null;){if(m=ii(c),m===null)return;if(s=m.tag,s===5||s===6){n=f=m;continue e}c=c.parentNode}}n=n.return}gd(function(){var u=f,d=Ou(r),l=[];e:{var o=Hd.get(t);if(o!==void 0){var a=bu,h=t;switch(t){case"keypress":if(po(r)===0)break e;case"keydown":case"keyup":a=vv;break;case"focusin":h="focus",a=zl;break;case"focusout":h="blur",a=zl;break;case"beforeblur":case"afterblur":a=zl;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=eh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=sv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=_v;break;case Ud:case Wd:case zd:a=lv;break;case Xd:a=Sv;break;case"scroll":a=nv;break;case"wheel":a=Tv;break;case"copy":case"cut":case"paste":a=uv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=rh}var g=(e&4)!==0,p=!g&&t==="scroll",v=g?o!==null?o+"Capture":null:o;g=[];for(var x=u,y;x!==null;){y=x;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,v!==null&&(_=ra(x,v),_!=null&&g.push(ca(x,_,y)))),p)break;x=x.return}0<g.length&&(o=new a(o,h,null,r,d),l.push({event:o,listeners:g}))}}if(!(e&7)){e:{if(o=t==="mouseover"||t==="pointerover",a=t==="mouseout"||t==="pointerout",o&&r!==Dc&&(h=r.relatedTarget||r.fromElement)&&(ii(h)||h[gn]))break e;if((a||o)&&(o=d.window===d?d:(o=d.ownerDocument)?o.defaultView||o.parentWindow:window,a?(h=r.relatedTarget||r.toElement,a=u,h=h?ii(h):null,h!==null&&(p=wi(h),h!==p||h.tag!==5&&h.tag!==6)&&(h=null)):(a=null,h=u),a!==h)){if(g=eh,_="onMouseLeave",v="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=rh,_="onPointerLeave",v="onPointerEnter",x="pointer"),p=a==null?o:Bi(a),y=h==null?o:Bi(h),o=new g(_,x+"leave",a,r,d),o.target=p,o.relatedTarget=y,_=null,ii(d)===u&&(g=new g(v,x+"enter",h,r,d),g.target=y,g.relatedTarget=p,_=g),p=_,a&&h)t:{for(g=a,v=h,x=0,y=g;y;y=Ai(y))x++;for(y=0,_=v;_;_=Ai(_))y++;for(;0<x-y;)g=Ai(g),x--;for(;0<y-x;)v=Ai(v),y--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Ai(g),v=Ai(v)}g=null}else g=null;a!==null&&dh(l,o,a,g,!1),h!==null&&p!==null&&dh(l,p,h,g,!0)}}e:{if(o=u?Bi(u):window,a=o.nodeName&&o.nodeName.toLowerCase(),a==="select"||a==="input"&&o.type==="file")var w=Dv;else if(sh(o))if(Ld)w=Lv;else{w=Rv;var C=bv}else(a=o.nodeName)&&a.toLowerCase()==="input"&&(o.type==="checkbox"||o.type==="radio")&&(w=Mv);if(w&&(w=w(t,u))){Md(l,w,r,d);break e}C&&C(t,o,u),t==="focusout"&&(C=o._wrapperState)&&C.controlled&&o.type==="number"&&Oc(o,"number",o.value)}switch(C=u?Bi(u):window,t){case"focusin":(sh(C)||C.contentEditable==="true")&&(Ii=C,Bc=u,Us=null);break;case"focusout":Us=Bc=Ii=null;break;case"mousedown":jc=!0;break;case"contextmenu":case"mouseup":case"dragend":jc=!1,uh(l,r,d);break;case"selectionchange":if(Bv)break;case"keydown":case"keyup":uh(l,r,d)}var S;if(Mu)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Li?bd(t,r)&&(O="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(Dd&&r.locale!=="ko"&&(Li||O!=="onCompositionStart"?O==="onCompositionEnd"&&Li&&(S=Fd()):(Fn=d,Du="value"in Fn?Fn.value:Fn.textContent,Li=!0)),C=Po(u,O),0<C.length&&(O=new th(O,t,null,r,d),l.push({event:O,listeners:C}),S?O.data=S:(S=Rd(r),S!==null&&(O.data=S)))),(S=Ov?Av(t,r):kv(t,r))&&(u=Po(u,"onBeforeInput"),0<u.length&&(d=new th("onBeforeInput","beforeinput",null,r,d),l.push({event:d,listeners:u}),d.data=S))}Yd(l,e)})}function ca(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Po(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,f=i.stateNode;i.tag===5&&f!==null&&(i=f,f=ra(t,r),f!=null&&n.unshift(ca(t,f,i)),f=ra(t,e),f!=null&&n.push(ca(t,f,i))),t=t.return}return n}function Ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function dh(t,e,r,n,i){for(var f=e._reactName,m=[];r!==null&&r!==n;){var c=r,s=c.alternate,u=c.stateNode;if(s!==null&&s===n)break;c.tag===5&&u!==null&&(c=u,i?(s=ra(r,f),s!=null&&m.unshift(ca(r,s,c))):i||(s=ra(r,f),s!=null&&m.push(ca(r,s,c)))),r=r.return}m.length!==0&&t.push({event:e,listeners:m})}var zv=/\r\n?/g,Xv=/\u0000|\uFFFD/g;function ph(t){return(typeof t=="string"?t:""+t).replace(zv,`
`).replace(Xv,"")}function Ga(t,e,r){if(e=ph(e),ph(t)!==e&&r)throw Error(ye(425))}function Fo(){}var Uc=null,Wc=null;function zc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xc=typeof setTimeout=="function"?setTimeout:void 0,Hv=typeof clearTimeout=="function"?clearTimeout:void 0,gh=typeof Promise=="function"?Promise:void 0,Yv=typeof queueMicrotask=="function"?queueMicrotask:typeof gh<"u"?function(t){return gh.resolve(null).then(t).catch(Vv)}:Xc;function Vv(t){setTimeout(function(){throw t})}function Ql(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),sa(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);sa(e)}function Nn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function mh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var hs=Math.random().toString(36).slice(2),$r="__reactFiber$"+hs,ua="__reactProps$"+hs,gn="__reactContainer$"+hs,Hc="__reactEvents$"+hs,Gv="__reactListeners$"+hs,$v="__reactHandles$"+hs;function ii(t){var e=t[$r];if(e)return e;for(var r=t.parentNode;r;){if(e=r[gn]||r[$r]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=mh(t);t!==null;){if(r=t[$r])return r;t=mh(t)}return e}t=r,r=t.parentNode}return null}function Oa(t){return t=t[$r]||t[gn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Bi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function hl(t){return t[ua]||null}var Yc=[],ji=-1;function $n(t){return{current:t}}function Ze(t){0>ji||(t.current=Yc[ji],Yc[ji]=null,ji--)}function qe(t,e){ji++,Yc[ji]=t.current,t.current=e}var Xn={},Yt=$n(Xn),rr=$n(!1),fi=Xn;function ns(t,e){var r=t.type.contextTypes;if(!r)return Xn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},f;for(f in r)i[f]=e[f];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function nr(t){return t=t.childContextTypes,t!=null}function Do(){Ze(rr),Ze(Yt)}function vh(t,e,r){if(Yt.current!==Xn)throw Error(ye(168));qe(Yt,e),qe(rr,r)}function Gd(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ye(108,bm(t)||"Unknown",i));return lt({},r,n)}function bo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Xn,fi=Yt.current,qe(Yt,t),qe(rr,rr.current),!0}function xh(t,e,r){var n=t.stateNode;if(!n)throw Error(ye(169));r?(t=Gd(t,e,fi),n.__reactInternalMemoizedMergedChildContext=t,Ze(rr),Ze(Yt),qe(Yt,t)):Ze(rr),qe(rr,r)}var sn=null,dl=!1,ql=!1;function $d(t){sn===null?sn=[t]:sn.push(t)}function Kv(t){dl=!0,$d(t)}function Kn(){if(!ql&&sn!==null){ql=!0;var t=0,e=Ge;try{var r=sn;for(Ge=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}sn=null,dl=!1}catch(i){throw sn!==null&&(sn=sn.slice(t+1)),yd(Au,Kn),i}finally{Ge=e,ql=!1}}return null}var Ui=[],Wi=0,Ro=null,Mo=0,Sr=[],Cr=0,hi=null,an=1,on="";function ei(t,e){Ui[Wi++]=Mo,Ui[Wi++]=Ro,Ro=t,Mo=e}function Kd(t,e,r){Sr[Cr++]=an,Sr[Cr++]=on,Sr[Cr++]=hi,hi=t;var n=an;t=on;var i=32-Nr(n)-1;n&=~(1<<i),r+=1;var f=32-Nr(e)+i;if(30<f){var m=i-i%5;f=(n&(1<<m)-1).toString(32),n>>=m,i-=m,an=1<<32-Nr(e)+i|r<<i|n,on=f+t}else an=1<<f|r<<i|n,on=t}function Iu(t){t.return!==null&&(ei(t,1),Kd(t,1,0))}function Nu(t){for(;t===Ro;)Ro=Ui[--Wi],Ui[Wi]=null,Mo=Ui[--Wi],Ui[Wi]=null;for(;t===hi;)hi=Sr[--Cr],Sr[Cr]=null,on=Sr[--Cr],Sr[Cr]=null,an=Sr[--Cr],Sr[Cr]=null}var gr=null,pr=null,rt=!1,Mr=null;function Qd(t,e){var r=Tr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function yh(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,gr=t,pr=Nn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,gr=t,pr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=hi!==null?{id:an,overflow:on}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Tr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,gr=t,pr=null,!0):!1;default:return!1}}function Vc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gc(t){if(rt){var e=pr;if(e){var r=e;if(!yh(t,e)){if(Vc(t))throw Error(ye(418));e=Nn(r.nextSibling);var n=gr;e&&yh(t,e)?Qd(n,r):(t.flags=t.flags&-4097|2,rt=!1,gr=t)}}else{if(Vc(t))throw Error(ye(418));t.flags=t.flags&-4097|2,rt=!1,gr=t}}}function _h(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gr=t}function $a(t){if(t!==gr)return!1;if(!rt)return _h(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zc(t.type,t.memoizedProps)),e&&(e=pr)){if(Vc(t))throw qd(),Error(ye(418));for(;e;)Qd(t,e),e=Nn(e.nextSibling)}if(_h(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){pr=Nn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}pr=null}}else pr=gr?Nn(t.stateNode.nextSibling):null;return!0}function qd(){for(var t=pr;t;)t=Nn(t.nextSibling)}function is(){pr=gr=null,rt=!1}function Bu(t){Mr===null?Mr=[t]:Mr.push(t)}var Qv=_n.ReactCurrentBatchConfig;function br(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}var Lo=$n(null),Io=null,zi=null,ju=null;function Uu(){ju=zi=Io=null}function Wu(t){var e=Lo.current;Ze(Lo),t._currentValue=e}function $c(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Qi(t,e){Io=t,ju=zi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(tr=!0),t.firstContext=null)}function Or(t){var e=t._currentValue;if(ju!==t)if(t={context:t,memoizedValue:e,next:null},zi===null){if(Io===null)throw Error(ye(308));zi=t,Io.dependencies={lanes:0,firstContext:t}}else zi=zi.next=t;return e}var si=null;function zu(t){si===null?si=[t]:si.push(t)}function Jd(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,zu(e)):(r.next=i.next,i.next=r),e.interleaved=r,mn(t,n)}function mn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var An=!1;function Xu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zd(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function cn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bn(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,We&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,mn(t,r)}return i=n.interleaved,i===null?(e.next=e,zu(n)):(e.next=i.next,i.next=e),n.interleaved=e,mn(t,r)}function go(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,ku(t,r)}}function wh(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,f=null;if(r=r.firstBaseUpdate,r!==null){do{var m={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};f===null?i=f=m:f=f.next=m,r=r.next}while(r!==null);f===null?i=f=e:f=f.next=e}else i=f=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:f,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function No(t,e,r,n){var i=t.updateQueue;An=!1;var f=i.firstBaseUpdate,m=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var s=c,u=s.next;s.next=null,m===null?f=u:m.next=u,m=s;var d=t.alternate;d!==null&&(d=d.updateQueue,c=d.lastBaseUpdate,c!==m&&(c===null?d.firstBaseUpdate=u:c.next=u,d.lastBaseUpdate=s))}if(f!==null){var l=i.baseState;m=0,d=u=s=null,c=f;do{var o=c.lane,a=c.eventTime;if((n&o)===o){d!==null&&(d=d.next={eventTime:a,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var h=t,g=c;switch(o=e,a=r,g.tag){case 1:if(h=g.payload,typeof h=="function"){l=h.call(a,l,o);break e}l=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,o=typeof h=="function"?h.call(a,l,o):h,o==null)break e;l=lt({},l,o);break e;case 2:An=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,o=i.effects,o===null?i.effects=[c]:o.push(c))}else a={eventTime:a,lane:o,tag:c.tag,payload:c.payload,callback:c.callback,next:null},d===null?(u=d=a,s=l):d=d.next=a,m|=o;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;o=c,c=o.next,o.next=null,i.lastBaseUpdate=o,i.shared.pending=null}}while(!0);if(d===null&&(s=l),i.baseState=s,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do m|=i.lane,i=i.next;while(i!==e)}else f===null&&(i.shared.lanes=0);pi|=m,t.lanes=m,t.memoizedState=l}}function Sh(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ye(191,i));i.call(n)}}}var ep=new J0.Component().refs;function Kc(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:lt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var pl={isMounted:function(t){return(t=t._reactInternals)?wi(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Kt(),i=Un(t),f=cn(n,i);f.payload=e,r!=null&&(f.callback=r),e=Bn(t,f,i),e!==null&&(Br(e,t,i,n),go(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Kt(),i=Un(t),f=cn(n,i);f.tag=1,f.payload=e,r!=null&&(f.callback=r),e=Bn(t,f,i),e!==null&&(Br(e,t,i,n),go(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Kt(),n=Un(t),i=cn(r,n);i.tag=2,e!=null&&(i.callback=e),e=Bn(t,i,n),e!==null&&(Br(e,t,n,r),go(e,t,n))}};function Ch(t,e,r,n,i,f,m){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,f,m):e.prototype&&e.prototype.isPureReactComponent?!oa(r,n)||!oa(i,f):!0}function tp(t,e,r){var n=!1,i=Xn,f=e.contextType;return typeof f=="object"&&f!==null?f=Or(f):(i=nr(e)?fi:Yt.current,n=e.contextTypes,f=(n=n!=null)?ns(t,i):Xn),e=new e(r,f),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pl,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=f),e}function Th(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&pl.enqueueReplaceState(e,e.state,null)}function Qc(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs=ep,Xu(t);var f=e.contextType;typeof f=="object"&&f!==null?i.context=Or(f):(f=nr(e)?fi:Yt.current,i.context=ns(t,f)),i.state=t.memoizedState,f=e.getDerivedStateFromProps,typeof f=="function"&&(Kc(t,e,f,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&pl.enqueueReplaceState(i,i.state,null),No(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Os(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ye(309));var n=r.stateNode}if(!n)throw Error(ye(147,t));var i=n,f=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===f?e.ref:(e=function(m){var c=i.refs;c===ep&&(c=i.refs={}),m===null?delete c[f]:c[f]=m},e._stringRef=f,e)}if(typeof t!="string")throw Error(ye(284));if(!r._owner)throw Error(ye(290,t))}return t}function Ka(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Eh(t){var e=t._init;return e(t._payload)}function rp(t){function e(v,x){if(t){var y=v.deletions;y===null?(v.deletions=[x],v.flags|=16):y.push(x)}}function r(v,x){if(!t)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function n(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=Wn(v,x),v.index=0,v.sibling=null,v}function f(v,x,y){return v.index=y,t?(y=v.alternate,y!==null?(y=y.index,y<x?(v.flags|=2,x):y):(v.flags|=2,x)):(v.flags|=1048576,x)}function m(v){return t&&v.alternate===null&&(v.flags|=2),v}function c(v,x,y,_){return x===null||x.tag!==6?(x=ic(y,v.mode,_),x.return=v,x):(x=i(x,y),x.return=v,x)}function s(v,x,y,_){var w=y.type;return w===Mi?d(v,x,y.props.children,_,y.key):x!==null&&(x.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===On&&Eh(w)===x.type)?(_=i(x,y.props),_.ref=Os(v,x,y),_.return=v,_):(_=wo(y.type,y.key,y.props,null,v.mode,_),_.ref=Os(v,x,y),_.return=v,_)}function u(v,x,y,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=sc(y,v.mode,_),x.return=v,x):(x=i(x,y.children||[]),x.return=v,x)}function d(v,x,y,_,w){return x===null||x.tag!==7?(x=li(y,v.mode,_,w),x.return=v,x):(x=i(x,y),x.return=v,x)}function l(v,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=ic(""+x,v.mode,y),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ba:return y=wo(x.type,x.key,x.props,null,v.mode,y),y.ref=Os(v,null,x),y.return=v,y;case Ri:return x=sc(x,v.mode,y),x.return=v,x;case On:var _=x._init;return l(v,_(x._payload),y)}if(bs(x)||ws(x))return x=li(x,v.mode,y,null),x.return=v,x;Ka(v,x)}return null}function o(v,x,y,_){var w=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return w!==null?null:c(v,x,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ba:return y.key===w?s(v,x,y,_):null;case Ri:return y.key===w?u(v,x,y,_):null;case On:return w=y._init,o(v,x,w(y._payload),_)}if(bs(y)||ws(y))return w!==null?null:d(v,x,y,_,null);Ka(v,y)}return null}function a(v,x,y,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(y)||null,c(x,v,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ba:return v=v.get(_.key===null?y:_.key)||null,s(x,v,_,w);case Ri:return v=v.get(_.key===null?y:_.key)||null,u(x,v,_,w);case On:var C=_._init;return a(v,x,y,C(_._payload),w)}if(bs(_)||ws(_))return v=v.get(y)||null,d(x,v,_,w,null);Ka(x,_)}return null}function h(v,x,y,_){for(var w=null,C=null,S=x,O=x=0,F=null;S!==null&&O<y.length;O++){S.index>O?(F=S,S=null):F=S.sibling;var N=o(v,S,y[O],_);if(N===null){S===null&&(S=F);break}t&&S&&N.alternate===null&&e(v,S),x=f(N,x,O),C===null?w=N:C.sibling=N,C=N,S=F}if(O===y.length)return r(v,S),rt&&ei(v,O),w;if(S===null){for(;O<y.length;O++)S=l(v,y[O],_),S!==null&&(x=f(S,x,O),C===null?w=S:C.sibling=S,C=S);return rt&&ei(v,O),w}for(S=n(v,S);O<y.length;O++)F=a(S,v,O,y[O],_),F!==null&&(t&&F.alternate!==null&&S.delete(F.key===null?O:F.key),x=f(F,x,O),C===null?w=F:C.sibling=F,C=F);return t&&S.forEach(function(W){return e(v,W)}),rt&&ei(v,O),w}function g(v,x,y,_){var w=ws(y);if(typeof w!="function")throw Error(ye(150));if(y=w.call(y),y==null)throw Error(ye(151));for(var C=w=null,S=x,O=x=0,F=null,N=y.next();S!==null&&!N.done;O++,N=y.next()){S.index>O?(F=S,S=null):F=S.sibling;var W=o(v,S,N.value,_);if(W===null){S===null&&(S=F);break}t&&S&&W.alternate===null&&e(v,S),x=f(W,x,O),C===null?w=W:C.sibling=W,C=W,S=F}if(N.done)return r(v,S),rt&&ei(v,O),w;if(S===null){for(;!N.done;O++,N=y.next())N=l(v,N.value,_),N!==null&&(x=f(N,x,O),C===null?w=N:C.sibling=N,C=N);return rt&&ei(v,O),w}for(S=n(v,S);!N.done;O++,N=y.next())N=a(S,v,O,N.value,_),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?O:N.key),x=f(N,x,O),C===null?w=N:C.sibling=N,C=N);return t&&S.forEach(function(X){return e(v,X)}),rt&&ei(v,O),w}function p(v,x,y,_){if(typeof y=="object"&&y!==null&&y.type===Mi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ba:e:{for(var w=y.key,C=x;C!==null;){if(C.key===w){if(w=y.type,w===Mi){if(C.tag===7){r(v,C.sibling),x=i(C,y.props.children),x.return=v,v=x;break e}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===On&&Eh(w)===C.type){r(v,C.sibling),x=i(C,y.props),x.ref=Os(v,C,y),x.return=v,v=x;break e}r(v,C);break}else e(v,C);C=C.sibling}y.type===Mi?(x=li(y.props.children,v.mode,_,y.key),x.return=v,v=x):(_=wo(y.type,y.key,y.props,null,v.mode,_),_.ref=Os(v,x,y),_.return=v,v=_)}return m(v);case Ri:e:{for(C=y.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){r(v,x.sibling),x=i(x,y.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else e(v,x);x=x.sibling}x=sc(y,v.mode,_),x.return=v,v=x}return m(v);case On:return C=y._init,p(v,x,C(y._payload),_)}if(bs(y))return h(v,x,y,_);if(ws(y))return g(v,x,y,_);Ka(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(r(v,x.sibling),x=i(x,y),x.return=v,v=x):(r(v,x),x=ic(y,v.mode,_),x.return=v,v=x),m(v)):r(v,x)}return p}var ss=rp(!0),np=rp(!1),Aa={},Qr=$n(Aa),fa=$n(Aa),ha=$n(Aa);function ai(t){if(t===Aa)throw Error(ye(174));return t}function Hu(t,e){switch(qe(ha,e),qe(fa,t),qe(Qr,Aa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kc(e,t)}Ze(Qr),qe(Qr,e)}function as(){Ze(Qr),Ze(fa),Ze(ha)}function ip(t){ai(ha.current);var e=ai(Qr.current),r=kc(e,t.type);e!==r&&(qe(fa,t),qe(Qr,r))}function Yu(t){fa.current===t&&(Ze(Qr),Ze(fa))}var at=$n(0);function Bo(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jl=[];function Vu(){for(var t=0;t<Jl.length;t++)Jl[t]._workInProgressVersionPrimary=null;Jl.length=0}var mo=_n.ReactCurrentDispatcher,Zl=_n.ReactCurrentBatchConfig,di=0,ot=null,_t=null,Ct=null,jo=!1,Ws=!1,da=0,qv=0;function Bt(){throw Error(ye(321))}function Gu(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Wr(t[r],e[r]))return!1;return!0}function $u(t,e,r,n,i,f){if(di=f,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mo.current=t===null||t.memoizedState===null?tx:rx,t=r(n,i),Ws){f=0;do{if(Ws=!1,da=0,25<=f)throw Error(ye(301));f+=1,Ct=_t=null,e.updateQueue=null,mo.current=nx,t=r(n,i)}while(Ws)}if(mo.current=Uo,e=_t!==null&&_t.next!==null,di=0,Ct=_t=ot=null,jo=!1,e)throw Error(ye(300));return t}function Ku(){var t=da!==0;return da=0,t}function Gr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?ot.memoizedState=Ct=t:Ct=Ct.next=t,Ct}function Ar(){if(_t===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=Ct===null?ot.memoizedState:Ct.next;if(e!==null)Ct=e,_t=t;else{if(t===null)throw Error(ye(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Ct===null?ot.memoizedState=Ct=t:Ct=Ct.next=t}return Ct}function pa(t,e){return typeof e=="function"?e(t):e}function ec(t){var e=Ar(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=_t,i=n.baseQueue,f=r.pending;if(f!==null){if(i!==null){var m=i.next;i.next=f.next,f.next=m}n.baseQueue=i=f,r.pending=null}if(i!==null){f=i.next,n=n.baseState;var c=m=null,s=null,u=f;do{var d=u.lane;if((di&d)===d)s!==null&&(s=s.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var l={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};s===null?(c=s=l,m=n):s=s.next=l,ot.lanes|=d,pi|=d}u=u.next}while(u!==null&&u!==f);s===null?m=n:s.next=c,Wr(n,e.memoizedState)||(tr=!0),e.memoizedState=n,e.baseState=m,e.baseQueue=s,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do f=i.lane,ot.lanes|=f,pi|=f,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function tc(t){var e=Ar(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,f=e.memoizedState;if(i!==null){r.pending=null;var m=i=i.next;do f=t(f,m.action),m=m.next;while(m!==i);Wr(f,e.memoizedState)||(tr=!0),e.memoizedState=f,e.baseQueue===null&&(e.baseState=f),r.lastRenderedState=f}return[f,n]}function sp(){}function ap(t,e){var r=ot,n=Ar(),i=e(),f=!Wr(n.memoizedState,i);if(f&&(n.memoizedState=i,tr=!0),n=n.queue,Qu(cp.bind(null,r,n,t),[t]),n.getSnapshot!==e||f||Ct!==null&&Ct.memoizedState.tag&1){if(r.flags|=2048,ga(9,lp.bind(null,r,n,i,e),void 0,null),At===null)throw Error(ye(349));di&30||op(r,e,i)}return i}function op(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function lp(t,e,r,n){e.value=r,e.getSnapshot=n,up(e)&&fp(t)}function cp(t,e,r){return r(function(){up(e)&&fp(t)})}function up(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Wr(t,r)}catch{return!0}}function fp(t){var e=mn(t,1);e!==null&&Br(e,t,1,-1)}function Oh(t){var e=Gr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:t},e.queue=t,t=t.dispatch=ex.bind(null,ot,t),[e.memoizedState,t]}function ga(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function hp(){return Ar().memoizedState}function vo(t,e,r,n){var i=Gr();ot.flags|=t,i.memoizedState=ga(1|e,r,void 0,n===void 0?null:n)}function gl(t,e,r,n){var i=Ar();n=n===void 0?null:n;var f=void 0;if(_t!==null){var m=_t.memoizedState;if(f=m.destroy,n!==null&&Gu(n,m.deps)){i.memoizedState=ga(e,r,f,n);return}}ot.flags|=t,i.memoizedState=ga(1|e,r,f,n)}function Ah(t,e){return vo(8390656,8,t,e)}function Qu(t,e){return gl(2048,8,t,e)}function dp(t,e){return gl(4,2,t,e)}function pp(t,e){return gl(4,4,t,e)}function gp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mp(t,e,r){return r=r!=null?r.concat([t]):null,gl(4,4,gp.bind(null,e,t),r)}function qu(){}function vp(t,e){var r=Ar();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gu(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function xp(t,e){var r=Ar();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gu(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function yp(t,e,r){return di&21?(Wr(r,e)||(r=Sd(),ot.lanes|=r,pi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,tr=!0),t.memoizedState=r)}function Jv(t,e){var r=Ge;Ge=r!==0&&4>r?r:4,t(!0);var n=Zl.transition;Zl.transition={};try{t(!1),e()}finally{Ge=r,Zl.transition=n}}function _p(){return Ar().memoizedState}function Zv(t,e,r){var n=Un(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wp(t))Sp(e,r);else if(r=Jd(t,e,r,n),r!==null){var i=Kt();Br(r,t,n,i),Cp(r,e,n)}}function ex(t,e,r){var n=Un(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wp(t))Sp(e,i);else{var f=t.alternate;if(t.lanes===0&&(f===null||f.lanes===0)&&(f=e.lastRenderedReducer,f!==null))try{var m=e.lastRenderedState,c=f(m,r);if(i.hasEagerState=!0,i.eagerState=c,Wr(c,m)){var s=e.interleaved;s===null?(i.next=i,zu(e)):(i.next=s.next,s.next=i),e.interleaved=i;return}}catch{}finally{}r=Jd(t,e,i,n),r!==null&&(i=Kt(),Br(r,t,n,i),Cp(r,e,n))}}function wp(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function Sp(t,e){Ws=jo=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Cp(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,ku(t,r)}}var Uo={readContext:Or,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},tx={readContext:Or,useCallback:function(t,e){return Gr().memoizedState=[t,e===void 0?null:e],t},useContext:Or,useEffect:Ah,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,vo(4194308,4,gp.bind(null,e,t),r)},useLayoutEffect:function(t,e){return vo(4194308,4,t,e)},useInsertionEffect:function(t,e){return vo(4,2,t,e)},useMemo:function(t,e){var r=Gr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Zv.bind(null,ot,t),[n.memoizedState,t]},useRef:function(t){var e=Gr();return t={current:t},e.memoizedState=t},useState:Oh,useDebugValue:qu,useDeferredValue:function(t){return Gr().memoizedState=t},useTransition:function(){var t=Oh(!1),e=t[0];return t=Jv.bind(null,t[1]),Gr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ot,i=Gr();if(rt){if(r===void 0)throw Error(ye(407));r=r()}else{if(r=e(),At===null)throw Error(ye(349));di&30||op(n,e,r)}i.memoizedState=r;var f={value:r,getSnapshot:e};return i.queue=f,Ah(cp.bind(null,n,f,t),[t]),n.flags|=2048,ga(9,lp.bind(null,n,f,r,e),void 0,null),r},useId:function(){var t=Gr(),e=At.identifierPrefix;if(rt){var r=on,n=an;r=(n&~(1<<32-Nr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=da++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=qv++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rx={readContext:Or,useCallback:vp,useContext:Or,useEffect:Qu,useImperativeHandle:mp,useInsertionEffect:dp,useLayoutEffect:pp,useMemo:xp,useReducer:ec,useRef:hp,useState:function(){return ec(pa)},useDebugValue:qu,useDeferredValue:function(t){var e=Ar();return yp(e,_t.memoizedState,t)},useTransition:function(){var t=ec(pa)[0],e=Ar().memoizedState;return[t,e]},useMutableSource:sp,useSyncExternalStore:ap,useId:_p,unstable_isNewReconciler:!1},nx={readContext:Or,useCallback:vp,useContext:Or,useEffect:Qu,useImperativeHandle:mp,useInsertionEffect:dp,useLayoutEffect:pp,useMemo:xp,useReducer:tc,useRef:hp,useState:function(){return tc(pa)},useDebugValue:qu,useDeferredValue:function(t){var e=Ar();return _t===null?e.memoizedState=t:yp(e,_t.memoizedState,t)},useTransition:function(){var t=tc(pa)[0],e=Ar().memoizedState;return[t,e]},useMutableSource:sp,useSyncExternalStore:ap,useId:_p,unstable_isNewReconciler:!1};function os(t,e){try{var r="",n=e;do r+=Dm(n),n=n.return;while(n);var i=r}catch(f){i=`
Error generating stack: `+f.message+`
`+f.stack}return{value:t,source:e,stack:i,digest:null}}function rc(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function qc(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var ix=typeof WeakMap=="function"?WeakMap:Map;function Tp(t,e,r){r=cn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){zo||(zo=!0,ou=n),qc(t,e)},r}function Ep(t,e,r){r=cn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){qc(t,e)}}var f=t.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(r.callback=function(){qc(t,e),typeof n!="function"&&(jn===null?jn=new Set([this]):jn.add(this));var m=e.stack;this.componentDidCatch(e.value,{componentStack:m!==null?m:""})}),r}function kh(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new ix;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=xx.bind(null,t,e,r),e.then(t,t))}function Ph(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Fh(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=cn(-1,1),e.tag=2,Bn(r,e,1))),r.lanes|=1),t)}var sx=_n.ReactCurrentOwner,tr=!1;function Vt(t,e,r,n){e.child=t===null?np(e,null,r,n):ss(e,t.child,r,n)}function Dh(t,e,r,n,i){r=r.render;var f=e.ref;return Qi(e,i),n=$u(t,e,r,n,f,i),r=Ku(),t!==null&&!tr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,vn(t,e,i)):(rt&&r&&Iu(e),e.flags|=1,Vt(t,e,n,i),e.child)}function bh(t,e,r,n,i){if(t===null){var f=r.type;return typeof f=="function"&&!af(f)&&f.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=f,Op(t,e,f,n,i)):(t=wo(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(f=t.child,!(t.lanes&i)){var m=f.memoizedProps;if(r=r.compare,r=r!==null?r:oa,r(m,n)&&t.ref===e.ref)return vn(t,e,i)}return e.flags|=1,t=Wn(f,n),t.ref=e.ref,t.return=e,e.child=t}function Op(t,e,r,n,i){if(t!==null){var f=t.memoizedProps;if(oa(f,n)&&t.ref===e.ref)if(tr=!1,e.pendingProps=n=f,(t.lanes&i)!==0)t.flags&131072&&(tr=!0);else return e.lanes=t.lanes,vn(t,e,i)}return Jc(t,e,r,n,i)}function Ap(t,e,r){var n=e.pendingProps,i=n.children,f=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(Hi,ur),ur|=r;else{if(!(r&1073741824))return t=f!==null?f.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qe(Hi,ur),ur|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=f!==null?f.baseLanes:r,qe(Hi,ur),ur|=n}else f!==null?(n=f.baseLanes|r,e.memoizedState=null):n=r,qe(Hi,ur),ur|=n;return Vt(t,e,i,r),e.child}function kp(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Jc(t,e,r,n,i){var f=nr(r)?fi:Yt.current;return f=ns(e,f),Qi(e,i),r=$u(t,e,r,n,f,i),n=Ku(),t!==null&&!tr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,vn(t,e,i)):(rt&&n&&Iu(e),e.flags|=1,Vt(t,e,r,i),e.child)}function Rh(t,e,r,n,i){if(nr(r)){var f=!0;bo(e)}else f=!1;if(Qi(e,i),e.stateNode===null)xo(t,e),tp(e,r,n),Qc(e,r,n,i),n=!0;else if(t===null){var m=e.stateNode,c=e.memoizedProps;m.props=c;var s=m.context,u=r.contextType;typeof u=="object"&&u!==null?u=Or(u):(u=nr(r)?fi:Yt.current,u=ns(e,u));var d=r.getDerivedStateFromProps,l=typeof d=="function"||typeof m.getSnapshotBeforeUpdate=="function";l||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(c!==n||s!==u)&&Th(e,m,n,u),An=!1;var o=e.memoizedState;m.state=o,No(e,n,m,i),s=e.memoizedState,c!==n||o!==s||rr.current||An?(typeof d=="function"&&(Kc(e,r,d,n),s=e.memoizedState),(c=An||Ch(e,r,c,n,o,s,u))?(l||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(e.flags|=4194308)):(typeof m.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=s),m.props=n,m.state=s,m.context=u,n=c):(typeof m.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{m=e.stateNode,Zd(t,e),c=e.memoizedProps,u=e.type===e.elementType?c:br(e.type,c),m.props=u,l=e.pendingProps,o=m.context,s=r.contextType,typeof s=="object"&&s!==null?s=Or(s):(s=nr(r)?fi:Yt.current,s=ns(e,s));var a=r.getDerivedStateFromProps;(d=typeof a=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(c!==l||o!==s)&&Th(e,m,n,s),An=!1,o=e.memoizedState,m.state=o,No(e,n,m,i);var h=e.memoizedState;c!==l||o!==h||rr.current||An?(typeof a=="function"&&(Kc(e,r,a,n),h=e.memoizedState),(u=An||Ch(e,r,u,n,o,h,s)||!1)?(d||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(n,h,s),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(n,h,s)),typeof m.componentDidUpdate=="function"&&(e.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof m.componentDidUpdate!="function"||c===t.memoizedProps&&o===t.memoizedState||(e.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&o===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=h),m.props=n,m.state=h,m.context=s,n=u):(typeof m.componentDidUpdate!="function"||c===t.memoizedProps&&o===t.memoizedState||(e.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&o===t.memoizedState||(e.flags|=1024),n=!1)}return Zc(t,e,r,n,f,i)}function Zc(t,e,r,n,i,f){kp(t,e);var m=(e.flags&128)!==0;if(!n&&!m)return i&&xh(e,r,!1),vn(t,e,f);n=e.stateNode,sx.current=e;var c=m&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&m?(e.child=ss(e,t.child,null,f),e.child=ss(e,null,c,f)):Vt(t,e,c,f),e.memoizedState=n.state,i&&xh(e,r,!0),e.child}function Pp(t){var e=t.stateNode;e.pendingContext?vh(t,e.pendingContext,e.pendingContext!==e.context):e.context&&vh(t,e.context,!1),Hu(t,e.containerInfo)}function Mh(t,e,r,n,i){return is(),Bu(i),e.flags|=256,Vt(t,e,r,n),e.child}var eu={dehydrated:null,treeContext:null,retryLane:0};function tu(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fp(t,e,r){var n=e.pendingProps,i=at.current,f=!1,m=(e.flags&128)!==0,c;if((c=m)||(c=t!==null&&t.memoizedState===null?!1:(i&2)!==0),c?(f=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),qe(at,i&1),t===null)return Gc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(m=n.children,t=n.fallback,f?(n=e.mode,f=e.child,m={mode:"hidden",children:m},!(n&1)&&f!==null?(f.childLanes=0,f.pendingProps=m):f=xl(m,n,0,null),t=li(t,n,r,null),f.return=e,t.return=e,f.sibling=t,e.child=f,e.child.memoizedState=tu(r),e.memoizedState=eu,t):Ju(e,m));if(i=t.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return ax(t,e,m,n,c,i,r);if(f){f=n.fallback,m=e.mode,i=t.child,c=i.sibling;var s={mode:"hidden",children:n.children};return!(m&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=s,e.deletions=null):(n=Wn(i,s),n.subtreeFlags=i.subtreeFlags&14680064),c!==null?f=Wn(c,f):(f=li(f,m,r,null),f.flags|=2),f.return=e,n.return=e,n.sibling=f,e.child=n,n=f,f=e.child,m=t.child.memoizedState,m=m===null?tu(r):{baseLanes:m.baseLanes|r,cachePool:null,transitions:m.transitions},f.memoizedState=m,f.childLanes=t.childLanes&~r,e.memoizedState=eu,n}return f=t.child,t=f.sibling,n=Wn(f,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Ju(t,e){return e=xl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qa(t,e,r,n){return n!==null&&Bu(n),ss(e,t.child,null,r),t=Ju(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ax(t,e,r,n,i,f,m){if(r)return e.flags&256?(e.flags&=-257,n=rc(Error(ye(422))),Qa(t,e,m,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(f=n.fallback,i=e.mode,n=xl({mode:"visible",children:n.children},i,0,null),f=li(f,i,m,null),f.flags|=2,n.return=e,f.return=e,n.sibling=f,e.child=n,e.mode&1&&ss(e,t.child,null,m),e.child.memoizedState=tu(m),e.memoizedState=eu,f);if(!(e.mode&1))return Qa(t,e,m,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var c=n.dgst;return n=c,f=Error(ye(419)),n=rc(f,n,void 0),Qa(t,e,m,n)}if(c=(m&t.childLanes)!==0,tr||c){if(n=At,n!==null){switch(m&-m){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|m)?0:i,i!==0&&i!==f.retryLane&&(f.retryLane=i,mn(t,i),Br(n,t,i,-1))}return sf(),n=rc(Error(ye(421))),Qa(t,e,m,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yx.bind(null,t),i._reactRetry=e,null):(t=f.treeContext,pr=Nn(i.nextSibling),gr=e,rt=!0,Mr=null,t!==null&&(Sr[Cr++]=an,Sr[Cr++]=on,Sr[Cr++]=hi,an=t.id,on=t.overflow,hi=e),e=Ju(e,n.children),e.flags|=4096,e)}function Lh(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),$c(t.return,e,r)}function nc(t,e,r,n,i){var f=t.memoizedState;f===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(f.isBackwards=e,f.rendering=null,f.renderingStartTime=0,f.last=n,f.tail=r,f.tailMode=i)}function Dp(t,e,r){var n=e.pendingProps,i=n.revealOrder,f=n.tail;if(Vt(t,e,n.children,r),n=at.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Lh(t,r,e);else if(t.tag===19)Lh(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(qe(at,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Bo(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),nc(e,!1,i,r,f);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Bo(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}nc(e,!0,r,null,f);break;case"together":nc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function vn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),pi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,r=Wn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Wn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function ox(t,e,r){switch(e.tag){case 3:Pp(e),is();break;case 5:ip(e);break;case 1:nr(e.type)&&bo(e);break;case 4:Hu(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;qe(Lo,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(qe(at,at.current&1),e.flags|=128,null):r&e.child.childLanes?Fp(t,e,r):(qe(at,at.current&1),t=vn(t,e,r),t!==null?t.sibling:null);qe(at,at.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Dp(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),qe(at,at.current),n)break;return null;case 22:case 23:return e.lanes=0,Ap(t,e,r)}return vn(t,e,r)}var bp,ru,Rp,Mp;bp=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ru=function(){};Rp=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,ai(Qr.current);var f=null;switch(r){case"input":i=Tc(t,i),n=Tc(t,n),f=[];break;case"select":i=lt({},i,{value:void 0}),n=lt({},n,{value:void 0}),f=[];break;case"textarea":i=Ac(t,i),n=Ac(t,n),f=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Fo)}Pc(r,n);var m;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var c=i[u];for(m in c)c.hasOwnProperty(m)&&(r||(r={}),r[m]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ea.hasOwnProperty(u)?f||(f=[]):(f=f||[]).push(u,null));for(u in n){var s=n[u];if(c=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&s!==c&&(s!=null||c!=null))if(u==="style")if(c){for(m in c)!c.hasOwnProperty(m)||s&&s.hasOwnProperty(m)||(r||(r={}),r[m]="");for(m in s)s.hasOwnProperty(m)&&c[m]!==s[m]&&(r||(r={}),r[m]=s[m])}else r||(f||(f=[]),f.push(u,r)),r=s;else u==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,c=c?c.__html:void 0,s!=null&&c!==s&&(f=f||[]).push(u,s)):u==="children"?typeof s!="string"&&typeof s!="number"||(f=f||[]).push(u,""+s):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ea.hasOwnProperty(u)?(s!=null&&u==="onScroll"&&Je("scroll",t),f||c===s||(f=[])):(f=f||[]).push(u,s))}r&&(f=f||[]).push("style",r);var u=f;(e.updateQueue=u)&&(e.flags|=4)}};Mp=function(t,e,r,n){r!==n&&(e.flags|=4)};function As(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function lx(t,e,r){var n=e.pendingProps;switch(Nu(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(e),null;case 1:return nr(e.type)&&Do(),jt(e),null;case 3:return n=e.stateNode,as(),Ze(rr),Ze(Yt),Vu(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&($a(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mr!==null&&(uu(Mr),Mr=null))),ru(t,e),jt(e),null;case 5:Yu(e);var i=ai(ha.current);if(r=e.type,t!==null&&e.stateNode!=null)Rp(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ye(166));return jt(e),null}if(t=ai(Qr.current),$a(e)){n=e.stateNode,r=e.type;var f=e.memoizedProps;switch(n[$r]=e,n[ua]=f,t=(e.mode&1)!==0,r){case"dialog":Je("cancel",n),Je("close",n);break;case"iframe":case"object":case"embed":Je("load",n);break;case"video":case"audio":for(i=0;i<Ms.length;i++)Je(Ms[i],n);break;case"source":Je("error",n);break;case"img":case"image":case"link":Je("error",n),Je("load",n);break;case"details":Je("toggle",n);break;case"input":Hf(n,f),Je("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!f.multiple},Je("invalid",n);break;case"textarea":Vf(n,f),Je("invalid",n)}Pc(r,f),i=null;for(var m in f)if(f.hasOwnProperty(m)){var c=f[m];m==="children"?typeof c=="string"?n.textContent!==c&&(f.suppressHydrationWarning!==!0&&Ga(n.textContent,c,t),i=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(f.suppressHydrationWarning!==!0&&Ga(n.textContent,c,t),i=["children",""+c]):ea.hasOwnProperty(m)&&c!=null&&m==="onScroll"&&Je("scroll",n)}switch(r){case"input":ja(n),Yf(n,f,!0);break;case"textarea":ja(n),Gf(n);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(n.onclick=Fo)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{m=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=od(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=m.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=m.createElement(r,{is:n.is}):(t=m.createElement(r),r==="select"&&(m=t,n.multiple?m.multiple=!0:n.size&&(m.size=n.size))):t=m.createElementNS(t,r),t[$r]=e,t[ua]=n,bp(t,e,!1,!1),e.stateNode=t;e:{switch(m=Fc(r,n),r){case"dialog":Je("cancel",t),Je("close",t),i=n;break;case"iframe":case"object":case"embed":Je("load",t),i=n;break;case"video":case"audio":for(i=0;i<Ms.length;i++)Je(Ms[i],t);i=n;break;case"source":Je("error",t),i=n;break;case"img":case"image":case"link":Je("error",t),Je("load",t),i=n;break;case"details":Je("toggle",t),i=n;break;case"input":Hf(t,n),i=Tc(t,n),Je("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=lt({},n,{value:void 0}),Je("invalid",t);break;case"textarea":Vf(t,n),i=Ac(t,n),Je("invalid",t);break;default:i=n}Pc(r,i),c=i;for(f in c)if(c.hasOwnProperty(f)){var s=c[f];f==="style"?ud(t,s):f==="dangerouslySetInnerHTML"?(s=s?s.__html:void 0,s!=null&&ld(t,s)):f==="children"?typeof s=="string"?(r!=="textarea"||s!=="")&&ta(t,s):typeof s=="number"&&ta(t,""+s):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(ea.hasOwnProperty(f)?s!=null&&f==="onScroll"&&Je("scroll",t):s!=null&&Su(t,f,s,m))}switch(r){case"input":ja(t),Yf(t,n,!1);break;case"textarea":ja(t),Gf(t);break;case"option":n.value!=null&&t.setAttribute("value",""+zn(n.value));break;case"select":t.multiple=!!n.multiple,f=n.value,f!=null?Vi(t,!!n.multiple,f,!1):n.defaultValue!=null&&Vi(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Fo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return jt(e),null;case 6:if(t&&e.stateNode!=null)Mp(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ye(166));if(r=ai(ha.current),ai(Qr.current),$a(e)){if(n=e.stateNode,r=e.memoizedProps,n[$r]=e,(f=n.nodeValue!==r)&&(t=gr,t!==null))switch(t.tag){case 3:Ga(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ga(n.nodeValue,r,(t.mode&1)!==0)}f&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$r]=e,e.stateNode=n}return jt(e),null;case 13:if(Ze(at),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&pr!==null&&e.mode&1&&!(e.flags&128))qd(),is(),e.flags|=98560,f=!1;else if(f=$a(e),n!==null&&n.dehydrated!==null){if(t===null){if(!f)throw Error(ye(318));if(f=e.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(ye(317));f[$r]=e}else is(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;jt(e),f=!1}else Mr!==null&&(uu(Mr),Mr=null),f=!0;if(!f)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||at.current&1?wt===0&&(wt=3):sf())),e.updateQueue!==null&&(e.flags|=4),jt(e),null);case 4:return as(),ru(t,e),t===null&&la(e.stateNode.containerInfo),jt(e),null;case 10:return Wu(e.type._context),jt(e),null;case 17:return nr(e.type)&&Do(),jt(e),null;case 19:if(Ze(at),f=e.memoizedState,f===null)return jt(e),null;if(n=(e.flags&128)!==0,m=f.rendering,m===null)if(n)As(f,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(m=Bo(t),m!==null){for(e.flags|=128,As(f,!1),n=m.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)f=r,t=n,f.flags&=14680066,m=f.alternate,m===null?(f.childLanes=0,f.lanes=t,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=m.childLanes,f.lanes=m.lanes,f.child=m.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=m.memoizedProps,f.memoizedState=m.memoizedState,f.updateQueue=m.updateQueue,f.type=m.type,t=m.dependencies,f.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return qe(at,at.current&1|2),e.child}t=t.sibling}f.tail!==null&&dt()>ls&&(e.flags|=128,n=!0,As(f,!1),e.lanes=4194304)}else{if(!n)if(t=Bo(m),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),As(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!rt)return jt(e),null}else 2*dt()-f.renderingStartTime>ls&&r!==1073741824&&(e.flags|=128,n=!0,As(f,!1),e.lanes=4194304);f.isBackwards?(m.sibling=e.child,e.child=m):(r=f.last,r!==null?r.sibling=m:e.child=m,f.last=m)}return f.tail!==null?(e=f.tail,f.rendering=e,f.tail=e.sibling,f.renderingStartTime=dt(),e.sibling=null,r=at.current,qe(at,n?r&1|2:r&1),e):(jt(e),null);case 22:case 23:return nf(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ur&1073741824&&(jt(e),e.subtreeFlags&6&&(e.flags|=8192)):jt(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function cx(t,e){switch(Nu(e),e.tag){case 1:return nr(e.type)&&Do(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return as(),Ze(rr),Ze(Yt),Vu(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yu(e),null;case 13:if(Ze(at),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));is()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(at),null;case 4:return as(),null;case 10:return Wu(e.type._context),null;case 22:case 23:return nf(),null;case 24:return null;default:return null}}var qa=!1,Wt=!1,ux=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Xi(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ut(t,e,n)}else r.current=null}function nu(t,e,r){try{r()}catch(n){ut(t,e,n)}}var Ih=!1;function fx(t,e){if(Uc=Ao,t=Bd(),Lu(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,f=n.focusNode;n=n.focusOffset;try{r.nodeType,f.nodeType}catch{r=null;break e}var m=0,c=-1,s=-1,u=0,d=0,l=t,o=null;t:for(;;){for(var a;l!==r||i!==0&&l.nodeType!==3||(c=m+i),l!==f||n!==0&&l.nodeType!==3||(s=m+n),l.nodeType===3&&(m+=l.nodeValue.length),(a=l.firstChild)!==null;)o=l,l=a;for(;;){if(l===t)break t;if(o===r&&++u===i&&(c=m),o===f&&++d===n&&(s=m),(a=l.nextSibling)!==null)break;l=o,o=l.parentNode}l=a}r=c===-1||s===-1?null:{start:c,end:s}}else r=null}r=r||{start:0,end:0}}else r=null;for(Wc={focusedElem:t,selectionRange:r},Ao=!1,ke=e;ke!==null;)if(e=ke,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ke=t;else for(;ke!==null;){e=ke;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var g=h.memoizedProps,p=h.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:br(e.type,g),p);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(_){ut(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,ke=t;break}ke=e.return}return h=Ih,Ih=!1,h}function zs(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var f=i.destroy;i.destroy=void 0,f!==void 0&&nu(e,r,f)}i=i.next}while(i!==n)}}function ml(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function iu(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Lp(t){var e=t.alternate;e!==null&&(t.alternate=null,Lp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$r],delete e[ua],delete e[Hc],delete e[Gv],delete e[$v])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ip(t){return t.tag===5||t.tag===3||t.tag===4}function Nh(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ip(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function su(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Fo));else if(n!==4&&(t=t.child,t!==null))for(su(t,e,r),t=t.sibling;t!==null;)su(t,e,r),t=t.sibling}function au(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(au(t,e,r),t=t.sibling;t!==null;)au(t,e,r),t=t.sibling}var Pt=null,Rr=!1;function Tn(t,e,r){for(r=r.child;r!==null;)Np(t,e,r),r=r.sibling}function Np(t,e,r){if(Kr&&typeof Kr.onCommitFiberUnmount=="function")try{Kr.onCommitFiberUnmount(ll,r)}catch{}switch(r.tag){case 5:Wt||Xi(r,e);case 6:var n=Pt,i=Rr;Pt=null,Tn(t,e,r),Pt=n,Rr=i,Pt!==null&&(Rr?(t=Pt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Pt.removeChild(r.stateNode));break;case 18:Pt!==null&&(Rr?(t=Pt,r=r.stateNode,t.nodeType===8?Ql(t.parentNode,r):t.nodeType===1&&Ql(t,r),sa(t)):Ql(Pt,r.stateNode));break;case 4:n=Pt,i=Rr,Pt=r.stateNode.containerInfo,Rr=!0,Tn(t,e,r),Pt=n,Rr=i;break;case 0:case 11:case 14:case 15:if(!Wt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var f=i,m=f.destroy;f=f.tag,m!==void 0&&(f&2||f&4)&&nu(r,e,m),i=i.next}while(i!==n)}Tn(t,e,r);break;case 1:if(!Wt&&(Xi(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){ut(r,e,c)}Tn(t,e,r);break;case 21:Tn(t,e,r);break;case 22:r.mode&1?(Wt=(n=Wt)||r.memoizedState!==null,Tn(t,e,r),Wt=n):Tn(t,e,r);break;default:Tn(t,e,r)}}function Bh(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new ux),e.forEach(function(n){var i=_x.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Pr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var f=t,m=e,c=m;e:for(;c!==null;){switch(c.tag){case 5:Pt=c.stateNode,Rr=!1;break e;case 3:Pt=c.stateNode.containerInfo,Rr=!0;break e;case 4:Pt=c.stateNode.containerInfo,Rr=!0;break e}c=c.return}if(Pt===null)throw Error(ye(160));Np(f,m,i),Pt=null,Rr=!1;var s=i.alternate;s!==null&&(s.return=null),i.return=null}catch(u){ut(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Bp(e,t),e=e.sibling}function Bp(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Pr(e,t),Hr(t),n&4){try{zs(3,t,t.return),ml(3,t)}catch(g){ut(t,t.return,g)}try{zs(5,t,t.return)}catch(g){ut(t,t.return,g)}}break;case 1:Pr(e,t),Hr(t),n&512&&r!==null&&Xi(r,r.return);break;case 5:if(Pr(e,t),Hr(t),n&512&&r!==null&&Xi(r,r.return),t.flags&32){var i=t.stateNode;try{ta(i,"")}catch(g){ut(t,t.return,g)}}if(n&4&&(i=t.stateNode,i!=null)){var f=t.memoizedProps,m=r!==null?r.memoizedProps:f,c=t.type,s=t.updateQueue;if(t.updateQueue=null,s!==null)try{c==="input"&&f.type==="radio"&&f.name!=null&&sd(i,f),Fc(c,m);var u=Fc(c,f);for(m=0;m<s.length;m+=2){var d=s[m],l=s[m+1];d==="style"?ud(i,l):d==="dangerouslySetInnerHTML"?ld(i,l):d==="children"?ta(i,l):Su(i,d,l,u)}switch(c){case"input":Ec(i,f);break;case"textarea":ad(i,f);break;case"select":var o=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!f.multiple;var a=f.value;a!=null?Vi(i,!!f.multiple,a,!1):o!==!!f.multiple&&(f.defaultValue!=null?Vi(i,!!f.multiple,f.defaultValue,!0):Vi(i,!!f.multiple,f.multiple?[]:"",!1))}i[ua]=f}catch(g){ut(t,t.return,g)}}break;case 6:if(Pr(e,t),Hr(t),n&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,f=t.memoizedProps;try{i.nodeValue=f}catch(g){ut(t,t.return,g)}}break;case 3:if(Pr(e,t),Hr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{sa(e.containerInfo)}catch(g){ut(t,t.return,g)}break;case 4:Pr(e,t),Hr(t);break;case 13:Pr(e,t),Hr(t),i=t.child,i.flags&8192&&(f=i.memoizedState!==null,i.stateNode.isHidden=f,!f||i.alternate!==null&&i.alternate.memoizedState!==null||(tf=dt())),n&4&&Bh(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Wt=(u=Wt)||d,Pr(e,t),Wt=u):Pr(e,t),Hr(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ke=t,d=t.child;d!==null;){for(l=ke=d;ke!==null;){switch(o=ke,a=o.child,o.tag){case 0:case 11:case 14:case 15:zs(4,o,o.return);break;case 1:Xi(o,o.return);var h=o.stateNode;if(typeof h.componentWillUnmount=="function"){n=o,r=o.return;try{e=n,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(g){ut(n,r,g)}}break;case 5:Xi(o,o.return);break;case 22:if(o.memoizedState!==null){Uh(l);continue}}a!==null?(a.return=o,ke=a):Uh(l)}d=d.sibling}e:for(d=null,l=t;;){if(l.tag===5){if(d===null){d=l;try{i=l.stateNode,u?(f=i.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(c=l.stateNode,s=l.memoizedProps.style,m=s!=null&&s.hasOwnProperty("display")?s.display:null,c.style.display=cd("display",m))}catch(g){ut(t,t.return,g)}}}else if(l.tag===6){if(d===null)try{l.stateNode.nodeValue=u?"":l.memoizedProps}catch(g){ut(t,t.return,g)}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===t)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===t)break e;for(;l.sibling===null;){if(l.return===null||l.return===t)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}}break;case 19:Pr(e,t),Hr(t),n&4&&Bh(t);break;case 21:break;default:Pr(e,t),Hr(t)}}function Hr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Ip(r)){var n=r;break e}r=r.return}throw Error(ye(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ta(i,""),n.flags&=-33);var f=Nh(t);au(t,f,i);break;case 3:case 4:var m=n.stateNode.containerInfo,c=Nh(t);su(t,c,m);break;default:throw Error(ye(161))}}catch(s){ut(t,t.return,s)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hx(t,e,r){ke=t,jp(t)}function jp(t,e,r){for(var n=(t.mode&1)!==0;ke!==null;){var i=ke,f=i.child;if(i.tag===22&&n){var m=i.memoizedState!==null||qa;if(!m){var c=i.alternate,s=c!==null&&c.memoizedState!==null||Wt;c=qa;var u=Wt;if(qa=m,(Wt=s)&&!u)for(ke=i;ke!==null;)m=ke,s=m.child,m.tag===22&&m.memoizedState!==null?Wh(i):s!==null?(s.return=m,ke=s):Wh(i);for(;f!==null;)ke=f,jp(f),f=f.sibling;ke=i,qa=c,Wt=u}jh(t)}else i.subtreeFlags&8772&&f!==null?(f.return=i,ke=f):jh(t)}}function jh(t){for(;ke!==null;){var e=ke;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wt||ml(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Wt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:br(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var f=e.updateQueue;f!==null&&Sh(e,f,n);break;case 3:var m=e.updateQueue;if(m!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Sh(e,m,r)}break;case 5:var c=e.stateNode;if(r===null&&e.flags&4){r=c;var s=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":s.autoFocus&&r.focus();break;case"img":s.src&&(r.src=s.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var l=d.dehydrated;l!==null&&sa(l)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Wt||e.flags&512&&iu(e)}catch(o){ut(e,e.return,o)}}if(e===t){ke=null;break}if(r=e.sibling,r!==null){r.return=e.return,ke=r;break}ke=e.return}}function Uh(t){for(;ke!==null;){var e=ke;if(e===t){ke=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ke=r;break}ke=e.return}}function Wh(t){for(;ke!==null;){var e=ke;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ml(4,e)}catch(s){ut(e,r,s)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(s){ut(e,i,s)}}var f=e.return;try{iu(e)}catch(s){ut(e,f,s)}break;case 5:var m=e.return;try{iu(e)}catch(s){ut(e,m,s)}}}catch(s){ut(e,e.return,s)}if(e===t){ke=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ke=c;break}ke=e.return}}var dx=Math.ceil,Wo=_n.ReactCurrentDispatcher,Zu=_n.ReactCurrentOwner,Er=_n.ReactCurrentBatchConfig,We=0,At=null,mt=null,Rt=0,ur=0,Hi=$n(0),wt=0,ma=null,pi=0,vl=0,ef=0,Xs=null,er=null,tf=0,ls=1/0,nn=null,zo=!1,ou=null,jn=null,Ja=!1,Dn=null,Xo=0,Hs=0,lu=null,yo=-1,_o=0;function Kt(){return We&6?dt():yo!==-1?yo:yo=dt()}function Un(t){return t.mode&1?We&2&&Rt!==0?Rt&-Rt:Qv.transition!==null?(_o===0&&(_o=Sd()),_o):(t=Ge,t!==0||(t=window.event,t=t===void 0?16:Pd(t.type)),t):1}function Br(t,e,r,n){if(50<Hs)throw Hs=0,lu=null,Error(ye(185));Ta(t,r,n),(!(We&2)||t!==At)&&(t===At&&(!(We&2)&&(vl|=r),wt===4&&Pn(t,Rt)),ir(t,n),r===1&&We===0&&!(e.mode&1)&&(ls=dt()+500,dl&&Kn()))}function ir(t,e){var r=t.callbackNode;Qm(t,e);var n=Oo(t,t===At?Rt:0);if(n===0)r!==null&&Qf(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Qf(r),e===1)t.tag===0?Kv(zh.bind(null,t)):$d(zh.bind(null,t)),Yv(function(){!(We&6)&&Kn()}),r=null;else{switch(Cd(n)){case 1:r=Au;break;case 4:r=_d;break;case 16:r=Eo;break;case 536870912:r=wd;break;default:r=Eo}r=Gp(r,Up.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Up(t,e){if(yo=-1,_o=0,We&6)throw Error(ye(327));var r=t.callbackNode;if(qi()&&t.callbackNode!==r)return null;var n=Oo(t,t===At?Rt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ho(t,n);else{e=n;var i=We;We|=2;var f=zp();(At!==t||Rt!==e)&&(nn=null,ls=dt()+500,oi(t,e));do try{mx();break}catch(c){Wp(t,c)}while(!0);Uu(),Wo.current=f,We=i,mt!==null?e=0:(At=null,Rt=0,e=wt)}if(e!==0){if(e===2&&(i=Lc(t),i!==0&&(n=i,e=cu(t,i))),e===1)throw r=ma,oi(t,0),Pn(t,n),ir(t,dt()),r;if(e===6)Pn(t,n);else{if(i=t.current.alternate,!(n&30)&&!px(i)&&(e=Ho(t,n),e===2&&(f=Lc(t),f!==0&&(n=f,e=cu(t,f))),e===1))throw r=ma,oi(t,0),Pn(t,n),ir(t,dt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ye(345));case 2:ti(t,er,nn);break;case 3:if(Pn(t,n),(n&130023424)===n&&(e=tf+500-dt(),10<e)){if(Oo(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Kt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Xc(ti.bind(null,t,er,nn),e);break}ti(t,er,nn);break;case 4:if(Pn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var m=31-Nr(n);f=1<<m,m=e[m],m>i&&(i=m),n&=~f}if(n=i,n=dt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*dx(n/1960))-n,10<n){t.timeoutHandle=Xc(ti.bind(null,t,er,nn),n);break}ti(t,er,nn);break;case 5:ti(t,er,nn);break;default:throw Error(ye(329))}}}return ir(t,dt()),t.callbackNode===r?Up.bind(null,t):null}function cu(t,e){var r=Xs;return t.current.memoizedState.isDehydrated&&(oi(t,e).flags|=256),t=Ho(t,e),t!==2&&(e=er,er=r,e!==null&&uu(e)),t}function uu(t){er===null?er=t:er.push.apply(er,t)}function px(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],f=i.getSnapshot;i=i.value;try{if(!Wr(f(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~ef,e&=~vl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Nr(e),n=1<<r;t[r]=-1,e&=~n}}function zh(t){if(We&6)throw Error(ye(327));qi();var e=Oo(t,0);if(!(e&1))return ir(t,dt()),null;var r=Ho(t,e);if(t.tag!==0&&r===2){var n=Lc(t);n!==0&&(e=n,r=cu(t,n))}if(r===1)throw r=ma,oi(t,0),Pn(t,e),ir(t,dt()),r;if(r===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ti(t,er,nn),ir(t,dt()),null}function rf(t,e){var r=We;We|=1;try{return t(e)}finally{We=r,We===0&&(ls=dt()+500,dl&&Kn())}}function gi(t){Dn!==null&&Dn.tag===0&&!(We&6)&&qi();var e=We;We|=1;var r=Er.transition,n=Ge;try{if(Er.transition=null,Ge=1,t)return t()}finally{Ge=n,Er.transition=r,We=e,!(We&6)&&Kn()}}function nf(){ur=Hi.current,Ze(Hi)}function oi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Hv(r)),mt!==null)for(r=mt.return;r!==null;){var n=r;switch(Nu(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Do();break;case 3:as(),Ze(rr),Ze(Yt),Vu();break;case 5:Yu(n);break;case 4:as();break;case 13:Ze(at);break;case 19:Ze(at);break;case 10:Wu(n.type._context);break;case 22:case 23:nf()}r=r.return}if(At=t,mt=t=Wn(t.current,null),Rt=ur=e,wt=0,ma=null,ef=vl=pi=0,er=Xs=null,si!==null){for(e=0;e<si.length;e++)if(r=si[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,f=r.pending;if(f!==null){var m=f.next;f.next=i,n.next=m}r.pending=n}si=null}return t}function Wp(t,e){do{var r=mt;try{if(Uu(),mo.current=Uo,jo){for(var n=ot.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}jo=!1}if(di=0,Ct=_t=ot=null,Ws=!1,da=0,Zu.current=null,r===null||r.return===null){wt=1,ma=e,mt=null;break}e:{var f=t,m=r.return,c=r,s=e;if(e=Rt,c.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){var u=s,d=c,l=d.tag;if(!(d.mode&1)&&(l===0||l===11||l===15)){var o=d.alternate;o?(d.updateQueue=o.updateQueue,d.memoizedState=o.memoizedState,d.lanes=o.lanes):(d.updateQueue=null,d.memoizedState=null)}var a=Ph(m);if(a!==null){a.flags&=-257,Fh(a,m,c,f,e),a.mode&1&&kh(f,u,e),e=a,s=u;var h=e.updateQueue;if(h===null){var g=new Set;g.add(s),e.updateQueue=g}else h.add(s);break e}else{if(!(e&1)){kh(f,u,e),sf();break e}s=Error(ye(426))}}else if(rt&&c.mode&1){var p=Ph(m);if(p!==null){!(p.flags&65536)&&(p.flags|=256),Fh(p,m,c,f,e),Bu(os(s,c));break e}}f=s=os(s,c),wt!==4&&(wt=2),Xs===null?Xs=[f]:Xs.push(f),f=m;do{switch(f.tag){case 3:f.flags|=65536,e&=-e,f.lanes|=e;var v=Tp(f,s,e);wh(f,v);break e;case 1:c=s;var x=f.type,y=f.stateNode;if(!(f.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(jn===null||!jn.has(y)))){f.flags|=65536,e&=-e,f.lanes|=e;var _=Ep(f,c,e);wh(f,_);break e}}f=f.return}while(f!==null)}Hp(r)}catch(w){e=w,mt===r&&r!==null&&(mt=r=r.return);continue}break}while(!0)}function zp(){var t=Wo.current;return Wo.current=Uo,t===null?Uo:t}function sf(){(wt===0||wt===3||wt===2)&&(wt=4),At===null||!(pi&268435455)&&!(vl&268435455)||Pn(At,Rt)}function Ho(t,e){var r=We;We|=2;var n=zp();(At!==t||Rt!==e)&&(nn=null,oi(t,e));do try{gx();break}catch(i){Wp(t,i)}while(!0);if(Uu(),We=r,Wo.current=n,mt!==null)throw Error(ye(261));return At=null,Rt=0,wt}function gx(){for(;mt!==null;)Xp(mt)}function mx(){for(;mt!==null&&!Wm();)Xp(mt)}function Xp(t){var e=Vp(t.alternate,t,ur);t.memoizedProps=t.pendingProps,e===null?Hp(t):mt=e,Zu.current=null}function Hp(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=cx(r,e),r!==null){r.flags&=32767,mt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,mt=null;return}}else if(r=lx(r,e,ur),r!==null){mt=r;return}if(e=e.sibling,e!==null){mt=e;return}mt=e=t}while(e!==null);wt===0&&(wt=5)}function ti(t,e,r){var n=Ge,i=Er.transition;try{Er.transition=null,Ge=1,vx(t,e,r,n)}finally{Er.transition=i,Ge=n}return null}function vx(t,e,r,n){do qi();while(Dn!==null);if(We&6)throw Error(ye(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var f=r.lanes|r.childLanes;if(qm(t,f),t===At&&(mt=At=null,Rt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ja||(Ja=!0,Gp(Eo,function(){return qi(),null})),f=(r.flags&15990)!==0,r.subtreeFlags&15990||f){f=Er.transition,Er.transition=null;var m=Ge;Ge=1;var c=We;We|=4,Zu.current=null,fx(t,r),Bp(r,t),Nv(Wc),Ao=!!Uc,Wc=Uc=null,t.current=r,hx(r),zm(),We=c,Ge=m,Er.transition=f}else t.current=r;if(Ja&&(Ja=!1,Dn=t,Xo=i),f=t.pendingLanes,f===0&&(jn=null),Ym(r.stateNode),ir(t,dt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(zo)throw zo=!1,t=ou,ou=null,t;return Xo&1&&t.tag!==0&&qi(),f=t.pendingLanes,f&1?t===lu?Hs++:(Hs=0,lu=t):Hs=0,Kn(),null}function qi(){if(Dn!==null){var t=Cd(Xo),e=Er.transition,r=Ge;try{if(Er.transition=null,Ge=16>t?16:t,Dn===null)var n=!1;else{if(t=Dn,Dn=null,Xo=0,We&6)throw Error(ye(331));var i=We;for(We|=4,ke=t.current;ke!==null;){var f=ke,m=f.child;if(ke.flags&16){var c=f.deletions;if(c!==null){for(var s=0;s<c.length;s++){var u=c[s];for(ke=u;ke!==null;){var d=ke;switch(d.tag){case 0:case 11:case 15:zs(8,d,f)}var l=d.child;if(l!==null)l.return=d,ke=l;else for(;ke!==null;){d=ke;var o=d.sibling,a=d.return;if(Lp(d),d===u){ke=null;break}if(o!==null){o.return=a,ke=o;break}ke=a}}}var h=f.alternate;if(h!==null){var g=h.child;if(g!==null){h.child=null;do{var p=g.sibling;g.sibling=null,g=p}while(g!==null)}}ke=f}}if(f.subtreeFlags&2064&&m!==null)m.return=f,ke=m;else e:for(;ke!==null;){if(f=ke,f.flags&2048)switch(f.tag){case 0:case 11:case 15:zs(9,f,f.return)}var v=f.sibling;if(v!==null){v.return=f.return,ke=v;break e}ke=f.return}}var x=t.current;for(ke=x;ke!==null;){m=ke;var y=m.child;if(m.subtreeFlags&2064&&y!==null)y.return=m,ke=y;else e:for(m=x;ke!==null;){if(c=ke,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ml(9,c)}}catch(w){ut(c,c.return,w)}if(c===m){ke=null;break e}var _=c.sibling;if(_!==null){_.return=c.return,ke=_;break e}ke=c.return}}if(We=i,Kn(),Kr&&typeof Kr.onPostCommitFiberRoot=="function")try{Kr.onPostCommitFiberRoot(ll,t)}catch{}n=!0}return n}finally{Ge=r,Er.transition=e}}return!1}function Xh(t,e,r){e=os(r,e),e=Tp(t,e,1),t=Bn(t,e,1),e=Kt(),t!==null&&(Ta(t,1,e),ir(t,e))}function ut(t,e,r){if(t.tag===3)Xh(t,t,r);else for(;e!==null;){if(e.tag===3){Xh(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(jn===null||!jn.has(n))){t=os(r,t),t=Ep(e,t,1),e=Bn(e,t,1),t=Kt(),e!==null&&(Ta(e,1,t),ir(e,t));break}}e=e.return}}function xx(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Kt(),t.pingedLanes|=t.suspendedLanes&r,At===t&&(Rt&r)===r&&(wt===4||wt===3&&(Rt&130023424)===Rt&&500>dt()-tf?oi(t,0):ef|=r),ir(t,e)}function Yp(t,e){e===0&&(t.mode&1?(e=za,za<<=1,!(za&130023424)&&(za=4194304)):e=1);var r=Kt();t=mn(t,e),t!==null&&(Ta(t,e,r),ir(t,r))}function yx(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Yp(t,r)}function _x(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ye(314))}n!==null&&n.delete(e),Yp(t,r)}var Vp;Vp=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||rr.current)tr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return tr=!1,ox(t,e,r);tr=!!(t.flags&131072)}else tr=!1,rt&&e.flags&1048576&&Kd(e,Mo,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;xo(t,e),t=e.pendingProps;var i=ns(e,Yt.current);Qi(e,r),i=$u(null,e,n,t,i,r);var f=Ku();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nr(n)?(f=!0,bo(e)):f=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Xu(e),i.updater=pl,e.stateNode=i,i._reactInternals=e,Qc(e,n,t,r),e=Zc(null,e,n,!0,f,r)):(e.tag=0,rt&&f&&Iu(e),Vt(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(xo(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Sx(n),t=br(n,t),i){case 0:e=Jc(null,e,n,t,r);break e;case 1:e=Rh(null,e,n,t,r);break e;case 11:e=Dh(null,e,n,t,r);break e;case 14:e=bh(null,e,n,br(n.type,t),r);break e}throw Error(ye(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Jc(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Rh(t,e,n,i,r);case 3:e:{if(Pp(e),t===null)throw Error(ye(387));n=e.pendingProps,f=e.memoizedState,i=f.element,Zd(t,e),No(e,n,null,r);var m=e.memoizedState;if(n=m.element,f.isDehydrated)if(f={element:n,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},e.updateQueue.baseState=f,e.memoizedState=f,e.flags&256){i=os(Error(ye(423)),e),e=Mh(t,e,n,r,i);break e}else if(n!==i){i=os(Error(ye(424)),e),e=Mh(t,e,n,r,i);break e}else for(pr=Nn(e.stateNode.containerInfo.firstChild),gr=e,rt=!0,Mr=null,r=np(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(is(),n===i){e=vn(t,e,r);break e}Vt(t,e,n,r)}e=e.child}return e;case 5:return ip(e),t===null&&Gc(e),n=e.type,i=e.pendingProps,f=t!==null?t.memoizedProps:null,m=i.children,zc(n,i)?m=null:f!==null&&zc(n,f)&&(e.flags|=32),kp(t,e),Vt(t,e,m,r),e.child;case 6:return t===null&&Gc(e),null;case 13:return Fp(t,e,r);case 4:return Hu(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=ss(e,null,n,r):Vt(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),Dh(t,e,n,i,r);case 7:return Vt(t,e,e.pendingProps,r),e.child;case 8:return Vt(t,e,e.pendingProps.children,r),e.child;case 12:return Vt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,f=e.memoizedProps,m=i.value,qe(Lo,n._currentValue),n._currentValue=m,f!==null)if(Wr(f.value,m)){if(f.children===i.children&&!rr.current){e=vn(t,e,r);break e}}else for(f=e.child,f!==null&&(f.return=e);f!==null;){var c=f.dependencies;if(c!==null){m=f.child;for(var s=c.firstContext;s!==null;){if(s.context===n){if(f.tag===1){s=cn(-1,r&-r),s.tag=2;var u=f.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?s.next=s:(s.next=d.next,d.next=s),u.pending=s}}f.lanes|=r,s=f.alternate,s!==null&&(s.lanes|=r),$c(f.return,r,e),c.lanes|=r;break}s=s.next}}else if(f.tag===10)m=f.type===e.type?null:f.child;else if(f.tag===18){if(m=f.return,m===null)throw Error(ye(341));m.lanes|=r,c=m.alternate,c!==null&&(c.lanes|=r),$c(m,r,e),m=f.sibling}else m=f.child;if(m!==null)m.return=f;else for(m=f;m!==null;){if(m===e){m=null;break}if(f=m.sibling,f!==null){f.return=m.return,m=f;break}m=m.return}f=m}Vt(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Qi(e,r),i=Or(i),n=n(i),e.flags|=1,Vt(t,e,n,r),e.child;case 14:return n=e.type,i=br(n,e.pendingProps),i=br(n.type,i),bh(t,e,n,i,r);case 15:return Op(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:br(n,i),xo(t,e),e.tag=1,nr(n)?(t=!0,bo(e)):t=!1,Qi(e,r),tp(e,n,i),Qc(e,n,i,r),Zc(null,e,n,!0,t,r);case 19:return Dp(t,e,r);case 22:return Ap(t,e,r)}throw Error(ye(156,e.tag))};function Gp(t,e){return yd(t,e)}function wx(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(t,e,r,n){return new wx(t,e,r,n)}function af(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Sx(t){if(typeof t=="function")return af(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tu)return 11;if(t===Eu)return 14}return 2}function Wn(t,e){var r=t.alternate;return r===null?(r=Tr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function wo(t,e,r,n,i,f){var m=2;if(n=t,typeof t=="function")af(t)&&(m=1);else if(typeof t=="string")m=5;else e:switch(t){case Mi:return li(r.children,i,f,e);case Cu:m=8,i|=8;break;case _c:return t=Tr(12,r,e,i|2),t.elementType=_c,t.lanes=f,t;case wc:return t=Tr(13,r,e,i),t.elementType=wc,t.lanes=f,t;case Sc:return t=Tr(19,r,e,i),t.elementType=Sc,t.lanes=f,t;case rd:return xl(r,i,f,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ed:m=10;break e;case td:m=9;break e;case Tu:m=11;break e;case Eu:m=14;break e;case On:m=16,n=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=Tr(m,r,e,i),e.elementType=t,e.type=n,e.lanes=f,e}function li(t,e,r,n){return t=Tr(7,t,n,e),t.lanes=r,t}function xl(t,e,r,n){return t=Tr(22,t,n,e),t.elementType=rd,t.lanes=r,t.stateNode={isHidden:!1},t}function ic(t,e,r){return t=Tr(6,t,null,e),t.lanes=r,t}function sc(t,e,r){return e=Tr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Cx(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jl(0),this.expirationTimes=jl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jl(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function of(t,e,r,n,i,f,m,c,s){return t=new Cx(t,e,r,c,s),e===1?(e=1,f===!0&&(e|=8)):e=0,f=Tr(3,null,null,e),t.current=f,f.stateNode=t,f.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xu(f),t}function Tx(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ri,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function $p(t){if(!t)return Xn;t=t._reactInternals;e:{if(wi(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var r=t.type;if(nr(r))return Gd(t,r,e)}return e}function Kp(t,e,r,n,i,f,m,c,s){return t=of(r,n,!0,t,i,f,m,c,s),t.context=$p(null),r=t.current,n=Kt(),i=Un(r),f=cn(n,i),f.callback=e??null,Bn(r,f,i),t.current.lanes=i,Ta(t,i,n),ir(t,n),t}function yl(t,e,r,n){var i=e.current,f=Kt(),m=Un(i);return r=$p(r),e.context===null?e.context=r:e.pendingContext=r,e=cn(f,m),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Bn(i,e,m),t!==null&&(Br(t,i,m,f),go(t,i,m)),m}function Yo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Hh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function lf(t,e){Hh(t,e),(t=t.alternate)&&Hh(t,e)}function Ex(){return null}var Qp=typeof reportError=="function"?reportError:function(t){console.error(t)};function cf(t){this._internalRoot=t}_l.prototype.render=cf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));yl(t,e,null,null)};_l.prototype.unmount=cf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gi(function(){yl(null,t,null,null)}),e[gn]=null}};function _l(t){this._internalRoot=t}_l.prototype.unstable_scheduleHydration=function(t){if(t){var e=Od();t={blockedOn:null,target:t,priority:e};for(var r=0;r<kn.length&&e!==0&&e<kn[r].priority;r++);kn.splice(r,0,t),r===0&&kd(t)}};function uf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Yh(){}function Ox(t,e,r,n,i){if(i){if(typeof n=="function"){var f=n;n=function(){var u=Yo(m);f.call(u)}}var m=Kp(e,n,t,0,null,!1,!1,"",Yh);return t._reactRootContainer=m,t[gn]=m.current,la(t.nodeType===8?t.parentNode:t),gi(),m}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var c=n;n=function(){var u=Yo(s);c.call(u)}}var s=of(t,0,!1,null,null,!1,!1,"",Yh);return t._reactRootContainer=s,t[gn]=s.current,la(t.nodeType===8?t.parentNode:t),gi(function(){yl(e,s,r,n)}),s}function Sl(t,e,r,n,i){var f=r._reactRootContainer;if(f){var m=f;if(typeof i=="function"){var c=i;i=function(){var s=Yo(m);c.call(s)}}yl(e,m,t,i)}else m=Ox(r,e,t,i,n);return Yo(m)}Td=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Rs(e.pendingLanes);r!==0&&(ku(e,r|1),ir(e,dt()),!(We&6)&&(ls=dt()+500,Kn()))}break;case 13:gi(function(){var n=mn(t,1);if(n!==null){var i=Kt();Br(n,t,1,i)}}),lf(t,1)}};Pu=function(t){if(t.tag===13){var e=mn(t,134217728);if(e!==null){var r=Kt();Br(e,t,134217728,r)}lf(t,134217728)}};Ed=function(t){if(t.tag===13){var e=Un(t),r=mn(t,e);if(r!==null){var n=Kt();Br(r,t,e,n)}lf(t,e)}};Od=function(){return Ge};Ad=function(t,e){var r=Ge;try{return Ge=t,e()}finally{Ge=r}};bc=function(t,e,r){switch(e){case"input":if(Ec(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=hl(n);if(!i)throw Error(ye(90));id(n),Ec(n,i)}}}break;case"textarea":ad(t,r);break;case"select":e=r.value,e!=null&&Vi(t,!!r.multiple,e,!1)}};dd=rf;pd=gi;var Ax={usingClientEntryPoint:!1,Events:[Oa,Bi,hl,fd,hd,rf]},ks={findFiberByHostInstance:ii,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},kx={bundleType:ks.bundleType,version:ks.version,rendererPackageName:ks.rendererPackageName,rendererConfig:ks.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_n.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vd(t),t===null?null:t.stateNode},findFiberByHostInstance:ks.findFiberByHostInstance||Ex,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Za=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Za.isDisabled&&Za.supportsFiber)try{ll=Za.inject(kx),Kr=Za}catch{}}xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ax;xr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uf(e))throw Error(ye(200));return Tx(t,e,null,r)};xr.createRoot=function(t,e){if(!uf(t))throw Error(ye(299));var r=!1,n="",i=Qp;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=of(t,1,!1,null,null,r,!1,n,i),t[gn]=e.current,la(t.nodeType===8?t.parentNode:t),new cf(e)};xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=vd(e),t=t===null?null:t.stateNode,t};xr.flushSync=function(t){return gi(t)};xr.hydrate=function(t,e,r){if(!wl(e))throw Error(ye(200));return Sl(null,t,e,!0,r)};xr.hydrateRoot=function(t,e,r){if(!uf(t))throw Error(ye(405));var n=r!=null&&r.hydratedSources||null,i=!1,f="",m=Qp;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onRecoverableError!==void 0&&(m=r.onRecoverableError)),e=Kp(e,null,t,1,r??null,i,!1,f,m),t[gn]=e.current,la(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new _l(e)};xr.render=function(t,e,r){if(!wl(e))throw Error(ye(200));return Sl(null,t,e,!1,r)};xr.unmountComponentAtNode=function(t){if(!wl(t))throw Error(ye(40));return t._reactRootContainer?(gi(function(){Sl(null,null,t,!1,function(){t._reactRootContainer=null,t[gn]=null})}),!0):!1};xr.unstable_batchedUpdates=rf;xr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!wl(r))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return Sl(t,e,r,!1,n)};xr.version="18.2.0-next-9e3b772b8-20220608";function qp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qp)}catch(t){console.error(t)}}qp(),K0.exports=xr;var ff=K0.exports,Vh=ff;xc.createRoot=Vh.createRoot,xc.hydrateRoot=Vh.hydrateRoot;var Fe={};const Px={},Fx=Object.freeze(Object.defineProperty({__proto__:null,default:Px},Symbol.toStringTag,{value:"Module"})),ac=im(Fx);(function(t){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var e=e||{version:"5.3.0"};if(t.fabric=e,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?e.document=document:e.document=document.implementation.createHTMLDocument(""),e.window=window;else{var r=ac,n=new r.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;e.document=n.document,e.jsdomImplForWrapper=ac.implForWrapper,e.nodeCanvas=ac.Canvas,e.window=n,DOMParser=e.window.DOMParser}e.isTouchSupported="ontouchstart"in e.window||"ontouchstart"in e.document||e.window&&e.window.navigator&&e.window.navigator.maxTouchPoints>0,e.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",e.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],e.DPI=96,e.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",e.commaWsp="(?:\\s+,?\\s*|,\\s*)",e.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,e.reNonWord=/[ \n\.,;!\?\-]/,e.fontPaths={},e.iMatrix=[1,0,0,1,0,0],e.svgNS="http://www.w3.org/2000/svg",e.perfLimitSizeTotal=2097152,e.maxCacheSideLimit=4096,e.minCacheSideLimit=256,e.charWidthsCache={},e.textureSize=2048,e.disableStyleCopyPaste=!1,e.enableGLFiltering=!0,e.devicePixelRatio=e.window.devicePixelRatio||e.window.webkitDevicePixelRatio||e.window.mozDevicePixelRatio||1,e.browserShadowBlurConstant=1,e.arcToSegmentsCache={},e.boundsOfCurveCache={},e.cachesBoundsOfCurve=!0,e.forceGLPutImageData=!1,e.initFilterBackend=function(){if(e.enableGLFiltering&&e.isWebglSupported&&e.isWebglSupported(e.textureSize))return console.log("max texture size: "+e.maxTextureSize),new e.WebglFilterBackend({tileSize:e.textureSize});if(e.Canvas2dFilterBackend)return new e.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=e),function(){function c(a,h){if(this.__eventListeners[a]){var g=this.__eventListeners[a];h?g[g.indexOf(h)]=!1:e.util.array.fill(g,!1)}}function s(a,h){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var g in a)this.on(g,a[g]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(h);return this}function u(a,h){var g=(function(){h.apply(this,arguments),this.off(a,g)}).bind(this);this.on(a,g)}function d(a,h){if(arguments.length===1)for(var g in a)u.call(this,g,a[g]);else u.call(this,a,h);return this}function l(a,h){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)c.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var g in a)c.call(this,g,a[g]);else c.call(this,a,h);return this}function o(a,h){if(!this.__eventListeners)return this;var g=this.__eventListeners[a];if(!g)return this;for(var p=0,v=g.length;p<v;p++)g[p]&&g[p].call(this,h||{});return this.__eventListeners[a]=g.filter(function(x){return x!==!1}),this}e.Observable={fire:o,on:s,once:d,off:l}}(),e.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var c=0,s=arguments.length;c<s;c++)this._onObjectAdded(arguments[c]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(c,s,u){var d=this._objects;return u?d[s]=c:d.splice(s,0,c),this._onObjectAdded&&this._onObjectAdded(c),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var c=this._objects,s,u=!1,d=0,l=arguments.length;d<l;d++)s=c.indexOf(arguments[d]),s!==-1&&(u=!0,c.splice(s,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&u&&this.requestRenderAll(),this},forEachObject:function(c,s){for(var u=this.getObjects(),d=0,l=u.length;d<l;d++)c.call(s,u[d],d,u);return this},getObjects:function(c){return typeof c>"u"?this._objects.concat():this._objects.filter(function(s){return s.type===c})},item:function(c){return this._objects[c]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(c,s){return this._objects.indexOf(c)>-1?!0:s?this._objects.some(function(u){return typeof u.contains=="function"&&u.contains(c,!0)}):!1},complexity:function(){return this._objects.reduce(function(c,s){return c+=s.complexity?s.complexity():0,c},0)}},e.CommonMethods={_setOptions:function(c){for(var s in c)this.set(s,c[s])},_initGradient:function(c,s){c&&c.colorStops&&!(c instanceof e.Gradient)&&this.set(s,new e.Gradient(c))},_initPattern:function(c,s,u){c&&c.source&&!(c instanceof e.Pattern)?this.set(s,new e.Pattern(c,u)):u&&u()},_setObject:function(c){for(var s in c)this._set(s,c[s])},set:function(c,s){return typeof c=="object"?this._setObject(c):this._set(c,s),this},_set:function(c,s){this[c]=s},toggle:function(c){var s=this.get(c);return typeof s=="boolean"&&this.set(c,!s),this},get:function(c){return this[c]}},function(c){var s=Math.sqrt,u=Math.atan2,d=Math.pow,l=Math.PI/180,o=Math.PI/2;e.util={cos:function(a){if(a===0)return 1;a<0&&(a=-a);var h=a/o;switch(h){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var h=a/o,g=1;switch(a<0&&(g=-1),h){case 1:return g;case 2:return 0;case 3:return-g}return Math.sin(a)},removeFromArray:function(a,h){var g=a.indexOf(h);return g!==-1&&a.splice(g,1),a},getRandomInt:function(a,h){return Math.floor(Math.random()*(h-a+1))+a},degreesToRadians:function(a){return a*l},radiansToDegrees:function(a){return a/l},rotatePoint:function(a,h,g){var p=new e.Point(a.x-h.x,a.y-h.y),v=e.util.rotateVector(p,g);return new e.Point(v.x,v.y).addEquals(h)},rotateVector:function(a,h){var g=e.util.sin(h),p=e.util.cos(h),v=a.x*p-a.y*g,x=a.x*g+a.y*p;return{x:v,y:x}},createVector:function(a,h){return new e.Point(h.x-a.x,h.y-a.y)},calcAngleBetweenVectors:function(a,h){return Math.acos((a.x*h.x+a.y*h.y)/(Math.hypot(a.x,a.y)*Math.hypot(h.x,h.y)))},getHatVector:function(a){return new e.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,h,g){var p=e.util.createVector(a,h),v=e.util.createVector(a,g),x=e.util.calcAngleBetweenVectors(p,v),y=e.util.calcAngleBetweenVectors(e.util.rotateVector(p,x),v),_=x*(y===0?1:-1)/2;return{vector:e.util.getHatVector(e.util.rotateVector(p,_)),angle:x}},projectStrokeOnPoints:function(a,h,g){var p=[],v=h.strokeWidth/2,x=h.strokeUniform?new e.Point(1/h.scaleX,1/h.scaleY):new e.Point(1,1),y=function(_){var w=v/Math.hypot(_.x,_.y);return new e.Point(_.x*w*x.x,_.y*w*x.y)};return a.length<=1||a.forEach(function(_,w){var C=new e.Point(_.x,_.y),S,O;w===0?(O=a[w+1],S=g?y(e.util.createVector(O,C)).addEquals(C):a[a.length-1]):w===a.length-1?(S=a[w-1],O=g?y(e.util.createVector(S,C)).addEquals(C):a[0]):(S=a[w-1],O=a[w+1]);var F=e.util.getBisector(C,S,O),N=F.vector,W=F.angle,X,Q;if(h.strokeLineJoin==="miter"&&(X=-v/Math.sin(W/2),Q=new e.Point(N.x*X*x.x,N.y*X*x.y),Math.hypot(Q.x,Q.y)/v<=h.strokeMiterLimit)){p.push(C.add(Q)),p.push(C.subtract(Q));return}X=-v*Math.SQRT2,Q=new e.Point(N.x*X*x.x,N.y*X*x.y),p.push(C.add(Q)),p.push(C.subtract(Q))}),p},transformPoint:function(a,h,g){return g?new e.Point(h[0]*a.x+h[2]*a.y,h[1]*a.x+h[3]*a.y):new e.Point(h[0]*a.x+h[2]*a.y+h[4],h[1]*a.x+h[3]*a.y+h[5])},makeBoundingBoxFromPoints:function(a,h){if(h)for(var g=0;g<a.length;g++)a[g]=e.util.transformPoint(a[g],h);var p=[a[0].x,a[1].x,a[2].x,a[3].x],v=e.util.array.min(p),x=e.util.array.max(p),y=x-v,_=[a[0].y,a[1].y,a[2].y,a[3].y],w=e.util.array.min(_),C=e.util.array.max(_),S=C-w;return{left:v,top:w,width:y,height:S}},invertTransform:function(a){var h=1/(a[0]*a[3]-a[1]*a[2]),g=[h*a[3],-h*a[1],-h*a[2],h*a[0]],p=e.util.transformPoint({x:a[4],y:a[5]},g,!0);return g[4]=-p.x,g[5]=-p.y,g},toFixed:function(a,h){return parseFloat(Number(a).toFixed(h))},parseUnit:function(a,h){var g=/\D{0,2}$/.exec(a),p=parseFloat(a);switch(h||(h=e.Text.DEFAULT_SVG_FONT_SIZE),g[0]){case"mm":return p*e.DPI/25.4;case"cm":return p*e.DPI/2.54;case"in":return p*e.DPI;case"pt":return p*e.DPI/72;case"pc":return p*e.DPI/72*12;case"em":return p*h;default:return p}},falseFunction:function(){return!1},getKlass:function(a,h){return a=e.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),e.util.resolveNamespace(h)[a]},getSvgAttributes:function(a){var h=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":h=h.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":h=h.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":h=h.concat(["offset","stop-color","stop-opacity"]);break}return h},resolveNamespace:function(a){if(!a)return e;var h=a.split("."),g=h.length,p,v=c||e.window;for(p=0;p<g;++p)v=v[h[p]];return v},loadImage:function(a,h,g,p){if(!a){h&&h.call(g,a);return}var v=e.util.createImage(),x=function(){h&&h.call(g,v,!1),v=v.onload=v.onerror=null};v.onload=x,v.onerror=function(){e.log("Error loading "+v.src),h&&h.call(g,null,!0),v=v.onload=v.onerror=null},a.indexOf("data")!==0&&p!==void 0&&p!==null&&(v.crossOrigin=p),a.substring(0,14)==="data:image/svg"&&(v.onload=null,e.util.loadImageInDom(v,x)),v.src=a},loadImageInDom:function(a,h){var g=e.document.createElement("div");g.style.width=g.style.height="1px",g.style.left=g.style.top="-100%",g.style.position="absolute",g.appendChild(a),e.document.querySelector("body").appendChild(g),a.onload=function(){h(),g.parentNode.removeChild(g),g=null}},enlivenObjects:function(a,h,g,p){a=a||[];var v=[],x=0,y=a.length;function _(){++x===y&&h&&h(v.filter(function(w){return w}))}if(!y){h&&h(v);return}a.forEach(function(w,C){if(!w||!w.type){_();return}var S=e.util.getKlass(w.type,g);S.fromObject(w,function(O,F){F||(v[C]=O),p&&p(w,O,F),_()})})},enlivenObjectEnlivables:function(a,h,g){var p=e.Object.ENLIVEN_PROPS.filter(function(v){return!!a[v]});e.util.enlivenObjects(p.map(function(v){return a[v]}),function(v){var x={};p.forEach(function(y,_){x[y]=v[_],h&&(h[y]=v[_])}),g&&g(x)})},enlivenPatterns:function(a,h){a=a||[];function g(){++v===x&&h&&h(p)}var p=[],v=0,x=a.length;if(!x){h&&h(p);return}a.forEach(function(y,_){y&&y.source?new e.Pattern(y,function(w){p[_]=w,g()}):(p[_]=y,g())})},groupSVGElements:function(a,h,g){var p;return a&&a.length===1?(typeof g<"u"&&(a[0].sourcePath=g),a[0]):(h&&(h.width&&h.height?h.centerPoint={x:h.width/2,y:h.height/2}:(delete h.width,delete h.height)),p=new e.Group(a,h),typeof g<"u"&&(p.sourcePath=g),p)},populateWithProperties:function(a,h,g){if(g&&Array.isArray(g))for(var p=0,v=g.length;p<v;p++)g[p]in a&&(h[g[p]]=a[g[p]])},createCanvasElement:function(){return e.document.createElement("canvas")},copyCanvasElement:function(a){var h=e.util.createCanvasElement();return h.width=a.width,h.height=a.height,h.getContext("2d").drawImage(a,0,0),h},toDataURL:function(a,h,g){return a.toDataURL("image/"+h,g)},createImage:function(){return e.document.createElement("img")},multiplyTransformMatrices:function(a,h,g){return[a[0]*h[0]+a[2]*h[1],a[1]*h[0]+a[3]*h[1],a[0]*h[2]+a[2]*h[3],a[1]*h[2]+a[3]*h[3],g?0:a[0]*h[4]+a[2]*h[5]+a[4],g?0:a[1]*h[4]+a[3]*h[5]+a[5]]},qrDecompose:function(a){var h=u(a[1],a[0]),g=d(a[0],2)+d(a[1],2),p=s(g),v=(a[0]*a[3]-a[2]*a[1])/p,x=u(a[0]*a[2]+a[1]*a[3],g);return{angle:h/l,scaleX:p,scaleY:v,skewX:x/l,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return e.iMatrix.concat();var h=e.util.degreesToRadians(a.angle),g=e.util.cos(h),p=e.util.sin(h);return[g,p,-p,g,0,0]},calcDimensionsMatrix:function(a){var h=typeof a.scaleX>"u"?1:a.scaleX,g=typeof a.scaleY>"u"?1:a.scaleY,p=[a.flipX?-h:h,0,0,a.flipY?-g:g,0,0],v=e.util.multiplyTransformMatrices,x=e.util.degreesToRadians;return a.skewX&&(p=v(p,[1,0,Math.tan(x(a.skewX)),1],!0)),a.skewY&&(p=v(p,[1,Math.tan(x(a.skewY)),0,1],!0)),p},composeMatrix:function(a){var h=[1,0,0,1,a.translateX||0,a.translateY||0],g=e.util.multiplyTransformMatrices;return a.angle&&(h=g(h,e.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(h=g(h,e.util.calcDimensionsMatrix(a))),h},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,h,g,p){p>0&&(h>p?h-=p:h=0,g>p?g-=p:g=0);var v=!0,x,y,_=a.getImageData(h,g,p*2||1,p*2||1),w=_.data.length;for(x=3;x<w&&(y=_.data[x],v=y<=0,v!==!1);x+=4);return _=null,v},parsePreserveAspectRatioAttribute:function(a){var h="meet",g="Mid",p="Mid",v=a.split(" "),x;return v&&v.length&&(h=v.pop(),h!=="meet"&&h!=="slice"?(x=h,h="meet"):v.length&&(x=v.pop())),g=x!=="none"?x.slice(1,4):"none",p=x!=="none"?x.slice(5,8):"none",{meetOrSlice:h,alignX:g,alignY:p}},clearFabricFontCache:function(a){a=(a||"").toLowerCase(),a?e.charWidthsCache[a]&&delete e.charWidthsCache[a]:e.charWidthsCache={}},limitDimsByArea:function(a,h){var g=Math.sqrt(h*a),p=Math.floor(h/g);return{x:Math.floor(g),y:p}},capValue:function(a,h,g){return Math.max(a,Math.min(h,g))},findScaleToFit:function(a,h){return Math.min(h.width/a.width,h.height/a.height)},findScaleToCover:function(a,h){return Math.max(h.width/a.width,h.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(h){return e.util.toFixed(h,e.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,h){var g=e.util.invertTransform(h),p=e.util.multiplyTransformMatrices(g,a.calcOwnMatrix());e.util.applyTransformToObject(a,p)},addTransformToObject:function(a,h){e.util.applyTransformToObject(a,e.util.multiplyTransformMatrices(h,a.calcOwnMatrix()))},applyTransformToObject:function(a,h){var g=e.util.qrDecompose(h),p=new e.Point(g.translateX,g.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",g.scaleX),a.set("scaleY",g.scaleY),a.skewX=g.skewX,a.skewY=g.skewY,a.angle=g.angle,a.setPositionByOrigin(p,"center","center")},sizeAfterTransform:function(a,h,g){var p=a/2,v=h/2,x=[{x:-p,y:-v},{x:p,y:-v},{x:-p,y:v},{x:p,y:v}],y=e.util.calcDimensionsMatrix(g),_=e.util.makeBoundingBoxFromPoints(x,y);return{x:_.width,y:_.height}},mergeClipPaths:function(a,h){var g=a,p=h;g.inverted&&!p.inverted&&(g=h,p=a),e.util.applyTransformToObject(p,e.util.multiplyTransformMatrices(e.util.invertTransform(g.calcTransformMatrix()),p.calcTransformMatrix()));var v=g.inverted&&p.inverted;return v&&(g.inverted=p.inverted=!1),new e.Group([g],{clipPath:p,inverted:v})},hasStyleChanged:function(a,h,g){return g=g||!1,a.fill!==h.fill||a.stroke!==h.stroke||a.strokeWidth!==h.strokeWidth||a.fontSize!==h.fontSize||a.fontFamily!==h.fontFamily||a.fontWeight!==h.fontWeight||a.fontStyle!==h.fontStyle||a.textBackgroundColor!==h.textBackgroundColor||a.deltaY!==h.deltaY||g&&(a.overline!==h.overline||a.underline!==h.underline||a.linethrough!==h.linethrough)},stylesToArray:function(g,h){for(var g=e.util.object.clone(g,!0),p=h.split(`
`),v=-1,x={},y=[],_=0;_<p.length;_++){if(!g[_]){v+=p[_].length;continue}for(var w=0;w<p[_].length;w++){v++;var C=g[_][w];if(C&&Object.keys(C).length>0){var S=e.util.hasStyleChanged(x,C,!0);S?y.push({start:v,end:v+1,style:C}):y[y.length-1].end++}x=C||{}}}return y},stylesFromArray:function(a,h){if(!Array.isArray(a))return a;for(var g=h.split(`
`),p=-1,v=0,x={},y=0;y<g.length;y++)for(var _=0;_<g[y].length;_++)p++,a[v]&&a[v].start<=p&&p<a[v].end&&(x[y]=x[y]||{},x[y][_]=Object.assign({},a[v].style),p===a[v].end-1&&v++);return x}}}(t),function(){var c=Array.prototype.join,s={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},u={m:"l",M:"L"};function d(k,D,L,E,b,A,T,R,z,K,H){var G=e.util.cos(k),ue=e.util.sin(k),le=e.util.cos(D),ee=e.util.sin(D),Y=L*b*le-E*A*ee+T,ce=E*b*le+L*A*ee+R,se=K+z*(-L*b*ue-E*A*G),V=H+z*(-E*b*ue+L*A*G),he=Y+z*(L*b*ee+E*A*le),ve=ce+z*(E*b*ee-L*A*le);return["C",se,V,he,ve,Y,ce]}function l(k,D,L,E,b,A,T){var R=Math.PI,z=T*R/180,K=e.util.sin(z),H=e.util.cos(z),G=0,ue=0;L=Math.abs(L),E=Math.abs(E);var le=-H*k*.5-K*D*.5,ee=-H*D*.5+K*k*.5,Y=L*L,ce=E*E,se=ee*ee,V=le*le,he=Y*ce-Y*se-ce*V,ve=0;if(he<0){var Re=Math.sqrt(1-he/(Y*ce));L*=Re,E*=Re}else ve=(b===A?-1:1)*Math.sqrt(he/(Y*se+ce*V));var Pe=ve*L*ee/E,pe=-ve*E*le/L,De=H*Pe-K*pe+k*.5,be=K*Pe+H*pe+D*.5,Be=o(1,0,(le-Pe)/L,(ee-pe)/E),Ke=o((le-Pe)/L,(ee-pe)/E,(-le-Pe)/L,(-ee-pe)/E);A===0&&Ke>0?Ke-=2*R:A===1&&Ke<0&&(Ke+=2*R);for(var Ue=Math.ceil(Math.abs(Ke/R*2)),nt=[],ct=Ke/Ue,Xr=8/3*Math.sin(ct/4)*Math.sin(ct/4)/Math.sin(ct/2),Cn=Be+ct,lr=0;lr<Ue;lr++)nt[lr]=d(Be,Cn,H,K,L,E,De,be,Xr,G,ue),G=nt[lr][5],ue=nt[lr][6],Be=Cn,Cn+=ct;return nt}function o(k,D,L,E){var b=Math.atan2(D,k),A=Math.atan2(E,L);return A>=b?A-b:2*Math.PI-(b-A)}function a(k,D,L,E,b,A,T,R){var z;if(e.cachesBoundsOfCurve&&(z=c.call(arguments),e.boundsOfCurveCache[z]))return e.boundsOfCurveCache[z];var K=Math.sqrt,H=Math.min,G=Math.max,ue=Math.abs,le=[],ee=[[],[]],Y,ce,se,V,he,ve,Re,Pe;ce=6*k-12*L+6*b,Y=-3*k+9*L-9*b+3*T,se=3*L-3*k;for(var pe=0;pe<2;++pe){if(pe>0&&(ce=6*D-12*E+6*A,Y=-3*D+9*E-9*A+3*R,se=3*E-3*D),ue(Y)<1e-12){if(ue(ce)<1e-12)continue;V=-se/ce,0<V&&V<1&&le.push(V);continue}Re=ce*ce-4*se*Y,!(Re<0)&&(Pe=K(Re),he=(-ce+Pe)/(2*Y),0<he&&he<1&&le.push(he),ve=(-ce-Pe)/(2*Y),0<ve&&ve<1&&le.push(ve))}for(var De,be,Be=le.length,Ke=Be,Ue;Be--;)V=le[Be],Ue=1-V,De=Ue*Ue*Ue*k+3*Ue*Ue*V*L+3*Ue*V*V*b+V*V*V*T,ee[0][Be]=De,be=Ue*Ue*Ue*D+3*Ue*Ue*V*E+3*Ue*V*V*A+V*V*V*R,ee[1][Be]=be;ee[0][Ke]=k,ee[1][Ke]=D,ee[0][Ke+1]=T,ee[1][Ke+1]=R;var nt=[{x:H.apply(null,ee[0]),y:H.apply(null,ee[1])},{x:G.apply(null,ee[0]),y:G.apply(null,ee[1])}];return e.cachesBoundsOfCurve&&(e.boundsOfCurveCache[z]=nt),nt}function h(k,D,L){for(var E=L[1],b=L[2],A=L[3],T=L[4],R=L[5],z=L[6],K=L[7],H=l(z-k,K-D,E,b,T,R,A),G=0,ue=H.length;G<ue;G++)H[G][1]+=k,H[G][2]+=D,H[G][3]+=k,H[G][4]+=D,H[G][5]+=k,H[G][6]+=D;return H}function g(k){var D=0,L=0,E=k.length,b=0,A=0,T,R,z,K=[],H,G,ue;for(R=0;R<E;++R){switch(z=!1,T=k[R].slice(0),T[0]){case"l":T[0]="L",T[1]+=D,T[2]+=L;case"L":D=T[1],L=T[2];break;case"h":T[1]+=D;case"H":T[0]="L",T[2]=L,D=T[1];break;case"v":T[1]+=L;case"V":T[0]="L",L=T[1],T[1]=D,T[2]=L;break;case"m":T[0]="M",T[1]+=D,T[2]+=L;case"M":D=T[1],L=T[2],b=T[1],A=T[2];break;case"c":T[0]="C",T[1]+=D,T[2]+=L,T[3]+=D,T[4]+=L,T[5]+=D,T[6]+=L;case"C":G=T[3],ue=T[4],D=T[5],L=T[6];break;case"s":T[0]="S",T[1]+=D,T[2]+=L,T[3]+=D,T[4]+=L;case"S":H==="C"?(G=2*D-G,ue=2*L-ue):(G=D,ue=L),D=T[3],L=T[4],T[0]="C",T[5]=T[3],T[6]=T[4],T[3]=T[1],T[4]=T[2],T[1]=G,T[2]=ue,G=T[3],ue=T[4];break;case"q":T[0]="Q",T[1]+=D,T[2]+=L,T[3]+=D,T[4]+=L;case"Q":G=T[1],ue=T[2],D=T[3],L=T[4];break;case"t":T[0]="T",T[1]+=D,T[2]+=L;case"T":H==="Q"?(G=2*D-G,ue=2*L-ue):(G=D,ue=L),T[0]="Q",D=T[1],L=T[2],T[1]=G,T[2]=ue,T[3]=D,T[4]=L;break;case"a":T[0]="A",T[6]+=D,T[7]+=L;case"A":z=!0,K=K.concat(h(D,L,T)),D=T[6],L=T[7];break;case"z":case"Z":D=b,L=A;break}z||K.push(T),H=T[0]}return K}function p(k,D,L,E){return Math.sqrt((L-k)*(L-k)+(E-D)*(E-D))}function v(k){return k*k*k}function x(k){return 3*k*k*(1-k)}function y(k){return 3*k*(1-k)*(1-k)}function _(k){return(1-k)*(1-k)*(1-k)}function w(k,D,L,E,b,A,T,R){return function(z){var K=v(z),H=x(z),G=y(z),ue=_(z);return{x:T*K+b*H+L*G+k*ue,y:R*K+A*H+E*G+D*ue}}}function C(k,D,L,E,b,A,T,R){return function(z){var K=1-z,H=3*K*K*(L-k)+6*K*z*(b-L)+3*z*z*(T-b),G=3*K*K*(E-D)+6*K*z*(A-E)+3*z*z*(R-A);return Math.atan2(G,H)}}function S(k){return k*k}function O(k){return 2*k*(1-k)}function F(k){return(1-k)*(1-k)}function N(k,D,L,E,b,A){return function(T){var R=S(T),z=O(T),K=F(T);return{x:b*R+L*z+k*K,y:A*R+E*z+D*K}}}function W(k,D,L,E,b,A){return function(T){var R=1-T,z=2*R*(L-k)+2*T*(b-L),K=2*R*(E-D)+2*T*(A-E);return Math.atan2(K,z)}}function X(k,D,L){var E={x:D,y:L},b,A=0,T;for(T=1;T<=100;T+=1)b=k(T/100),A+=p(E.x,E.y,b.x,b.y),E=b;return A}function Q(k,D){for(var L=0,E=0,b=k.iterator,A={x:k.x,y:k.y},T,R,z=.01,K=k.angleFinder,H;E<D&&z>1e-4;)T=b(L),H=L,R=p(A.x,A.y,T.x,T.y),R+E>D?(L-=z,z/=2):(A=T,L+=z,E+=R);return T.angle=K(H),T}function ae(k){for(var D=0,L=k.length,E,b=0,A=0,T=0,R=0,z=[],K,H,G,ue=0;ue<L;ue++){switch(E=k[ue],H={x:b,y:A,command:E[0]},E[0]){case"M":H.length=0,T=b=E[1],R=A=E[2];break;case"L":H.length=p(b,A,E[1],E[2]),b=E[1],A=E[2];break;case"C":K=w(b,A,E[1],E[2],E[3],E[4],E[5],E[6]),G=C(b,A,E[1],E[2],E[3],E[4],E[5],E[6]),H.iterator=K,H.angleFinder=G,H.length=X(K,b,A),b=E[5],A=E[6];break;case"Q":K=N(b,A,E[1],E[2],E[3],E[4]),G=W(b,A,E[1],E[2],E[3],E[4]),H.iterator=K,H.angleFinder=G,H.length=X(K,b,A),b=E[3],A=E[4];break;case"Z":case"z":H.destX=T,H.destY=R,H.length=p(b,A,T,R),b=T,A=R;break}D+=H.length,z.push(H)}return z.push({length:D,x:b,y:A}),z}function ne(k,D,L){L||(L=ae(k));for(var E=0;D-L[E].length>0&&E<L.length-2;)D-=L[E].length,E++;var b=L[E],A=D/b.length,T=b.command,R=k[E],z;switch(T){case"M":return{x:b.x,y:b.y,angle:0};case"Z":case"z":return z=new e.Point(b.x,b.y).lerp(new e.Point(b.destX,b.destY),A),z.angle=Math.atan2(b.destY-b.y,b.destX-b.x),z;case"L":return z=new e.Point(b.x,b.y).lerp(new e.Point(R[1],R[2]),A),z.angle=Math.atan2(R[2]-b.y,R[1]-b.x),z;case"C":return Q(b,D);case"Q":return Q(b,D)}}function J(k){var D=[],L=[],E,b,A=e.rePathCommand,T="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",R="("+T+")"+e.commaWsp,z="([01])"+e.commaWsp+"?",K=R+"?"+R+"?"+R+z+z+R+"?("+T+")",H=new RegExp(K,"g"),G,ue,le;if(!k||!k.match)return D;le=k.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var ee=0,Y,ce=le.length;ee<ce;ee++){E=le[ee],ue=E.slice(1).trim(),L.length=0;var se=E.charAt(0);if(Y=[se],se.toLowerCase()==="a")for(var V;V=H.exec(ue);)for(var he=1;he<V.length;he++)L.push(V[he]);else for(;G=A.exec(ue);)L.push(G[0]);for(var he=0,ve=L.length;he<ve;he++)b=parseFloat(L[he]),isNaN(b)||Y.push(b);var Re=s[se.toLowerCase()],Pe=u[se]||se;if(Y.length-1>Re)for(var pe=1,De=Y.length;pe<De;pe+=Re)D.push([se].concat(Y.slice(pe,pe+Re))),se=Pe;else D.push(Y)}return D}function oe(k,D){var L=[],E,b=new e.Point(k[0].x,k[0].y),A=new e.Point(k[1].x,k[1].y),T=k.length,R=1,z=0,K=T>2;for(D=D||0,K&&(R=k[2].x<A.x?-1:k[2].x===A.x?0:1,z=k[2].y<A.y?-1:k[2].y===A.y?0:1),L.push(["M",b.x-R*D,b.y-z*D]),E=1;E<T;E++){if(!b.eq(A)){var H=b.midPointFrom(A);L.push(["Q",b.x,b.y,H.x,H.y])}b=k[E],E+1<k.length&&(A=k[E+1])}return K&&(R=b.x>k[E-2].x?1:b.x===k[E-2].x?0:-1,z=b.y>k[E-2].y?1:b.y===k[E-2].y?0:-1),L.push(["L",b.x+R*D,b.y+z*D]),L}function q(k,D,L){return L&&(D=e.util.multiplyTransformMatrices(D,[1,0,0,1,-L.x,-L.y])),k.map(function(E){for(var b=E.slice(0),A={},T=1;T<E.length-1;T+=2)A.x=E[T],A.y=E[T+1],A=e.util.transformPoint(A,D),b[T]=A.x,b[T+1]=A.y;return b})}e.util.joinPath=function(k){return k.map(function(D){return D.join(" ")}).join(" ")},e.util.parsePath=J,e.util.makePathSimpler=g,e.util.getSmoothPathFromPoints=oe,e.util.getPathSegmentsInfo=ae,e.util.getBoundsOfCurve=a,e.util.getPointOnPath=ne,e.util.transformPath=q}(),function(){var c=Array.prototype.slice;function s(a,h){for(var g=c.call(arguments,2),p=[],v=0,x=a.length;v<x;v++)p[v]=g.length?a[v][h].apply(a[v],g):a[v][h].call(a[v]);return p}function u(a,h){return o(a,h,function(g,p){return g>=p})}function d(a,h){return o(a,h,function(g,p){return g<p})}function l(a,h){for(var g=a.length;g--;)a[g]=h;return a}function o(a,h,g){if(!(!a||a.length===0)){var p=a.length-1,v=h?a[p][h]:a[p];if(h)for(;p--;)g(a[p][h],v)&&(v=a[p][h]);else for(;p--;)g(a[p],v)&&(v=a[p]);return v}}e.util.array={fill:l,invoke:s,min:d,max:u}}(),function(){function c(u,d,l){if(l)if(!e.isLikelyNode&&d instanceof Element)u=d;else if(d instanceof Array){u=[];for(var o=0,a=d.length;o<a;o++)u[o]=c({},d[o],l)}else if(d&&typeof d=="object")for(var h in d)h==="canvas"||h==="group"?u[h]=null:d.hasOwnProperty(h)&&(u[h]=c({},d[h],l));else u=d;else for(var h in d)u[h]=d[h];return u}function s(u,d){return c({},u,d)}e.util.object={extend:c,clone:s},e.util.object.extend(e.util,e.Observable)}(),function(){function c(o){return o.replace(/-+(.)?/g,function(a,h){return h?h.toUpperCase():""})}function s(o,a){return o.charAt(0).toUpperCase()+(a?o.slice(1):o.slice(1).toLowerCase())}function u(o){return o.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(o){var a=0,h,g=[];for(a=0,h;a<o.length;a++)(h=l(o,a))!==!1&&g.push(h);return g}function l(o,a){var h=o.charCodeAt(a);if(isNaN(h))return"";if(h<55296||h>57343)return o.charAt(a);if(55296<=h&&h<=56319){if(o.length<=a+1)throw"High surrogate without following low surrogate";var g=o.charCodeAt(a+1);if(56320>g||g>57343)throw"High surrogate without following low surrogate";return o.charAt(a)+o.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var p=o.charCodeAt(a-1);if(55296>p||p>56319)throw"Low surrogate without preceding high surrogate";return!1}e.util.string={camelize:c,capitalize:s,escapeXml:u,graphemeSplit:d}}(),function(){var c=Array.prototype.slice,s=function(){},u=function(){for(var h in{toString:1})if(h==="toString")return!1;return!0}(),d=function(h,g,p){for(var v in g)v in h.prototype&&typeof h.prototype[v]=="function"&&(g[v]+"").indexOf("callSuper")>-1?h.prototype[v]=function(x){return function(){var y=this.constructor.superclass;this.constructor.superclass=p;var _=g[x].apply(this,arguments);if(this.constructor.superclass=y,x!=="initialize")return _}}(v):h.prototype[v]=g[v],u&&(g.toString!==Object.prototype.toString&&(h.prototype.toString=g.toString),g.valueOf!==Object.prototype.valueOf&&(h.prototype.valueOf=g.valueOf))};function l(){}function o(h){for(var g=null,p=this;p.constructor.superclass;){var v=p.constructor.superclass.prototype[h];if(p[h]!==v){g=v;break}p=p.constructor.superclass.prototype}return g?arguments.length>1?g.apply(this,c.call(arguments,1)):g.call(this):console.log("tried to callSuper "+h+", method not found in prototype chain",this)}function a(){var h=null,g=c.call(arguments,0);typeof g[0]=="function"&&(h=g.shift());function p(){this.initialize.apply(this,arguments)}p.superclass=h,p.subclasses=[],h&&(l.prototype=h.prototype,p.prototype=new l,h.subclasses.push(p));for(var v=0,x=g.length;v<x;v++)d(p,g[v],h);return p.prototype.initialize||(p.prototype.initialize=s),p.prototype.constructor=p,p.prototype.callSuper=o,p}e.util.createClass=a}(),function(){var c=!!e.document.createElement("div").attachEvent,s=["touchstart","touchmove","touchend"];e.util.addListener=function(d,l,o,a){d&&d.addEventListener(l,o,c?!1:a)},e.util.removeListener=function(d,l,o,a){d&&d.removeEventListener(l,o,c?!1:a)};function u(d){var l=d.changedTouches;return l&&l[0]?l[0]:d}e.util.getPointer=function(d){var l=d.target,o=e.util.getScrollLeftTop(l),a=u(d);return{x:a.clientX+o.left,y:a.clientY+o.top}},e.util.isTouchEvent=function(d){return s.indexOf(d.type)>-1||d.pointerType==="touch"}}(),function(){function c(a,h){var g=a.style;if(!g)return a;if(typeof h=="string")return a.style.cssText+=";"+h,h.indexOf("opacity")>-1?o(a,h.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var p in h)if(p==="opacity")o(a,h[p]);else{var v=p==="float"||p==="cssFloat"?typeof g.styleFloat>"u"?"cssFloat":"styleFloat":p;g.setProperty(v,h[p])}return a}var s=e.document.createElement("div"),u=typeof s.style.opacity=="string",d=typeof s.style.filter=="string",l=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,o=function(a){return a};u?o=function(a,h){return a.style.opacity=h,a}:d&&(o=function(a,h){var g=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(g.zoom=1),l.test(g.filter)?(h=h>=.9999?"":"alpha(opacity="+h*100+")",g.filter=g.filter.replace(l,h)):g.filter+=" alpha(opacity="+h*100+")",a}),e.util.setStyle=c}(),function(){var c=Array.prototype.slice;function s(_){return typeof _=="string"?e.document.getElementById(_):_}var u,d=function(_){return c.call(_,0)};try{u=d(e.document.childNodes)instanceof Array}catch{}u||(d=function(_){for(var w=new Array(_.length),C=_.length;C--;)w[C]=_[C];return w});function l(_,w){var C=e.document.createElement(_);for(var S in w)S==="class"?C.className=w[S]:S==="for"?C.htmlFor=w[S]:C.setAttribute(S,w[S]);return C}function o(_,w){_&&(" "+_.className+" ").indexOf(" "+w+" ")===-1&&(_.className+=(_.className?" ":"")+w)}function a(_,w,C){return typeof w=="string"&&(w=l(w,C)),_.parentNode&&_.parentNode.replaceChild(w,_),w.appendChild(_),w}function h(_){for(var w=0,C=0,S=e.document.documentElement,O=e.document.body||{scrollLeft:0,scrollTop:0};_&&(_.parentNode||_.host)&&(_=_.parentNode||_.host,_===e.document?(w=O.scrollLeft||S.scrollLeft||0,C=O.scrollTop||S.scrollTop||0):(w+=_.scrollLeft||0,C+=_.scrollTop||0),!(_.nodeType===1&&_.style.position==="fixed")););return{left:w,top:C}}function g(_){var w,C=_&&_.ownerDocument,S={left:0,top:0},O={left:0,top:0},F,N={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return O;for(var W in N)O[N[W]]+=parseInt(p(_,W),10)||0;return w=C.documentElement,typeof _.getBoundingClientRect<"u"&&(S=_.getBoundingClientRect()),F=h(_),{left:S.left+F.left-(w.clientLeft||0)+O.left,top:S.top+F.top-(w.clientTop||0)+O.top}}var p;e.document.defaultView&&e.document.defaultView.getComputedStyle?p=function(_,w){var C=e.document.defaultView.getComputedStyle(_,null);return C?C[w]:void 0}:p=function(_,w){var C=_.style[w];return!C&&_.currentStyle&&(C=_.currentStyle[w]),C},function(){var _=e.document.documentElement.style,w="userSelect"in _?"userSelect":"MozUserSelect"in _?"MozUserSelect":"WebkitUserSelect"in _?"WebkitUserSelect":"KhtmlUserSelect"in _?"KhtmlUserSelect":"";function C(O){return typeof O.onselectstart<"u"&&(O.onselectstart=e.util.falseFunction),w?O.style[w]="none":typeof O.unselectable=="string"&&(O.unselectable="on"),O}function S(O){return typeof O.onselectstart<"u"&&(O.onselectstart=null),w?O.style[w]="":typeof O.unselectable=="string"&&(O.unselectable=""),O}e.util.makeElementUnselectable=C,e.util.makeElementSelectable=S}();function v(_){var w=e.jsdomImplForWrapper(_);return w._canvas||w._image}function x(_){if(e.isLikelyNode){var w=e.jsdomImplForWrapper(_);w&&(w._image=null,w._canvas=null,w._currentSrc=null,w._attributes=null,w._classList=null)}}function y(_,w){_.imageSmoothingEnabled=_.imageSmoothingEnabled||_.webkitImageSmoothingEnabled||_.mozImageSmoothingEnabled||_.msImageSmoothingEnabled||_.oImageSmoothingEnabled,_.imageSmoothingEnabled=w}e.util.setImageSmoothing=y,e.util.getById=s,e.util.toArray=d,e.util.addClass=o,e.util.makeElement=l,e.util.wrapElement=a,e.util.getScrollLeftTop=h,e.util.getElementOffset=g,e.util.getNodeCanvas=v,e.util.cleanUpJsdomNode=x}(),function(){function c(d,l){return d+(/\?/.test(d)?"&":"?")+l}function s(){}function u(d,l){l||(l={});var o=l.method?l.method.toUpperCase():"GET",a=l.onComplete||function(){},h=new e.window.XMLHttpRequest,g=l.body||l.parameters;return h.onreadystatechange=function(){h.readyState===4&&(a(h),h.onreadystatechange=s)},o==="GET"&&(g=null,typeof l.parameters=="string"&&(d=c(d,l.parameters))),h.open(o,d,!0),(o==="POST"||o==="PUT")&&h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),h.send(g),h}e.util.request=u}(),e.log=console.log,e.warn=console.warn,function(){var c=e.util.object.extend,s=e.util.object.clone,u=[];e.util.object.extend(u,{cancelAll:function(){var v=this.splice(0);return v.forEach(function(x){x.cancel()}),v},cancelByCanvas:function(v){if(!v)return[];var x=this.filter(function(y){return typeof y.target=="object"&&y.target.canvas===v});return x.forEach(function(y){y.cancel()}),x},cancelByTarget:function(v){var x=this.findAnimationsByTarget(v);return x.forEach(function(y){y.cancel()}),x},findAnimationIndex:function(v){return this.indexOf(this.findAnimation(v))},findAnimation:function(v){return this.find(function(x){return x.cancel===v})},findAnimationsByTarget:function(v){return v?this.filter(function(x){return x.target===v}):[]}});function d(){return!1}function l(v,x,y,_){return-y*Math.cos(v/_*(Math.PI/2))+y+x}function o(v){v||(v={});var x=!1,y,_=function(){var w=e.runningAnimations.indexOf(y);return w>-1&&e.runningAnimations.splice(w,1)[0]};return y=c(s(v),{cancel:function(){return x=!0,_()},currentValue:"startValue"in v?v.startValue:0,completionRate:0,durationRate:0}),e.runningAnimations.push(y),g(function(w){var C=w||+new Date,S=v.duration||500,O=C+S,F,N=v.onChange||d,W=v.abort||d,X=v.onComplete||d,Q=v.easing||l,ae="startValue"in v?v.startValue.length>0:!1,ne="startValue"in v?v.startValue:0,J="endValue"in v?v.endValue:100,oe=v.byValue||(ae?ne.map(function(q,k){return J[k]-ne[k]}):J-ne);v.onStart&&v.onStart(),function q(k){F=k||+new Date;var D=F>O?S:F-C,L=D/S,E=ae?ne.map(function(A,T){return Q(D,ne[T],oe[T],S)}):Q(D,ne,oe,S),b=Math.abs(ae?(E[0]-ne[0])/oe[0]:(E-ne)/oe);if(y.currentValue=ae?E.slice():E,y.completionRate=b,y.durationRate=L,!x){if(W(E,b,L)){_();return}if(F>O){y.currentValue=ae?J.slice():J,y.completionRate=1,y.durationRate=1,N(ae?J.slice():J,1,1),X(J,1,1),_();return}else N(E,b,L),g(q)}}(C)}),y.cancel}var a=e.window.requestAnimationFrame||e.window.webkitRequestAnimationFrame||e.window.mozRequestAnimationFrame||e.window.oRequestAnimationFrame||e.window.msRequestAnimationFrame||function(v){return e.window.setTimeout(v,1e3/60)},h=e.window.cancelAnimationFrame||e.window.clearTimeout;function g(){return a.apply(e.window,arguments)}function p(){return h.apply(e.window,arguments)}e.util.animate=o,e.util.requestAnimFrame=g,e.util.cancelAnimFrame=p,e.runningAnimations=u}(),function(){function c(u,d,l){var o="rgba("+parseInt(u[0]+l*(d[0]-u[0]),10)+","+parseInt(u[1]+l*(d[1]-u[1]),10)+","+parseInt(u[2]+l*(d[2]-u[2]),10);return o+=","+(u&&d?parseFloat(u[3]+l*(d[3]-u[3])):1),o+=")",o}function s(u,d,l,o){var a=new e.Color(u).getSource(),h=new e.Color(d).getSource(),g=o.onComplete,p=o.onChange;return o=o||{},e.util.animate(e.util.object.extend(o,{duration:l||500,startValue:a,endValue:h,byValue:h,easing:function(v,x,y,_){var w=o.colorEasing?o.colorEasing(v,_):1-Math.cos(v/_*(Math.PI/2));return c(x,y,w)},onComplete:function(v,x,y){if(g)return g(c(h,h,0),x,y)},onChange:function(v,x,y){if(p){if(Array.isArray(v))return p(c(v,v,0),x,y);p(v,x,y)}}}))}e.util.animateColor=s}(),function(){function c(k,D,L,E){return k<Math.abs(D)?(k=D,E=L/4):D===0&&k===0?E=L/(2*Math.PI)*Math.asin(1):E=L/(2*Math.PI)*Math.asin(D/k),{a:k,c:D,p:L,s:E}}function s(k,D,L){return k.a*Math.pow(2,10*(D-=1))*Math.sin((D*L-k.s)*(2*Math.PI)/k.p)}function u(k,D,L,E){return L*((k=k/E-1)*k*k+1)+D}function d(k,D,L,E){return k/=E/2,k<1?L/2*k*k*k+D:L/2*((k-=2)*k*k+2)+D}function l(k,D,L,E){return L*(k/=E)*k*k*k+D}function o(k,D,L,E){return-L*((k=k/E-1)*k*k*k-1)+D}function a(k,D,L,E){return k/=E/2,k<1?L/2*k*k*k*k+D:-L/2*((k-=2)*k*k*k-2)+D}function h(k,D,L,E){return L*(k/=E)*k*k*k*k+D}function g(k,D,L,E){return L*((k=k/E-1)*k*k*k*k+1)+D}function p(k,D,L,E){return k/=E/2,k<1?L/2*k*k*k*k*k+D:L/2*((k-=2)*k*k*k*k+2)+D}function v(k,D,L,E){return-L*Math.cos(k/E*(Math.PI/2))+L+D}function x(k,D,L,E){return L*Math.sin(k/E*(Math.PI/2))+D}function y(k,D,L,E){return-L/2*(Math.cos(Math.PI*k/E)-1)+D}function _(k,D,L,E){return k===0?D:L*Math.pow(2,10*(k/E-1))+D}function w(k,D,L,E){return k===E?D+L:L*(-Math.pow(2,-10*k/E)+1)+D}function C(k,D,L,E){return k===0?D:k===E?D+L:(k/=E/2,k<1?L/2*Math.pow(2,10*(k-1))+D:L/2*(-Math.pow(2,-10*--k)+2)+D)}function S(k,D,L,E){return-L*(Math.sqrt(1-(k/=E)*k)-1)+D}function O(k,D,L,E){return L*Math.sqrt(1-(k=k/E-1)*k)+D}function F(k,D,L,E){return k/=E/2,k<1?-L/2*(Math.sqrt(1-k*k)-1)+D:L/2*(Math.sqrt(1-(k-=2)*k)+1)+D}function N(k,D,L,E){var b=1.70158,A=0,T=L;if(k===0)return D;if(k/=E,k===1)return D+L;A||(A=E*.3);var R=c(T,L,A,b);return-s(R,k,E)+D}function W(k,D,L,E){var b=1.70158,A=0,T=L;if(k===0)return D;if(k/=E,k===1)return D+L;A||(A=E*.3);var R=c(T,L,A,b);return R.a*Math.pow(2,-10*k)*Math.sin((k*E-R.s)*(2*Math.PI)/R.p)+R.c+D}function X(k,D,L,E){var b=1.70158,A=0,T=L;if(k===0)return D;if(k/=E/2,k===2)return D+L;A||(A=E*(.3*1.5));var R=c(T,L,A,b);return k<1?-.5*s(R,k,E)+D:R.a*Math.pow(2,-10*(k-=1))*Math.sin((k*E-R.s)*(2*Math.PI)/R.p)*.5+R.c+D}function Q(k,D,L,E,b){return b===void 0&&(b=1.70158),L*(k/=E)*k*((b+1)*k-b)+D}function ae(k,D,L,E,b){return b===void 0&&(b=1.70158),L*((k=k/E-1)*k*((b+1)*k+b)+1)+D}function ne(k,D,L,E,b){return b===void 0&&(b=1.70158),k/=E/2,k<1?L/2*(k*k*(((b*=1.525)+1)*k-b))+D:L/2*((k-=2)*k*(((b*=1.525)+1)*k+b)+2)+D}function J(k,D,L,E){return L-oe(E-k,0,L,E)+D}function oe(k,D,L,E){return(k/=E)<1/2.75?L*(7.5625*k*k)+D:k<2/2.75?L*(7.5625*(k-=1.5/2.75)*k+.75)+D:k<2.5/2.75?L*(7.5625*(k-=2.25/2.75)*k+.9375)+D:L*(7.5625*(k-=2.625/2.75)*k+.984375)+D}function q(k,D,L,E){return k<E/2?J(k*2,0,L,E)*.5+D:oe(k*2-E,0,L,E)*.5+L*.5+D}e.util.ease={easeInQuad:function(k,D,L,E){return L*(k/=E)*k+D},easeOutQuad:function(k,D,L,E){return-L*(k/=E)*(k-2)+D},easeInOutQuad:function(k,D,L,E){return k/=E/2,k<1?L/2*k*k+D:-L/2*(--k*(k-2)-1)+D},easeInCubic:function(k,D,L,E){return L*(k/=E)*k*k+D},easeOutCubic:u,easeInOutCubic:d,easeInQuart:l,easeOutQuart:o,easeInOutQuart:a,easeInQuint:h,easeOutQuint:g,easeInOutQuint:p,easeInSine:v,easeOutSine:x,easeInOutSine:y,easeInExpo:_,easeOutExpo:w,easeInOutExpo:C,easeInCirc:S,easeOutCirc:O,easeInOutCirc:F,easeInElastic:N,easeOutElastic:W,easeInOutElastic:X,easeInBack:Q,easeOutBack:ae,easeInOutBack:ne,easeInBounce:J,easeOutBounce:oe,easeInOutBounce:q}}(),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.util.object.clone,l=s.util.toFixed,o=s.util.parseUnit,a=s.util.multiplyTransformMatrices,h=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],g=["symbol","image","marker","pattern","view","svg"],p=["pattern","defs","symbol","metadata","clipPath","mask","desc"],v=["symbol","g","a","svg","clipPath","defs"],x={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},y={stroke:"strokeOpacity",fill:"fillOpacity"},_="font-size",w="clip-path";s.svgValidTagNamesRegEx=O(h),s.svgViewBoxElementsRegEx=O(g),s.svgInvalidAncestorsRegEx=O(p),s.svgValidParentsRegEx=O(v),s.cssRules={},s.gradientDefs={},s.clipPaths={};function C(A){return A in x?x[A]:A}function S(A,T,R,z){var K=Array.isArray(T),H;if((A==="fill"||A==="stroke")&&T==="none")T="";else{if(A==="strokeUniform")return T==="non-scaling-stroke";if(A==="strokeDashArray")T==="none"?T=null:T=T.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(A==="transformMatrix")R&&R.transformMatrix?T=a(R.transformMatrix,s.parseTransformAttribute(T)):T=s.parseTransformAttribute(T);else if(A==="visible")T=T!=="none"&&T!=="hidden",R&&R.visible===!1&&(T=!1);else if(A==="opacity")T=parseFloat(T),R&&typeof R.opacity<"u"&&(T*=R.opacity);else if(A==="textAnchor")T=T==="start"?"left":T==="end"?"right":"center";else if(A==="charSpacing")H=o(T,z)/z*1e3;else if(A==="paintFirst"){var G=T.indexOf("fill"),ue=T.indexOf("stroke"),T="fill";(G>-1&&ue>-1&&ue<G||G===-1&&ue>-1)&&(T="stroke")}else{if(A==="href"||A==="xlink:href"||A==="font")return T;if(A==="imageSmoothing")return T==="optimizeQuality";H=K?T.map(o):o(T,z)}}return!K&&isNaN(H)?T:H}function O(A){return new RegExp("^("+A.join("|")+")\\b","i")}function F(A){for(var T in y)if(!(typeof A[y[T]]>"u"||A[T]==="")){if(typeof A[T]>"u"){if(!s.Object.prototype[T])continue;A[T]=s.Object.prototype[T]}if(A[T].indexOf("url(")!==0){var R=new s.Color(A[T]);A[T]=R.setAlpha(l(R.getAlpha()*A[y[T]],2)).toRgba()}}return A}function N(A,T){var R,z=[],K,H,G;for(H=0,G=T.length;H<G;H++)R=T[H],K=A.getElementsByTagName(R),z=z.concat(Array.prototype.slice.call(K));return z}s.parseTransformAttribute=function(){function A(pe,De){var be=s.util.cos(De[0]),Be=s.util.sin(De[0]),Ke=0,Ue=0;De.length===3&&(Ke=De[1],Ue=De[2]),pe[0]=be,pe[1]=Be,pe[2]=-Be,pe[3]=be,pe[4]=Ke-(be*Ke-Be*Ue),pe[5]=Ue-(Be*Ke+be*Ue)}function T(pe,De){var be=De[0],Be=De.length===2?De[1]:De[0];pe[0]=be,pe[3]=Be}function R(pe,De,be){pe[be]=Math.tan(s.util.degreesToRadians(De[0]))}function z(pe,De){pe[4]=De[0],De.length===2&&(pe[5]=De[1])}var K=s.iMatrix,H=s.reNum,G=s.commaWsp,ue="(?:(skewX)\\s*\\(\\s*("+H+")\\s*\\))",le="(?:(skewY)\\s*\\(\\s*("+H+")\\s*\\))",ee="(?:(rotate)\\s*\\(\\s*("+H+")(?:"+G+"("+H+")"+G+"("+H+"))?\\s*\\))",Y="(?:(scale)\\s*\\(\\s*("+H+")(?:"+G+"("+H+"))?\\s*\\))",ce="(?:(translate)\\s*\\(\\s*("+H+")(?:"+G+"("+H+"))?\\s*\\))",se="(?:(matrix)\\s*\\(\\s*("+H+")"+G+"("+H+")"+G+"("+H+")"+G+"("+H+")"+G+"("+H+")"+G+"("+H+")\\s*\\))",V="(?:"+se+"|"+ce+"|"+Y+"|"+ee+"|"+ue+"|"+le+")",he="(?:"+V+"(?:"+G+"*"+V+")*)",ve="^\\s*(?:"+he+"?)\\s*$",Re=new RegExp(ve),Pe=new RegExp(V,"g");return function(pe){var De=K.concat(),be=[];if(!pe||pe&&!Re.test(pe))return De;pe.replace(Pe,function(Ke){var Ue=new RegExp(V).exec(Ke).filter(function(Xr){return!!Xr}),nt=Ue[1],ct=Ue.slice(2).map(parseFloat);switch(nt){case"translate":z(De,ct);break;case"rotate":ct[0]=s.util.degreesToRadians(ct[0]),A(De,ct);break;case"scale":T(De,ct);break;case"skewX":R(De,ct,2);break;case"skewY":R(De,ct,1);break;case"matrix":De=ct;break}be.push(De.concat()),De=K.concat()});for(var Be=be[0];be.length>1;)be.shift(),Be=s.util.multiplyTransformMatrices(Be,be[0]);return Be}}();function W(A,T){var R,z;A.replace(/;\s*$/,"").split(";").forEach(function(K){var H=K.split(":");R=H[0].trim().toLowerCase(),z=H[1].trim(),T[R]=z})}function X(A,T){var R,z;for(var K in A)typeof A[K]>"u"||(R=K.toLowerCase(),z=A[K],T[R]=z)}function Q(A,T){var R={};for(var z in s.cssRules[T])if(ae(A,z.split(" ")))for(var K in s.cssRules[T][z])R[K]=s.cssRules[T][z][K];return R}function ae(A,T){var R,z=!0;return R=J(A,T.pop()),R&&T.length&&(z=ne(A,T)),R&&z&&T.length===0}function ne(A,T){for(var R,z=!0;A.parentNode&&A.parentNode.nodeType===1&&T.length;)z&&(R=T.pop()),A=A.parentNode,z=J(A,R);return T.length===0}function J(A,T){var R=A.nodeName,z=A.getAttribute("class"),K=A.getAttribute("id"),H,G;if(H=new RegExp("^"+R,"i"),T=T.replace(H,""),K&&T.length&&(H=new RegExp("#"+K+"(?![a-zA-Z\\-]+)","i"),T=T.replace(H,"")),z&&T.length)for(z=z.split(" "),G=z.length;G--;)H=new RegExp("\\."+z[G]+"(?![a-zA-Z\\-]+)","i"),T=T.replace(H,"");return T.length===0}function oe(A,T){var R;if(A.getElementById&&(R=A.getElementById(T)),R)return R;var z,K,H,G=A.getElementsByTagName("*");for(K=0,H=G.length;K<H;K++)if(z=G[K],T===z.getAttribute("id"))return z}function q(A){for(var T=N(A,["use","svg:use"]),R=0;T.length&&R<T.length;){var z=T[R],K=z.getAttribute("xlink:href")||z.getAttribute("href");if(K===null)return;var H=K.slice(1),G=z.getAttribute("x")||0,ue=z.getAttribute("y")||0,le=oe(A,H).cloneNode(!0),ee=(le.getAttribute("transform")||"")+" translate("+G+", "+ue+")",Y,ce=T.length,se,V,he,ve,Re=s.svgNS;if(D(le),/^svg$/i.test(le.nodeName)){var Pe=le.ownerDocument.createElementNS(Re,"g");for(V=0,he=le.attributes,ve=he.length;V<ve;V++)se=he.item(V),Pe.setAttributeNS(Re,se.nodeName,se.nodeValue);for(;le.firstChild;)Pe.appendChild(le.firstChild);le=Pe}for(V=0,he=z.attributes,ve=he.length;V<ve;V++)se=he.item(V),!(se.nodeName==="x"||se.nodeName==="y"||se.nodeName==="xlink:href"||se.nodeName==="href")&&(se.nodeName==="transform"?ee=se.nodeValue+" "+ee:le.setAttribute(se.nodeName,se.nodeValue));le.setAttribute("transform",ee),le.setAttribute("instantiated_by_use","1"),le.removeAttribute("id"),Y=z.parentNode,Y.replaceChild(le,z),T.length===ce&&R++}}var k=new RegExp("^\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*$");function D(A){if(!s.svgViewBoxElementsRegEx.test(A.nodeName))return{};var T=A.getAttribute("viewBox"),R=1,z=1,K=0,H=0,G,ue,le,ee,Y=A.getAttribute("width"),ce=A.getAttribute("height"),se=A.getAttribute("x")||0,V=A.getAttribute("y")||0,he=A.getAttribute("preserveAspectRatio")||"",ve=!T||!(T=T.match(k)),Re=!Y||!ce||Y==="100%"||ce==="100%",Pe=ve&&Re,pe={},De="",be=0,Be=0;if(pe.width=0,pe.height=0,pe.toBeParsed=Pe,ve&&(se||V)&&A.parentNode&&A.parentNode.nodeName!=="#document"&&(De=" translate("+o(se)+" "+o(V)+") ",le=(A.getAttribute("transform")||"")+De,A.setAttribute("transform",le),A.removeAttribute("x"),A.removeAttribute("y")),Pe)return pe;if(ve)return pe.width=o(Y),pe.height=o(ce),pe;if(K=-parseFloat(T[1]),H=-parseFloat(T[2]),G=parseFloat(T[3]),ue=parseFloat(T[4]),pe.minX=K,pe.minY=H,pe.viewBoxWidth=G,pe.viewBoxHeight=ue,Re?(pe.width=G,pe.height=ue):(pe.width=o(Y),pe.height=o(ce),R=pe.width/G,z=pe.height/ue),he=s.util.parsePreserveAspectRatioAttribute(he),he.alignX!=="none"&&(he.meetOrSlice==="meet"&&(z=R=R>z?z:R),he.meetOrSlice==="slice"&&(z=R=R>z?R:z),be=pe.width-G*R,Be=pe.height-ue*R,he.alignX==="Mid"&&(be/=2),he.alignY==="Mid"&&(Be/=2),he.alignX==="Min"&&(be=0),he.alignY==="Min"&&(Be=0)),R===1&&z===1&&K===0&&H===0&&se===0&&V===0)return pe;if((se||V)&&A.parentNode.nodeName!=="#document"&&(De=" translate("+o(se)+" "+o(V)+") "),le=De+" matrix("+R+" 0 0 "+z+" "+(K*R+be)+" "+(H*z+Be)+") ",A.nodeName==="svg"){for(ee=A.ownerDocument.createElementNS(s.svgNS,"g");A.firstChild;)ee.appendChild(A.firstChild);A.appendChild(ee)}else ee=A,ee.removeAttribute("x"),ee.removeAttribute("y"),le=ee.getAttribute("transform")+le;return ee.setAttribute("transform",le),pe}function L(A,T){for(;A&&(A=A.parentNode);)if(A.nodeName&&T.test(A.nodeName.replace("svg:",""))&&!A.getAttribute("instantiated_by_use"))return!0;return!1}s.parseSVGDocument=function(A,T,R,z){if(A){q(A);var K=s.Object.__uid++,H,G,ue=D(A),le=s.util.toArray(A.getElementsByTagName("*"));if(ue.crossOrigin=z&&z.crossOrigin,ue.svgUid=K,le.length===0&&s.isLikelyNode){le=A.selectNodes('//*[name(.)!="svg"]');var ee=[];for(H=0,G=le.length;H<G;H++)ee[H]=le[H];le=ee}var Y=le.filter(function(se){return D(se),s.svgValidTagNamesRegEx.test(se.nodeName.replace("svg:",""))&&!L(se,s.svgInvalidAncestorsRegEx)});if(!Y||Y&&!Y.length){T&&T([],{});return}var ce={};le.filter(function(se){return se.nodeName.replace("svg:","")==="clipPath"}).forEach(function(se){var V=se.getAttribute("id");ce[V]=s.util.toArray(se.getElementsByTagName("*")).filter(function(he){return s.svgValidTagNamesRegEx.test(he.nodeName.replace("svg:",""))})}),s.gradientDefs[K]=s.getGradientDefs(A),s.cssRules[K]=s.getCSSRules(A),s.clipPaths[K]=ce,s.parseElements(Y,function(se,V){T&&(T(se,ue,V,le),delete s.gradientDefs[K],delete s.cssRules[K],delete s.clipPaths[K])},d(ue),R,z)}};function E(A,T){var R=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],z="xlink:href",K=T.getAttribute(z).slice(1),H=oe(A,K);if(H&&H.getAttribute(z)&&E(A,H),R.forEach(function(ue){H&&!T.hasAttribute(ue)&&H.hasAttribute(ue)&&T.setAttribute(ue,H.getAttribute(ue))}),!T.children.length)for(var G=H.cloneNode(!0);G.firstChild;)T.appendChild(G.firstChild);T.removeAttribute(z)}var b=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+s.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+s.reNum+"))?\\s+(.*)");u(s,{parseFontDeclaration:function(A,T){var R=A.match(b);if(R){var z=R[1],K=R[3],H=R[4],G=R[5],ue=R[6];z&&(T.fontStyle=z),K&&(T.fontWeight=isNaN(parseFloat(K))?K:parseFloat(K)),H&&(T.fontSize=o(H)),ue&&(T.fontFamily=ue),G&&(T.lineHeight=G==="normal"?1:G)}},getGradientDefs:function(A){var T=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],R=N(A,T),z,K=0,H={};for(K=R.length;K--;)z=R[K],z.getAttribute("xlink:href")&&E(A,z),H[z.getAttribute("id")]=z;return H},parseAttributes:function(A,T,R){if(A){var z,K={},H,G;typeof R>"u"&&(R=A.getAttribute("svgUid")),A.parentNode&&s.svgValidParentsRegEx.test(A.parentNode.nodeName)&&(K=s.parseAttributes(A.parentNode,T,R));var ue=T.reduce(function(he,ve){return z=A.getAttribute(ve),z&&(he[ve]=z),he},{}),le=u(Q(A,R),s.parseStyleAttribute(A));ue=u(ue,le),le[w]&&A.setAttribute(w,le[w]),H=G=K.fontSize||s.Text.DEFAULT_SVG_FONT_SIZE,ue[_]&&(ue[_]=H=o(ue[_],G));var ee,Y,ce={};for(var se in ue)ee=C(se),Y=S(ee,ue[se],K,H),ce[ee]=Y;ce&&ce.font&&s.parseFontDeclaration(ce.font,ce);var V=u(K,ce);return s.svgValidParentsRegEx.test(A.nodeName)?V:F(V)}},parseElements:function(A,T,R,z,K){new s.ElementsParser(A,T,R,z,K).parse()},parseStyleAttribute:function(A){var T={},R=A.getAttribute("style");return R&&(typeof R=="string"?W(R,T):X(R,T)),T},parsePointsAttribute:function(A){if(!A)return null;A=A.replace(/,/g," ").trim(),A=A.split(/\s+/);var T=[],R,z;for(R=0,z=A.length;R<z;R+=2)T.push({x:parseFloat(A[R]),y:parseFloat(A[R+1])});return T},getCSSRules:function(A){var T=A.getElementsByTagName("style"),R,z,K={},H;for(R=0,z=T.length;R<z;R++){var G=T[R].textContent;G=G.replace(/\/\*[\s\S]*?\*\//g,""),G.trim()!==""&&(H=G.split("}"),H=H.filter(function(ue){return ue.trim()}),H.forEach(function(ue){var le=ue.split("{"),ee={},Y=le[1].trim(),ce=Y.split(";").filter(function(ve){return ve.trim()});for(R=0,z=ce.length;R<z;R++){var se=ce[R].split(":"),V=se[0].trim(),he=se[1].trim();ee[V]=he}ue=le[0].trim(),ue.split(",").forEach(function(ve){ve=ve.replace(/^svg/i,"").trim(),ve!==""&&(K[ve]?s.util.object.extend(K[ve],ee):K[ve]=s.util.object.clone(ee))})}))}return K},loadSVGFromURL:function(A,T,R,z){A=A.replace(/^\n\s*/,"").trim(),new s.util.request(A,{method:"get",onComplete:K});function K(H){var G=H.responseXML;if(!G||!G.documentElement)return T&&T(null),!1;s.parseSVGDocument(G.documentElement,function(ue,le,ee,Y){T&&T(ue,le,ee,Y)},R,z)}},loadSVGFromString:function(A,T,R,z){var K=new s.window.DOMParser,H=K.parseFromString(A.trim(),"text/xml");s.parseSVGDocument(H.documentElement,function(G,ue,le,ee){T(G,ue,le,ee)},R,z)}})}(t),e.ElementsParser=function(c,s,u,d,l,o){this.elements=c,this.callback=s,this.options=u,this.reviver=d,this.svgUid=u&&u.svgUid||0,this.parsingOptions=l,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=o},function(c){c.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},c.createObjects=function(){var s=this;this.elements.forEach(function(u,d){u.setAttribute("svgUid",s.svgUid),s.createObject(u,d)})},c.findTag=function(s){return e[e.util.string.capitalize(s.tagName.replace("svg:",""))]},c.createObject=function(s,u){var d=this.findTag(s);if(d&&d.fromElement)try{d.fromElement(s,this.createCallback(u,s),this.options)}catch(l){e.log(l)}else this.checkIfDone()},c.createCallback=function(s,u){var d=this;return function(l){var o;d.resolveGradient(l,u,"fill"),d.resolveGradient(l,u,"stroke"),l instanceof e.Image&&l._originalElement&&(o=l.parsePreserveAspectRatioAttribute(u)),l._removeTransformMatrix(o),d.resolveClipPath(l,u),d.reviver&&d.reviver(u,l),d.instances[s]=l,d.checkIfDone()}},c.extractPropertyDefinition=function(s,u,d){var l=s[u],o=this.regexUrl;if(o.test(l)){o.lastIndex=0;var a=o.exec(l)[1];return o.lastIndex=0,e[d][this.svgUid][a]}},c.resolveGradient=function(s,u,d){var l=this.extractPropertyDefinition(s,d,"gradientDefs");if(l){var o=u.getAttribute(d+"-opacity"),a=e.Gradient.fromElement(l,s,o,this.options);s.set(d,a)}},c.createClipPathCallback=function(s,u){return function(d){d._removeTransformMatrix(),d.fillRule=d.clipRule,u.push(d)}},c.resolveClipPath=function(s,u){var d=this.extractPropertyDefinition(s,"clipPath","clipPaths"),l,o,a,h,g,p;if(d){h=[],a=e.util.invertTransform(s.calcTransformMatrix());for(var v=d[0].parentNode,x=u;x.parentNode&&x.getAttribute("clip-path")!==s.clipPath;)x=x.parentNode;x.parentNode.appendChild(v);for(var y=0;y<d.length;y++)l=d[y],o=this.findTag(l),o.fromElement(l,this.createClipPathCallback(s,h),this.options);h.length===1?d=h[0]:d=new e.Group(h),g=e.util.multiplyTransformMatrices(a,d.calcTransformMatrix()),d.clipPath&&this.resolveClipPath(d,x);var p=e.util.qrDecompose(g);d.flipX=!1,d.flipY=!1,d.set("scaleX",p.scaleX),d.set("scaleY",p.scaleY),d.angle=p.angle,d.skewX=p.skewX,d.skewY=0,d.setPositionByOrigin({x:p.translateX,y:p.translateY},"center","center"),s.clipPath=d}else delete s.clipPath},c.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(s){return s!=null}),this.callback(this.instances,this.elements))}}(e.ElementsParser.prototype),function(c){var s=c.fabric||(c.fabric={});if(s.Point){s.warn("fabric.Point is already defined");return}s.Point=u;function u(d,l){this.x=d,this.y=l}u.prototype={type:"point",constructor:u,add:function(d){return new u(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new u(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new u(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new u(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new u(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new u(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,l){return typeof l>"u"&&(l=.5),l=Math.max(Math.min(1,l),0),new u(this.x+(d.x-this.x)*l,this.y+(d.y-this.y)*l)},distanceFrom:function(d){var l=this.x-d.x,o=this.y-d.y;return Math.sqrt(l*l+o*o)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new u(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new u(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,l){return this.x=d,this.y=l,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var l=this.x,o=this.y;this.x=d.x,this.y=d.y,d.x=l,d.y=o},clone:function(){return new u(this.x,this.y)}}}(t),function(c){var s=c.fabric||(c.fabric={});if(s.Intersection){s.warn("fabric.Intersection is already defined");return}function u(d){this.status=d,this.points=[]}s.Intersection=u,s.Intersection.prototype={constructor:u,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},s.Intersection.intersectLineLine=function(d,l,o,a){var h,g=(a.x-o.x)*(d.y-o.y)-(a.y-o.y)*(d.x-o.x),p=(l.x-d.x)*(d.y-o.y)-(l.y-d.y)*(d.x-o.x),v=(a.y-o.y)*(l.x-d.x)-(a.x-o.x)*(l.y-d.y);if(v!==0){var x=g/v,y=p/v;0<=x&&x<=1&&0<=y&&y<=1?(h=new u("Intersection"),h.appendPoint(new s.Point(d.x+x*(l.x-d.x),d.y+x*(l.y-d.y)))):h=new u}else g===0||p===0?h=new u("Coincident"):h=new u("Parallel");return h},s.Intersection.intersectLinePolygon=function(d,l,o){var a=new u,h=o.length,g,p,v,x;for(x=0;x<h;x++)g=o[x],p=o[(x+1)%h],v=u.intersectLineLine(d,l,g,p),a.appendPoints(v.points);return a.points.length>0&&(a.status="Intersection"),a},s.Intersection.intersectPolygonPolygon=function(d,l){var o=new u,a=d.length,h;for(h=0;h<a;h++){var g=d[h],p=d[(h+1)%a],v=u.intersectLinePolygon(g,p,l);o.appendPoints(v.points)}return o.points.length>0&&(o.status="Intersection"),o},s.Intersection.intersectPolygonRectangle=function(d,l,o){var a=l.min(o),h=l.max(o),g=new s.Point(h.x,a.y),p=new s.Point(a.x,h.y),v=u.intersectLinePolygon(a,g,d),x=u.intersectLinePolygon(g,h,d),y=u.intersectLinePolygon(h,p,d),_=u.intersectLinePolygon(p,a,d),w=new u;return w.appendPoints(v.points),w.appendPoints(x.points),w.appendPoints(y.points),w.appendPoints(_.points),w.points.length>0&&(w.status="Intersection"),w}}(t),function(c){var s=c.fabric||(c.fabric={});if(s.Color){s.warn("fabric.Color is already defined.");return}function u(l){l?this._tryParsingColor(l):this.setSource([0,0,0,1])}s.Color=u,s.Color.prototype={_tryParsingColor:function(l){var o;l in u.colorNameMap&&(l=u.colorNameMap[l]),l==="transparent"&&(o=[255,255,255,0]),o||(o=u.sourceFromHex(l)),o||(o=u.sourceFromRgb(l)),o||(o=u.sourceFromHsl(l)),o||(o=[0,0,0,1]),o&&this.setSource(o)},_rgbToHsl:function(l,o,a){l/=255,o/=255,a/=255;var h,g,p,v=s.util.array.max([l,o,a]),x=s.util.array.min([l,o,a]);if(p=(v+x)/2,v===x)h=g=0;else{var y=v-x;switch(g=p>.5?y/(2-v-x):y/(v+x),v){case l:h=(o-a)/y+(o<a?6:0);break;case o:h=(a-l)/y+2;break;case a:h=(l-o)/y+4;break}h/=6}return[Math.round(h*360),Math.round(g*100),Math.round(p*100)]},getSource:function(){return this._source},setSource:function(l){this._source=l},toRgb:function(){var l=this.getSource();return"rgb("+l[0]+","+l[1]+","+l[2]+")"},toRgba:function(){var l=this.getSource();return"rgba("+l[0]+","+l[1]+","+l[2]+","+l[3]+")"},toHsl:function(){var l=this.getSource(),o=this._rgbToHsl(l[0],l[1],l[2]);return"hsl("+o[0]+","+o[1]+"%,"+o[2]+"%)"},toHsla:function(){var l=this.getSource(),o=this._rgbToHsl(l[0],l[1],l[2]);return"hsla("+o[0]+","+o[1]+"%,"+o[2]+"%,"+l[3]+")"},toHex:function(){var l=this.getSource(),o,a,h;return o=l[0].toString(16),o=o.length===1?"0"+o:o,a=l[1].toString(16),a=a.length===1?"0"+a:a,h=l[2].toString(16),h=h.length===1?"0"+h:h,o.toUpperCase()+a.toUpperCase()+h.toUpperCase()},toHexa:function(){var l=this.getSource(),o;return o=Math.round(l[3]*255),o=o.toString(16),o=o.length===1?"0"+o:o,this.toHex()+o.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(l){var o=this.getSource();return o[3]=l,this.setSource(o),this},toGrayscale:function(){var l=this.getSource(),o=parseInt((l[0]*.3+l[1]*.59+l[2]*.11).toFixed(0),10),a=l[3];return this.setSource([o,o,o,a]),this},toBlackWhite:function(l){var o=this.getSource(),a=(o[0]*.3+o[1]*.59+o[2]*.11).toFixed(0),h=o[3];return l=l||127,a=Number(a)<Number(l)?0:255,this.setSource([a,a,a,h]),this},overlayWith:function(l){l instanceof u||(l=new u(l));var o=[],a=this.getAlpha(),h=.5,g=this.getSource(),p=l.getSource(),v;for(v=0;v<3;v++)o.push(Math.round(g[v]*(1-h)+p[v]*h));return o[3]=a,this.setSource(o),this}},s.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,s.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,s.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,s.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function d(l,o,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?l+(o-l)*6*a:a<1/2?o:a<2/3?l+(o-l)*(2/3-a)*6:l}s.Color.fromRgb=function(l){return u.fromSource(u.sourceFromRgb(l))},s.Color.sourceFromRgb=function(l){var o=l.match(u.reRGBa);if(o){var a=parseInt(o[1],10)/(/%$/.test(o[1])?100:1)*(/%$/.test(o[1])?255:1),h=parseInt(o[2],10)/(/%$/.test(o[2])?100:1)*(/%$/.test(o[2])?255:1),g=parseInt(o[3],10)/(/%$/.test(o[3])?100:1)*(/%$/.test(o[3])?255:1);return[parseInt(a,10),parseInt(h,10),parseInt(g,10),o[4]?parseFloat(o[4]):1]}},s.Color.fromRgba=u.fromRgb,s.Color.fromHsl=function(l){return u.fromSource(u.sourceFromHsl(l))},s.Color.sourceFromHsl=function(l){var o=l.match(u.reHSLa);if(o){var a=(parseFloat(o[1])%360+360)%360/360,h=parseFloat(o[2])/(/%$/.test(o[2])?100:1),g=parseFloat(o[3])/(/%$/.test(o[3])?100:1),p,v,x;if(h===0)p=v=x=g;else{var y=g<=.5?g*(h+1):g+h-g*h,_=g*2-y;p=d(_,y,a+1/3),v=d(_,y,a),x=d(_,y,a-1/3)}return[Math.round(p*255),Math.round(v*255),Math.round(x*255),o[4]?parseFloat(o[4]):1]}},s.Color.fromHsla=u.fromHsl,s.Color.fromHex=function(l){return u.fromSource(u.sourceFromHex(l))},s.Color.sourceFromHex=function(l){if(l.match(u.reHex)){var o=l.slice(l.indexOf("#")+1),a=o.length===3||o.length===4,h=o.length===8||o.length===4,g=a?o.charAt(0)+o.charAt(0):o.substring(0,2),p=a?o.charAt(1)+o.charAt(1):o.substring(2,4),v=a?o.charAt(2)+o.charAt(2):o.substring(4,6),x=h?a?o.charAt(3)+o.charAt(3):o.substring(6,8):"FF";return[parseInt(g,16),parseInt(p,16),parseInt(v,16),parseFloat((parseInt(x,16)/255).toFixed(2))]}},s.Color.fromSource=function(l){var o=new u;return o.setSource(l),o}}(t),function(c){var s=c.fabric||(c.fabric={}),u=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],l={},o="left",a="top",h="right",g="bottom",p="center",v={top:g,bottom:a,left:h,right:o,center:p},x=s.util.radiansToDegrees,y=Math.sign||function(ee){return(ee>0)-(ee<0)||+ee};function _(ee,Y){var ce=ee.angle+x(Math.atan2(Y.y,Y.x))+360;return Math.round(ce%360/45)}function w(ee,Y){var ce=Y.transform.target,se=ce.canvas,V=s.util.object.clone(Y);V.target=ce,se&&se.fire("object:"+ee,V),ce.fire(ee,Y)}function C(ee,Y){var ce=Y.canvas,se=ce.uniScaleKey,V=ee[se];return ce.uniformScaling&&!V||!ce.uniformScaling&&V}function S(ee){return ee.originX===p&&ee.originY===p}function O(ee,Y,ce){var se=ee.lockScalingX,V=ee.lockScalingY;return!!(se&&V||!Y&&(se||V)&&ce||se&&Y==="x"||V&&Y==="y")}function F(ee,Y,ce){var se="not-allowed",V=C(ee,ce),he="";if(Y.x!==0&&Y.y===0?he="x":Y.x===0&&Y.y!==0&&(he="y"),O(ce,he,V))return se;var ve=_(ce,Y);return u[ve]+"-resize"}function N(ee,Y,ce){var se="not-allowed";if(Y.x!==0&&ce.lockSkewingY||Y.y!==0&&ce.lockSkewingX)return se;var V=_(ce,Y)%4;return d[V]+"-resize"}function W(ee,Y,ce){return ee[ce.canvas.altActionKey]?l.skewCursorStyleHandler(ee,Y,ce):l.scaleCursorStyleHandler(ee,Y,ce)}function X(ee,Y,ce){var se=ee[ce.canvas.altActionKey];if(Y.x===0)return se?"skewX":"scaleY";if(Y.y===0)return se?"skewY":"scaleX"}function Q(ee,Y,ce){return ce.lockRotation?"not-allowed":Y.cursorStyle}function ae(ee,Y,ce,se){return{e:ee,transform:Y,pointer:{x:ce,y:se}}}function ne(ee){return function(Y,ce,se,V){var he=ce.target,ve=he.getCenterPoint(),Re=he.translateToOriginPoint(ve,ce.originX,ce.originY),Pe=ee(Y,ce,se,V);return he.setPositionByOrigin(Re,ce.originX,ce.originY),Pe}}function J(ee,Y){return function(ce,se,V,he){var ve=Y(ce,se,V,he);return ve&&w(ee,ae(ce,se,V,he)),ve}}function oe(ee,Y,ce,se,V){var he=ee.target,ve=he.controls[ee.corner],Re=he.canvas.getZoom(),Pe=he.padding/Re,pe=he.toLocalPoint(new s.Point(se,V),Y,ce);return pe.x>=Pe&&(pe.x-=Pe),pe.x<=-Pe&&(pe.x+=Pe),pe.y>=Pe&&(pe.y-=Pe),pe.y<=Pe&&(pe.y+=Pe),pe.x-=ve.offsetX,pe.y-=ve.offsetY,pe}function q(ee){return ee.flipX!==ee.flipY}function k(ee,Y,ce,se,V){if(ee[Y]!==0){var he=ee._getTransformedDimensions()[se],ve=V/he*ee[ce];ee.set(ce,ve)}}function D(ee,Y,ce,se){var V=Y.target,he=V._getTransformedDimensions(0,V.skewY),ve=oe(Y,Y.originX,Y.originY,ce,se),Re=Math.abs(ve.x*2)-he.x,Pe=V.skewX,pe;Re<2?pe=0:(pe=x(Math.atan2(Re/V.scaleX,he.y/V.scaleY)),Y.originX===o&&Y.originY===g&&(pe=-pe),Y.originX===h&&Y.originY===a&&(pe=-pe),q(V)&&(pe=-pe));var De=Pe!==pe;if(De){var be=V._getTransformedDimensions().y;V.set("skewX",pe),k(V,"skewY","scaleY","y",be)}return De}function L(ee,Y,ce,se){var V=Y.target,he=V._getTransformedDimensions(V.skewX,0),ve=oe(Y,Y.originX,Y.originY,ce,se),Re=Math.abs(ve.y*2)-he.y,Pe=V.skewY,pe;Re<2?pe=0:(pe=x(Math.atan2(Re/V.scaleY,he.x/V.scaleX)),Y.originX===o&&Y.originY===g&&(pe=-pe),Y.originX===h&&Y.originY===a&&(pe=-pe),q(V)&&(pe=-pe));var De=Pe!==pe;if(De){var be=V._getTransformedDimensions().x;V.set("skewY",pe),k(V,"skewX","scaleX","x",be)}return De}function E(ee,Y,ce,se){var V=Y.target,he=V.skewX,ve,Re=Y.originY;if(V.lockSkewingX)return!1;if(he===0){var Pe=oe(Y,p,p,ce,se);Pe.x>0?ve=o:ve=h}else he>0&&(ve=Re===a?o:h),he<0&&(ve=Re===a?h:o),q(V)&&(ve=ve===o?h:o);Y.originX=ve;var pe=J("skewing",ne(D));return pe(ee,Y,ce,se)}function b(ee,Y,ce,se){var V=Y.target,he=V.skewY,ve,Re=Y.originX;if(V.lockSkewingY)return!1;if(he===0){var Pe=oe(Y,p,p,ce,se);Pe.y>0?ve=a:ve=g}else he>0&&(ve=Re===o?a:g),he<0&&(ve=Re===o?g:a),q(V)&&(ve=ve===a?g:a);Y.originY=ve;var pe=J("skewing",ne(L));return pe(ee,Y,ce,se)}function A(ee,Y,ce,se){var V=Y,he=V.target,ve=he.translateToOriginPoint(he.getCenterPoint(),V.originX,V.originY);if(he.lockRotation)return!1;var Re=Math.atan2(V.ey-ve.y,V.ex-ve.x),Pe=Math.atan2(se-ve.y,ce-ve.x),pe=x(Pe-Re+V.theta),De=!0;if(he.snapAngle>0){var be=he.snapAngle,Be=he.snapThreshold||be,Ke=Math.ceil(pe/be)*be,Ue=Math.floor(pe/be)*be;Math.abs(pe-Ue)<Be?pe=Ue:Math.abs(pe-Ke)<Be&&(pe=Ke)}return pe<0&&(pe=360+pe),pe%=360,De=he.angle!==pe,he.angle=pe,De}function T(ee,Y,ce,se,V){V=V||{};var he=Y.target,ve=he.lockScalingX,Re=he.lockScalingY,Pe=V.by,pe,De,be,Be,Ke=C(ee,he),Ue=O(he,Pe,Ke),nt,ct,Xr=Y.gestureScale;if(Ue)return!1;if(Xr)De=Y.scaleX*Xr,be=Y.scaleY*Xr;else{if(pe=oe(Y,Y.originX,Y.originY,ce,se),nt=Pe!=="y"?y(pe.x):1,ct=Pe!=="x"?y(pe.y):1,Y.signX||(Y.signX=nt),Y.signY||(Y.signY=ct),he.lockScalingFlip&&(Y.signX!==nt||Y.signY!==ct))return!1;if(Be=he._getTransformedDimensions(),Ke&&!Pe){var Cn=Math.abs(pe.x)+Math.abs(pe.y),lr=Y.original,Ma=Math.abs(Be.x*lr.scaleX/he.scaleX)+Math.abs(Be.y*lr.scaleY/he.scaleY),vs=Cn/Ma;De=lr.scaleX*vs,be=lr.scaleY*vs}else De=Math.abs(pe.x*he.scaleX/Be.x),be=Math.abs(pe.y*he.scaleY/Be.y);S(Y)&&(De*=2,be*=2),Y.signX!==nt&&Pe!=="y"&&(Y.originX=v[Y.originX],De*=-1,Y.signX=nt),Y.signY!==ct&&Pe!=="x"&&(Y.originY=v[Y.originY],be*=-1,Y.signY=ct)}var La=he.scaleX,Dl=he.scaleY;return Pe?(Pe==="x"&&he.set("scaleX",De),Pe==="y"&&he.set("scaleY",be)):(!ve&&he.set("scaleX",De),!Re&&he.set("scaleY",be)),La!==he.scaleX||Dl!==he.scaleY}function R(ee,Y,ce,se){return T(ee,Y,ce,se)}function z(ee,Y,ce,se){return T(ee,Y,ce,se,{by:"x"})}function K(ee,Y,ce,se){return T(ee,Y,ce,se,{by:"y"})}function H(ee,Y,ce,se){return ee[Y.target.canvas.altActionKey]?l.skewHandlerX(ee,Y,ce,se):l.scalingY(ee,Y,ce,se)}function G(ee,Y,ce,se){return ee[Y.target.canvas.altActionKey]?l.skewHandlerY(ee,Y,ce,se):l.scalingX(ee,Y,ce,se)}function ue(ee,Y,ce,se){var V=Y.target,he=oe(Y,Y.originX,Y.originY,ce,se),ve=V.strokeWidth/(V.strokeUniform?V.scaleX:1),Re=S(Y)?2:1,Pe=V.width,pe=Math.abs(he.x*Re/V.scaleX)-ve;return V.set("width",Math.max(pe,0)),Pe!==pe}function le(ee,Y,ce,se){var V=Y.target,he=ce-Y.offsetX,ve=se-Y.offsetY,Re=!V.get("lockMovementX")&&V.left!==he,Pe=!V.get("lockMovementY")&&V.top!==ve;return Re&&V.set("left",he),Pe&&V.set("top",ve),(Re||Pe)&&w("moving",ae(ee,Y,ce,se)),Re||Pe}l.scaleCursorStyleHandler=F,l.skewCursorStyleHandler=N,l.scaleSkewCursorStyleHandler=W,l.rotationWithSnapping=J("rotating",ne(A)),l.scalingEqually=J("scaling",ne(R)),l.scalingX=J("scaling",ne(z)),l.scalingY=J("scaling",ne(K)),l.scalingYOrSkewingX=H,l.scalingXOrSkewingY=G,l.changeWidth=J("resizing",ne(ue)),l.skewHandlerX=E,l.skewHandlerY=b,l.dragHandler=le,l.scaleOrSkewActionName=X,l.rotationStyleHandler=Q,l.fireEvent=w,l.wrapWithFixedAnchor=ne,l.wrapWithFireEvent=J,l.getLocalPoint=oe,s.controlsUtils=l}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.degreesToRadians,d=s.controlsUtils;function l(a,h,g,p,v){p=p||{};var x=this.sizeX||p.cornerSize||v.cornerSize,y=this.sizeY||p.cornerSize||v.cornerSize,_=typeof p.transparentCorners<"u"?p.transparentCorners:v.transparentCorners,w=_?"stroke":"fill",C=!_&&(p.cornerStrokeColor||v.cornerStrokeColor),S=h,O=g,F;a.save(),a.fillStyle=p.cornerColor||v.cornerColor,a.strokeStyle=p.cornerStrokeColor||v.cornerStrokeColor,x>y?(F=x,a.scale(1,y/x),O=g*x/y):y>x?(F=y,a.scale(x/y,1),S=h*y/x):F=x,a.lineWidth=1,a.beginPath(),a.arc(S,O,F/2,0,2*Math.PI,!1),a[w](),C&&a.stroke(),a.restore()}function o(a,h,g,p,v){p=p||{};var x=this.sizeX||p.cornerSize||v.cornerSize,y=this.sizeY||p.cornerSize||v.cornerSize,_=typeof p.transparentCorners<"u"?p.transparentCorners:v.transparentCorners,w=_?"stroke":"fill",C=!_&&(p.cornerStrokeColor||v.cornerStrokeColor),S=x/2,O=y/2;a.save(),a.fillStyle=p.cornerColor||v.cornerColor,a.strokeStyle=p.cornerStrokeColor||v.cornerStrokeColor,a.lineWidth=1,a.translate(h,g),a.rotate(u(v.angle)),a[w+"Rect"](-S,-O,x,y),C&&a.strokeRect(-S,-O,x,y),a.restore()}d.renderCircleControl=l,d.renderSquareControl=o}(t),function(c){var s=c.fabric||(c.fabric={});function u(d){for(var l in d)this[l]=d[l]}s.Control=u,s.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(d,l){return l.cursorStyle},getActionName:function(d,l){return l.actionName},getVisibility:function(d,l){var o=d._controlsVisibility;return o&&typeof o[l]<"u"?o[l]:this.visible},setVisibility:function(d){this.visible=d},positionHandler:function(d,l){var o=s.util.transformPoint({x:this.x*d.x+this.offsetX,y:this.y*d.y+this.offsetY},l);return o},calcCornerCoords:function(d,l,o,a,h){var g,p,v,x,y=h?this.touchSizeX:this.sizeX,_=h?this.touchSizeY:this.sizeY;if(y&&_&&y!==_){var w=Math.atan2(_,y),C=Math.sqrt(y*y+_*_)/2,S=w-s.util.degreesToRadians(d),O=Math.PI/2-w-s.util.degreesToRadians(d);g=C*s.util.cos(S),p=C*s.util.sin(S),v=C*s.util.cos(O),x=C*s.util.sin(O)}else{var F=y&&_?y:l;C=F*.7071067812;var S=s.util.degreesToRadians(45-d);g=v=C*s.util.cos(S),p=x=C*s.util.sin(S)}return{tl:{x:o-x,y:a-v},tr:{x:o+g,y:a-p},bl:{x:o-g,y:a+p},br:{x:o+x,y:a+v}}},render:function(d,l,o,a,h){switch(a=a||{},a.cornerStyle||h.cornerStyle){case"circle":s.controlsUtils.renderCircleControl.call(this,d,l,o,a,h);break;default:s.controlsUtils.renderSquareControl.call(this,d,l,o,a,h)}}}}(t),function(){function c(o,a){var h=o.getAttribute("style"),g=o.getAttribute("offset")||0,p,v,x,y;if(g=parseFloat(g)/(/%$/.test(g)?100:1),g=g<0?0:g>1?1:g,h){var _=h.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),y=_.length;y--;){var w=_[y].split(/\s*:\s*/),C=w[0].trim(),S=w[1].trim();C==="stop-color"?p=S:C==="stop-opacity"&&(x=S)}}return p||(p=o.getAttribute("stop-color")||"rgb(0,0,0)"),x||(x=o.getAttribute("stop-opacity")),p=new e.Color(p),v=p.getAlpha(),x=isNaN(parseFloat(x))?1:parseFloat(x),x*=v*a,{offset:g,color:p.toRgb(),opacity:x}}function s(o){return{x1:o.getAttribute("x1")||0,y1:o.getAttribute("y1")||0,x2:o.getAttribute("x2")||"100%",y2:o.getAttribute("y2")||0}}function u(o){return{x1:o.getAttribute("fx")||o.getAttribute("cx")||"50%",y1:o.getAttribute("fy")||o.getAttribute("cy")||"50%",r1:0,x2:o.getAttribute("cx")||"50%",y2:o.getAttribute("cy")||"50%",r2:o.getAttribute("r")||"50%"}}var d=e.util.object.clone;e.Gradient=e.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(o){o||(o={}),o.coords||(o.coords={});var a,h=this;Object.keys(o).forEach(function(g){h[g]=o[g]}),this.id?this.id+="_"+e.Object.__uid++:this.id=e.Object.__uid++,a={x1:o.coords.x1||0,y1:o.coords.y1||0,x2:o.coords.x2||0,y2:o.coords.y2||0},this.type==="radial"&&(a.r1=o.coords.r1||0,a.r2=o.coords.r2||0),this.coords=a,this.colorStops=o.colorStops.slice()},addColorStop:function(o){for(var a in o){var h=new e.Color(o[a]);this.colorStops.push({offset:parseFloat(a),color:h.toRgb(),opacity:h.getAlpha()})}return this},toObject:function(o){var a={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return e.util.populateWithProperties(this,a,o),a},toSVG:function(o,v){var h=d(this.coords,!0),g,p,v=v||{},x,y,_=d(this.colorStops,!0),w=h.r1>h.r2,C=this.gradientTransform?this.gradientTransform.concat():e.iMatrix.concat(),S=-this.offsetX,O=-this.offsetY,F=!!v.additionalTransform,N=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(_.sort(function(ne,J){return ne.offset-J.offset}),N==="objectBoundingBox"?(S/=o.width,O/=o.height):(S+=o.width/2,O+=o.height/2),o.type==="path"&&this.gradientUnits!=="percentage"&&(S-=o.pathOffset.x,O-=o.pathOffset.y),C[4]-=S,C[5]-=O,y='id="SVGID_'+this.id+'" gradientUnits="'+N+'"',y+=' gradientTransform="'+(F?v.additionalTransform+" ":"")+e.util.matrixToSVG(C)+'" ',this.type==="linear"?x=["<linearGradient ",y,' x1="',h.x1,'" y1="',h.y1,'" x2="',h.x2,'" y2="',h.y2,`">
`]:this.type==="radial"&&(x=["<radialGradient ",y,' cx="',w?h.x1:h.x2,'" cy="',w?h.y1:h.y2,'" r="',w?h.r1:h.r2,'" fx="',w?h.x2:h.x1,'" fy="',w?h.y2:h.y1,`">
`]),this.type==="radial"){if(w)for(_=_.concat(),_.reverse(),g=0,p=_.length;g<p;g++)_[g].offset=1-_[g].offset;var W=Math.min(h.r1,h.r2);if(W>0){var X=Math.max(h.r1,h.r2),Q=W/X;for(g=0,p=_.length;g<p;g++)_[g].offset+=Q*(1-_[g].offset)}}for(g=0,p=_.length;g<p;g++){var ae=_[g];x.push("<stop ",'offset="',ae.offset*100+"%",'" style="stop-color:',ae.color,typeof ae.opacity<"u"?";stop-opacity: "+ae.opacity:";",`"/>
`)}return x.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),x.join("")},toLive:function(o){var a,h=e.util.object.clone(this.coords),g,p;if(this.type){for(this.type==="linear"?a=o.createLinearGradient(h.x1,h.y1,h.x2,h.y2):this.type==="radial"&&(a=o.createRadialGradient(h.x1,h.y1,h.r1,h.x2,h.y2,h.r2)),g=0,p=this.colorStops.length;g<p;g++){var v=this.colorStops[g].color,x=this.colorStops[g].opacity,y=this.colorStops[g].offset;typeof x<"u"&&(v=new e.Color(v).setAlpha(x).toRgba()),a.addColorStop(y,v)}return a}}}),e.util.object.extend(e.Gradient,{fromElement:function(o,a,h,g){var p=parseFloat(h)/(/%$/.test(h)?100:1);p=p<0?0:p>1?1:p,isNaN(p)&&(p=1);var v=o.getElementsByTagName("stop"),x,y=o.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",_=o.getAttribute("gradientTransform")||"",w=[],C,S,O=0,F=0,N;for(o.nodeName==="linearGradient"||o.nodeName==="LINEARGRADIENT"?(x="linear",C=s(o)):(x="radial",C=u(o)),S=v.length;S--;)w.push(c(v[S],p));N=e.parseTransformAttribute(_),l(a,C,g,y),y==="pixels"&&(O=-a.left,F=-a.top);var W=new e.Gradient({id:o.getAttribute("id"),type:x,coords:C,colorStops:w,gradientUnits:y,gradientTransform:N,offsetX:O,offsetY:F});return W}});function l(o,a,h,g){var p,v;Object.keys(a).forEach(function(x){p=a[x],p==="Infinity"?v=1:p==="-Infinity"?v=0:(v=parseFloat(a[x],10),typeof p=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(p)&&(v*=.01,g==="pixels"&&((x==="x1"||x==="x2"||x==="r2")&&(v*=h.viewBoxWidth||h.width),(x==="y1"||x==="y2")&&(v*=h.viewBoxHeight||h.height)))),a[x]=v})}}(),function(){var c=e.util.toFixed;e.Pattern=e.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(s,u){if(s||(s={}),this.id=e.Object.__uid++,this.setOptions(s),!s.source||s.source&&typeof s.source!="string"){u&&u(this);return}else{var d=this;this.source=e.util.createImage(),e.util.loadImage(s.source,function(l,o){d.source=l,u&&u(d,o)},null,this.crossOrigin)}},toObject:function(s){var u=e.Object.NUM_FRACTION_DIGITS,d,l;return typeof this.source.src=="string"?d=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(d=this.source.toDataURL()),l={type:"pattern",source:d,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:c(this.offsetX,u),offsetY:c(this.offsetY,u),patternTransform:this.patternTransform?this.patternTransform.concat():null},e.util.populateWithProperties(this,l,s),l},toSVG:function(s){var u=typeof this.source=="function"?this.source():this.source,d=u.width/s.width,l=u.height/s.height,o=this.offsetX/s.width,a=this.offsetY/s.height,h="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(l=1,a&&(l+=Math.abs(a))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(d=1,o&&(d+=Math.abs(o))),u.src?h=u.src:u.toDataURL&&(h=u.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+o+'" y="'+a+'" width="'+d+'" height="'+l+`">
<image x="0" y="0" width="`+u.width+'" height="'+u.height+'" xlink:href="'+h+`"></image>
</pattern>
`},setOptions:function(s){for(var u in s)this[u]=s[u]},toLive:function(s){var u=this.source;return!u||typeof u.src<"u"&&(!u.complete||u.naturalWidth===0||u.naturalHeight===0)?"":s.createPattern(u,this.repeat)}})}(),function(c){var s=c.fabric||(c.fabric={}),u=s.util.toFixed;if(s.Shadow){s.warn("fabric.Shadow is already defined.");return}s.Shadow=s.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){typeof d=="string"&&(d=this._parseShadow(d));for(var l in d)this[l]=d[l];this.id=s.Object.__uid++},_parseShadow:function(d){var l=d.trim(),o=s.Shadow.reOffsetsAndBlur.exec(l)||[],a=l.replace(s.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:a.trim(),offsetX:parseFloat(o[1],10)||0,offsetY:parseFloat(o[2],10)||0,blur:parseFloat(o[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var l=40,o=40,a=s.Object.NUM_FRACTION_DIGITS,h=s.util.rotateVector({x:this.offsetX,y:this.offsetY},s.util.degreesToRadians(-d.angle)),g=20,p=new s.Color(this.color);return d.width&&d.height&&(l=u((Math.abs(h.x)+this.blur)/d.width,a)*100+g,o=u((Math.abs(h.y)+this.blur)/d.height,a)*100+g),d.flipX&&(h.x*=-1),d.flipY&&(h.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+o+'%" height="'+(100+2*o)+'%" x="-'+l+'%" width="'+(100+2*l)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+u(this.blur?this.blur/2:0,a)+`"></feGaussianBlur>
	<feOffset dx="`+u(h.x,a)+'" dy="'+u(h.y,a)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+p.toRgb()+'" flood-opacity="'+p.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},l=s.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(o){this[o]!==l[o]&&(d[o]=this[o])},this),d}}),s.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(t),function(){if(e.StaticCanvas){e.warn("fabric.StaticCanvas is already defined.");return}var c=e.util.object.extend,s=e.util.getElementOffset,u=e.util.removeFromArray,d=e.util.toFixed,l=e.util.transformPoint,o=e.util.invertTransform,a=e.util.getNodeCanvas,h=e.util.createCanvasElement,g=new Error("Could not initialize `canvas` element");e.StaticCanvas=e.util.createClass(e.CommonMethods,{initialize:function(p,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(p,v)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:e.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(p,v){var x=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(p),this._initOptions(v),this.interactive||this._initRetinaScaling(),v.overlayImage&&this.setOverlayImage(v.overlayImage,x),v.backgroundImage&&this.setBackgroundImage(v.backgroundImage,x),v.backgroundColor&&this.setBackgroundColor(v.backgroundColor,x),v.overlayColor&&this.setOverlayColor(v.overlayColor,x),this.calcOffset()},_isRetinaScaling:function(){return e.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,e.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var p=e.devicePixelRatio;this.__initRetinaScaling(p,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(p,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(p,v,x){v.setAttribute("width",this.width*p),v.setAttribute("height",this.height*p),x.scale(p,p)},calcOffset:function(){return this._offset=s(this.lowerCanvasEl),this},setOverlayImage:function(p,v,x){return this.__setBgOverlayImage("overlayImage",p,v,x)},setBackgroundImage:function(p,v,x){return this.__setBgOverlayImage("backgroundImage",p,v,x)},setOverlayColor:function(p,v){return this.__setBgOverlayColor("overlayColor",p,v)},setBackgroundColor:function(p,v){return this.__setBgOverlayColor("backgroundColor",p,v)},__setBgOverlayImage:function(p,v,x,y){return typeof v=="string"?e.util.loadImage(v,function(_,w){if(_){var C=new e.Image(_,y);this[p]=C,C.canvas=this}x&&x(_,w)},this,y&&y.crossOrigin):(y&&v.setOptions(y),this[p]=v,v&&(v.canvas=this),x&&x(v,!1)),this},__setBgOverlayColor:function(p,v,x){return this[p]=v,this._initGradient(v,p),this._initPattern(v,p,x),this},_createCanvasElement:function(){var p=h();if(!p||(p.style||(p.style={}),typeof p.getContext>"u"))throw g;return p},_initOptions:function(p){var v=this.lowerCanvasEl;this._setOptions(p),this.width=this.width||parseInt(v.width,10)||0,this.height=this.height||parseInt(v.height,10)||0,this.lowerCanvasEl.style&&(v.width=this.width,v.height=this.height,v.style.width=this.width+"px",v.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(p){p&&p.getContext?this.lowerCanvasEl=p:this.lowerCanvasEl=e.util.getById(p)||this._createCanvasElement(),e.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(p,v){return this.setDimensions({width:p},v)},setHeight:function(p,v){return this.setDimensions({height:p},v)},setDimensions:function(p,v){var x;v=v||{};for(var y in p)x=p[y],v.cssOnly||(this._setBackstoreDimension(y,p[y]),x+="px",this.hasLostContext=!0),v.backstoreOnly||this._setCssDimension(y,x);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),v.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(p,v){return this.lowerCanvasEl[p]=v,this.upperCanvasEl&&(this.upperCanvasEl[p]=v),this.cacheCanvasEl&&(this.cacheCanvasEl[p]=v),this[p]=v,this},_setCssDimension:function(p,v){return this.lowerCanvasEl.style[p]=v,this.upperCanvasEl&&(this.upperCanvasEl.style[p]=v),this.wrapperEl&&(this.wrapperEl.style[p]=v),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(p){var v=this._activeObject,x=this.backgroundImage,y=this.overlayImage,_,w,C;for(this.viewportTransform=p,w=0,C=this._objects.length;w<C;w++)_=this._objects[w],_.group||_.setCoords(!0);return v&&v.setCoords(),x&&x.setCoords(!0),y&&y.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(p,v){var x=p,y=this.viewportTransform.slice(0);p=l(p,o(this.viewportTransform)),y[0]=v,y[3]=v;var _=l(p,y);return y[4]+=x.x-_.x,y[5]+=x.y-_.y,this.setViewportTransform(y)},setZoom:function(p){return this.zoomToPoint(new e.Point(0,0),p),this},absolutePan:function(p){var v=this.viewportTransform.slice(0);return v[4]=-p.x,v[5]=-p.y,this.setViewportTransform(v)},relativePan:function(p){return this.absolutePan(new e.Point(-p.x-this.viewportTransform[4],-p.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(p){this.stateful&&p.setupState(),p._set("canvas",this),p.setCoords(),this.fire("object:added",{target:p}),p.fire("added")},_onObjectRemoved:function(p){this.fire("object:removed",{target:p}),p.fire("removed"),delete p.canvas},clearContext:function(p){return p.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var p=this.contextContainer;return this.renderCanvas(p,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=e.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var p={},v=this.width,x=this.height,y=o(this.viewportTransform);return p.tl=l({x:0,y:0},y),p.br=l({x:v,y:x},y),p.tr=new e.Point(p.br.x,p.tl.y),p.bl=new e.Point(p.tl.x,p.br.y),this.vptCoords=p,p},cancelRequestedRender:function(){this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(p,v){var x=this.viewportTransform,y=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(p),e.util.setImageSmoothing(p,this.imageSmoothingEnabled),this.fire("before:render",{ctx:p}),this._renderBackground(p),p.save(),p.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._renderObjects(p,v),p.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),y&&(y.canvas=this,y.shouldCache(),y._transformDone=!0,y.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(p)),this._renderOverlay(p),this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),this.fire("after:render",{ctx:p})},drawClipPathOnCanvas:function(p){var v=this.viewportTransform,x=this.clipPath;p.save(),p.transform(v[0],v[1],v[2],v[3],v[4],v[5]),p.globalCompositeOperation="destination-in",x.transform(p),p.scale(1/x.zoomX,1/x.zoomY),p.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),p.restore()},_renderObjects:function(p,v){var x,y;for(x=0,y=v.length;x<y;++x)v[x]&&v[x].render(p)},_renderBackgroundOrOverlay:function(p,v){var x=this[v+"Color"],y=this[v+"Image"],_=this.viewportTransform,w=this[v+"Vpt"];if(!(!x&&!y)){if(x){p.save(),p.beginPath(),p.moveTo(0,0),p.lineTo(this.width,0),p.lineTo(this.width,this.height),p.lineTo(0,this.height),p.closePath(),p.fillStyle=x.toLive?x.toLive(p,this):x,w&&p.transform(_[0],_[1],_[2],_[3],_[4],_[5]),p.transform(1,0,0,1,x.offsetX||0,x.offsetY||0);var C=x.gradientTransform||x.patternTransform;C&&p.transform(C[0],C[1],C[2],C[3],C[4],C[5]),p.fill(),p.restore()}y&&(p.save(),w&&p.transform(_[0],_[1],_[2],_[3],_[4],_[5]),y.render(p),p.restore())}},_renderBackground:function(p){this._renderBackgroundOrOverlay(p,"background")},_renderOverlay:function(p){this._renderBackgroundOrOverlay(p,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new e.Point(this.width/2,this.height/2)},centerObjectH:function(p){return this._centerObject(p,new e.Point(this.getCenterPoint().x,p.getCenterPoint().y))},centerObjectV:function(p){return this._centerObject(p,new e.Point(p.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(p){var v=this.getCenterPoint();return this._centerObject(p,v)},viewportCenterObject:function(p){var v=this.getVpCenter();return this._centerObject(p,v)},viewportCenterObjectH:function(p){var v=this.getVpCenter();return this._centerObject(p,new e.Point(v.x,p.getCenterPoint().y)),this},viewportCenterObjectV:function(p){var v=this.getVpCenter();return this._centerObject(p,new e.Point(p.getCenterPoint().x,v.y))},getVpCenter:function(){var p=this.getCenterPoint(),v=o(this.viewportTransform);return l(p,v)},_centerObject:function(p,v){return p.setPositionByOrigin(v,"center","center"),p.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(p){return this.toDatalessObject(p)},toObject:function(p){return this._toObjectMethod("toObject",p)},toDatalessObject:function(p){return this._toObjectMethod("toDatalessObject",p)},_toObjectMethod:function(p,v){var x=this.clipPath,y={version:e.version,objects:this._toObjects(p,v)};return x&&!x.excludeFromExport&&(y.clipPath=this._toObject(this.clipPath,p,v)),c(y,this.__serializeBgOverlay(p,v)),e.util.populateWithProperties(this,y,v),y},_toObjects:function(p,v){return this._objects.filter(function(x){return!x.excludeFromExport}).map(function(x){return this._toObject(x,p,v)},this)},_toObject:function(p,v,x){var y;this.includeDefaultValues||(y=p.includeDefaultValues,p.includeDefaultValues=!1);var _=p[v](x);return this.includeDefaultValues||(p.includeDefaultValues=y),_},__serializeBgOverlay:function(p,v){var x={},y=this.backgroundImage,_=this.overlayImage,w=this.backgroundColor,C=this.overlayColor;return w&&w.toObject?w.excludeFromExport||(x.background=w.toObject(v)):w&&(x.background=w),C&&C.toObject?C.excludeFromExport||(x.overlay=C.toObject(v)):C&&(x.overlay=C),y&&!y.excludeFromExport&&(x.backgroundImage=this._toObject(y,p,v)),_&&!_.excludeFromExport&&(x.overlayImage=this._toObject(_,p,v)),x},svgViewportTransformation:!0,toSVG:function(p,v){p||(p={}),p.reviver=v;var x=[];return this._setSVGPreamble(x,p),this._setSVGHeader(x,p),this.clipPath&&x.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(x,"background"),this._setSVGBgOverlayImage(x,"backgroundImage",v),this._setSVGObjects(x,v),this.clipPath&&x.push(`</g>
`),this._setSVGBgOverlayColor(x,"overlay"),this._setSVGBgOverlayImage(x,"overlayImage",v),x.push("</svg>"),x.join("")},_setSVGPreamble:function(p,v){v.suppressPreamble||p.push('<?xml version="1.0" encoding="',v.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(p,v){var x=v.width||this.width,y=v.height||this.height,_,w='viewBox="0 0 '+this.width+" "+this.height+'" ',C=e.Object.NUM_FRACTION_DIGITS;v.viewBox?w='viewBox="'+v.viewBox.x+" "+v.viewBox.y+" "+v.viewBox.width+" "+v.viewBox.height+'" ':this.svgViewportTransformation&&(_=this.viewportTransform,w='viewBox="'+d(-_[4]/_[0],C)+" "+d(-_[5]/_[3],C)+" "+d(this.width/_[0],C)+" "+d(this.height/_[3],C)+'" '),p.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',x,'" ','height="',y,'" ',w,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",e.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(v),`</defs>
`)},createSVGClipPathMarkup:function(p){var v=this.clipPath;return v?(v.clipPathId="CLIPPATH_"+e.Object.__uid++,'<clipPath id="'+v.clipPathId+`" >
`+this.clipPath.toClipPathSVG(p.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var p=this,v=["background","overlay"].map(function(x){var y=p[x+"Color"];if(y&&y.toLive){var _=p[x+"Vpt"],w=p.viewportTransform,C={width:p.width/(_?w[0]:1),height:p.height/(_?w[3]:1)};return y.toSVG(C,{additionalTransform:_?e.util.matrixToSVG(w):""})}});return v.join("")},createSVGFontFacesMarkup:function(){var p="",v={},x,y,_,w,C,S,O,F,N,W=e.fontPaths,X=[];for(this._objects.forEach(function ae(ne){X.push(ne),ne._objects&&ne._objects.forEach(ae)}),F=0,N=X.length;F<N;F++)if(x=X[F],y=x.fontFamily,!(x.type.indexOf("text")===-1||v[y]||!W[y])&&(v[y]=!0,!!x.styles)){_=x.styles;for(C in _){w=_[C];for(O in w)S=w[O],y=S.fontFamily,!v[y]&&W[y]&&(v[y]=!0)}}for(var Q in v)p+=[`		@font-face {
`,"			font-family: '",Q,`';
`,"			src: url('",W[Q],`');
`,`		}
`].join("");return p&&(p=['	<style type="text/css">',`<![CDATA[
`,p,"]]>",`</style>
`].join("")),p},_setSVGObjects:function(p,v){var x,y,_,w=this._objects;for(y=0,_=w.length;y<_;y++)x=w[y],!x.excludeFromExport&&this._setSVGObject(p,x,v)},_setSVGObject:function(p,v,x){p.push(v.toSVG(x))},_setSVGBgOverlayImage:function(p,v,x){this[v]&&!this[v].excludeFromExport&&this[v].toSVG&&p.push(this[v].toSVG(x))},_setSVGBgOverlayColor:function(p,v){var x=this[v+"Color"],y=this.viewportTransform,_=this.width,w=this.height;if(x)if(x.toLive){var C=x.repeat,S=e.util.invertTransform(y),O=this[v+"Vpt"],F=O?e.util.matrixToSVG(S):"";p.push('<rect transform="'+F+" translate(",_/2,",",w/2,')"',' x="',x.offsetX-_/2,'" y="',x.offsetY-w/2,'" ','width="',C==="repeat-y"||C==="no-repeat"?x.source.width:_,'" height="',C==="repeat-x"||C==="no-repeat"?x.source.height:w,'" fill="url(#SVGID_'+x.id+')"',`></rect>
`)}else p.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',x,'"',`></rect>
`)},sendToBack:function(p){if(!p)return this;var v=this._activeObject,x,y,_;if(p===v&&p.type==="activeSelection")for(_=v._objects,x=_.length;x--;)y=_[x],u(this._objects,y),this._objects.unshift(y);else u(this._objects,p),this._objects.unshift(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(p){if(!p)return this;var v=this._activeObject,x,y,_;if(p===v&&p.type==="activeSelection")for(_=v._objects,x=0;x<_.length;x++)y=_[x],u(this._objects,y),this._objects.push(y);else u(this._objects,p),this._objects.push(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(p,v){if(!p)return this;var x=this._activeObject,y,_,w,C,S,O=0;if(p===x&&p.type==="activeSelection")for(S=x._objects,y=0;y<S.length;y++)_=S[y],w=this._objects.indexOf(_),w>0+O&&(C=w-1,u(this._objects,_),this._objects.splice(C,0,_)),O++;else w=this._objects.indexOf(p),w!==0&&(C=this._findNewLowerIndex(p,w,v),u(this._objects,p),this._objects.splice(C,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(p,v,x){var y,_;if(x)for(y=v,_=v-1;_>=0;--_){var w=p.intersectsWithObject(this._objects[_])||p.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(p);if(w){y=_;break}}else y=v-1;return y},bringForward:function(p,v){if(!p)return this;var x=this._activeObject,y,_,w,C,S,O=0;if(p===x&&p.type==="activeSelection")for(S=x._objects,y=S.length;y--;)_=S[y],w=this._objects.indexOf(_),w<this._objects.length-1-O&&(C=w+1,u(this._objects,_),this._objects.splice(C,0,_)),O++;else w=this._objects.indexOf(p),w!==this._objects.length-1&&(C=this._findNewUpperIndex(p,w,v),u(this._objects,p),this._objects.splice(C,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(p,v,x){var y,_,w;if(x)for(y=v,_=v+1,w=this._objects.length;_<w;++_){var C=p.intersectsWithObject(this._objects[_])||p.isContainedWithinObject(this._objects[_])||this._objects[_].isContainedWithinObject(p);if(C){y=_;break}}else y=v+1;return y},moveTo:function(p,v){return u(this._objects,p),this._objects.splice(v,0,p),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(e.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(p){p.dispose&&p.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),e.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),e.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),c(e.StaticCanvas.prototype,e.Observable),c(e.StaticCanvas.prototype,e.Collection),c(e.StaticCanvas.prototype,e.DataURLExporter),c(e.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(p){var v=h();if(!v||!v.getContext)return null;var x=v.getContext("2d");if(!x)return null;switch(p){case"setLineDash":return typeof x.setLineDash<"u";default:return null}}}),e.StaticCanvas.prototype.toJSON=e.StaticCanvas.prototype.toObject,e.isLikelyNode&&(e.StaticCanvas.prototype.createPNGStream=function(){var p=a(this.lowerCanvasEl);return p&&p.createPNGStream()},e.StaticCanvas.prototype.createJPEGStream=function(p){var v=a(this.lowerCanvasEl);return v&&v.createJPEGStream(p)})}(),e.BaseBrush=e.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(c){c.strokeStyle=this.color,c.lineWidth=this.width,c.lineCap=this.strokeLineCap,c.miterLimit=this.strokeMiterLimit,c.lineJoin=this.strokeLineJoin,c.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(c){var s=this.canvas.viewportTransform;c.save(),c.transform(s[0],s[1],s[2],s[3],s[4],s[5])},_setShadow:function(){if(this.shadow){var c=this.canvas,s=this.shadow,u=c.contextTop,d=c.getZoom();c&&c._isRetinaScaling()&&(d*=e.devicePixelRatio),u.shadowColor=s.color,u.shadowBlur=s.blur*d,u.shadowOffsetX=s.offsetX*d,u.shadowOffsetY=s.offsetY*d}},needsFullRender:function(){var c=new e.Color(this.color);return c.getAlpha()<1||!!this.shadow},_resetShadow:function(){var c=this.canvas.contextTop;c.shadowColor="",c.shadowBlur=c.shadowOffsetX=c.shadowOffsetY=0},_isOutSideCanvas:function(c){return c.x<0||c.x>this.canvas.getWidth()||c.y<0||c.y>this.canvas.getHeight()}}),function(){e.PencilBrush=e.util.createClass(e.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(c){this.canvas=c,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(c,s,u){var d=s.midPointFrom(u);return c.quadraticCurveTo(s.x,s.y,d.x,d.y),d},onMouseDown:function(c,s){this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],this._prepareForDrawing(c),this._captureDrawingPath(c),this._render())},onMouseMove:function(c,s){if(this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(c))&&this._captureDrawingPath(c)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var u=this._points,d=u.length,l=this.canvas.contextTop;this._saveAndTransform(l),this.oldEnd&&(l.beginPath(),l.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(l,u[d-2],u[d-1],!0),l.stroke(),l.restore()}},onMouseUp:function(c){return this.canvas._isMainEvent(c.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(c){var s=new e.Point(c.x,c.y);this._reset(),this._addPoint(s),this.canvas.contextTop.moveTo(s.x,s.y)},_addPoint:function(c){return this._points.length>1&&c.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(c),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(c){var s=new e.Point(c.x,c.y);return this._addPoint(s)},_render:function(c){var s,u,d=this._points[0],l=this._points[1];if(c=c||this.canvas.contextTop,this._saveAndTransform(c),c.beginPath(),this._points.length===2&&d.x===l.x&&d.y===l.y){var o=this.width/1e3;d=new e.Point(d.x,d.y),l=new e.Point(l.x,l.y),d.x-=o,l.x+=o}for(c.moveTo(d.x,d.y),s=1,u=this._points.length;s<u;s++)this._drawSegment(c,d,l),d=this._points[s],l=this._points[s+1];c.lineTo(d.x,d.y),c.stroke(),c.restore()},convertPointsToSVGPath:function(c){var s=this.width/1e3;return e.util.getSmoothPathFromPoints(c,s)},_isEmptySVGPath:function(c){var s=e.util.joinPath(c);return s==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(c){var s=new e.Path(c,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,s.shadow=new e.Shadow(this.shadow)),s},decimatePoints:function(c,s){if(c.length<=2)return c;var u=this.canvas.getZoom(),d=Math.pow(s/u,2),l,o=c.length-1,a=c[0],h=[a],g;for(l=1;l<o-1;l++)g=Math.pow(a.x-c[l].x,2)+Math.pow(a.y-c[l].y,2),g>=d&&(a=c[l],h.push(a));return h.push(c[o]),h},_finalizeAndAddPath:function(){var c=this.canvas.contextTop;c.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var s=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(s)){this.canvas.requestRenderAll();return}var u=this.createPath(s);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.requestRenderAll(),u.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:u})}})}(),e.CircleBrush=e.util.createClass(e.BaseBrush,{width:10,initialize:function(c){this.canvas=c,this.points=[]},drawDot:function(c){var s=this.addPoint(c),u=this.canvas.contextTop;this._saveAndTransform(u),this.dot(u,s),u.restore()},dot:function(c,s){c.fillStyle=s.fill,c.beginPath(),c.arc(s.x,s.y,s.radius,0,Math.PI*2,!1),c.closePath(),c.fill()},onMouseDown:function(c){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(c)},_render:function(){var c=this.canvas.contextTop,s,u,d=this.points;for(this._saveAndTransform(c),s=0,u=d.length;s<u;s++)this.dot(c,d[s]);c.restore()},onMouseMove:function(c){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(c)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(c),this._render()):this.drawDot(c))},onMouseUp:function(){var c=this.canvas.renderOnAddRemove,s,u;this.canvas.renderOnAddRemove=!1;var d=[];for(s=0,u=this.points.length;s<u;s++){var l=this.points[s],o=new e.Circle({radius:l.radius,left:l.x,top:l.y,originX:"center",originY:"center",fill:l.fill});this.shadow&&(o.shadow=new e.Shadow(this.shadow)),d.push(o)}var a=new e.Group(d);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=c,this.canvas.requestRenderAll()},addPoint:function(c){var s=new e.Point(c.x,c.y),u=e.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new e.Color(this.color).setAlpha(e.util.getRandomInt(0,100)/100).toRgba();return s.radius=u,s.fill=d,this.points.push(s),s}}),e.SprayBrush=e.util.createClass(e.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(c){this.canvas=c,this.sprayChunks=[]},onMouseDown:function(c){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(c),this.render(this.sprayChunkPoints)},onMouseMove:function(c){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(c)||(this.addSprayChunk(c),this.render(this.sprayChunkPoints))},onMouseUp:function(){var c=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var s=[],u=0,d=this.sprayChunks.length;u<d;u++)for(var l=this.sprayChunks[u],o=0,a=l.length;o<a;o++){var h=new e.Rect({width:l[o].width,height:l[o].width,left:l[o].x+1,top:l[o].y+1,originX:"center",originY:"center",fill:this.color});s.push(h)}this.optimizeOverlapping&&(s=this._getOptimizedRects(s));var g=new e.Group(s);this.shadow&&g.set("shadow",new e.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:g}),this.canvas.add(g),this.canvas.fire("path:created",{path:g}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=c,this.canvas.requestRenderAll()},_getOptimizedRects:function(c){var s={},u,d,l;for(d=0,l=c.length;d<l;d++)u=c[d].left+""+c[d].top,s[u]||(s[u]=c[d]);var o=[];for(u in s)o.push(s[u]);return o},render:function(c){var s=this.canvas.contextTop,u,d;for(s.fillStyle=this.color,this._saveAndTransform(s),u=0,d=c.length;u<d;u++){var l=c[u];typeof l.opacity<"u"&&(s.globalAlpha=l.opacity),s.fillRect(l.x,l.y,l.width,l.width)}s.restore()},_render:function(){var c=this.canvas.contextTop,s,u;for(c.fillStyle=this.color,this._saveAndTransform(c),s=0,u=this.sprayChunks.length;s<u;s++)this.render(this.sprayChunks[s]);c.restore()},addSprayChunk:function(c){this.sprayChunkPoints=[];var s,u,d,l=this.width/2,o;for(o=0;o<this.density;o++){s=e.util.getRandomInt(c.x-l,c.x+l),u=e.util.getRandomInt(c.y-l,c.y+l),this.dotWidthVariance?d=e.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):d=this.dotWidth;var a=new e.Point(s,u);a.width=d,this.randomOpacity&&(a.opacity=e.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),e.PatternBrush=e.util.createClass(e.PencilBrush,{getPatternSrc:function(){var c=20,s=5,u=e.util.createCanvasElement(),d=u.getContext("2d");return u.width=u.height=c+s,d.fillStyle=this.color,d.beginPath(),d.arc(c/2,c/2,c/2,0,Math.PI*2,!1),d.closePath(),d.fill(),u},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(c){return c.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(c){this.callSuper("_setBrushStyles",c),c.strokeStyle=this.getPattern(c)},createPath:function(c){var s=this.callSuper("createPath",c),u=s._getLeftTopCoords().scalarAdd(s.strokeWidth/2);return s.stroke=new e.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-u.x,offsetY:-u.y}),s}}),function(){var c=e.util.getPointer,s=e.util.degreesToRadians,u=e.util.isTouchEvent;e.Canvas=e.util.createClass(e.StaticCanvas,{initialize:function(l,o){o||(o={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,o),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=e.PencilBrush&&new e.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var l=this.getActiveObjects(),o,a,h;if(l.length>0&&!this.preserveObjectStacking){a=[],h=[];for(var g=0,p=this._objects.length;g<p;g++)o=this._objects[g],l.indexOf(o)===-1?a.push(o):h.push(o);l.length>1&&(this._activeObject._objects=h),a.push.apply(a,h)}else a=this._objects;return a},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var l=this.contextContainer;return this.renderCanvas(l,this._chooseObjectsToRender()),this},renderTopLayer:function(l){l.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(l),this.contextTopDirty=!0),l.restore()},renderTop:function(){var l=this.contextTop;return this.clearContext(l),this.renderTopLayer(l),this.fire("after:render"),this},_normalizePointer:function(l,o){var a=l.calcTransformMatrix(),h=e.util.invertTransform(a),g=this.restorePointerVpt(o);return e.util.transformPoint(g,h)},isTargetTransparent:function(l,o,a){if(l.shouldCache()&&l._cacheCanvas&&l!==this._activeObject){var h=this._normalizePointer(l,{x:o,y:a}),g=Math.max(l.cacheTranslationX+h.x*l.zoomX,0),p=Math.max(l.cacheTranslationY+h.y*l.zoomY,0),_=e.util.isTransparent(l._cacheContext,Math.round(g),Math.round(p),this.targetFindTolerance);return _}var v=this.contextCache,x=l.selectionBackgroundColor,y=this.viewportTransform;l.selectionBackgroundColor="",this.clearContext(v),v.save(),v.transform(y[0],y[1],y[2],y[3],y[4],y[5]),l.render(v),v.restore(),l.selectionBackgroundColor=x;var _=e.util.isTransparent(v,o,a,this.targetFindTolerance);return _},_isSelectionKeyPressed:function(l){var o=!1;return Array.isArray(this.selectionKey)?o=!!this.selectionKey.find(function(a){return l[a]===!0}):o=l[this.selectionKey],o},_shouldClearSelection:function(l,o){var a=this.getActiveObjects(),h=this._activeObject;return!o||o&&h&&a.length>1&&a.indexOf(o)===-1&&h!==o&&!this._isSelectionKeyPressed(l)||o&&!o.evented||o&&!o.selectable&&h&&h!==o},_shouldCenterTransform:function(l,o,a){if(l){var h;return o==="scale"||o==="scaleX"||o==="scaleY"||o==="resizing"?h=this.centeredScaling||l.centeredScaling:o==="rotate"&&(h=this.centeredRotation||l.centeredRotation),h?!a:a}},_getOriginFromCorner:function(l,o){var a={x:l.originX,y:l.originY};return o==="ml"||o==="tl"||o==="bl"?a.x="right":(o==="mr"||o==="tr"||o==="br")&&(a.x="left"),o==="tl"||o==="mt"||o==="tr"?a.y="bottom":(o==="bl"||o==="mb"||o==="br")&&(a.y="top"),a},_getActionFromCorner:function(l,o,a,h){if(!o||!l)return"drag";var g=h.controls[o];return g.getActionName(a,g,h)},_setupCurrentTransform:function(l,o,a){if(o){var h=this.getPointer(l),g=o.__corner,p=o.controls[g],v=a&&g?p.getActionHandler(l,o,p):e.controlsUtils.dragHandler,x=this._getActionFromCorner(a,g,l,o),y=this._getOriginFromCorner(o,g),_=l[this.centeredKey],w={target:o,action:x,actionHandler:v,corner:g,scaleX:o.scaleX,scaleY:o.scaleY,skewX:o.skewX,skewY:o.skewY,offsetX:h.x-o.left,offsetY:h.y-o.top,originX:y.x,originY:y.y,ex:h.x,ey:h.y,lastX:h.x,lastY:h.y,theta:s(o.angle),width:o.width*o.scaleX,shiftKey:l.shiftKey,altKey:_,original:e.util.saveObjectTransform(o)};this._shouldCenterTransform(o,x,_)&&(w.originX="center",w.originY="center"),w.original.originX=y.x,w.original.originY=y.y,this._currentTransform=w,this._beforeTransform(l)}},setCursor:function(l){this.upperCanvasEl.style.cursor=l},_drawSelection:function(l){var o=this._groupSelector,a=new e.Point(o.ex,o.ey),h=e.util.transformPoint(a,this.viewportTransform),g=new e.Point(o.ex+o.left,o.ey+o.top),p=e.util.transformPoint(g,this.viewportTransform),v=Math.min(h.x,p.x),x=Math.min(h.y,p.y),y=Math.max(h.x,p.x),_=Math.max(h.y,p.y),w=this.selectionLineWidth/2;this.selectionColor&&(l.fillStyle=this.selectionColor,l.fillRect(v,x,y-v,_-x)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(l.lineWidth=this.selectionLineWidth,l.strokeStyle=this.selectionBorderColor,v+=w,x+=w,y-=w,_-=w,e.Object.prototype._setLineDash.call(this,l,this.selectionDashArray),l.strokeRect(v,x,y-v,_-x))},findTarget:function(l,o){if(!this.skipTargetFind){var a=!0,h=this.getPointer(l,a),g=this._activeObject,p=this.getActiveObjects(),v,x,y=u(l),_=p.length>1&&!o||p.length===1;if(this.targets=[],_&&g._findTargetCorner(h,y)||p.length>1&&!o&&g===this._searchPossibleTargets([g],h))return g;if(p.length===1&&g===this._searchPossibleTargets([g],h))if(this.preserveObjectStacking)v=g,x=this.targets,this.targets=[];else return g;var w=this._searchPossibleTargets(this._objects,h);return l[this.altSelectionKey]&&w&&v&&w!==v&&(w=v,this.targets=x),w}},_checkTarget:function(l,o,a){if(o&&o.visible&&o.evented&&o.containsPoint(l))if((this.perPixelTargetFind||o.perPixelTargetFind)&&!o.isEditing){var h=this.isTargetTransparent(o,a.x,a.y);if(!h)return!0}else return!0},_searchPossibleTargets:function(l,o){for(var a,h=l.length,g;h--;){var p=l[h],v=p.group?this._normalizePointer(p.group,o):o;if(this._checkTarget(v,p,o)){a=l[h],a.subTargetCheck&&a instanceof e.Group&&(g=this._searchPossibleTargets(a._objects,o),g&&this.targets.push(g));break}}return a},restorePointerVpt:function(l){return e.util.transformPoint(l,e.util.invertTransform(this.viewportTransform))},getPointer:function(l,o){if(this._absolutePointer&&!o)return this._absolutePointer;if(this._pointer&&o)return this._pointer;var a=c(l),h=this.upperCanvasEl,g=h.getBoundingClientRect(),p=g.width||0,v=g.height||0,x;(!p||!v)&&("top"in g&&"bottom"in g&&(v=Math.abs(g.top-g.bottom)),"right"in g&&"left"in g&&(p=Math.abs(g.right-g.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,o||(a=this.restorePointerVpt(a));var y=this.getRetinaScaling();return y!==1&&(a.x/=y,a.y/=y),p===0||v===0?x={width:1,height:1}:x={width:h.width/p,height:h.height/v},{x:a.x*x.width,y:a.y*x.height}},_createUpperCanvas:function(){var l=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),o=this.lowerCanvasEl,a=this.upperCanvasEl;a?a.className="":(a=this._createCanvasElement(),this.upperCanvasEl=a),e.util.addClass(a,"upper-canvas "+l),this.wrapperEl.appendChild(a),this._copyCanvasStyle(o,a),this._applyCanvasStyle(a),this.contextTop=a.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=e.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),e.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),e.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(l){var o=this.width||l.width,a=this.height||l.height;e.util.setStyle(l,{position:"absolute",width:o+"px",height:a+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),l.width=o,l.height=a,e.util.makeElementUnselectable(l)},_copyCanvasStyle:function(l,o){o.style.cssText=l.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var l=this._activeObject;return l?l.type==="activeSelection"&&l._objects?l._objects.slice(0):[l]:[]},_onObjectRemoved:function(l){l===this._activeObject&&(this.fire("before:selection:cleared",{target:l}),this._discardActiveObject(),this.fire("selection:cleared",{target:l}),l.fire("deselected")),l===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",l)},_fireSelectionEvents:function(l,o){var a=!1,h=this.getActiveObjects(),g=[],p=[];l.forEach(function(v){h.indexOf(v)===-1&&(a=!0,v.fire("deselected",{e:o,target:v}),p.push(v))}),h.forEach(function(v){l.indexOf(v)===-1&&(a=!0,v.fire("selected",{e:o,target:v}),g.push(v))}),l.length>0&&h.length>0?a&&this.fire("selection:updated",{e:o,selected:g,deselected:p}):h.length>0?this.fire("selection:created",{e:o,selected:g}):l.length>0&&this.fire("selection:cleared",{e:o,deselected:p})},setActiveObject:function(l,o){var a=this.getActiveObjects();return this._setActiveObject(l,o),this._fireSelectionEvents(a,o),this},_setActiveObject:function(l,o){return this._activeObject===l||!this._discardActiveObject(o,l)||l.onSelect({e:o})?!1:(this._activeObject=l,!0)},_discardActiveObject:function(l,o){var a=this._activeObject;if(a){if(a.onDeselect({e:l,object:o}))return!1;this._activeObject=null}return!0},discardActiveObject:function(l){var o=this.getActiveObjects(),a=this.getActiveObject();return o.length&&this.fire("before:selection:cleared",{target:a,e:l}),this._discardActiveObject(l),this._fireSelectionEvents(o,l),this},dispose:function(){var l=this.wrapperEl;return this.removeListeners(),l.removeChild(this.upperCanvasEl),l.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(o){e.util.cleanUpJsdomNode(this[o]),this[o]=void 0}).bind(this)),l.parentNode&&l.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,e.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(l){var o=this._activeObject;o&&o._renderControls(l)},_toObject:function(l,o,a){var h=this._realizeGroupTransformOnObject(l),g=this.callSuper("_toObject",l,o,a);return this._unwindGroupTransformOnObject(l,h),g},_realizeGroupTransformOnObject:function(l){if(l.group&&l.group.type==="activeSelection"&&this._activeObject===l.group){var o=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],a={};return o.forEach(function(h){a[h]=l[h]}),e.util.addTransformToObject(l,this._activeObject.calcOwnMatrix()),a}else return null},_unwindGroupTransformOnObject:function(l,o){o&&l.set(o)},_setSVGObject:function(l,o,a){var h=this._realizeGroupTransformOnObject(o);this.callSuper("_setSVGObject",l,o,a),this._unwindGroupTransformOnObject(o,h)},setViewportTransform:function(l){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),e.StaticCanvas.prototype.setViewportTransform.call(this,l)}});for(var d in e.StaticCanvas)d!=="prototype"&&(e.Canvas[d]=e.StaticCanvas[d])}(),function(){var c=e.util.addListener,s=e.util.removeListener,u=3,d=2,l=1,o={passive:!1};function a(h,g){return h.button&&h.button===g-1}e.util.object.extend(e.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(c,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(h,g){var p=this.upperCanvasEl,v=this._getEventPrefix();h(e.window,"resize",this._onResize),h(p,v+"down",this._onMouseDown),h(p,v+"move",this._onMouseMove,o),h(p,v+"out",this._onMouseOut),h(p,v+"enter",this._onMouseEnter),h(p,"wheel",this._onMouseWheel),h(p,"contextmenu",this._onContextMenu),h(p,"dblclick",this._onDoubleClick),h(p,"dragover",this._onDragOver),h(p,"dragenter",this._onDragEnter),h(p,"dragleave",this._onDragLeave),h(p,"drop",this._onDrop),this.enablePointerEvents||h(p,"touchstart",this._onTouchStart,o),typeof eventjs<"u"&&g in eventjs&&(eventjs[g](p,"gesture",this._onGesture),eventjs[g](p,"drag",this._onDrag),eventjs[g](p,"orientation",this._onOrientationChange),eventjs[g](p,"shake",this._onShake),eventjs[g](p,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(s,"remove");var h=this._getEventPrefix();s(e.document,h+"up",this._onMouseUp),s(e.document,"touchend",this._onTouchEnd,o),s(e.document,h+"move",this._onMouseMove,o),s(e.document,"touchmove",this._onMouseMove,o)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(h,g){this.__onTransformGesture&&this.__onTransformGesture(h,g)},_onDrag:function(h,g){this.__onDrag&&this.__onDrag(h,g)},_onMouseWheel:function(h){this.__onMouseWheel(h)},_onMouseOut:function(h){var g=this._hoveredTarget;this.fire("mouse:out",{target:g,e:h}),this._hoveredTarget=null,g&&g.fire("mouseout",{e:h});var p=this;this._hoveredTargets.forEach(function(v){p.fire("mouse:out",{target:g,e:h}),v&&g.fire("mouseout",{e:h})}),this._hoveredTargets=[]},_onMouseEnter:function(h){!this._currentTransform&&!this.findTarget(h)&&(this.fire("mouse:over",{target:null,e:h}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(h,g){this.__onOrientationChange&&this.__onOrientationChange(h,g)},_onShake:function(h,g){this.__onShake&&this.__onShake(h,g)},_onLongPress:function(h,g){this.__onLongPress&&this.__onLongPress(h,g)},_onDragOver:function(h){h.preventDefault();var g=this._simpleEventHandler("dragover",h);this._fireEnterLeaveEvents(g,h)},_onDrop:function(h){return this._simpleEventHandler("drop:before",h),this._simpleEventHandler("drop",h)},_onContextMenu:function(h){return this.stopContextMenu&&(h.stopPropagation(),h.preventDefault()),!1},_onDoubleClick:function(h){this._cacheTransformEventData(h),this._handleEvent(h,"dblclick"),this._resetTransformEventData(h)},getPointerId:function(h){var g=h.changedTouches;return g?g[0]&&g[0].identifier:this.enablePointerEvents?h.pointerId:-1},_isMainEvent:function(h){return h.isPrimary===!0?!0:h.isPrimary===!1?!1:h.type==="touchend"&&h.touches.length===0?!0:h.changedTouches?h.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(h){h.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(h)),this.__onMouseDown(h),this._resetTransformEventData();var g=this.upperCanvasEl,p=this._getEventPrefix();c(e.document,"touchend",this._onTouchEnd,o),c(e.document,"touchmove",this._onMouseMove,o),s(g,p+"down",this._onMouseDown)},_onMouseDown:function(h){this.__onMouseDown(h),this._resetTransformEventData();var g=this.upperCanvasEl,p=this._getEventPrefix();s(g,p+"move",this._onMouseMove,o),c(e.document,p+"up",this._onMouseUp),c(e.document,p+"move",this._onMouseMove,o)},_onTouchEnd:function(h){if(!(h.touches.length>0)){this.__onMouseUp(h),this._resetTransformEventData(),this.mainTouchId=null;var g=this._getEventPrefix();s(e.document,"touchend",this._onTouchEnd,o),s(e.document,"touchmove",this._onMouseMove,o);var p=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){c(p.upperCanvasEl,g+"down",p._onMouseDown),p._willAddMouseDown=0},400)}},_onMouseUp:function(h){this.__onMouseUp(h),this._resetTransformEventData();var g=this.upperCanvasEl,p=this._getEventPrefix();this._isMainEvent(h)&&(s(e.document,p+"up",this._onMouseUp),s(e.document,p+"move",this._onMouseMove,o),c(g,p+"move",this._onMouseMove,o))},_onMouseMove:function(h){!this.allowTouchScrolling&&h.preventDefault&&h.preventDefault(),this.__onMouseMove(h)},_onResize:function(){this.calcOffset()},_shouldRender:function(h){var g=this._activeObject;return!!g!=!!h||g&&h&&g!==h?!0:(g&&g.isEditing,!1)},__onMouseUp:function(h){var g,p=this._currentTransform,v=this._groupSelector,x=!1,y=!v||v.left===0&&v.top===0;if(this._cacheTransformEventData(h),g=this._target,this._handleEvent(h,"up:before"),a(h,u)){this.fireRightClick&&this._handleEvent(h,"up",u,y);return}if(a(h,d)){this.fireMiddleClick&&this._handleEvent(h,"up",d,y),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(h);return}if(this._isMainEvent(h)){if(p&&(this._finalizeCurrentTransform(h),x=p.actionPerformed),!y){var _=g===this._activeObject;this._maybeGroupObjects(h),x||(x=this._shouldRender(g)||!_&&g===this._activeObject)}var w,C;if(g){if(w=g._findTargetCorner(this.getPointer(h,!0),e.util.isTouchEvent(h)),g.selectable&&g!==this._activeObject&&g.activeOn==="up")this.setActiveObject(g,h),x=!0;else{var S=g.controls[w],O=S&&S.getMouseUpHandler(h,g,S);O&&(C=this.getPointer(h),O(h,p,C.x,C.y))}g.isMoving=!1}if(p&&(p.target!==g||p.corner!==w)){var F=p.target&&p.target.controls[p.corner],N=F&&F.getMouseUpHandler(h,g,S);C=C||this.getPointer(h),N&&N(h,p,C.x,C.y)}this._setCursorFromEvent(h,g),this._handleEvent(h,"up",l,y),this._groupSelector=null,this._currentTransform=null,g&&(g.__corner=0),x?this.requestRenderAll():y||this.renderTop()}},_simpleEventHandler:function(h,g){var p=this.findTarget(g),v=this.targets,x={e:g,target:p,subTargets:v};if(this.fire(h,x),p&&p.fire(h,x),!v)return p;for(var y=0;y<v.length;y++)v[y].fire(h,x);return p},_handleEvent:function(h,g,p,v){var x=this._target,y=this.targets||[],_={e:h,target:x,subTargets:y,button:p||l,isClick:v||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};g==="up"&&(_.currentTarget=this.findTarget(h),_.currentSubTargets=this.targets),this.fire("mouse:"+g,_),x&&x.fire("mouse"+g,_);for(var w=0;w<y.length;w++)y[w].fire("mouse"+g,_)},_finalizeCurrentTransform:function(h){var g=this._currentTransform,p=g.target,v={e:h,target:p,transform:g,action:g.action};p._scaling&&(p._scaling=!1),p.setCoords(),(g.actionPerformed||this.stateful&&p.hasStateChanged())&&this._fire("modified",v)},_onMouseDownInDrawingMode:function(h){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(h).requestRenderAll();var g=this.getPointer(h);this.freeDrawingBrush.onMouseDown(g,{e:h,pointer:g}),this._handleEvent(h,"down")},_onMouseMoveInDrawingMode:function(h){if(this._isCurrentlyDrawing){var g=this.getPointer(h);this.freeDrawingBrush.onMouseMove(g,{e:h,pointer:g})}this.setCursor(this.freeDrawingCursor),this._handleEvent(h,"move")},_onMouseUpInDrawingMode:function(h){var g=this.getPointer(h);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:h,pointer:g}),this._handleEvent(h,"up")},__onMouseDown:function(h){this._cacheTransformEventData(h),this._handleEvent(h,"down:before");var g=this._target;if(a(h,u)){this.fireRightClick&&this._handleEvent(h,"down",u);return}if(a(h,d)){this.fireMiddleClick&&this._handleEvent(h,"down",d);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(h);return}if(this._isMainEvent(h)&&!this._currentTransform){var p=this._pointer;this._previousPointer=p;var v=this._shouldRender(g),x=this._shouldGroup(h,g);if(this._shouldClearSelection(h,g)?this.discardActiveObject(h):x&&(this._handleGrouping(h,g),g=this._activeObject),this.selection&&(!g||!g.selectable&&!g.isEditing&&g!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),g){var y=g===this._activeObject;g.selectable&&g.activeOn==="down"&&this.setActiveObject(g,h);var _=g._findTargetCorner(this.getPointer(h,!0),e.util.isTouchEvent(h));if(g.__corner=_,g===this._activeObject&&(_||!x)){this._setupCurrentTransform(h,g,y);var w=g.controls[_],p=this.getPointer(h),C=w&&w.getMouseDownHandler(h,g,w);C&&C(h,this._currentTransform,p.x,p.y)}}this._handleEvent(h,"down"),(v||x)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(h){this._resetTransformEventData(),this._pointer=this.getPointer(h,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(h)||null},_beforeTransform:function(h){var g=this._currentTransform;this.stateful&&g.target.saveState(),this.fire("before:transform",{e:h,transform:g})},__onMouseMove:function(h){this._handleEvent(h,"move:before"),this._cacheTransformEventData(h);var g,p;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(h);return}if(this._isMainEvent(h)){var v=this._groupSelector;v?(p=this._absolutePointer,v.left=p.x-v.ex,v.top=p.y-v.ey,this.renderTop()):this._currentTransform?this._transformObject(h):(g=this.findTarget(h)||null,this._setCursorFromEvent(h,g),this._fireOverOutEvents(g,h)),this._handleEvent(h,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(h,g){var p=this._hoveredTarget,v=this._hoveredTargets,x=this.targets,y=Math.max(v.length,x.length);this.fireSyntheticInOutEvents(h,g,{oldTarget:p,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(x[_],g,{oldTarget:v[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=h,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(h,g){var p=this._draggedoverTarget,v=this._hoveredTargets,x=this.targets,y=Math.max(v.length,x.length);this.fireSyntheticInOutEvents(h,g,{oldTarget:p,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<y;_++)this.fireSyntheticInOutEvents(x[_],g,{oldTarget:v[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=h},fireSyntheticInOutEvents:function(h,g,p){var v,x,y=p.oldTarget,_,w,C=y!==h,S=p.canvasEvtIn,O=p.canvasEvtOut;C&&(v={e:g,target:h,previousTarget:y},x={e:g,target:y,nextTarget:h}),w=h&&C,_=y&&C,_&&(O&&this.fire(O,x),y.fire(p.evtOut,x)),w&&(S&&this.fire(S,v),h.fire(p.evtIn,v))},__onMouseWheel:function(h){this._cacheTransformEventData(h),this._handleEvent(h,"wheel"),this._resetTransformEventData()},_transformObject:function(h){var g=this.getPointer(h),p=this._currentTransform;p.reset=!1,p.shiftKey=h.shiftKey,p.altKey=h[this.centeredKey],this._performTransformAction(h,p,g),p.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(h,g,p){var v=p.x,x=p.y,y=g.action,_=!1,w=g.actionHandler;w&&(_=w(h,g,v,x)),y==="drag"&&_&&(g.target.isMoving=!0,this.setCursor(g.target.moveCursor||this.moveCursor)),g.actionPerformed=g.actionPerformed||_},_fire:e.controlsUtils.fireEvent,_setCursorFromEvent:function(h,g){if(!g)return this.setCursor(this.defaultCursor),!1;var p=g.hoverCursor||this.hoverCursor,v=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,x=(!v||!v.contains(g))&&g._findTargetCorner(this.getPointer(h,!0));x?this.setCursor(this.getCornerCursor(x,g,h)):(g.subTargetCheck&&this.targets.concat().reverse().map(function(y){p=y.hoverCursor||p}),this.setCursor(p))},getCornerCursor:function(h,g,p){var v=g.controls[h];return v.cursorStyleHandler(p,v,g)}})}(),function(){var c=Math.min,s=Math.max;e.util.object.extend(e.Canvas.prototype,{_shouldGroup:function(u,d){var l=this._activeObject;return l&&this._isSelectionKeyPressed(u)&&d&&d.selectable&&this.selection&&(l!==d||l.type==="activeSelection")&&!d.onSelect({e:u})},_handleGrouping:function(u,d){var l=this._activeObject;l.__corner||d===l&&(d=this.findTarget(u,!0),!d||!d.selectable)||(l&&l.type==="activeSelection"?this._updateActiveSelection(d,u):this._createActiveSelection(d,u))},_updateActiveSelection:function(u,d){var l=this._activeObject,o=l._objects.slice(0);l.contains(u)?(l.removeWithUpdate(u),this._hoveredTarget=u,this._hoveredTargets=this.targets.concat(),l.size()===1&&this._setActiveObject(l.item(0),d)):(l.addWithUpdate(u),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(o,d)},_createActiveSelection:function(u,d){var l=this.getActiveObjects(),o=this._createGroup(u);this._hoveredTarget=o,this._setActiveObject(o,d),this._fireSelectionEvents(l,d)},_createGroup:function(u){var d=this._objects,l=d.indexOf(this._activeObject)<d.indexOf(u),o=l?[this._activeObject,u]:[u,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new e.ActiveSelection(o,{canvas:this})},_groupSelectedObjects:function(u){var d=this._collectObjects(u),l;d.length===1?this.setActiveObject(d[0],u):d.length>1&&(l=new e.ActiveSelection(d.reverse(),{canvas:this}),this.setActiveObject(l,u))},_collectObjects:function(u){for(var d=[],l,o=this._groupSelector.ex,a=this._groupSelector.ey,h=o+this._groupSelector.left,g=a+this._groupSelector.top,p=new e.Point(c(o,h),c(a,g)),v=new e.Point(s(o,h),s(a,g)),x=!this.selectionFullyContained,y=o===h&&a===g,_=this._objects.length;_--&&(l=this._objects[_],!(!(!l||!l.selectable||!l.visible)&&(x&&l.intersectsWithRect(p,v,!0)||l.isContainedWithinRect(p,v,!0)||x&&l.containsPoint(p,null,!0)||x&&l.containsPoint(v,null,!0))&&(d.push(l),y))););return d.length>1&&(d=d.filter(function(w){return!w.onSelect({e:u})})),d},_maybeGroupObjects:function(u){this.selection&&this._groupSelector&&this._groupSelectedObjects(u),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){e.util.object.extend(e.StaticCanvas.prototype,{toDataURL:function(c){c||(c={});var s=c.format||"png",u=c.quality||1,d=(c.multiplier||1)*(c.enableRetinaScaling?this.getRetinaScaling():1),l=this.toCanvasElement(d,c);return e.util.toDataURL(l,s,u)},toCanvasElement:function(c,s){c=c||1,s=s||{};var u=(s.width||this.width)*c,d=(s.height||this.height)*c,l=this.getZoom(),o=this.width,a=this.height,h=l*c,g=this.viewportTransform,p=(g[4]-(s.left||0))*c,v=(g[5]-(s.top||0))*c,x=this.interactive,y=[h,0,0,h,p,v],_=this.enableRetinaScaling,w=e.util.createCanvasElement(),C=this.contextTop;return w.width=u,w.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=y,this.width=u,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),this._objects),this.viewportTransform=g,this.width=o,this.height=a,this.calcViewportBoundaries(),this.interactive=x,this.enableRetinaScaling=_,this.contextTop=C,w}})}(),e.util.object.extend(e.StaticCanvas.prototype,{loadFromJSON:function(c,s,u){if(c){var d=typeof c=="string"?JSON.parse(c):e.util.object.clone(c),l=this,o=d.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(h){l.clear(),l._setBgOverlay(d,function(){o?l._enlivenObjects([o],function(g){l.clipPath=g[0],l.__setupCanvas.call(l,d,h,a,s)}):l.__setupCanvas.call(l,d,h,a,s)})},u),this}},__setupCanvas:function(c,s,u,d){var l=this;s.forEach(function(o,a){l.insertAt(o,a)}),this.renderOnAddRemove=u,delete c.objects,delete c.backgroundImage,delete c.overlayImage,delete c.background,delete c.overlay,this._setOptions(c),this.renderAll(),d&&d()},_setBgOverlay:function(c,s){var u={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!c.backgroundImage&&!c.overlayImage&&!c.background&&!c.overlay){s&&s();return}var d=function(){u.backgroundImage&&u.overlayImage&&u.backgroundColor&&u.overlayColor&&s&&s()};this.__setBgOverlay("backgroundImage",c.backgroundImage,u,d),this.__setBgOverlay("overlayImage",c.overlayImage,u,d),this.__setBgOverlay("backgroundColor",c.background,u,d),this.__setBgOverlay("overlayColor",c.overlay,u,d)},__setBgOverlay:function(c,s,u,d){var l=this;if(!s){u[c]=!0,d&&d();return}c==="backgroundImage"||c==="overlayImage"?e.util.enlivenObjects([s],function(o){l[c]=o[0],u[c]=!0,d&&d()}):this["set"+e.util.string.capitalize(c,!0)](s,function(){u[c]=!0,d&&d()})},_enlivenObjects:function(c,s,u){if(!c||c.length===0){s&&s([]);return}e.util.enlivenObjects(c,function(d){s&&s(d)},null,u)},_toDataURL:function(c,s){this.clone(function(u){s(u.toDataURL(c))})},_toDataURLWithMultiplier:function(c,s,u){this.clone(function(d){u(d.toDataURLWithMultiplier(c,s))})},clone:function(c,s){var u=JSON.stringify(this.toJSON(s));this.cloneWithoutData(function(d){d.loadFromJSON(u,function(){c&&c(d)})})},cloneWithoutData:function(c){var s=e.util.createCanvasElement();s.width=this.width,s.height=this.height;var u=new e.Canvas(s);this.backgroundImage?(u.setBackgroundImage(this.backgroundImage.src,function(){u.renderAll(),c&&c(u)}),u.backgroundImageOpacity=this.backgroundImageOpacity,u.backgroundImageStretch=this.backgroundImageStretch):c&&c(u)}}),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.util.object.clone,l=s.util.toFixed,o=s.util.string.capitalize,a=s.util.degreesToRadians,h=!s.isLikelyNode,g=2;s.Object||(s.Object=s.util.createClass(s.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:h,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(p){p&&this.setOptions(p)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=s.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(p){var v=s.perfLimitSizeTotal,x=p.width,y=p.height,_=s.maxCacheSideLimit,w=s.minCacheSideLimit;if(x<=_&&y<=_&&x*y<=v)return x<w&&(p.width=w),y<w&&(p.height=w),p;var C=x/y,S=s.util.limitDimsByArea(C,v),O=s.util.capValue,F=O(w,S.x,_),N=O(w,S.y,_);return x>F&&(p.zoomX/=x/F,p.width=F,p.capped=!0),y>N&&(p.zoomY/=y/N,p.height=N,p.capped=!0),p},_getCacheCanvasDimensions:function(){var p=this.getTotalObjectScaling(),v=this._getTransformedDimensions(0,0),x=v.x*p.scaleX/this.scaleX,y=v.y*p.scaleY/this.scaleY;return{width:x+g,height:y+g,zoomX:p.scaleX,zoomY:p.scaleY,x,y}},_updateCacheCanvas:function(){var p=this.canvas;if(this.noScaleCache&&p&&p._currentTransform){var v=p._currentTransform.target,x=p._currentTransform.action;if(this===v&&x.slice&&x.slice(0,5)==="scale")return!1}var y=this._cacheCanvas,_=this._limitCacheSize(this._getCacheCanvasDimensions()),w=s.minCacheSideLimit,C=_.width,S=_.height,O,F,N=_.zoomX,W=_.zoomY,X=C!==this.cacheWidth||S!==this.cacheHeight,Q=this.zoomX!==N||this.zoomY!==W,ae=X||Q,ne=0,J=0,oe=!1;if(X){var q=this._cacheCanvas.width,k=this._cacheCanvas.height,D=C>q||S>k,L=(C<q*.9||S<k*.9)&&q>w&&k>w;oe=D||L,D&&!_.capped&&(C>w||S>w)&&(ne=C*.1,J=S*.1)}return this instanceof s.Text&&this.path&&(ae=!0,oe=!0,ne+=this.getHeightOfLine(0)*this.zoomX,J+=this.getHeightOfLine(0)*this.zoomY),ae?(oe?(y.width=Math.ceil(C+ne),y.height=Math.ceil(S+J)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,y.width,y.height)),O=_.x/2,F=_.y/2,this.cacheTranslationX=Math.round(y.width/2-O)+O,this.cacheTranslationY=Math.round(y.height/2-F)+F,this.cacheWidth=C,this.cacheHeight=S,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(N,W),this.zoomX=N,this.zoomY=W,!0):!1},setOptions:function(p){this._setOptions(p),this._initGradient(p.fill,"fill"),this._initGradient(p.stroke,"stroke"),this._initPattern(p.fill,"fill"),this._initPattern(p.stroke,"stroke")},transform:function(p){var v=this.group&&!this.group._transformDone||this.group&&this.canvas&&p===this.canvas.contextTop,x=this.calcTransformMatrix(!v);p.transform(x[0],x[1],x[2],x[3],x[4],x[5])},toObject:function(p){var v=s.Object.NUM_FRACTION_DIGITS,x={type:this.type,version:s.version,originX:this.originX,originY:this.originY,left:l(this.left,v),top:l(this.top,v),width:l(this.width,v),height:l(this.height,v),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:l(this.strokeWidth,v),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:l(this.strokeMiterLimit,v),scaleX:l(this.scaleX,v),scaleY:l(this.scaleY,v),angle:l(this.angle,v),flipX:this.flipX,flipY:this.flipY,opacity:l(this.opacity,v),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:l(this.skewX,v),skewY:l(this.skewY,v)};return this.clipPath&&!this.clipPath.excludeFromExport&&(x.clipPath=this.clipPath.toObject(p),x.clipPath.inverted=this.clipPath.inverted,x.clipPath.absolutePositioned=this.clipPath.absolutePositioned),s.util.populateWithProperties(this,x,p),this.includeDefaultValues||(x=this._removeDefaultValues(x)),x},toDatalessObject:function(p){return this.toObject(p)},_removeDefaultValues:function(p){var v=s.util.getKlass(p.type).prototype,x=v.stateProperties;return x.forEach(function(y){y==="left"||y==="top"||(p[y]===v[y]&&delete p[y],Array.isArray(p[y])&&Array.isArray(v[y])&&p[y].length===0&&v[y].length===0&&delete p[y])}),p},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var p=s.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(p.scaleX),scaleY:Math.abs(p.scaleY)}},getTotalObjectScaling:function(){var p=this.getObjectScaling(),v=p.scaleX,x=p.scaleY;if(this.canvas){var y=this.canvas.getZoom(),_=this.canvas.getRetinaScaling();v*=y*_,x*=y*_}return{scaleX:v,scaleY:x}},getObjectOpacity:function(){var p=this.opacity;return this.group&&(p*=this.group.getObjectOpacity()),p},_set:function(p,v){var x=p==="scaleX"||p==="scaleY",y=this[p]!==v,_=!1;return x&&(v=this._constrainScale(v)),p==="scaleX"&&v<0?(this.flipX=!this.flipX,v*=-1):p==="scaleY"&&v<0?(this.flipY=!this.flipY,v*=-1):p==="shadow"&&v&&!(v instanceof s.Shadow)?v=new s.Shadow(v):p==="dirty"&&this.group&&this.group.set("dirty",v),this[p]=v,y&&(_=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(p)>-1?(this.dirty=!0,_&&this.group.set("dirty",!0)):_&&this.stateProperties.indexOf(p)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:s.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(p){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(p.save(),this._setupCompositeOperation(p),this.drawSelectionBackground(p),this.transform(p),this._setOpacity(p),this._setShadow(p,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(p)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(p),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),p.restore())},renderCache:function(p){p=p||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,p.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(p,v){if(p.save(),v.inverted?p.globalCompositeOperation="destination-out":p.globalCompositeOperation="destination-in",v.absolutePositioned){var x=s.util.invertTransform(this.calcTransformMatrix());p.transform(x[0],x[1],x[2],x[3],x[4],x[5])}v.transform(p),p.scale(1/v.zoomX,1/v.zoomY),p.drawImage(v._cacheCanvas,-v.cacheTranslationX,-v.cacheTranslationY),p.restore()},drawObject:function(p,v){var x=this.fill,y=this.stroke;v?(this.fill="black",this.stroke="",this._setClippingProperties(p)):this._renderBackground(p),this._render(p),this._drawClipPath(p,this.clipPath),this.fill=x,this.stroke=y},_drawClipPath:function(p,v){v&&(v.canvas=this.canvas,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCache(p,v))},drawCacheOnCanvas:function(p){p.scale(1/this.zoomX,1/this.zoomY),p.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(p){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!p&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!p){var v=this.cacheWidth/this.zoomX,x=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-v/2,-x/2,v,x)}return!0}return!1},_renderBackground:function(p){if(this.backgroundColor){var v=this._getNonTransformedDimensions();p.fillStyle=this.backgroundColor,p.fillRect(-v.x/2,-v.y/2,v.x,v.y),this._removeShadow(p)}},_setOpacity:function(p){this.group&&!this.group._transformDone?p.globalAlpha=this.getObjectOpacity():p.globalAlpha*=this.opacity},_setStrokeStyles:function(p,v){var x=v.stroke;x&&(p.lineWidth=v.strokeWidth,p.lineCap=v.strokeLineCap,p.lineDashOffset=v.strokeDashOffset,p.lineJoin=v.strokeLineJoin,p.miterLimit=v.strokeMiterLimit,x.toLive?x.gradientUnits==="percentage"||x.gradientTransform||x.patternTransform?this._applyPatternForTransformedGradient(p,x):(p.strokeStyle=x.toLive(p,this),this._applyPatternGradientTransform(p,x)):p.strokeStyle=v.stroke)},_setFillStyles:function(p,v){var x=v.fill;x&&(x.toLive?(p.fillStyle=x.toLive(p,this),this._applyPatternGradientTransform(p,v.fill)):p.fillStyle=x)},_setClippingProperties:function(p){p.globalAlpha=1,p.strokeStyle="transparent",p.fillStyle="#000000"},_setLineDash:function(p,v){!v||v.length===0||(1&v.length&&v.push.apply(v,v),p.setLineDash(v))},_renderControls:function(p,v){var x=this.getViewportTransform(),y=this.calcTransformMatrix(),_,w,C;v=v||{},w=typeof v.hasBorders<"u"?v.hasBorders:this.hasBorders,C=typeof v.hasControls<"u"?v.hasControls:this.hasControls,y=s.util.multiplyTransformMatrices(x,y),_=s.util.qrDecompose(y),p.save(),p.translate(_.translateX,_.translateY),p.lineWidth=1*this.borderScaleFactor,this.group||(p.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),p.rotate(a(this.group?_.angle:this.angle)),v.forActiveSelection||this.group?w&&this.drawBordersInGroup(p,_,v):w&&this.drawBorders(p,v),C&&this.drawControls(p,v),p.restore()},_setShadow:function(p){if(this.shadow){var v=this.shadow,x=this.canvas,y,_=x&&x.viewportTransform[0]||1,w=x&&x.viewportTransform[3]||1;v.nonScaling?y={scaleX:1,scaleY:1}:y=this.getObjectScaling(),x&&x._isRetinaScaling()&&(_*=s.devicePixelRatio,w*=s.devicePixelRatio),p.shadowColor=v.color,p.shadowBlur=v.blur*s.browserShadowBlurConstant*(_+w)*(y.scaleX+y.scaleY)/4,p.shadowOffsetX=v.offsetX*_*y.scaleX,p.shadowOffsetY=v.offsetY*w*y.scaleY}},_removeShadow:function(p){this.shadow&&(p.shadowColor="",p.shadowBlur=p.shadowOffsetX=p.shadowOffsetY=0)},_applyPatternGradientTransform:function(p,v){if(!v||!v.toLive)return{offsetX:0,offsetY:0};var x=v.gradientTransform||v.patternTransform,y=-this.width/2+v.offsetX||0,_=-this.height/2+v.offsetY||0;return v.gradientUnits==="percentage"?p.transform(this.width,0,0,this.height,y,_):p.transform(1,0,0,1,y,_),x&&p.transform(x[0],x[1],x[2],x[3],x[4],x[5]),{offsetX:y,offsetY:_}},_renderPaintInOrder:function(p){this.paintFirst==="stroke"?(this._renderStroke(p),this._renderFill(p)):(this._renderFill(p),this._renderStroke(p))},_render:function(){},_renderFill:function(p){this.fill&&(p.save(),this._setFillStyles(p,this),this.fillRule==="evenodd"?p.fill("evenodd"):p.fill(),p.restore())},_renderStroke:function(p){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(p),p.save(),this.strokeUniform&&this.group){var v=this.getObjectScaling();p.scale(1/v.scaleX,1/v.scaleY)}else this.strokeUniform&&p.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(p,this.strokeDashArray),this._setStrokeStyles(p,this),p.stroke(),p.restore()}},_applyPatternForTransformedGradient:function(p,v){var x=this._limitCacheSize(this._getCacheCanvasDimensions()),y=s.util.createCanvasElement(),_,w=this.canvas.getRetinaScaling(),C=x.x/this.scaleX/w,S=x.y/this.scaleY/w;y.width=C,y.height=S,_=y.getContext("2d"),_.beginPath(),_.moveTo(0,0),_.lineTo(C,0),_.lineTo(C,S),_.lineTo(0,S),_.closePath(),_.translate(C/2,S/2),_.scale(x.zoomX/this.scaleX/w,x.zoomY/this.scaleY/w),this._applyPatternGradientTransform(_,v),_.fillStyle=v.toLive(p),_.fill(),p.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),p.scale(w*this.scaleX/x.zoomX,w*this.scaleY/x.zoomY),p.strokeStyle=_.createPattern(y,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var p=s.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",p.scaleX),this.set("scaleY",p.scaleY),this.angle=p.angle,this.skewX=p.skewX,this.skewY=0}},_removeTransformMatrix:function(p){var v=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),v=s.util.transformPoint(v,this.transformMatrix)),this.transformMatrix=null,p&&(this.scaleX*=p.scaleX,this.scaleY*=p.scaleY,this.cropX=p.cropX,this.cropY=p.cropY,v.x+=p.offsetLeft,v.y+=p.offsetTop,this.width=p.width,this.height=p.height),this.setPositionByOrigin(v,"center","center")},clone:function(p,v){var x=this.toObject(v);this.constructor.fromObject?this.constructor.fromObject(x,p):s.Object._fromObject("Object",x,p)},cloneAsImage:function(p,v){var x=this.toCanvasElement(v);return p&&p(new s.Image(x)),this},toCanvasElement:function(p){p||(p={});var v=s.util,x=v.saveObjectTransform(this),y=this.group,_=this.shadow,w=Math.abs,C=(p.multiplier||1)*(p.enableRetinaScaling?s.devicePixelRatio:1);delete this.group,p.withoutTransform&&v.resetObjectTransform(this),p.withoutShadow&&(this.shadow=null);var S=s.util.createCanvasElement(),O=this.getBoundingRect(!0,!0),F=this.shadow,N,W={x:0,y:0},X,Q,ae;F&&(X=F.blur,F.nonScaling?N={scaleX:1,scaleY:1}:N=this.getObjectScaling(),W.x=2*Math.round(w(F.offsetX)+X)*w(N.scaleX),W.y=2*Math.round(w(F.offsetY)+X)*w(N.scaleY)),Q=O.width+W.x,ae=O.height+W.y,S.width=Math.ceil(Q),S.height=Math.ceil(ae);var ne=new s.StaticCanvas(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});p.format==="jpeg"&&(ne.backgroundColor="#fff"),this.setPositionByOrigin(new s.Point(ne.width/2,ne.height/2),"center","center");var J=this.canvas;ne.add(this);var oe=ne.toCanvasElement(C||1,p);return this.shadow=_,this.set("canvas",J),y&&(this.group=y),this.set(x).setCoords(),ne._objects=[],ne.dispose(),ne=null,oe},toDataURL:function(p){return p||(p={}),s.util.toDataURL(this.toCanvasElement(p),p.format||"png",p.quality||1)},isType:function(p){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===p},complexity:function(){return 1},toJSON:function(p){return this.toObject(p)},rotate:function(p){var v=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return v&&this._setOriginToCenter(),this.set("angle",p),v&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(p,v){v=v||this.canvas.getPointer(p);var x=new s.Point(v.x,v.y),y=this._getLeftTopCoords();return this.angle&&(x=s.util.rotatePoint(x,y,a(-this.angle))),{x:x.x-y.x,y:x.y-y.y}},_setupCompositeOperation:function(p){this.globalCompositeOperation&&(p.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){s.runningAnimations&&s.runningAnimations.cancelByTarget(this)}}),s.util.createAccessors&&s.util.createAccessors(s.Object),u(s.Object.prototype,s.Observable),s.Object.NUM_FRACTION_DIGITS=2,s.Object.ENLIVEN_PROPS=["clipPath"],s.Object._fromObject=function(p,v,x,y){var _=s[p];v=d(v,!0),s.util.enlivenPatterns([v.fill,v.stroke],function(w){typeof w[0]<"u"&&(v.fill=w[0]),typeof w[1]<"u"&&(v.stroke=w[1]),s.util.enlivenObjectEnlivables(v,v,function(){var C=y?new _(v[y],v):new _(v);x&&x(C)})})},s.Object.__uid=0)}(t),function(){var c=e.util.degreesToRadians,s={left:-.5,center:0,right:.5},u={top:-.5,center:0,bottom:.5};e.util.object.extend(e.Object.prototype,{translateToGivenOrigin:function(d,l,o,a,h){var g=d.x,p=d.y,v,x,y;return typeof l=="string"?l=s[l]:l-=.5,typeof a=="string"?a=s[a]:a-=.5,v=a-l,typeof o=="string"?o=u[o]:o-=.5,typeof h=="string"?h=u[h]:h-=.5,x=h-o,(v||x)&&(y=this._getTransformedDimensions(),g=d.x+v*y.x,p=d.y+x*y.y),new e.Point(g,p)},translateToCenterPoint:function(d,l,o){var a=this.translateToGivenOrigin(d,l,o,"center","center");return this.angle?e.util.rotatePoint(a,d,c(this.angle)):a},translateToOriginPoint:function(d,l,o){var a=this.translateToGivenOrigin(d,"center","center",l,o);return this.angle?e.util.rotatePoint(a,d,c(this.angle)):a},getCenterPoint:function(){var d=new e.Point(this.left,this.top);return this.translateToCenterPoint(d,this.originX,this.originY)},getPointByOrigin:function(d,l){var o=this.getCenterPoint();return this.translateToOriginPoint(o,d,l)},toLocalPoint:function(d,l,o){var a=this.getCenterPoint(),h,g;return typeof l<"u"&&typeof o<"u"?h=this.translateToGivenOrigin(a,"center","center",l,o):h=new e.Point(this.left,this.top),g=new e.Point(d.x,d.y),this.angle&&(g=e.util.rotatePoint(g,a,-c(this.angle))),g.subtractEquals(h)},setPositionByOrigin:function(d,l,o){var a=this.translateToCenterPoint(d,l,o),h=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",h.x),this.set("top",h.y)},adjustPosition:function(d){var l=c(this.angle),o=this.getScaledWidth(),a=e.util.cos(l)*o,h=e.util.sin(l)*o,g,p;typeof this.originX=="string"?g=s[this.originX]:g=this.originX-.5,typeof d=="string"?p=s[d]:p=d-.5,this.left+=a*(p-g),this.top+=h*(p-g),this.setCoords(),this.originX=d},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var d=this.getCenterPoint();this.originX="center",this.originY="center",this.left=d.x,this.top=d.y},_resetOrigin:function(){var d=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=d.x,this.top=d.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function c(o){return[new e.Point(o.tl.x,o.tl.y),new e.Point(o.tr.x,o.tr.y),new e.Point(o.br.x,o.br.y),new e.Point(o.bl.x,o.bl.y)]}var s=e.util,u=s.degreesToRadians,d=s.multiplyTransformMatrices,l=s.transformPoint;s.object.extend(e.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(o,a){return a?o?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),o?this.aCoords:this.lineCoords)},getCoords:function(o,a){return c(this._getCoords(o,a))},intersectsWithRect:function(o,a,h,g){var p=this.getCoords(h,g),v=e.Intersection.intersectPolygonRectangle(p,o,a);return v.status==="Intersection"},intersectsWithObject:function(o,a,h){var g=e.Intersection.intersectPolygonPolygon(this.getCoords(a,h),o.getCoords(a,h));return g.status==="Intersection"||o.isContainedWithinObject(this,a,h)||this.isContainedWithinObject(o,a,h)},isContainedWithinObject:function(o,a,h){for(var g=this.getCoords(a,h),p=a?o.aCoords:o.lineCoords,v=0,x=o._getImageLines(p);v<4;v++)if(!o.containsPoint(g[v],x))return!1;return!0},isContainedWithinRect:function(o,a,h,g){var p=this.getBoundingRect(h,g);return p.left>=o.x&&p.left+p.width<=a.x&&p.top>=o.y&&p.top+p.height<=a.y},containsPoint:function(o,v,h,g){var p=this._getCoords(h,g),v=v||this._getImageLines(p),x=this._findCrossPoints(o,v);return x!==0&&x%2===1},isOnScreen:function(o){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,h=this.canvas.vptCoords.br,g=this.getCoords(!0,o);return g.some(function(p){return p.x<=h.x&&p.x>=a.x&&p.y<=h.y&&p.y>=a.y})||this.intersectsWithRect(a,h,!0,o)?!0:this._containsCenterOfCanvas(a,h,o)},_containsCenterOfCanvas:function(o,a,h){var g={x:(o.x+a.x)/2,y:(o.y+a.y)/2};return!!this.containsPoint(g,null,!0,h)},isPartiallyOnScreen:function(o){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,h=this.canvas.vptCoords.br;if(this.intersectsWithRect(a,h,!0,o))return!0;var g=this.getCoords(!0,o).every(function(p){return(p.x>=h.x||p.x<=a.x)&&(p.y>=h.y||p.y<=a.y)});return g&&this._containsCenterOfCanvas(a,h,o)},_getImageLines:function(o){var a={topline:{o:o.tl,d:o.tr},rightline:{o:o.tr,d:o.br},bottomline:{o:o.br,d:o.bl},leftline:{o:o.bl,d:o.tl}};return a},_findCrossPoints:function(o,a){var h,g,p,v,x,y=0,_;for(var w in a)if(_=a[w],!(_.o.y<o.y&&_.d.y<o.y)&&!(_.o.y>=o.y&&_.d.y>=o.y)&&(_.o.x===_.d.x&&_.o.x>=o.x?x=_.o.x:(h=0,g=(_.d.y-_.o.y)/(_.d.x-_.o.x),p=o.y-h*o.x,v=_.o.y-g*_.o.x,x=-(p-v)/(h-g)),x>=o.x&&(y+=1),y===2))break;return y},getBoundingRect:function(o,a){var h=this.getCoords(o,a);return s.makeBoundingBoxFromPoints(h)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(o){return Math.abs(o)<this.minScaleLimit?o<0?-this.minScaleLimit:this.minScaleLimit:o===0?1e-4:o},scale:function(o){return this._set("scaleX",o),this._set("scaleY",o),this.setCoords()},scaleToWidth:function(o,a){var h=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(o/this.width/h)},scaleToHeight:function(o,a){var h=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(o/this.height/h)},calcLineCoords:function(){var o=this.getViewportTransform(),a=this.padding,h=u(this.angle),g=s.cos(h),p=s.sin(h),v=g*a,x=p*a,y=v+x,_=v-x,w=this.calcACoords(),C={tl:l(w.tl,o),tr:l(w.tr,o),bl:l(w.bl,o),br:l(w.br,o)};return a&&(C.tl.x-=_,C.tl.y-=y,C.tr.x+=y,C.tr.y-=_,C.bl.x-=y,C.bl.y+=_,C.br.x+=_,C.br.y+=y),C},calcOCoords:function(){var o=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),h=this.getViewportTransform(),g=d(h,a),p=d(g,o),p=d(p,[1/h[0],0,0,1/h[3],0,0]),v=this._calculateCurrentDimensions(),x={};return this.forEachControl(function(y,_,w){x[_]=y.positionHandler(v,p,w)}),x},calcACoords:function(){var o=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),h=d(a,o),g=this._getTransformedDimensions(),p=g.x/2,v=g.y/2;return{tl:l({x:-p,y:-v},h),tr:l({x:p,y:-v},h),bl:l({x:-p,y:v},h),br:l({x:p,y:v},h)}},setCoords:function(o){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),o?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return s.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var o=this.getCenterPoint();return[1,0,0,1,o.x,o.y]},transformMatrixKey:function(o){var a="_",h="";return!o&&this.group&&(h=this.group.transformMatrixKey(o)+a),h+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(o){var a=this.calcOwnMatrix();if(o||!this.group)return a;var h=this.transformMatrixKey(o),g=this.matrixCache||(this.matrixCache={});return g.key===h?g.value:(this.group&&(a=d(this.group.calcTransformMatrix(!1),a)),g.key=h,g.value=a,a)},calcOwnMatrix:function(){var o=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===o)return a.value;var h=this._calcTranslateMatrix(),g={angle:this.angle,translateX:h[4],translateY:h[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=o,a.value=s.composeMatrix(g),a.value},_getNonTransformedDimensions:function(){var o=this.strokeWidth,a=this.width+o,h=this.height+o;return{x:a,y:h}},_getTransformedDimensions:function(o,a){typeof o>"u"&&(o=this.skewX),typeof a>"u"&&(a=this.skewY);var h,g,p,v=o===0&&a===0;if(this.strokeUniform?(g=this.width,p=this.height):(h=this._getNonTransformedDimensions(),g=h.x,p=h.y),v)return this._finalizeDimensions(g*this.scaleX,p*this.scaleY);var x=s.sizeAfterTransform(g,p,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:o,skewY:a});return this._finalizeDimensions(x.x,x.y)},_finalizeDimensions:function(o,a){return this.strokeUniform?{x:o+this.strokeWidth,y:a+this.strokeWidth}:{x:o,y:a}},_calculateCurrentDimensions:function(){var o=this.getViewportTransform(),a=this._getTransformedDimensions(),h=l(a,o,!0);return h.scalarAdd(2*this.padding)}})}(),e.util.object.extend(e.Object.prototype,{sendToBack:function(){return this.group?e.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?e.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(c){return this.group?e.StaticCanvas.prototype.sendBackwards.call(this.group,this,c):this.canvas&&this.canvas.sendBackwards(this,c),this},bringForward:function(c){return this.group?e.StaticCanvas.prototype.bringForward.call(this.group,this,c):this.canvas&&this.canvas.bringForward(this,c),this},moveTo:function(c){return this.group&&this.group.type!=="activeSelection"?e.StaticCanvas.prototype.moveTo.call(this.group,this,c):this.canvas&&this.canvas.moveTo(this,c),this}}),function(){function c(u,d){if(d){if(d.toLive)return u+": url(#SVGID_"+d.id+"); ";var l=new e.Color(d),o=u+": "+l.toRgb()+"; ",a=l.getAlpha();return a!==1&&(o+=u+"-opacity: "+a.toString()+"; "),o}else return u+": none; "}var s=e.util.toFixed;e.util.object.extend(e.Object.prototype,{getSvgStyles:function(u){var d=this.fillRule?this.fillRule:"nonzero",l=this.strokeWidth?this.strokeWidth:"0",o=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",h=this.strokeLineCap?this.strokeLineCap:"butt",g=this.strokeLineJoin?this.strokeLineJoin:"miter",p=this.strokeMiterLimit?this.strokeMiterLimit:"4",v=typeof this.opacity<"u"?this.opacity:"1",x=this.visible?"":" visibility: hidden;",y=u?"":this.getSvgFilter(),_=c("fill",this.fill),w=c("stroke",this.stroke);return[w,"stroke-width: ",l,"; ","stroke-dasharray: ",o,"; ","stroke-linecap: ",h,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",g,"; ","stroke-miterlimit: ",p,"; ",_,"fill-rule: ",d,"; ","opacity: ",v,";",y,x].join("")},getSvgSpanStyles:function(u,d){var l="; ",a=u.fontFamily?"font-family: "+(u.fontFamily.indexOf("'")===-1&&u.fontFamily.indexOf('"')===-1?"'"+u.fontFamily+"'":u.fontFamily)+l:"",o=u.strokeWidth?"stroke-width: "+u.strokeWidth+l:"",a=a,h=u.fontSize?"font-size: "+u.fontSize+"px"+l:"",g=u.fontStyle?"font-style: "+u.fontStyle+l:"",p=u.fontWeight?"font-weight: "+u.fontWeight+l:"",v=u.fill?c("fill",u.fill):"",x=u.stroke?c("stroke",u.stroke):"",y=this.getSvgTextDecoration(u),_=u.deltaY?"baseline-shift: "+-u.deltaY+"; ":"";return y&&(y="text-decoration: "+y+l),[x,o,a,h,g,p,y,v,_,d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(u){return["overline","underline","line-through"].filter(function(d){return u[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(u,d){var l=u?this.calcTransformMatrix():this.calcOwnMatrix(),o='transform="'+e.util.matrixToSVG(l);return o+(d||"")+'" '},_setSVGBg:function(u){if(this.backgroundColor){var d=e.Object.NUM_FRACTION_DIGITS;u.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,d),'" y="',s(-this.height/2,d),'" width="',s(this.width,d),'" height="',s(this.height,d),`"></rect>
`)}},toSVG:function(u){return this._createBaseSVGMarkup(this._toSVG(u),{reviver:u})},toClipPathSVG:function(u){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(u),{reviver:u})},_createBaseClipPathSVGMarkup:function(u,d){d=d||{};var l=d.reviver,o=d.additionalTransform||"",a=[this.getSvgTransform(!0,o),this.getSvgCommons()].join(""),h=u.indexOf("COMMON_PARTS");return u[h]=a,l?l(u.join("")):u.join("")},_createBaseSVGMarkup:function(u,d){d=d||{};var l=d.noStyle,o=d.reviver,a=l?"":'style="'+this.getSvgStyles()+'" ',h=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",g=this.clipPath,p=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",v=g&&g.absolutePositioned,x=this.stroke,y=this.fill,_=this.shadow,w,C=[],S,O=u.indexOf("COMMON_PARTS"),F=d.additionalTransform;return g&&(g.clipPathId="CLIPPATH_"+e.Object.__uid++,S='<clipPath id="'+g.clipPathId+`" >
`+g.toClipPathSVG(o)+`</clipPath>
`),v&&C.push("<g ",h,this.getSvgCommons(),` >
`),C.push("<g ",this.getSvgTransform(!1),v?"":h+this.getSvgCommons(),` >
`),w=[a,p,l?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),u[O]=w,y&&y.toLive&&C.push(y.toSVG(this)),x&&x.toLive&&C.push(x.toSVG(this)),_&&C.push(_.toSVG(this)),g&&C.push(S),C.push(u.join("")),C.push(`</g>
`),v&&C.push(`</g>
`),o?o(C.join("")):C.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var c=e.util.object.extend,s="stateProperties";function u(l,o,a){var h={},g=!0;a.forEach(function(p){h[p]=l[p]}),c(l[o],h,g)}function d(l,o,a){if(l===o)return!0;if(Array.isArray(l)){if(!Array.isArray(o)||l.length!==o.length)return!1;for(var h=0,g=l.length;h<g;h++)if(!d(l[h],o[h]))return!1;return!0}else if(l&&typeof l=="object"){var p=Object.keys(l),v;if(!o||typeof o!="object"||!a&&p.length!==Object.keys(o).length)return!1;for(var h=0,g=p.length;h<g;h++)if(v=p[h],!(v==="canvas"||v==="group")&&!d(l[v],o[v]))return!1;return!0}}e.util.object.extend(e.Object.prototype,{hasStateChanged:function(l){l=l||s;var o="_"+l;return Object.keys(this[o]).length<this[l].length?!0:!d(this[o],this,!0)},saveState:function(l){var o=l&&l.propertySet||s,a="_"+o;return this[a]?(u(this,a,this[o]),l&&l.stateProperties&&u(this,a,l.stateProperties),this):this.setupState(l)},setupState:function(l){l=l||{};var o=l.propertySet||s;return l.propertySet=o,this["_"+o]={},this.saveState(l),this}})}(),function(){var c=e.util.degreesToRadians;e.util.object.extend(e.Object.prototype,{_findTargetCorner:function(s,u){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d=s.x,l=s.y,o,a,h=Object.keys(this.oCoords),g=h.length-1,p;for(this.__corner=0;g>=0;g--)if(p=h[g],!!this.isControlVisible(p)&&(a=this._getImageLines(u?this.oCoords[p].touchCorner:this.oCoords[p].corner),o=this._findCrossPoints({x:d,y:l},a),o!==0&&o%2===1))return this.__corner=p,p;return!1},forEachControl:function(s){for(var u in this.controls)s(this.controls[u],u,this)},_setCornerCoords:function(){var s=this.oCoords;for(var u in s){var d=this.controls[u];s[u].corner=d.calcCornerCoords(this.angle,this.cornerSize,s[u].x,s[u].y,!1),s[u].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,s[u].x,s[u].y,!0)}},drawSelectionBackground:function(s){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;s.save();var u=this.getCenterPoint(),d=this._calculateCurrentDimensions(),l=this.canvas.viewportTransform;return s.translate(u.x,u.y),s.scale(1/l[0],1/l[3]),s.rotate(c(this.angle)),s.fillStyle=this.selectionBackgroundColor,s.fillRect(-d.x/2,-d.y/2,d.x,d.y),s.restore(),this},drawBorders:function(s,u){u=u||{};var d=this._calculateCurrentDimensions(),l=this.borderScaleFactor,o=d.x+l,a=d.y+l,h=typeof u.hasControls<"u"?u.hasControls:this.hasControls,g=!1;return s.save(),s.strokeStyle=u.borderColor||this.borderColor,this._setLineDash(s,u.borderDashArray||this.borderDashArray),s.strokeRect(-o/2,-a/2,o,a),h&&(s.beginPath(),this.forEachControl(function(p,v,x){p.withConnection&&p.getVisibility(x,v)&&(g=!0,s.moveTo(p.x*o,p.y*a),s.lineTo(p.x*o+p.offsetX,p.y*a+p.offsetY))}),g&&s.stroke()),s.restore(),this},drawBordersInGroup:function(s,u,d){d=d||{};var l=e.util.sizeAfterTransform(this.width,this.height,u),o=this.strokeWidth,a=this.strokeUniform,h=this.borderScaleFactor,g=l.x+o*(a?this.canvas.getZoom():u.scaleX)+h,p=l.y+o*(a?this.canvas.getZoom():u.scaleY)+h;return s.save(),this._setLineDash(s,d.borderDashArray||this.borderDashArray),s.strokeStyle=d.borderColor||this.borderColor,s.strokeRect(-g/2,-p/2,g,p),s.restore(),this},drawControls:function(s,u){u=u||{},s.save();var d=this.canvas.getRetinaScaling(),l,o;return s.setTransform(d,0,0,d,0,0),s.strokeStyle=s.fillStyle=u.cornerColor||this.cornerColor,this.transparentCorners||(s.strokeStyle=u.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(s,u.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(l=this.group.calcTransformMatrix()),this.forEachControl(function(a,h,g){o=g.oCoords[h],a.getVisibility(g,h)&&(l&&(o=e.util.transformPoint(o,l)),a.render(s,o.x,o.y,u,g))}),s.restore(),this},isControlVisible:function(s){return this.controls[s]&&this.controls[s].getVisibility(this,s)},setControlVisible:function(s,u){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[s]=u,this},setControlsVisibility:function(s){s||(s={});for(var u in s)this.setControlVisible(u,s[u]);return this},onDeselect:function(){},onSelect:function(){}})}(),e.util.object.extend(e.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(c,s){s=s||{};var u=function(){},d=s.onComplete||u,l=s.onChange||u,o=this;return e.util.animate({target:this,startValue:c.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(a){c.set("left",a),o.requestRenderAll(),l()},onComplete:function(){c.setCoords(),d()}})},fxCenterObjectV:function(c,s){s=s||{};var u=function(){},d=s.onComplete||u,l=s.onChange||u,o=this;return e.util.animate({target:this,startValue:c.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(a){c.set("top",a),o.requestRenderAll(),l()},onComplete:function(){c.setCoords(),d()}})},fxRemove:function(c,s){s=s||{};var u=function(){},d=s.onComplete||u,l=s.onChange||u,o=this;return e.util.animate({target:this,startValue:c.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(a){c.set("opacity",a),o.requestRenderAll(),l()},onComplete:function(){o.remove(c),d()}})}}),e.util.object.extend(e.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var c=[],s,u,d=[];for(s in arguments[0])c.push(s);for(var l=0,o=c.length;l<o;l++)s=c[l],u=l!==o-1,d.push(this._animate(s,arguments[0][s],arguments[1],u));return d}else return this._animate.apply(this,arguments)},_animate:function(c,s,u,d){var l=this,o;s=s.toString(),u?u=e.util.object.clone(u):u={},~c.indexOf(".")&&(o=c.split("."));var a=l.colorProperties.indexOf(c)>-1||o&&l.colorProperties.indexOf(o[1])>-1,h=o?this.get(o[0])[o[1]]:this.get(c);"from"in u||(u.from=h),a||(~s.indexOf("=")?s=h+parseFloat(s.replace("=","")):s=parseFloat(s));var g={target:this,startValue:u.from,endValue:s,byValue:u.by,easing:u.easing,duration:u.duration,abort:u.abort&&function(p,v,x){return u.abort.call(l,p,v,x)},onChange:function(p,v,x){o?l[o[0]][o[1]]=p:l.set(c,p),!d&&u.onChange&&u.onChange(p,v,x)},onComplete:function(p,v,x){d||(l.setCoords(),u.onComplete&&u.onComplete(p,v,x))}};return a?e.util.animateColor(g.startValue,g.endValue,g.duration,g):e.util.animate(g)}}),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.util.object.clone,l={x1:1,x2:1,y1:1,y2:1};if(s.Line){s.warn("fabric.Line is already defined");return}s.Line=s.util.createClass(s.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:s.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(a,h){a||(a=[0,0,0,0]),this.callSuper("initialize",h),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(h)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,h){return this.callSuper("_set",a,h),typeof l[a]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:o({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:o({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var h=this.calcLinePoints();a.moveTo(h.x1,h.y1),a.lineTo(h.x2,h.y2),a.lineWidth=this.strokeWidth;var g=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=g},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(a){return u(this.callSuper("toObject",a),this.calcLinePoints())},_getNonTransformedDimensions:function(){var a=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(a.y-=this.strokeWidth),this.height===0&&(a.x-=this.strokeWidth)),a},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,h=this.y1<=this.y2?-1:1,g=a*this.width*.5,p=h*this.height*.5,v=a*this.width*-.5,x=h*this.height*-.5;return{x1:g,x2:v,y1:p,y2:x}},_toSVG:function(){var a=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`" />
`]}}),s.Line.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),s.Line.fromElement=function(a,h,g){g=g||{};var p=s.parseAttributes(a,s.Line.ATTRIBUTE_NAMES),v=[p.x1||0,p.y1||0,p.x2||0,p.y2||0];h(new s.Line(v,u(p,g)))},s.Line.fromObject=function(a,h){function g(v){delete v.points,h&&h(v)}var p=d(a,!0);p.points=[a.x1,a.y1,a.x2,a.y2],s.Object._fromObject("Line",p,g,"points")};function o(a,h){var g=a.origin,p=a.axis1,v=a.axis2,x=a.dimension,y=h.nearest,_=h.center,w=h.farthest;return function(){switch(this.get(g)){case y:return Math.min(this.get(p),this.get(v));case _:return Math.min(this.get(p),this.get(v))+.5*this.get(x);case w:return Math.max(this.get(p),this.get(v))}}}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.degreesToRadians;if(s.Circle){s.warn("fabric.Circle is already defined.");return}s.Circle=s.util.createClass(s.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:s.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(l,o){return this.callSuper("_set",l,o),l==="radius"&&this.setRadius(o),this},toObject:function(l){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(l))},_toSVG:function(){var l,o=0,a=0,h=(this.endAngle-this.startAngle)%360;if(h===0)l=["<circle ","COMMON_PARTS",'cx="'+o+'" cy="'+a+'" ','r="',this.radius,`" />
`];else{var g=u(this.startAngle),p=u(this.endAngle),v=this.radius,x=s.util.cos(g)*v,y=s.util.sin(g)*v,_=s.util.cos(p)*v,w=s.util.sin(p)*v,C=h>180?"1":"0";l=['<path d="M '+x+" "+y," A "+v+" "+v," 0 ",+C+" 1"," "+_+" "+w,'" ',"COMMON_PARTS",` />
`]}return l},_render:function(l){l.beginPath(),l.arc(0,0,this.radius,u(this.startAngle),u(this.endAngle),!1),this._renderPaintInOrder(l)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(l){return this.radius=l,this.set("width",l*2).set("height",l*2)}}),s.Circle.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),s.Circle.fromElement=function(l,o){var a=s.parseAttributes(l,s.Circle.ATTRIBUTE_NAMES);if(!d(a))throw new Error("value of `r` attribute is required and can not be negative");a.left=(a.left||0)-a.radius,a.top=(a.top||0)-a.radius,o(new s.Circle(a))};function d(l){return"radius"in l&&l.radius>=0}s.Circle.fromObject=function(l,o){s.Object._fromObject("Circle",l,o)}}(t),function(c){var s=c.fabric||(c.fabric={});if(s.Triangle){s.warn("fabric.Triangle is already defined");return}s.Triangle=s.util.createClass(s.Object,{type:"triangle",width:100,height:100,_render:function(u){var d=this.width/2,l=this.height/2;u.beginPath(),u.moveTo(-d,l),u.lineTo(0,-l),u.lineTo(d,l),u.closePath(),this._renderPaintInOrder(u)},_toSVG:function(){var u=this.width/2,d=this.height/2,l=[-u+" "+d,"0 "+-d,u+" "+d].join(",");return["<polygon ","COMMON_PARTS",'points="',l,'" />']}}),s.Triangle.fromObject=function(u,d){return s.Object._fromObject("Triangle",u,d)}}(t),function(c){var s=c.fabric||(c.fabric={}),u=Math.PI*2;if(s.Ellipse){s.warn("fabric.Ellipse is already defined.");return}s.Ellipse=s.util.createClass(s.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,l){switch(this.callSuper("_set",d,l),d){case"rx":this.rx=l,this.set("width",l*2);break;case"ry":this.ry=l,this.set("height",l*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,u,!1),d.restore(),this._renderPaintInOrder(d)}}),s.Ellipse.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),s.Ellipse.fromElement=function(d,l){var o=s.parseAttributes(d,s.Ellipse.ATTRIBUTE_NAMES);o.left=(o.left||0)-o.rx,o.top=(o.top||0)-o.ry,l(new s.Ellipse(o))},s.Ellipse.fromObject=function(d,l){s.Object._fromObject("Ellipse",d,l)}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend;if(s.Rect){s.warn("fabric.Rect is already defined");return}s.Rect=s.util.createClass(s.Object,{stateProperties:s.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var l=this.rx?Math.min(this.rx,this.width/2):0,o=this.ry?Math.min(this.ry,this.height/2):0,a=this.width,h=this.height,g=-this.width/2,p=-this.height/2,v=l!==0||o!==0,x=1-.5522847498;d.beginPath(),d.moveTo(g+l,p),d.lineTo(g+a-l,p),v&&d.bezierCurveTo(g+a-x*l,p,g+a,p+x*o,g+a,p+o),d.lineTo(g+a,p+h-o),v&&d.bezierCurveTo(g+a,p+h-x*o,g+a-x*l,p+h,g+a-l,p+h),d.lineTo(g+l,p+h),v&&d.bezierCurveTo(g+x*l,p+h,g,p+h-x*o,g,p+h-o),d.lineTo(g,p+o),v&&d.bezierCurveTo(g,p+x*o,g+x*l,p,g+l,p),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){var d=-this.width/2,l=-this.height/2;return["<rect ","COMMON_PARTS",'x="',d,'" y="',l,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),s.Rect.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),s.Rect.fromElement=function(d,l,o){if(!d)return l(null);o=o||{};var a=s.parseAttributes(d,s.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var h=new s.Rect(u(o?s.util.object.clone(o):{},a));h.visible=h.visible&&h.width>0&&h.height>0,l(h)},s.Rect.fromObject=function(d,l){return s.Object._fromObject("Rect",d,l)}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.util.array.min,l=s.util.array.max,o=s.util.toFixed,a=s.util.projectStrokeOnPoints;if(s.Polyline){s.warn("fabric.Polyline is already defined");return}s.Polyline=s.util.createClass(s.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:s.Object.prototype.cacheProperties.concat("points"),initialize:function(h,g){g=g||{},this.points=h||[],this.callSuper("initialize",g),this._setPositionDimensions(g)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(h){var g=this._calcDimensions(h),p,v=this.exactBoundingBox?this.strokeWidth:0;this.width=g.width-v,this.height=g.height-v,h.fromSVG||(p=this.translateToGivenOrigin({x:g.left-this.strokeWidth/2+v/2,y:g.top-this.strokeWidth/2+v/2},"left","top",this.originX,this.originY)),typeof h.left>"u"&&(this.left=h.fromSVG?g.left:p.x),typeof h.top>"u"&&(this.top=h.fromSVG?g.top:p.y),this.pathOffset={x:g.left+this.width/2+v/2,y:g.top+this.height/2+v/2}},_calcDimensions:function(){var h=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,g=d(h,"x")||0,p=d(h,"y")||0,v=l(h,"x")||0,x=l(h,"y")||0,y=v-g,_=x-p;return{left:g,top:p,width:y,height:_}},toObject:function(h){return u(this.callSuper("toObject",h),{points:this.points.concat()})},_toSVG:function(){for(var h=[],g=this.pathOffset.x,p=this.pathOffset.y,v=s.Object.NUM_FRACTION_DIGITS,x=0,y=this.points.length;x<y;x++)h.push(o(this.points[x].x-g,v),",",o(this.points[x].y-p,v)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',h.join(""),`" />
`]},commonRender:function(h){var g,p=this.points.length,v=this.pathOffset.x,x=this.pathOffset.y;if(!p||isNaN(this.points[p-1].y))return!1;h.beginPath(),h.moveTo(this.points[0].x-v,this.points[0].y-x);for(var y=0;y<p;y++)g=this.points[y],h.lineTo(g.x-v,g.y-x);return!0},_render:function(h){this.commonRender(h)&&this._renderPaintInOrder(h)},complexity:function(){return this.get("points").length}}),s.Polyline.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polyline.fromElementGenerator=function(h){return function(g,p,v){if(!g)return p(null);v||(v={});var x=s.parsePointsAttribute(g.getAttribute("points")),y=s.parseAttributes(g,s[h].ATTRIBUTE_NAMES);y.fromSVG=!0,p(new s[h](x,u(y,v)))}},s.Polyline.fromElement=s.Polyline.fromElementGenerator("Polyline"),s.Polyline.fromObject=function(h,g){return s.Object._fromObject("Polyline",h,g,"points")}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.projectStrokeOnPoints;if(s.Polygon){s.warn("fabric.Polygon is already defined");return}s.Polygon=s.util.createClass(s.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return u(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),s.Polygon.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polygon.fromElement=s.Polyline.fromElementGenerator("Polygon"),s.Polygon.fromObject=function(d,l){s.Object._fromObject("Polygon",d,l,"points")}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.array.min,d=s.util.array.max,l=s.util.object.extend,o=s.util.object.clone,a=s.util.toFixed;if(s.Path){s.warn("fabric.Path is already defined");return}s.Path=s.util.createClass(s.Object,{type:"path",path:null,cacheProperties:s.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:s.Object.prototype.stateProperties.concat("path"),initialize:function(h,g){g=o(g||{}),delete g.path,this.callSuper("initialize",g),this._setPath(h||[],g)},_setPath:function(h,g){this.path=s.util.makePathSimpler(Array.isArray(h)?h:s.util.parsePath(h)),s.Polyline.prototype._setPositionDimensions.call(this,g||{})},_renderPathCommands:function(h){var g,p=0,v=0,x=0,y=0,_=0,w=0,C=-this.pathOffset.x,S=-this.pathOffset.y;h.beginPath();for(var O=0,F=this.path.length;O<F;++O)switch(g=this.path[O],g[0]){case"L":x=g[1],y=g[2],h.lineTo(x+C,y+S);break;case"M":x=g[1],y=g[2],p=x,v=y,h.moveTo(x+C,y+S);break;case"C":x=g[5],y=g[6],_=g[3],w=g[4],h.bezierCurveTo(g[1]+C,g[2]+S,_+C,w+S,x+C,y+S);break;case"Q":h.quadraticCurveTo(g[1]+C,g[2]+S,g[3]+C,g[4]+S),x=g[3],y=g[4],_=g[1],w=g[2];break;case"z":case"Z":x=p,y=v,h.closePath();break}},_render:function(h){this._renderPathCommands(h),this._renderPaintInOrder(h)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(h){return l(this.callSuper("toObject",h),{path:this.path.map(function(g){return g.slice()})})},toDatalessObject:function(h){var g=this.toObject(["sourcePath"].concat(h));return g.sourcePath&&delete g.path,g},_toSVG:function(){var h=s.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',h,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var h=s.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,h)+", "+a(-this.pathOffset.y,h)+")"},toClipPathSVG:function(h){var g=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:h,additionalTransform:g})},toSVG:function(h){var g=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:h,additionalTransform:g})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var h=[],g=[],p,v=0,x=0,y=0,_=0,w,C=0,S=this.path.length;C<S;++C){switch(p=this.path[C],p[0]){case"L":y=p[1],_=p[2],w=[];break;case"M":y=p[1],_=p[2],v=y,x=_,w=[];break;case"C":w=s.util.getBoundsOfCurve(y,_,p[1],p[2],p[3],p[4],p[5],p[6]),y=p[5],_=p[6];break;case"Q":w=s.util.getBoundsOfCurve(y,_,p[1],p[2],p[1],p[2],p[3],p[4]),y=p[3],_=p[4];break;case"z":case"Z":y=v,_=x;break}w.forEach(function(ae){h.push(ae.x),g.push(ae.y)}),h.push(y),g.push(_)}var O=u(h)||0,F=u(g)||0,N=d(h)||0,W=d(g)||0,X=N-O,Q=W-F;return{left:O,top:F,width:X,height:Q}}}),s.Path.fromObject=function(h,g){if(typeof h.sourcePath=="string"){var p=h.sourcePath;s.loadSVGFromURL(p,function(v){var x=v[0];x.setOptions(h),h.clipPath?s.util.enlivenObjects([h.clipPath],function(y){x.clipPath=y[0],g&&g(x)}):g&&g(x)})}else s.Object._fromObject("Path",h,g,"path")},s.Path.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(["d"]),s.Path.fromElement=function(h,g,p){var v=s.parseAttributes(h,s.Path.ATTRIBUTE_NAMES);v.fromSVG=!0,g(new s.Path(v.d,l(v,p)))}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.array.min,d=s.util.array.max;s.Group||(s.Group=s.util.createClass(s.Object,s.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(l,o,a){o=o||{},this._objects=[],a&&this.callSuper("initialize",o),this._objects=l||[];for(var h=this._objects.length;h--;)this._objects[h].group=this;if(a)this._updateObjectsACoords();else{var g=o&&o.centerPoint;o.originX!==void 0&&(this.originX=o.originX),o.originY!==void 0&&(this.originY=o.originY),g||this._calcBounds(),this._updateObjectsCoords(g),delete o.centerPoint,this.callSuper("initialize",o)}this.setCoords()},_updateObjectsACoords:function(){for(var l=!0,o=this._objects.length;o--;)this._objects[o].setCoords(l)},_updateObjectsCoords:function(o){for(var o=o||this.getCenterPoint(),a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],o)},_updateObjectCoords:function(l,o){var a=l.left,h=l.top,g=!0;l.set({left:a-o.x,top:h-o.y}),l.group=this,l.setCoords(g)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(l){var o=!!this.group;return this._restoreObjectsState(),s.util.resetObjectTransform(this),l&&(o&&s.util.removeTransformFromObject(l,this.group.calcTransformMatrix()),this._objects.push(l),l.group=this,l._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,o?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(l){return this._restoreObjectsState(),s.util.resetObjectTransform(this),this.remove(l),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(l){this.dirty=!0,l.group=this,l._set("canvas",this.canvas)},_onObjectRemoved:function(l){this.dirty=!0,delete l.group},_set:function(l,o){var a=this._objects.length;if(this.useSetOnGroup)for(;a--;)this._objects[a].setOnGroup(l,o);if(l==="canvas")for(;a--;)this._objects[a]._set(l,o);s.Object.prototype._set.call(this,l,o)},toObject:function(l){var o=this.includeDefaultValues,a=this._objects.filter(function(g){return!g.excludeFromExport}).map(function(g){var p=g.includeDefaultValues;g.includeDefaultValues=o;var v=g.toObject(l);return g.includeDefaultValues=p,v}),h=s.Object.prototype.toObject.call(this,l);return h.objects=a,h},toDatalessObject:function(l){var o,a=this.sourcePath;if(a)o=a;else{var h=this.includeDefaultValues;o=this._objects.map(function(p){var v=p.includeDefaultValues;p.includeDefaultValues=h;var x=p.toDatalessObject(l);return p.includeDefaultValues=v,x})}var g=s.Object.prototype.toDatalessObject.call(this,l);return g.objects=o,g},render:function(l){this._transformDone=!0,this.callSuper("render",l),this._transformDone=!1},shouldCache:function(){var l=s.Object.prototype.shouldCache.call(this);if(l){for(var o=0,a=this._objects.length;o<a;o++)if(this._objects[o].willDrawShadow())return this.ownCaching=!1,!1}return l},willDrawShadow:function(){if(s.Object.prototype.willDrawShadow.call(this))return!0;for(var l=0,o=this._objects.length;l<o;l++)if(this._objects[l].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(l){for(var o=0,a=this._objects.length;o<a;o++)this._objects[o].render(l);this._drawClipPath(l,this.clipPath)},isCacheDirty:function(l){if(this.callSuper("isCacheDirty",l))return!0;if(!this.statefullCache)return!1;for(var o=0,a=this._objects.length;o<a;o++)if(this._objects[o].isCacheDirty(!0)){if(this._cacheCanvas){var h=this.cacheWidth/this.zoomX,g=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-h/2,-g/2,h,g)}return!0}return!1},_restoreObjectsState:function(){var l=this.calcOwnMatrix();return this._objects.forEach(function(o){s.util.addTransformToObject(o,l),delete o.group,o.setCoords()}),this},destroy:function(){return this._objects.forEach(function(l){l.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var l=this._objects,o=this.canvas;this._objects=[];var a=this.toObject();delete a.objects;var h=new s.ActiveSelection([]);return h.set(a),h.type="activeSelection",o.remove(this),l.forEach(function(g){g.group=h,g.dirty=!0,o.add(g)}),h.canvas=o,h._objects=l,o._activeObject=h,h.setCoords(),h}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var l=!0;return this.forEachObject(function(o){o.setCoords(l)}),this},_calcBounds:function(l){for(var o=[],a=[],h,g,p,v=["tr","br","bl","tl"],x=0,y=this._objects.length,_,w=v.length;x<y;++x){for(h=this._objects[x],p=h.calcACoords(),_=0;_<w;_++)g=v[_],o.push(p[g].x),a.push(p[g].y);h.aCoords=p}this._getBounds(o,a,l)},_getBounds:function(l,o,a){var h=new s.Point(u(l),u(o)),g=new s.Point(d(l),d(o)),p=h.y||0,v=h.x||0,x=g.x-h.x||0,y=g.y-h.y||0;this.width=x,this.height=y,a||this.setPositionByOrigin({x:v,y:p},"left","top")},_toSVG:function(l){for(var o=["<g ","COMMON_PARTS",` >
`],a=0,h=this._objects.length;a<h;a++)o.push("		",this._objects[a].toSVG(l));return o.push(`</g>
`),o},getSvgStyles:function(){var l=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",o=this.visible?"":" visibility: hidden;";return[l,this.getSvgFilter(),o].join("")},toClipPathSVG:function(l){for(var o=[],a=0,h=this._objects.length;a<h;a++)o.push("	",this._objects[a].toClipPathSVG(l));return this._createBaseClipPathSVGMarkup(o,{reviver:l})}}),s.Group.fromObject=function(l,o){var a=l.objects,h=s.util.object.clone(l,!0);if(delete h.objects,typeof a=="string"){s.loadSVGFromURL(a,function(g){var p=s.util.groupSVGElements(g,l,a),v=h.clipPath;delete h.clipPath,p.set(h),v?s.util.enlivenObjects([v],function(x){p.clipPath=x[0],o&&o(p)}):o&&o(p)});return}s.util.enlivenObjects(a,function(g){s.util.enlivenObjectEnlivables(l,h,function(){o&&o(new s.Group(g,h,!0))})})})}(t),function(c){var s=c.fabric||(c.fabric={});s.ActiveSelection||(s.ActiveSelection=s.util.createClass(s.Group,{type:"activeSelection",initialize:function(u,d){d=d||{},this._objects=u||[];for(var l=this._objects.length;l--;)this._objects[l].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),s.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var u=this._objects.concat();this._objects=[];var d=s.Object.prototype.toObject.call(this),l=new s.Group([]);if(delete d.type,l.set(d),u.forEach(function(a){a.canvas.remove(a),a.group=l}),l._objects=u,!this.canvas)return l;var o=this.canvas;return o.add(l),o._activeObject=l,l.setCoords(),l},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(u,d,l){u.save(),u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",u,d),l=l||{},typeof l.hasControls>"u"&&(l.hasControls=!1),l.forActiveSelection=!0;for(var o=0,a=this._objects.length;o<a;o++)this._objects[o]._renderControls(u,l);u.restore()}}),s.ActiveSelection.fromObject=function(u,d){s.util.enlivenObjects(u.objects,function(l){delete u.objects,d&&d(new s.ActiveSelection(l,u,!0))})})}(t),function(c){var s=e.util.object.extend;if(c.fabric||(c.fabric={}),c.fabric.Image){e.warn("fabric.Image is already defined.");return}e.Image=e.util.createClass(e.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:e.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:e.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(u,d){d||(d={}),this.filters=[],this.cacheKey="texture"+e.Object.__uid++,this.callSuper("initialize",d),this._initElement(u,d)},getElement:function(){return this._element||{}},setElement:function(u,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=u,this._originalElement=u,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(u){var d=e.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(u)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(u){e.util.cleanUpJsdomNode(this[u]),this[u]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var u=this.getElement();return{width:u.naturalWidth||u.width,height:u.naturalHeight||u.height}},_stroke:function(u){if(!(!this.stroke||this.strokeWidth===0)){var d=this.width/2,l=this.height/2;u.beginPath(),u.moveTo(-d,-l),u.lineTo(d,-l),u.lineTo(d,l),u.lineTo(-d,l),u.lineTo(-d,-l),u.closePath()}},toObject:function(u){var d=[];this.filters.forEach(function(o){o&&d.push(o.toObject())});var l=s(this.callSuper("toObject",["cropX","cropY"].concat(u)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(l.resizeFilter=this.resizeFilter.toObject()),l},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var u=[],d=[],l,o=this._element,a=-this.width/2,h=-this.height/2,g="",p="";if(!o)return[];if(this.hasCrop()){var v=e.Object.__uid++;u.push('<clipPath id="imageCrop_'+v+`">
`,'	<rect x="'+a+'" y="'+h+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),g=' clip-path="url(#imageCrop_'+v+')" '}if(this.imageSmoothing||(p='" image-rendering="optimizeSpeed'),d.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',a-this.cropX,'" y="',h-this.cropY,'" width="',o.width||o.naturalWidth,'" height="',o.height||o.height,p,'"',g,`></image>
`),this.stroke||this.strokeDashArray){var x=this.fill;this.fill=null,l=["	<rect ",'x="',a,'" y="',h,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=x}return this.paintFirst!=="fill"?u=u.concat(l,d):u=u.concat(d,l),u},getSrc:function(u){var d=u?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(u,d,l){return e.util.loadImage(u,function(o,a){this.setElement(o,l),this._setWidthHeight(),d&&d(this,a)},this,l&&l.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var u=this.resizeFilter,d=this.minimumScaleTrigger,l=this.getTotalObjectScaling(),o=l.scaleX,a=l.scaleY,h=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!u||o>d&&a>d){this._element=h,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=o,this._lastScaleY=a;return}e.filterBackend||(e.filterBackend=e.initFilterBackend());var g=e.util.createCanvasElement(),p=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,v=h.width,x=h.height;g.width=v,g.height=x,this._element=g,this._lastScaleX=u.scaleX=o,this._lastScaleY=u.scaleY=a,e.filterBackend.applyFilters([u],h,v,x,this._element,p),this._filterScalingX=g.width/this._originalElement.width,this._filterScalingY=g.height/this._originalElement.height},applyFilters:function(u){if(u=u||this.filters||[],u=u.filter(function(h){return h&&!h.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),u.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,l=d.naturalWidth||d.width,o=d.naturalHeight||d.height;if(this._element===this._originalElement){var a=e.util.createCanvasElement();a.width=l,a.height=o,this._element=a,this._filteredEl=a}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,l,o),this._lastScaleX=1,this._lastScaleY=1;return e.filterBackend||(e.filterBackend=e.initFilterBackend()),e.filterBackend.applyFilters(u,this._originalElement,l,o,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(u){e.util.setImageSmoothing(u,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(u),this._renderPaintInOrder(u)},drawCacheOnCanvas:function(u){e.util.setImageSmoothing(u,this.imageSmoothing),e.Object.prototype.drawCacheOnCanvas.call(this,u)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(u){var d=this._element;if(d){var l=this._filterScalingX,o=this._filterScalingY,a=this.width,h=this.height,g=Math.min,p=Math.max,v=p(this.cropX,0),x=p(this.cropY,0),y=d.naturalWidth||d.width,_=d.naturalHeight||d.height,w=v*l,C=x*o,S=g(a*l,y-w),O=g(h*o,_-C),F=-a/2,N=-h/2,W=g(a,y/l-v),X=g(h,_/o-x);d&&u.drawImage(d,w,C,S,O,F,N,W,X)}},_needsResize:function(){var u=this.getTotalObjectScaling();return u.scaleX!==this._lastScaleX||u.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(u,d){this.setElement(e.util.getById(u),d),e.util.addClass(this.getElement(),e.Image.CSS_CANVAS)},_initConfig:function(u){u||(u={}),this.setOptions(u),this._setWidthHeight(u)},_initFilters:function(u,d){u&&u.length?e.util.enlivenObjects(u,function(l){d&&d(l)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(u){u||(u={});var d=this.getElement();this.width=u.width||d.naturalWidth||d.width||0,this.height=u.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var u=e.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),d=this._element.width,l=this._element.height,o=1,a=1,h=0,g=0,p=0,v=0,x,y=this.width,_=this.height,w={width:y,height:_};return u&&(u.alignX!=="none"||u.alignY!=="none")?(u.meetOrSlice==="meet"&&(o=a=e.util.findScaleToFit(this._element,w),x=(y-d*o)/2,u.alignX==="Min"&&(h=-x),u.alignX==="Max"&&(h=x),x=(_-l*a)/2,u.alignY==="Min"&&(g=-x),u.alignY==="Max"&&(g=x)),u.meetOrSlice==="slice"&&(o=a=e.util.findScaleToCover(this._element,w),x=d-y/o,u.alignX==="Mid"&&(p=x/2),u.alignX==="Max"&&(p=x),x=l-_/a,u.alignY==="Mid"&&(v=x/2),u.alignY==="Max"&&(v=x),d=y/o,l=_/a)):(o=y/d,a=_/l),{width:d,height:l,scaleX:o,scaleY:a,offsetLeft:h,offsetTop:g,cropX:p,cropY:v}}}),e.Image.CSS_CANVAS="canvas-img",e.Image.prototype.getSvgSrc=e.Image.prototype.getSrc,e.Image.fromObject=function(u,d){var l=e.util.object.clone(u);e.util.loadImage(l.src,function(o,a){if(a){d&&d(null,!0);return}e.Image.prototype._initFilters.call(l,l.filters,function(h){l.filters=h||[],e.Image.prototype._initFilters.call(l,[l.resizeFilter],function(g){l.resizeFilter=g[0],e.util.enlivenObjectEnlivables(l,l,function(){var p=new e.Image(o,l);d(p,!1)})})})},null,l.crossOrigin)},e.Image.fromURL=function(u,d,l){e.util.loadImage(u,function(o,a){d&&d(new e.Image(o,l),a)},null,l&&l.crossOrigin)},e.Image.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),e.Image.fromElement=function(u,d,l){var o=e.parseAttributes(u,e.Image.ATTRIBUTE_NAMES);e.Image.fromURL(o["xlink:href"],d,s(l?e.util.object.clone(l):{},o))}}(t),e.util.object.extend(e.Object.prototype,{_getAngleValueForStraighten:function(){var c=this.angle%360;return c>0?Math.round((c-1)/90)*90:Math.round(c/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(c){c=c||{};var s=function(){},u=c.onComplete||s,d=c.onChange||s,l=this;return e.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(o){l.rotate(o),d()},onComplete:function(){l.setCoords(),u()}})}}),e.util.object.extend(e.StaticCanvas.prototype,{straightenObject:function(c){return c.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(c){return c.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function c(u,d){var l="precision "+d+` float;
void main(){}`,o=u.createShader(u.FRAGMENT_SHADER);return u.shaderSource(o,l),u.compileShader(o),!!u.getShaderParameter(o,u.COMPILE_STATUS)}e.isWebglSupported=function(u){if(e.isLikelyNode)return!1;u=u||e.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),l=d.getContext("webgl")||d.getContext("experimental-webgl"),o=!1;if(l){e.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),o=e.maxTextureSize>=u;for(var a=["highp","mediump","lowp"],h=0;h<3;h++)if(c(l,a[h])){e.webGlPrecision=a[h];break}}return this.isSupported=o,o},e.WebglFilterBackend=s;function s(u){u&&u.tileSize&&(this.tileSize=u.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}s.prototype={tileSize:2048,resources:{},setupGLContext:function(u,d){this.dispose(),this.createWebGLCanvas(u,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(u,d)},chooseFastestCopyGLTo2DMethod:function(u,d){var l=typeof window.performance<"u",o;try{new ImageData(1,1),o=!0}catch{o=!1}var a=typeof ArrayBuffer<"u",h=typeof Uint8ClampedArray<"u";if(l&&o&&a&&h){var g=e.util.createCanvasElement(),p=new ArrayBuffer(u*d*4);if(e.forceGLPutImageData){this.imageBuffer=p,this.copyGLTo2D=m;return}var v={imageBuffer:p,destinationWidth:u,destinationHeight:d,targetCanvas:g},x,y,_;g.width=u,g.height=d,x=window.performance.now(),f.call(v,this.gl,v),y=window.performance.now()-x,x=window.performance.now(),m.call(v,this.gl,v),_=window.performance.now()-x,y>_?(this.imageBuffer=p,this.copyGLTo2D=m):this.copyGLTo2D=f}},createWebGLCanvas:function(u,d){var l=e.util.createCanvasElement();l.width=u,l.height=d;var o={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},a=l.getContext("webgl",o);a||(a=l.getContext("experimental-webgl",o)),a&&(a.clearColor(0,0,0,0),this.canvas=l,this.gl=a)},applyFilters:function(u,d,l,o,a,h){var g=this.gl,p;h&&(p=this.getCachedTexture(h,d));var v={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:l,sourceHeight:o,destinationWidth:l,destinationHeight:o,context:g,sourceTexture:this.createTexture(g,l,o,!p&&d),targetTexture:this.createTexture(g,l,o),originalTexture:p||this.createTexture(g,l,o,!p&&d),passes:u.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},x=g.createFramebuffer();return g.bindFramebuffer(g.FRAMEBUFFER,x),u.forEach(function(y){y&&y.applyTo(v)}),i(v),this.copyGLTo2D(g,v),g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(v.sourceTexture),g.deleteTexture(v.targetTexture),g.deleteFramebuffer(x),a.getContext("2d").setTransform(1,0,0,1,0,0),v},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(u,d,l,o,a){var h=u.createTexture();return u.bindTexture(u.TEXTURE_2D,h),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,a||u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,a||u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),o?u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,o):u.texImage2D(u.TEXTURE_2D,0,u.RGBA,d,l,0,u.RGBA,u.UNSIGNED_BYTE,null),h},getCachedTexture:function(u,d){if(this.textureCache[u])return this.textureCache[u];var l=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[u]=l,l},evictCachesForKey:function(u){this.textureCache[u]&&(this.gl.deleteTexture(this.textureCache[u]),delete this.textureCache[u])},copyGLTo2D:f,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var u=this.gl,d={renderer:"",vendor:""};if(!u)return d;var l=u.getExtension("WEBGL_debug_renderer_info");if(l){var o=u.getParameter(l.UNMASKED_RENDERER_WEBGL),a=u.getParameter(l.UNMASKED_VENDOR_WEBGL);o&&(d.renderer=o.toLowerCase()),a&&(d.vendor=a.toLowerCase())}return this.gpuInfo=d,d}}}();function i(c){var s=c.targetCanvas,u=s.width,d=s.height,l=c.destinationWidth,o=c.destinationHeight;(u!==l||d!==o)&&(s.width=l,s.height=o)}function f(c,s){var u=c.canvas,d=s.targetCanvas,l=d.getContext("2d");l.translate(0,d.height),l.scale(1,-1);var o=u.height-d.height;l.drawImage(u,0,o,d.width,d.height,0,0,d.width,d.height)}function m(c,s){var u=s.targetCanvas,d=u.getContext("2d"),l=s.destinationWidth,o=s.destinationHeight,a=l*o*4,h=new Uint8Array(this.imageBuffer,0,a),g=new Uint8ClampedArray(this.imageBuffer,0,a);c.readPixels(0,0,l,o,c.RGBA,c.UNSIGNED_BYTE,h);var p=new ImageData(g,l,o);d.putImageData(p,0,0)}(function(){var c=function(){};e.Canvas2dFilterBackend=s;function s(){}s.prototype={evictCachesForKey:c,dispose:c,clearWebGLCaches:c,resources:{},applyFilters:function(u,d,l,o,a){var h=a.getContext("2d");h.drawImage(d,0,0,l,o);var g=h.getImageData(0,0,l,o),p=h.getImageData(0,0,l,o),v={sourceWidth:l,sourceHeight:o,imageData:g,originalEl:d,originalImageData:p,canvasEl:a,ctx:h,filterBackend:this};return u.forEach(function(x){x.applyTo(v)}),(v.imageData.width!==l||v.imageData.height!==o)&&(a.width=v.imageData.width,a.height=v.imageData.height),h.putImageData(v.imageData,0,0),v}}})(),e.Image=e.Image||{},e.Image.filters=e.Image.filters||{},e.Image.filters.BaseFilter=e.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(c){c&&this.setOptions(c)},setOptions:function(c){for(var s in c)this[s]=c[s]},createProgram:function(c,s,u){s=s||this.fragmentSource,u=u||this.vertexSource,e.webGlPrecision!=="highp"&&(s=s.replace(/precision highp float/g,"precision "+e.webGlPrecision+" float"));var d=c.createShader(c.VERTEX_SHADER);if(c.shaderSource(d,u),c.compileShader(d),!c.getShaderParameter(d,c.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+c.getShaderInfoLog(d));var l=c.createShader(c.FRAGMENT_SHADER);if(c.shaderSource(l,s),c.compileShader(l),!c.getShaderParameter(l,c.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+c.getShaderInfoLog(l));var o=c.createProgram();if(c.attachShader(o,d),c.attachShader(o,l),c.linkProgram(o),!c.getProgramParameter(o,c.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+c.getProgramInfoLog(o));var a=this.getAttributeLocations(c,o),h=this.getUniformLocations(c,o)||{};return h.uStepW=c.getUniformLocation(o,"uStepW"),h.uStepH=c.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:a,uniformLocations:h}},getAttributeLocations:function(c,s){return{aPosition:c.getAttribLocation(s,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(c,s,u){var d=s.aPosition,l=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,l),c.enableVertexAttribArray(d),c.vertexAttribPointer(d,2,c.FLOAT,!1,0,0),c.bufferData(c.ARRAY_BUFFER,u,c.STATIC_DRAW)},_setupFrameBuffer:function(c){var s=c.context,u,d;c.passes>1?(u=c.destinationWidth,d=c.destinationHeight,(c.sourceWidth!==u||c.sourceHeight!==d)&&(s.deleteTexture(c.targetTexture),c.targetTexture=c.filterBackend.createTexture(s,u,d)),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,c.targetTexture,0)):(s.bindFramebuffer(s.FRAMEBUFFER,null),s.finish())},_swapTextures:function(c){c.passes--,c.pass++;var s=c.targetTexture;c.targetTexture=c.sourceTexture,c.sourceTexture=s},isNeutralState:function(){var c=this.mainParameter,s=e.Image.filters[this.type].prototype;if(c)if(Array.isArray(s[c])){for(var u=s[c].length;u--;)if(this[c][u]!==s[c][u])return!1;return!0}else return s[c]===this[c];else return!1},applyTo:function(c){c.webgl?(this._setupFrameBuffer(c),this.applyToWebGL(c),this._swapTextures(c)):this.applyTo2d(c)},retrieveShader:function(c){return c.programCache.hasOwnProperty(this.type)||(c.programCache[this.type]=this.createProgram(c.context)),c.programCache[this.type]},applyToWebGL:function(c){var s=c.context,u=this.retrieveShader(c);c.pass===0&&c.originalTexture?s.bindTexture(s.TEXTURE_2D,c.originalTexture):s.bindTexture(s.TEXTURE_2D,c.sourceTexture),s.useProgram(u.program),this.sendAttributeData(s,u.attributeLocations,c.aPosition),s.uniform1f(u.uniformLocations.uStepW,1/c.sourceWidth),s.uniform1f(u.uniformLocations.uStepH,1/c.sourceHeight),this.sendUniformData(s,u.uniformLocations),s.viewport(0,0,c.destinationWidth,c.destinationHeight),s.drawArrays(s.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(c,s,u){c.activeTexture(u),c.bindTexture(c.TEXTURE_2D,s),c.activeTexture(c.TEXTURE0)},unbindAdditionalTexture:function(c,s){c.activeTexture(s),c.bindTexture(c.TEXTURE_2D,null),c.activeTexture(c.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(c){this[this.mainParameter]=c},sendUniformData:function(){},createHelpLayer:function(c){if(!c.helpLayer){var s=document.createElement("canvas");s.width=c.sourceWidth,s.height=c.sourceHeight,c.helpLayer=s}},toObject:function(){var c={type:this.type},s=this.mainParameter;return s&&(c[s]=this[s]),c},toJSON:function(){return this.toObject()}}),e.Image.filters.BaseFilter.fromObject=function(c,s){var u=new e.Image.filters[c.type](c);return s&&s(u),u},function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.ColorMatrix=d(u.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(l){this.callSuper("initialize",l),this.matrix=this.matrix.slice(0)},applyTo2d:function(l){var o=l.imageData,a=o.data,h=a.length,g=this.matrix,p,v,x,y,_,w=this.colorsOnly;for(_=0;_<h;_+=4)p=a[_],v=a[_+1],x=a[_+2],w?(a[_]=p*g[0]+v*g[1]+x*g[2]+g[4]*255,a[_+1]=p*g[5]+v*g[6]+x*g[7]+g[9]*255,a[_+2]=p*g[10]+v*g[11]+x*g[12]+g[14]*255):(y=a[_+3],a[_]=p*g[0]+v*g[1]+x*g[2]+y*g[3]+g[4]*255,a[_+1]=p*g[5]+v*g[6]+x*g[7]+y*g[8]+g[9]*255,a[_+2]=p*g[10]+v*g[11]+x*g[12]+y*g[13]+g[14]*255,a[_+3]=p*g[15]+v*g[16]+x*g[17]+y*g[18]+g[19]*255)},getUniformLocations:function(l,o){return{uColorMatrix:l.getUniformLocation(o,"uColorMatrix"),uConstants:l.getUniformLocation(o,"uConstants")}},sendUniformData:function(l,o){var a=this.matrix,h=[a[0],a[1],a[2],a[3],a[5],a[6],a[7],a[8],a[10],a[11],a[12],a[13],a[15],a[16],a[17],a[18]],g=[a[4],a[9],a[14],a[19]];l.uniformMatrix4fv(o.uColorMatrix,!1,h),l.uniform4fv(o.uConstants,g)}}),s.Image.filters.ColorMatrix.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Brightness=d(u.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(l){if(this.brightness!==0){var o=l.imageData,a=o.data,h,g=a.length,p=Math.round(this.brightness*255);for(h=0;h<g;h+=4)a[h]=a[h]+p,a[h+1]=a[h+1]+p,a[h+2]=a[h+2]+p}},getUniformLocations:function(l,o){return{uBrightness:l.getUniformLocation(o,"uBrightness")}},sendUniformData:function(l,o){l.uniform1f(o.uBrightness,this.brightness)}}),s.Image.filters.Brightness.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.Image.filters,l=s.util.createClass;d.Convolute=l(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(o){var a=Math.sqrt(this.matrix.length),h=this.type+"_"+a+"_"+(this.opaque?1:0),g=this.fragmentSource[h];return o.programCache.hasOwnProperty(h)||(o.programCache[h]=this.createProgram(o.context,g)),o.programCache[h]},applyTo2d:function(o){var a=o.imageData,h=a.data,g=this.matrix,p=Math.round(Math.sqrt(g.length)),v=Math.floor(p/2),x=a.width,y=a.height,_=o.ctx.createImageData(x,y),w=_.data,C=this.opaque?1:0,S,O,F,N,W,X,Q,ae,ne,J,oe,q,k;for(oe=0;oe<y;oe++)for(J=0;J<x;J++){for(W=(oe*x+J)*4,S=0,O=0,F=0,N=0,k=0;k<p;k++)for(q=0;q<p;q++)Q=oe+k-v,X=J+q-v,!(Q<0||Q>=y||X<0||X>=x)&&(ae=(Q*x+X)*4,ne=g[k*p+q],S+=h[ae]*ne,O+=h[ae+1]*ne,F+=h[ae+2]*ne,C||(N+=h[ae+3]*ne));w[W]=S,w[W+1]=O,w[W+2]=F,C?w[W+3]=h[W+3]:w[W+3]=N}o.imageData=_},getUniformLocations:function(o,a){return{uMatrix:o.getUniformLocation(a,"uMatrix"),uOpaque:o.getUniformLocation(a,"uOpaque"),uHalfSize:o.getUniformLocation(a,"uHalfSize"),uSize:o.getUniformLocation(a,"uSize")}},sendUniformData:function(o,a){o.uniform1fv(a.uMatrix,this.matrix)},toObject:function(){return u(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),s.Image.filters.Convolute.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Grayscale=d(u.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(l){var o=l.imageData,a=o.data,h,g=a.length,p,v=this.mode;for(h=0;h<g;h+=4)v==="average"?p=(a[h]+a[h+1]+a[h+2])/3:v==="lightness"?p=(Math.min(a[h],a[h+1],a[h+2])+Math.max(a[h],a[h+1],a[h+2]))/2:v==="luminosity"&&(p=.21*a[h]+.72*a[h+1]+.07*a[h+2]),a[h]=p,a[h+1]=p,a[h+2]=p},retrieveShader:function(l){var o=this.type+"_"+this.mode;if(!l.programCache.hasOwnProperty(o)){var a=this.fragmentSource[this.mode];l.programCache[o]=this.createProgram(l.context,a)}return l.programCache[o]},getUniformLocations:function(l,o){return{uMode:l.getUniformLocation(o,"uMode")}},sendUniformData:function(l,o){var a=1;l.uniform1i(o.uMode,a)},isNeutralState:function(){return!1}}),s.Image.filters.Grayscale.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Invert=d(u.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(l){var o=l.imageData,a=o.data,h,g=a.length;for(h=0;h<g;h+=4)a[h]=255-a[h],a[h+1]=255-a[h+1],a[h+2]=255-a[h+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(l,o){return{uInvert:l.getUniformLocation(o,"uInvert")}},sendUniformData:function(l,o){l.uniform1i(o.uInvert,this.invert)}}),s.Image.filters.Invert.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.Image.filters,l=s.util.createClass;d.Noise=l(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(o){if(this.noise!==0){var a=o.imageData,h=a.data,g,p=h.length,v=this.noise,x;for(g=0,p=h.length;g<p;g+=4)x=(.5-Math.random())*v,h[g]+=x,h[g+1]+=x,h[g+2]+=x}},getUniformLocations:function(o,a){return{uNoise:o.getUniformLocation(a,"uNoise"),uSeed:o.getUniformLocation(a,"uSeed")}},sendUniformData:function(o,a){o.uniform1f(a.uNoise,this.noise/255),o.uniform1f(a.uSeed,Math.random())},toObject:function(){return u(this.callSuper("toObject"),{noise:this.noise})}}),s.Image.filters.Noise.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Pixelate=d(u.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(l){var o=l.imageData,a=o.data,h=o.height,g=o.width,p,v,x,y,_,w,C,S,O,F,N;for(v=0;v<h;v+=this.blocksize)for(x=0;x<g;x+=this.blocksize)for(p=v*4*g+x*4,y=a[p],_=a[p+1],w=a[p+2],C=a[p+3],F=Math.min(v+this.blocksize,h),N=Math.min(x+this.blocksize,g),S=v;S<F;S++)for(O=x;O<N;O++)p=S*4*g+O*4,a[p]=y,a[p+1]=_,a[p+2]=w,a[p+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(l,o){return{uBlocksize:l.getUniformLocation(o,"uBlocksize"),uStepW:l.getUniformLocation(o,"uStepW"),uStepH:l.getUniformLocation(o,"uStepH")}},sendUniformData:function(l,o){l.uniform1f(o.uBlocksize,this.blocksize)}}),s.Image.filters.Pixelate.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.extend,d=s.Image.filters,l=s.util.createClass;d.RemoveColor=l(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(o){var a=o.imageData,h=a.data,g,p=this.distance*255,v,x,y,_=new s.Color(this.color).getSource(),w=[_[0]-p,_[1]-p,_[2]-p],C=[_[0]+p,_[1]+p,_[2]+p];for(g=0;g<h.length;g+=4)v=h[g],x=h[g+1],y=h[g+2],v>w[0]&&x>w[1]&&y>w[2]&&v<C[0]&&x<C[1]&&y<C[2]&&(h[g+3]=0)},getUniformLocations:function(o,a){return{uLow:o.getUniformLocation(a,"uLow"),uHigh:o.getUniformLocation(a,"uHigh")}},sendUniformData:function(o,a){var h=new s.Color(this.color).getSource(),g=parseFloat(this.distance),p=[0+h[0]/255-g,0+h[1]/255-g,0+h[2]/255-g,1],v=[h[0]/255+g,h[1]/255+g,h[2]/255+g,1];o.uniform4fv(a.uLow,p),o.uniform4fv(a.uHigh,v)},toObject:function(){return u(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),s.Image.filters.RemoveColor.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass,l={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in l)u[o]=d(u.ColorMatrix,{type:o,matrix:l[o],mainParameter:!1,colorsOnly:!0}),s.Image.filters[o].fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric,u=s.Image.filters,d=s.util.createClass;u.BlendColor=d(u.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(l){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[l]+`}
}`},retrieveShader:function(l){var o=this.type+"_"+this.mode,a;return l.programCache.hasOwnProperty(o)||(a=this.buildSource(this.mode),l.programCache[o]=this.createProgram(l.context,a)),l.programCache[o]},applyTo2d:function(l){var o=l.imageData,a=o.data,h=a.length,g,p,v,x,y,_,w,C=1-this.alpha;w=new s.Color(this.color).getSource(),g=w[0]*this.alpha,p=w[1]*this.alpha,v=w[2]*this.alpha;for(var S=0;S<h;S+=4)switch(x=a[S],y=a[S+1],_=a[S+2],this.mode){case"multiply":a[S]=x*g/255,a[S+1]=y*p/255,a[S+2]=_*v/255;break;case"screen":a[S]=255-(255-x)*(255-g)/255,a[S+1]=255-(255-y)*(255-p)/255,a[S+2]=255-(255-_)*(255-v)/255;break;case"add":a[S]=x+g,a[S+1]=y+p,a[S+2]=_+v;break;case"diff":case"difference":a[S]=Math.abs(x-g),a[S+1]=Math.abs(y-p),a[S+2]=Math.abs(_-v);break;case"subtract":a[S]=x-g,a[S+1]=y-p,a[S+2]=_-v;break;case"darken":a[S]=Math.min(x,g),a[S+1]=Math.min(y,p),a[S+2]=Math.min(_,v);break;case"lighten":a[S]=Math.max(x,g),a[S+1]=Math.max(y,p),a[S+2]=Math.max(_,v);break;case"overlay":a[S]=g<128?2*x*g/255:255-2*(255-x)*(255-g)/255,a[S+1]=p<128?2*y*p/255:255-2*(255-y)*(255-p)/255,a[S+2]=v<128?2*_*v/255:255-2*(255-_)*(255-v)/255;break;case"exclusion":a[S]=g+x-2*g*x/255,a[S+1]=p+y-2*p*y/255,a[S+2]=v+_-2*v*_/255;break;case"tint":a[S]=g+x*C,a[S+1]=p+y*C,a[S+2]=v+_*C}},getUniformLocations:function(l,o){return{uColor:l.getUniformLocation(o,"uColor")}},sendUniformData:function(l,o){var a=new s.Color(this.color).getSource();a[0]=this.alpha*a[0]/255,a[1]=this.alpha*a[1]/255,a[2]=this.alpha*a[2]/255,a[3]=this.alpha,l.uniform4fv(o.uColor,a)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendColor.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric,u=s.Image.filters,d=s.util.createClass;u.BlendImage=d(u.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(l){var o=this.type+"_"+this.mode,a=this.fragmentSource[this.mode];return l.programCache.hasOwnProperty(o)||(l.programCache[o]=this.createProgram(l.context,a)),l.programCache[o]},applyToWebGL:function(l){var o=l.context,a=this.createTexture(l.filterBackend,this.image);this.bindAdditionalTexture(o,a,o.TEXTURE1),this.callSuper("applyToWebGL",l),this.unbindAdditionalTexture(o,o.TEXTURE1)},createTexture:function(l,o){return l.getCachedTexture(o.cacheKey,o._element)},calculateMatrix:function(){var l=this.image,o=l._element.width,a=l._element.height;return[1/l.scaleX,0,0,0,1/l.scaleY,0,-l.left/o,-l.top/a,1]},applyTo2d:function(l){var o=l.imageData,a=l.filterBackend.resources,h=o.data,g=h.length,p=o.width,v=o.height,x,y,_,w,C,S,O,F,N,W,X=this.image,Q;a.blendImage||(a.blendImage=s.util.createCanvasElement()),N=a.blendImage,W=N.getContext("2d"),N.width!==p||N.height!==v?(N.width=p,N.height=v):W.clearRect(0,0,p,v),W.setTransform(X.scaleX,0,0,X.scaleY,X.left,X.top),W.drawImage(X._element,0,0,p,v),Q=W.getImageData(0,0,p,v).data;for(var ae=0;ae<g;ae+=4)switch(C=h[ae],S=h[ae+1],O=h[ae+2],F=h[ae+3],x=Q[ae],y=Q[ae+1],_=Q[ae+2],w=Q[ae+3],this.mode){case"multiply":h[ae]=C*x/255,h[ae+1]=S*y/255,h[ae+2]=O*_/255,h[ae+3]=F*w/255;break;case"mask":h[ae+3]=w;break}},getUniformLocations:function(l,o){return{uTransformMatrix:l.getUniformLocation(o,"uTransformMatrix"),uImage:l.getUniformLocation(o,"uImage")}},sendUniformData:function(l,o){var a=this.calculateMatrix();l.uniform1i(o.uImage,1),l.uniformMatrix3fv(o.uTransformMatrix,!1,a)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendImage.fromObject=function(l,o){s.Image.fromObject(l.image,function(a){var h=s.util.object.clone(l);h.image=a,o(new s.Image.filters.BlendImage(h))})}}(t),function(c){var s=c.fabric||(c.fabric={}),u=Math.pow,d=Math.floor,l=Math.sqrt,o=Math.abs,a=Math.round,h=Math.sin,g=Math.ceil,p=s.Image.filters,v=s.util.createClass;p.Resize=v(p.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(x,y){return{uDelta:x.getUniformLocation(y,"uDelta"),uTaps:x.getUniformLocation(y,"uTaps")}},sendUniformData:function(x,y){x.uniform2fv(y.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),x.uniform1fv(y.uTaps,this.taps)},retrieveShader:function(x){var y=this.getFilterWindow(),_=this.type+"_"+y;if(!x.programCache.hasOwnProperty(_)){var w=this.generateShader(y);x.programCache[_]=this.createProgram(x.context,w)}return x.programCache[_]},getFilterWindow:function(){var x=this.tempScale;return Math.ceil(this.lanczosLobes/x)},getTaps:function(){for(var x=this.lanczosCreate(this.lanczosLobes),y=this.tempScale,_=this.getFilterWindow(),w=new Array(_),C=1;C<=_;C++)w[C-1]=x(C*y);return w},generateShader:function(w){for(var y=new Array(w),_=this.fragmentSourceTOP,w,C=1;C<=w;C++)y[C-1]=C+".0 * uDelta";return _+="uniform float uTaps["+w+`];
`,_+=`void main() {
`,_+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,_+=`  float sum = 1.0;
`,y.forEach(function(S,O){_+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+O+`];
`,_+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+O+`];
`,_+="  sum += 2.0 * uTaps["+O+`];
`}),_+=`  gl_FragColor = color / sum;
`,_+="}",_},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(x){x.webgl?(x.passes++,this.width=x.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=x.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),x.destinationWidth=this.dW,this._setupFrameBuffer(x),this.applyToWebGL(x),this._swapTextures(x),x.sourceWidth=x.destinationWidth,this.height=x.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),x.destinationHeight=this.dH,this._setupFrameBuffer(x),this.applyToWebGL(x),this._swapTextures(x),x.sourceHeight=x.destinationHeight):this.applyTo2d(x)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(x){return function(y){if(y>=x||y<=-x)return 0;if(y<11920929e-14&&y>-11920929e-14)return 1;y*=Math.PI;var _=y/x;return h(y)/y*h(_)/_}},applyTo2d:function(x){var y=x.imageData,_=this.scaleX,w=this.scaleY;this.rcpScaleX=1/_,this.rcpScaleY=1/w;var C=y.width,S=y.height,O=a(C*_),F=a(S*w),N;this.resizeType==="sliceHack"?N=this.sliceByTwo(x,C,S,O,F):this.resizeType==="hermite"?N=this.hermiteFastResize(x,C,S,O,F):this.resizeType==="bilinear"?N=this.bilinearFiltering(x,C,S,O,F):this.resizeType==="lanczos"&&(N=this.lanczosResize(x,C,S,O,F)),x.imageData=N},sliceByTwo:function(x,y,_,w,C){var S=x.imageData,O=.5,F=!1,N=!1,W=y*O,X=_*O,Q=s.filterBackend.resources,ae,ne,J=0,oe=0,q=y,k=0;for(Q.sliceByTwo||(Q.sliceByTwo=document.createElement("canvas")),ae=Q.sliceByTwo,(ae.width<y*1.5||ae.height<_)&&(ae.width=y*1.5,ae.height=_),ne=ae.getContext("2d"),ne.clearRect(0,0,y*1.5,_),ne.putImageData(S,0,0),w=d(w),C=d(C);!F||!N;)y=W,_=X,w<d(W*O)?W=d(W*O):(W=w,F=!0),C<d(X*O)?X=d(X*O):(X=C,N=!0),ne.drawImage(ae,J,oe,y,_,q,k,W,X),J=q,oe=k,k+=X;return ne.getImageData(J,oe,w,C)},lanczosResize:function(x,y,_,w,C){function S(L){var E,b,A,T,R,z,K,H,G,ue,le;for(k.x=(L+.5)*X,D.x=d(k.x),E=0;E<C;E++){for(k.y=(E+.5)*Q,D.y=d(k.y),R=0,z=0,K=0,H=0,G=0,b=D.x-J;b<=D.x+J;b++)if(!(b<0||b>=y)){ue=d(1e3*o(b-k.x)),q[ue]||(q[ue]={});for(var ee=D.y-oe;ee<=D.y+oe;ee++)ee<0||ee>=_||(le=d(1e3*o(ee-k.y)),q[ue][le]||(q[ue][le]=W(l(u(ue*ae,2)+u(le*ne,2))/1e3)),A=q[ue][le],A>0&&(T=(ee*y+b)*4,R+=A,z+=A*O[T],K+=A*O[T+1],H+=A*O[T+2],G+=A*O[T+3]))}T=(E*w+L)*4,N[T]=z/R,N[T+1]=K/R,N[T+2]=H/R,N[T+3]=G/R}return++L<w?S(L):F}var O=x.imageData.data,F=x.ctx.createImageData(w,C),N=F.data,W=this.lanczosCreate(this.lanczosLobes),X=this.rcpScaleX,Q=this.rcpScaleY,ae=2/this.rcpScaleX,ne=2/this.rcpScaleY,J=g(X*this.lanczosLobes/2),oe=g(Q*this.lanczosLobes/2),q={},k={},D={};return S(0)},bilinearFiltering:function(x,y,_,w,C){var S,O,F,N,W,X,Q,ae,ne,J,oe,q,k=0,D,L=this.rcpScaleX,E=this.rcpScaleY,b=4*(y-1),A=x.imageData,T=A.data,R=x.ctx.createImageData(w,C),z=R.data;for(Q=0;Q<C;Q++)for(ae=0;ae<w;ae++)for(W=d(L*ae),X=d(E*Q),ne=L*ae-W,J=E*Q-X,D=4*(X*y+W),oe=0;oe<4;oe++)S=T[D+oe],O=T[D+4+oe],F=T[D+b+oe],N=T[D+b+4+oe],q=S*(1-ne)*(1-J)+O*ne*(1-J)+F*J*(1-ne)+N*ne*J,z[k++]=q;return R},hermiteFastResize:function(x,y,_,w,C){for(var S=this.rcpScaleX,O=this.rcpScaleY,F=g(S/2),N=g(O/2),W=x.imageData,X=W.data,Q=x.ctx.createImageData(w,C),ae=Q.data,ne=0;ne<C;ne++)for(var J=0;J<w;J++){for(var oe=(J+ne*w)*4,q=0,k=0,D=0,L=0,E=0,b=0,A=0,T=(ne+.5)*O,R=d(ne*O);R<(ne+1)*O;R++)for(var z=o(T-(R+.5))/N,K=(J+.5)*S,H=z*z,G=d(J*S);G<(J+1)*S;G++){var ue=o(K-(G+.5))/F,le=l(H+ue*ue);le>1&&le<-1||(q=2*le*le*le-3*le*le+1,q>0&&(ue=4*(G+R*y),A+=q*X[ue+3],D+=q,X[ue+3]<255&&(q=q*X[ue+3]/250),L+=q*X[ue],E+=q*X[ue+1],b+=q*X[ue+2],k+=q))}ae[oe]=L/k,ae[oe+1]=E/k,ae[oe+2]=b/k,ae[oe+3]=A/D}return Q},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),s.Image.filters.Resize.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Contrast=d(u.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(l){if(this.contrast!==0){var o=l.imageData,a,g,h=o.data,g=h.length,p=Math.floor(this.contrast*255),v=259*(p+255)/(255*(259-p));for(a=0;a<g;a+=4)h[a]=v*(h[a]-128)+128,h[a+1]=v*(h[a+1]-128)+128,h[a+2]=v*(h[a+2]-128)+128}},getUniformLocations:function(l,o){return{uContrast:l.getUniformLocation(o,"uContrast")}},sendUniformData:function(l,o){l.uniform1f(o.uContrast,this.contrast)}}),s.Image.filters.Contrast.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Saturation=d(u.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(l){if(this.saturation!==0){var o=l.imageData,a=o.data,h=a.length,g=-this.saturation,p,v;for(p=0;p<h;p+=4)v=Math.max(a[p],a[p+1],a[p+2]),a[p]+=v!==a[p]?(v-a[p])*g:0,a[p+1]+=v!==a[p+1]?(v-a[p+1])*g:0,a[p+2]+=v!==a[p+2]?(v-a[p+2])*g:0}},getUniformLocations:function(l,o){return{uSaturation:l.getUniformLocation(o,"uSaturation")}},sendUniformData:function(l,o){l.uniform1f(o.uSaturation,-this.saturation)}}),s.Image.filters.Saturation.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Vibrance=d(u.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(l){if(this.vibrance!==0){var o=l.imageData,a=o.data,h=a.length,g=-this.vibrance,p,v,x,y;for(p=0;p<h;p+=4)v=Math.max(a[p],a[p+1],a[p+2]),x=(a[p]+a[p+1]+a[p+2])/3,y=Math.abs(v-x)*2/255*g,a[p]+=v!==a[p]?(v-a[p])*y:0,a[p+1]+=v!==a[p+1]?(v-a[p+1])*y:0,a[p+2]+=v!==a[p+2]?(v-a[p+2])*y:0}},getUniformLocations:function(l,o){return{uVibrance:l.getUniformLocation(o,"uVibrance")}},sendUniformData:function(l,o){l.uniform1f(o.uVibrance,-this.vibrance)}}),s.Image.filters.Vibrance.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Blur=d(u.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(l){l.webgl?(this.aspectRatio=l.sourceWidth/l.sourceHeight,l.passes++,this._setupFrameBuffer(l),this.horizontal=!0,this.applyToWebGL(l),this._swapTextures(l),this._setupFrameBuffer(l),this.horizontal=!1,this.applyToWebGL(l),this._swapTextures(l)):this.applyTo2d(l)},applyTo2d:function(l){l.imageData=this.simpleBlur(l)},simpleBlur:function(l){var o=l.filterBackend.resources,a,h,g=l.imageData.width,p=l.imageData.height;o.blurLayer1||(o.blurLayer1=s.util.createCanvasElement(),o.blurLayer2=s.util.createCanvasElement()),a=o.blurLayer1,h=o.blurLayer2,(a.width!==g||a.height!==p)&&(h.width=a.width=g,h.height=a.height=p);var v=a.getContext("2d"),x=h.getContext("2d"),y=15,_,w,C,S,O=this.blur*.06*.5;for(v.putImageData(l.imageData,0,0),x.clearRect(0,0,g,p),S=-y;S<=y;S++)_=(Math.random()-.5)/4,w=S/y,C=O*w*g+_,x.globalAlpha=1-Math.abs(w),x.drawImage(a,C,_),v.drawImage(h,0,0),x.globalAlpha=1,x.clearRect(0,0,h.width,h.height);for(S=-y;S<=y;S++)_=(Math.random()-.5)/4,w=S/y,C=O*w*p+_,x.globalAlpha=1-Math.abs(w),x.drawImage(a,_,C),v.drawImage(h,0,0),x.globalAlpha=1,x.clearRect(0,0,h.width,h.height);l.ctx.drawImage(a,0,0);var F=l.ctx.getImageData(0,0,a.width,a.height);return v.globalAlpha=1,v.clearRect(0,0,a.width,a.height),F},getUniformLocations:function(l,o){return{delta:l.getUniformLocation(o,"uDelta")}},sendUniformData:function(l,o){var a=this.chooseRightDelta();l.uniform2fv(o.delta,a)},chooseRightDelta:function(){var l=1,o=[0,0],a;return this.horizontal?this.aspectRatio>1&&(l=1/this.aspectRatio):this.aspectRatio<1&&(l=this.aspectRatio),a=l*this.blur*.12,this.horizontal?o[0]=a:o[1]=a,o}}),u.Blur.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Gamma=d(u.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(l){this.gamma=[1,1,1],u.BaseFilter.prototype.initialize.call(this,l)},applyTo2d:function(l){var o=l.imageData,a=o.data,h=this.gamma,g=a.length,p=1/h[0],v=1/h[1],x=1/h[2],y;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),y=0,g=256;y<g;y++)this.rVals[y]=Math.pow(y/255,p)*255,this.gVals[y]=Math.pow(y/255,v)*255,this.bVals[y]=Math.pow(y/255,x)*255;for(y=0,g=a.length;y<g;y+=4)a[y]=this.rVals[a[y]],a[y+1]=this.gVals[a[y+1]],a[y+2]=this.bVals[a[y+2]]},getUniformLocations:function(l,o){return{uGamma:l.getUniformLocation(o,"uGamma")}},sendUniformData:function(l,o){l.uniform3fv(o.uGamma,this.gamma)}}),s.Image.filters.Gamma.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.Composed=d(u.BaseFilter,{type:"Composed",subFilters:[],initialize:function(l){this.callSuper("initialize",l),this.subFilters=this.subFilters.slice(0)},applyTo:function(l){l.passes+=this.subFilters.length-1,this.subFilters.forEach(function(o){o.applyTo(l)})},toObject:function(){return s.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(l){return l.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(l){return!l.isNeutralState()})}}),s.Image.filters.Composed.fromObject=function(l,o){var a=l.subFilters||[],h=a.map(function(p){return new s.Image.filters[p.type](p)}),g=new s.Image.filters.Composed({subFilters:h});return o&&o(g),g}}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.Image.filters,d=s.util.createClass;u.HueRotation=d(u.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var l=this.rotation*Math.PI,o=s.util.cos(l),a=s.util.sin(l),h=1/3,g=Math.sqrt(h)*a,p=1-o;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=o+p/3,this.matrix[1]=h*p-g,this.matrix[2]=h*p+g,this.matrix[5]=h*p+g,this.matrix[6]=o+h*p,this.matrix[7]=h*p-g,this.matrix[10]=h*p-g,this.matrix[11]=h*p+g,this.matrix[12]=o+h*p},isNeutralState:function(l){return this.calculateMatrix(),u.BaseFilter.prototype.isNeutralState.call(this,l)},applyTo:function(l){this.calculateMatrix(),u.BaseFilter.prototype.applyTo.call(this,l)}}),s.Image.filters.HueRotation.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(c){var s=c.fabric||(c.fabric={}),u=s.util.object.clone;if(s.Text){s.warn("fabric.Text is already defined");return}var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");s.Text=s.util.createClass(s.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:s.Object.prototype.stateProperties.concat(d),cacheProperties:s.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(l,o){this.styles=o?o.styles||{}:{},this.text=l,this.__skipDimension=!0,this.callSuper("initialize",o),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var l=this.path;l&&(l.segmentsInfo=s.util.getPathSegmentsInfo(l.path))},getMeasuringContext:function(){return s._measuringContext||(s._measuringContext=this.canvas&&this.canvas.contextCache||s.util.createCanvasElement().getContext("2d")),s._measuringContext},_splitText:function(){var l=this._splitTextIntoLines(this.text);return this.textLines=l.lines,this._textLines=l.graphemeLines,this._unwrappedTextLines=l._unwrappedLines,this._text=l.graphemeText,l},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var l,o,a,h,g,p,v,x=0,y=this._textLines.length;x<y;x++)if(!(this.textAlign!=="justify"&&(x===y-1||this.isEndOfWrapping(x)))&&(h=0,g=this._textLines[x],o=this.getLineWidth(x),o<this.width&&(v=this.textLines[x].match(this._reSpacesAndTabs)))){a=v.length,l=(this.width-o)/a;for(var _=0,w=g.length;_<=w;_++)p=this.__charBounds[x][_],this._reSpaceAndTab.test(g[_])?(p.width+=l,p.kernedWidth+=l,p.left+=h,h+=l):p.left+=h}},isEndOfWrapping:function(l){return l===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var l=this.callSuper("_getCacheCanvasDimensions"),o=this.fontSize;return l.width+=o*l.zoomX,l.height+=o*l.zoomY,l},_render:function(l){var o=this.path;o&&!o.isNotVisible()&&o._render(l),this._setTextStyles(l),this._renderTextLinesBackground(l),this._renderTextDecoration(l,"underline"),this._renderText(l),this._renderTextDecoration(l,"overline"),this._renderTextDecoration(l,"linethrough")},_renderText:function(l){this.paintFirst==="stroke"?(this._renderTextStroke(l),this._renderTextFill(l)):(this._renderTextFill(l),this._renderTextStroke(l))},_setTextStyles:function(l,o,a){if(l.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":l.textBaseline="middle";break;case"ascender":l.textBaseline="top";break;case"descender":l.textBaseline="bottom";break}l.font=this._getFontDeclaration(o,a)},calcTextWidth:function(){for(var l=this.getLineWidth(0),o=1,a=this._textLines.length;o<a;o++){var h=this.getLineWidth(o);h>l&&(l=h)}return l},_renderTextLine:function(l,o,a,h,g,p){this._renderChars(l,o,a,h,g,p)},_renderTextLinesBackground:function(l){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var o,a,h=l.fillStyle,g,p,v=this._getLeftOffset(),x=this._getTopOffset(),y=0,_=0,w,C,S=this.path,O,F=0,N=this._textLines.length;F<N;F++){if(o=this.getHeightOfLine(F),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",F)){x+=o;continue}g=this._textLines[F],a=this._getLineLeftOffset(F),_=0,y=0,p=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var W=0,X=g.length;W<X;W++)w=this.__charBounds[F][W],C=this.getValueOfPropertyAt(F,W,"textBackgroundColor"),S?(l.save(),l.translate(w.renderLeft,w.renderTop),l.rotate(w.angle),l.fillStyle=C,C&&l.fillRect(-w.width/2,-o/this.lineHeight*(1-this._fontSizeFraction),w.width,o/this.lineHeight),l.restore()):C!==p?(O=v+a+y,this.direction==="rtl"&&(O=this.width-O-_),l.fillStyle=p,p&&l.fillRect(O,x,_,o/this.lineHeight),y=w.left,_=w.width,p=C):_+=w.kernedWidth;C&&!S&&(O=v+a+y,this.direction==="rtl"&&(O=this.width-O-_),l.fillStyle=C,l.fillRect(O,x,_,o/this.lineHeight)),x+=o}l.fillStyle=h,this._removeShadow(l)}},getFontCache:function(l){var o=l.fontFamily.toLowerCase();s.charWidthsCache[o]||(s.charWidthsCache[o]={});var a=s.charWidthsCache[o],h=l.fontStyle.toLowerCase()+"_"+(l.fontWeight+"").toLowerCase();return a[h]||(a[h]={}),a[h]},_measureChar:function(l,o,a,h){var g=this.getFontCache(o),p=this._getFontDeclaration(o),v=this._getFontDeclaration(h),x=a+l,y=p===v,_,w,C,S=o.fontSize/this.CACHE_FONT_SIZE,O;if(a&&g[a]!==void 0&&(C=g[a]),g[l]!==void 0&&(O=_=g[l]),y&&g[x]!==void 0&&(w=g[x],O=w-C),_===void 0||C===void 0||w===void 0){var F=this.getMeasuringContext();this._setTextStyles(F,o,!0)}return _===void 0&&(O=_=F.measureText(l).width,g[l]=_),C===void 0&&y&&a&&(C=F.measureText(a).width,g[a]=C),y&&w===void 0&&(w=F.measureText(x).width,g[x]=w,O=w-C),{width:_*S,kernedWidth:O*S}},getHeightOfChar:function(l,o){return this.getValueOfPropertyAt(l,o,"fontSize")},measureLine:function(l){var o=this._measureLine(l);return this.charSpacing!==0&&(o.width-=this._getWidthOfCharSpacing()),o.width<0&&(o.width=0),o},_measureLine:function(l){var o=0,a,h,g=this._textLines[l],p,v,x=0,y=new Array(g.length),_=0,w,C,S=this.path,O=this.pathSide==="right";for(this.__charBounds[l]=y,a=0;a<g.length;a++)h=g[a],v=this._getGraphemeBox(h,l,a,p),y[a]=v,o+=v.kernedWidth,p=h;if(y[a]={left:v?v.left+v.width:0,width:0,kernedWidth:0,height:this.fontSize},S){switch(C=S.segmentsInfo[S.segmentsInfo.length-1].length,w=s.util.getPointOnPath(S.path,0,S.segmentsInfo),w.x+=S.pathOffset.x,w.y+=S.pathOffset.y,this.textAlign){case"left":_=O?C-o:0;break;case"center":_=(C-o)/2;break;case"right":_=O?0:C-o;break}for(_+=this.pathStartOffset*(O?-1:1),a=O?g.length-1:0;O?a>=0:a<g.length;O?a--:a++)v=y[a],_>C?_%=C:_<0&&(_+=C),this._setGraphemeOnPath(_,v,w),_+=v.kernedWidth}return{width:o,numOfSpaces:x}},_setGraphemeOnPath:function(l,o,a){var h=l+o.kernedWidth/2,g=this.path,p=s.util.getPointOnPath(g.path,h,g.segmentsInfo);o.renderLeft=p.x-a.x,o.renderTop=p.y-a.y,o.angle=p.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(l,o,a,h,g){var p=this.getCompleteStyleDeclaration(o,a),v=h?this.getCompleteStyleDeclaration(o,a-1):{},x=this._measureChar(l,p,h,v),y=x.kernedWidth,_=x.width,w;this.charSpacing!==0&&(w=this._getWidthOfCharSpacing(),_+=w,y+=w);var C={width:_,left:0,height:p.fontSize,kernedWidth:y,deltaY:p.deltaY};if(a>0&&!g){var S=this.__charBounds[o][a-1];C.left=S.left+S.width+x.kernedWidth-x.width}return C},getHeightOfLine:function(l){if(this.__lineHeights[l])return this.__lineHeights[l];for(var o=this._textLines[l],a=this.getHeightOfChar(l,0),h=1,g=o.length;h<g;h++)a=Math.max(this.getHeightOfChar(l,h),a);return this.__lineHeights[l]=a*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var l,o=0,a=0,h=this._textLines.length;a<h;a++)l=this.getHeightOfLine(a),o+=a===h-1?l/this.lineHeight:l;return o},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(l,o){l.save();for(var a=0,h=this._getLeftOffset(),g=this._getTopOffset(),p=0,v=this._textLines.length;p<v;p++){var x=this.getHeightOfLine(p),y=x/this.lineHeight,_=this._getLineLeftOffset(p);this._renderTextLine(o,l,this._textLines[p],h+_,g+a+y,p),a+=x}l.restore()},_renderTextFill:function(l){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(l,"fillText")},_renderTextStroke:function(l){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this._setLineDash(l,this.strokeDashArray),l.beginPath(),this._renderTextCommon(l,"strokeText"),l.closePath(),l.restore())},_renderChars:function(l,o,a,h,g,p){var v=this.getHeightOfLine(p),x=this.textAlign.indexOf("justify")!==-1,y,_,w="",C,S=0,O,F=this.path,N=!x&&this.charSpacing===0&&this.isEmptyStyles(p)&&!F,W=this.direction==="ltr",X=this.direction==="ltr"?1:-1,Q,ae=o.canvas.getAttribute("dir");if(o.save(),ae!==this.direction&&(o.canvas.setAttribute("dir",W?"ltr":"rtl"),o.direction=W?"ltr":"rtl",o.textAlign=W?"left":"right"),g-=v*this._fontSizeFraction/this.lineHeight,N){this._renderChar(l,o,p,0,a.join(""),h,g,v),o.restore();return}for(var ne=0,J=a.length-1;ne<=J;ne++)O=ne===J||this.charSpacing||F,w+=a[ne],C=this.__charBounds[p][ne],S===0?(h+=X*(C.kernedWidth-C.width),S+=C.width):S+=C.kernedWidth,x&&!O&&this._reSpaceAndTab.test(a[ne])&&(O=!0),O||(y=y||this.getCompleteStyleDeclaration(p,ne),_=this.getCompleteStyleDeclaration(p,ne+1),O=s.util.hasStyleChanged(y,_,!1)),O&&(F?(o.save(),o.translate(C.renderLeft,C.renderTop),o.rotate(C.angle),this._renderChar(l,o,p,ne,w,-S/2,0,v),o.restore()):(Q=h,this._renderChar(l,o,p,ne,w,Q,g,v)),w="",y=_,h+=X*S,S=0);o.restore()},_applyPatternGradientTransformText:function(l){var o=s.util.createCanvasElement(),a,h=this.width+this.strokeWidth,g=this.height+this.strokeWidth;return o.width=h,o.height=g,a=o.getContext("2d"),a.beginPath(),a.moveTo(0,0),a.lineTo(h,0),a.lineTo(h,g),a.lineTo(0,g),a.closePath(),a.translate(h/2,g/2),a.fillStyle=l.toLive(a),this._applyPatternGradientTransform(a,l),a.fill(),a.createPattern(o,"no-repeat")},handleFiller:function(l,o,a){var h,g;return a.toLive?a.gradientUnits==="percentage"||a.gradientTransform||a.patternTransform?(h=-this.width/2,g=-this.height/2,l.translate(h,g),l[o]=this._applyPatternGradientTransformText(a),{offsetX:h,offsetY:g}):(l[o]=a.toLive(l,this),this._applyPatternGradientTransform(l,a)):(l[o]=a,{offsetX:0,offsetY:0})},_setStrokeStyles:function(l,o){return l.lineWidth=o.strokeWidth,l.lineCap=this.strokeLineCap,l.lineDashOffset=this.strokeDashOffset,l.lineJoin=this.strokeLineJoin,l.miterLimit=this.strokeMiterLimit,this.handleFiller(l,"strokeStyle",o.stroke)},_setFillStyles:function(l,o){return this.handleFiller(l,"fillStyle",o.fill)},_renderChar:function(l,o,a,h,g,p,v){var x=this._getStyleDeclaration(a,h),y=this.getCompleteStyleDeclaration(a,h),_=l==="fillText"&&y.fill,w=l==="strokeText"&&y.stroke&&y.strokeWidth,C,S;!w&&!_||(o.save(),_&&(C=this._setFillStyles(o,y)),w&&(S=this._setStrokeStyles(o,y)),o.font=this._getFontDeclaration(y),x&&x.textBackgroundColor&&this._removeShadow(o),x&&x.deltaY&&(v+=x.deltaY),_&&o.fillText(g,p-C.offsetX,v-C.offsetY),w&&o.strokeText(g,p-S.offsetX,v-S.offsetY),o.restore())},setSuperscript:function(l,o){return this._setScript(l,o,this.superscript)},setSubscript:function(l,o){return this._setScript(l,o,this.subscript)},_setScript:function(l,o,a){var h=this.get2DCursorLocation(l,!0),g=this.getValueOfPropertyAt(h.lineIndex,h.charIndex,"fontSize"),p=this.getValueOfPropertyAt(h.lineIndex,h.charIndex,"deltaY"),v={fontSize:g*a.size,deltaY:p+g*a.baseline};return this.setSelectionStyles(v,l,o),this},_getLineLeftOffset:function(l){var o=this.getLineWidth(l),a=this.width-o,h=this.textAlign,g=this.direction,v,p=0,v=this.isEndOfWrapping(l);return h==="justify"||h==="justify-center"&&!v||h==="justify-right"&&!v||h==="justify-left"&&!v?0:(h==="center"&&(p=a/2),h==="right"&&(p=a),h==="justify-center"&&(p=a/2),h==="justify-right"&&(p=a),g==="rtl"&&(p-=a),p)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var l=this._forceClearCache;return l||(l=this.hasStateChanged("_dimensionAffectingProps")),l&&(this.dirty=!0,this._forceClearCache=!1),l},getLineWidth:function(l){if(this.__lineWidths[l]!==void 0)return this.__lineWidths[l];var o=this.measureLine(l),a=o.width;return this.__lineWidths[l]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(l,o,a){var h=this._getStyleDeclaration(l,o);return h&&typeof h[a]<"u"?h[a]:this[a]},_renderTextDecoration:function(l,o){if(!(!this[o]&&!this.styleHas(o))){for(var a,h,g,p,v,x,y,_,w=this._getLeftOffset(),C=this._getTopOffset(),S,O,F,N,W,X,Q,ae,ne=this.path,J=this._getWidthOfCharSpacing(),oe=this.offsets[o],q=0,k=this._textLines.length;q<k;q++){if(a=this.getHeightOfLine(q),!this[o]&&!this.styleHas(o,q)){C+=a;continue}y=this._textLines[q],X=a/this.lineHeight,p=this._getLineLeftOffset(q),O=0,F=0,_=this.getValueOfPropertyAt(q,0,o),ae=this.getValueOfPropertyAt(q,0,"fill"),S=C+X*(1-this._fontSizeFraction),h=this.getHeightOfChar(q,0),v=this.getValueOfPropertyAt(q,0,"deltaY");for(var D=0,L=y.length;D<L;D++)if(N=this.__charBounds[q][D],W=this.getValueOfPropertyAt(q,D,o),Q=this.getValueOfPropertyAt(q,D,"fill"),g=this.getHeightOfChar(q,D),x=this.getValueOfPropertyAt(q,D,"deltaY"),ne&&W&&Q)l.save(),l.fillStyle=ae,l.translate(N.renderLeft,N.renderTop),l.rotate(N.angle),l.fillRect(-N.kernedWidth/2,oe*g+x,N.kernedWidth,this.fontSize/15),l.restore();else if((W!==_||Q!==ae||g!==h||x!==v)&&F>0){var E=w+p+O;this.direction==="rtl"&&(E=this.width-E-F),_&&ae&&(l.fillStyle=ae,l.fillRect(E,S+oe*h+v,F,this.fontSize/15)),O=N.left,F=N.width,_=W,ae=Q,h=g,v=x}else F+=N.kernedWidth;var E=w+p+O;this.direction==="rtl"&&(E=this.width-E-F),l.fillStyle=Q,W&&Q&&l.fillRect(E,S+oe*h+v,F-J,this.fontSize/15),C+=a}this._removeShadow(l)}},_getFontDeclaration:function(l,o){var a=l||this,h=this.fontFamily,g=s.Text.genericFonts.indexOf(h.toLowerCase())>-1,p=h===void 0||h.indexOf("'")>-1||h.indexOf(",")>-1||h.indexOf('"')>-1||g?a.fontFamily:'"'+a.fontFamily+'"';return[s.isLikelyNode?a.fontWeight:a.fontStyle,s.isLikelyNode?a.fontStyle:a.fontWeight,o?this.CACHE_FONT_SIZE+"px":a.fontSize+"px",p].join(" ")},render:function(l){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",l)))},_splitTextIntoLines:function(l){for(var o=l.split(this._reNewline),a=new Array(o.length),h=[`
`],g=[],p=0;p<o.length;p++)a[p]=s.util.string.graphemeSplit(o[p]),g=g.concat(a[p],h);return g.pop(),{_unwrappedLines:a,lines:o,graphemeText:g,graphemeLines:a}},toObject:function(l){var o=d.concat(l),a=this.callSuper("toObject",o);return a.styles=s.util.stylesToArray(this.styles,this.text),a.path&&(a.path=this.path.toObject()),a},set:function(l,o){this.callSuper("set",l,o);var a=!1,h=!1;if(typeof l=="object")for(var g in l)g==="path"&&this.setPathInfo(),a=a||this._dimensionAffectingProps.indexOf(g)!==-1,h=h||g==="path";else a=this._dimensionAffectingProps.indexOf(l)!==-1,h=l==="path";return h&&this.setPathInfo(),a&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),s.Text.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),s.Text.DEFAULT_SVG_FONT_SIZE=16,s.Text.fromElement=function(l,o,a){if(!l)return o(null);var h=s.parseAttributes(l,s.Text.ATTRIBUTE_NAMES),g=h.textAnchor||"left";if(a=s.util.object.extend(a?u(a):{},h),a.top=a.top||0,a.left=a.left||0,h.textDecoration){var p=h.textDecoration;p.indexOf("underline")!==-1&&(a.underline=!0),p.indexOf("overline")!==-1&&(a.overline=!0),p.indexOf("line-through")!==-1&&(a.linethrough=!0),delete a.textDecoration}"dx"in h&&(a.left+=h.dx),"dy"in h&&(a.top+=h.dy),"fontSize"in a||(a.fontSize=s.Text.DEFAULT_SVG_FONT_SIZE);var v="";"textContent"in l?v=l.textContent:"firstChild"in l&&l.firstChild!==null&&"data"in l.firstChild&&l.firstChild.data!==null&&(v=l.firstChild.data),v=v.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var x=a.strokeWidth;a.strokeWidth=0;var y=new s.Text(v,a),_=y.getScaledHeight()/y.height,w=(y.height+y.strokeWidth)*y.lineHeight-y.height,C=w*_,S=y.getScaledHeight()+C,O=0;g==="center"&&(O=y.getScaledWidth()/2),g==="right"&&(O=y.getScaledWidth()),y.set({left:y.left-O,top:y.top-(S-y.fontSize*(.07+y._fontSizeFraction))/y.lineHeight,strokeWidth:typeof x<"u"?x:1}),o(y)},s.Text.fromObject=function(l,o){var a=u(l),h=l.path;return delete a.path,s.Object._fromObject("Text",a,function(g){g.styles=s.util.stylesFromArray(l.styles,l.text),h?s.Object._fromObject("Path",h,function(p){g.set("path",p),o(g)},"path"):o(g)},"text")},s.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],s.util.createAccessors&&s.util.createAccessors(s.Text)}(t),function(){e.util.object.extend(e.Text.prototype,{isEmptyStyles:function(c){if(!this.styles||typeof c<"u"&&!this.styles[c])return!0;var s=typeof c>"u"?this.styles:{line:this.styles[c]};for(var u in s)for(var d in s[u])for(var l in s[u][d])return!1;return!0},styleHas:function(c,s){if(!this.styles||!c||c===""||typeof s<"u"&&!this.styles[s])return!1;var u=typeof s>"u"?this.styles:{0:this.styles[s]};for(var d in u)for(var l in u[d])if(typeof u[d][l][c]<"u")return!0;return!1},cleanStyle:function(c){if(!this.styles||!c||c==="")return!1;var s=this.styles,u=0,d,l,o=!0,a=0,h;for(var g in s){d=0;for(var p in s[g]){var h=s[g][p],v=h.hasOwnProperty(c);u++,v?(l?h[c]!==l&&(o=!1):l=h[c],h[c]===this[c]&&delete h[c]):o=!1,Object.keys(h).length!==0?d++:delete s[g][p]}d===0&&delete s[g]}for(var x=0;x<this._textLines.length;x++)a+=this._textLines[x].length;o&&u===a&&(this[c]=l,this.removeStyle(c))},removeStyle:function(c){if(!(!this.styles||!c||c==="")){var s=this.styles,u,d,l;for(d in s){u=s[d];for(l in u)delete u[l][c],Object.keys(u[l]).length===0&&delete u[l];Object.keys(u).length===0&&delete s[d]}}},_extendStyles:function(c,s){var u=this.get2DCursorLocation(c);this._getLineStyle(u.lineIndex)||this._setLineStyle(u.lineIndex),this._getStyleDeclaration(u.lineIndex,u.charIndex)||this._setStyleDeclaration(u.lineIndex,u.charIndex,{}),e.util.object.extend(this._getStyleDeclaration(u.lineIndex,u.charIndex),s)},get2DCursorLocation:function(c,s){typeof c>"u"&&(c=this.selectionStart);for(var u=s?this._unwrappedTextLines:this._textLines,d=u.length,l=0;l<d;l++){if(c<=u[l].length)return{lineIndex:l,charIndex:c};c-=u[l].length+this.missingNewlineOffset(l)}return{lineIndex:l-1,charIndex:u[l-1].length<c?u[l-1].length:c}},getSelectionStyles:function(c,s,u){typeof c>"u"&&(c=this.selectionStart||0),typeof s>"u"&&(s=this.selectionEnd||c);for(var d=[],l=c;l<s;l++)d.push(this.getStyleAtPosition(l,u));return d},getStyleAtPosition:function(c,s){var u=this.get2DCursorLocation(c),d=s?this.getCompleteStyleDeclaration(u.lineIndex,u.charIndex):this._getStyleDeclaration(u.lineIndex,u.charIndex);return d||{}},setSelectionStyles:function(c,s,u){typeof s>"u"&&(s=this.selectionStart||0),typeof u>"u"&&(u=this.selectionEnd||s);for(var d=s;d<u;d++)this._extendStyles(d,c);return this._forceClearCache=!0,this},_getStyleDeclaration:function(c,s){var u=this.styles&&this.styles[c];return u?u[s]:null},getCompleteStyleDeclaration:function(c,s){for(var u=this._getStyleDeclaration(c,s)||{},d={},l,o=0;o<this._styleProperties.length;o++)l=this._styleProperties[o],d[l]=typeof u[l]>"u"?this[l]:u[l];return d},_setStyleDeclaration:function(c,s,u){this.styles[c][s]=u},_deleteStyleDeclaration:function(c,s){delete this.styles[c][s]},_getLineStyle:function(c){return!!this.styles[c]},_setLineStyle:function(c){this.styles[c]={}},_deleteLineStyle:function(c){delete this.styles[c]}})}(),function(){function c(s){s.textDecoration&&(s.textDecoration.indexOf("underline")>-1&&(s.underline=!0),s.textDecoration.indexOf("line-through")>-1&&(s.linethrough=!0),s.textDecoration.indexOf("overline")>-1&&(s.overline=!0),delete s.textDecoration)}e.IText=e.util.createClass(e.Text,e.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(s,u){this.callSuper("initialize",s,u),this.initBehavior()},setSelectionStart:function(s){s=Math.max(s,0),this._updateAndFire("selectionStart",s)},setSelectionEnd:function(s){s=Math.min(s,this.text.length),this._updateAndFire("selectionEnd",s)},_updateAndFire:function(s,u){this[s]!==u&&(this._fireSelectionChanged(),this[s]=u),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(s){this.clearContextTop(),this.callSuper("render",s),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(s){this.callSuper("_render",s)},clearContextTop:function(s){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var u=this.canvas.contextTop,d=this.canvas.viewportTransform;u.save(),u.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(u),this._clearTextArea(u),s||u.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var s=this._getCursorBoundaries(),u=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(s,u):this.renderSelection(s,u),u.restore()}},_clearTextArea:function(s){var u=this.width+4,d=this.height+4;s.clearRect(-u/2,-d/2,u,d)},_getCursorBoundaries:function(s){typeof s>"u"&&(s=this.selectionStart);var u=this._getLeftOffset(),d=this._getTopOffset(),l=this._getCursorBoundariesOffsets(s);return{left:u,top:d,leftOffset:l.left,topOffset:l.top}},_getCursorBoundariesOffsets:function(s){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var u,d,l,o=0,a=0,h,g=this.get2DCursorLocation(s);l=g.charIndex,d=g.lineIndex;for(var p=0;p<d;p++)o+=this.getHeightOfLine(p);u=this._getLineLeftOffset(d);var v=this.__charBounds[d][l];return v&&(a=v.left),this.charSpacing!==0&&l===this._textLines[d].length&&(a-=this._getWidthOfCharSpacing()),h={top:o,left:u+(a>0?a:0)},this.direction==="rtl"&&(h.left*=-1),this.cursorOffsetCache=h,this.cursorOffsetCache},renderCursor:function(s,u){var d=this.get2DCursorLocation(),l=d.lineIndex,o=d.charIndex>0?d.charIndex-1:0,a=this.getValueOfPropertyAt(l,o,"fontSize"),h=this.scaleX*this.canvas.getZoom(),g=this.cursorWidth/h,p=s.topOffset,v=this.getValueOfPropertyAt(l,o,"deltaY");p+=(1-this._fontSizeFraction)*this.getHeightOfLine(l)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(s,u),u.fillStyle=this.cursorColor||this.getValueOfPropertyAt(l,o,"fill"),u.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,u.fillRect(s.left+s.leftOffset-g/2,p+s.top+v,g,a)},renderSelection:function(s,u){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,l=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,o=this.textAlign.indexOf("justify")!==-1,a=this.get2DCursorLocation(d),h=this.get2DCursorLocation(l),g=a.lineIndex,p=h.lineIndex,v=a.charIndex<0?0:a.charIndex,x=h.charIndex<0?0:h.charIndex,y=g;y<=p;y++){var _=this._getLineLeftOffset(y)||0,w=this.getHeightOfLine(y),C=0,S=0,O=0;if(y===g&&(S=this.__charBounds[g][v].left),y>=g&&y<p)O=o&&!this.isEndOfWrapping(y)?this.width:this.getLineWidth(y)||5;else if(y===p)if(x===0)O=this.__charBounds[p][x].left;else{var F=this._getWidthOfCharSpacing();O=this.__charBounds[p][x-1].left+this.__charBounds[p][x-1].width-F}C=w,(this.lineHeight<1||y===p&&this.lineHeight>1)&&(w/=this.lineHeight);var N=s.left+_+S,W=O-S,X=w,Q=0;this.inCompositionMode?(u.fillStyle=this.compositionColor||"black",X=1,Q=w):u.fillStyle=this.selectionColor,this.direction==="rtl"&&(N=this.width-N-W),u.fillRect(N,s.top+s.topOffset+Q,W,X),s.topOffset+=C}},getCurrentCharFontSize:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fontSize")},getCurrentCharColor:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fill")},_getCurrentCharIndex:function(){var s=this.get2DCursorLocation(this.selectionStart,!0),u=s.charIndex>0?s.charIndex-1:0;return{l:s.lineIndex,c:u}}}),e.IText.fromObject=function(s,u){var d=e.util.stylesFromArray(s.styles,s.text),l=Object.assign({},s,{styles:d});if(c(l),l.styles)for(var o in l.styles)for(var a in l.styles[o])c(l.styles[o][a]);e.Object._fromObject("IText",l,u,"text")}}(),function(){var c=e.util.object.clone;e.util.object.extend(e.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var s=this;this.on("added",function(){var u=s.canvas;u&&(u._hasITextHandlers||(u._hasITextHandlers=!0,s._initCanvasHandlers(u)),u._iTextInstances=u._iTextInstances||[],u._iTextInstances.push(s))})},initRemovedHandler:function(){var s=this;this.on("removed",function(){var u=s.canvas;u&&(u._iTextInstances=u._iTextInstances||[],e.util.removeFromArray(u._iTextInstances,s),u._iTextInstances.length===0&&(u._hasITextHandlers=!1,s._removeCanvasHandlers(u)))})},_initCanvasHandlers:function(s){s._mouseUpITextHandler=function(){s._iTextInstances&&s._iTextInstances.forEach(function(u){u.__isMousedown=!1})},s.on("mouse:up",s._mouseUpITextHandler)},_removeCanvasHandlers:function(s){s.off("mouse:up",s._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(s,u,d,l){var o;return o={isAborted:!1,abort:function(){this.isAborted=!0}},s.animate("_currentCursorOpacity",u,{duration:d,onComplete:function(){o.isAborted||s[l]()},onChange:function(){s.canvas&&s.selectionStart===s.selectionEnd&&s.renderCursorOrSelection()},abort:function(){return o.isAborted}}),o},_onTickComplete:function(){var s=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){s._currentTickCompleteState=s._animateCursor(s,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(s){var u=this,d=s?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){u._tick()},d)},abortCursorAnimation:function(){var s=this._currentTickState||this._currentTickCompleteState,u=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,s&&u&&u.clearContext(u.contextTop||u.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(s){var u=0,d=s-1;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)u++,d--;for(;/\S/.test(this._text[d])&&d>-1;)u++,d--;return s-u},findWordBoundaryRight:function(s){var u=0,d=s;if(this._reSpace.test(this._text[d]))for(;this._reSpace.test(this._text[d]);)u++,d++;for(;/\S/.test(this._text[d])&&d<this._text.length;)u++,d++;return s+u},findLineBoundaryLeft:function(s){for(var u=0,d=s-1;!/\n/.test(this._text[d])&&d>-1;)u++,d--;return s-u},findLineBoundaryRight:function(s){for(var u=0,d=s;!/\n/.test(this._text[d])&&d<this._text.length;)u++,d++;return s+u},searchWordBoundary:function(s,u){for(var d=this._text,l=this._reSpace.test(d[s])?s-1:s,o=d[l],a=e.reNonWord;!a.test(o)&&l>0&&l<d.length;)l+=u,o=d[l];return a.test(o)&&(l+=u===1?0:1),l},selectWord:function(s){s=s||this.selectionStart;var u=this.searchWordBoundary(s,-1),d=this.searchWordBoundary(s,1);this.selectionStart=u,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(s){s=s||this.selectionStart;var u=this.findLineBoundaryLeft(s),d=this.findLineBoundaryRight(s);return this.selectionStart=u,this.selectionEnd=d,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(s){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(s),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(s){s._iTextInstances&&s._iTextInstances.forEach(function(u){u.selected=!1,u.isEditing&&u.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(s){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var u=this.getSelectionStartFromPointer(s.e),d=this.selectionStart,l=this.selectionEnd;(u!==this.__selectionStartOnMouseDown||d===l)&&(d===u||l===u)||(u>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=u):(this.selectionStart=u,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==d||this.selectionEnd!==l)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(s,u,d){var l=d.slice(0,s),o=e.util.string.graphemeSplit(l).length;if(s===u)return{selectionStart:o,selectionEnd:o};var a=d.slice(s,u),h=e.util.string.graphemeSplit(a).length;return{selectionStart:o,selectionEnd:o+h}},fromGraphemeToStringSelection:function(s,u,d){var l=d.slice(0,s),o=l.join("").length;if(s===u)return{selectionStart:o,selectionEnd:o};var a=d.slice(s,u),h=a.join("").length;return{selectionStart:o,selectionEnd:o+h}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var s=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=s.selectionStart,this.hiddenTextarea.selectionEnd=s.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var s=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=s.selectionEnd,this.inCompositionMode||(this.selectionStart=s.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var s=this._calcTextareaPosition();this.hiddenTextarea.style.left=s.left,this.hiddenTextarea.style.top=s.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var s=this.inCompositionMode?this.compositionStart:this.selectionStart,u=this._getCursorBoundaries(s),d=this.get2DCursorLocation(s),l=d.lineIndex,o=d.charIndex,a=this.getValueOfPropertyAt(l,o,"fontSize")*this.lineHeight,h=u.leftOffset,g=this.calcTransformMatrix(),p={x:u.left+h,y:u.top+u.topOffset+a},v=this.canvas.getRetinaScaling(),x=this.canvas.upperCanvasEl,y=x.width/v,_=x.height/v,w=y-a,C=_-a,S=x.clientWidth/y,O=x.clientHeight/_;return p=e.util.transformPoint(p,g),p=e.util.transformPoint(p,this.canvas.viewportTransform),p.x*=S,p.y*=O,p.x<0&&(p.x=0),p.x>w&&(p.x=w),p.y<0&&(p.y=0),p.y>C&&(p.y=C),p.x+=this.canvas._offset.left,p.y+=this.canvas._offset.top,{left:p.x+"px",top:p.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var s=this._textBeforeEdit!==this.text,u=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,u&&(u.blur&&u.blur(),u.parentNode&&u.parentNode.removeChild(u)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),s&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),s&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var s in this.styles)this._textLines[s]||delete this.styles[s]},removeStyleFromTo:function(s,u){var d=this.get2DCursorLocation(s,!0),l=this.get2DCursorLocation(u,!0),o=d.lineIndex,a=d.charIndex,h=l.lineIndex,g=l.charIndex,p,v;if(o!==h){if(this.styles[o])for(p=a;p<this._unwrappedTextLines[o].length;p++)delete this.styles[o][p];if(this.styles[h])for(p=g;p<this._unwrappedTextLines[h].length;p++)v=this.styles[h][p],v&&(this.styles[o]||(this.styles[o]={}),this.styles[o][a+p-g]=v);for(p=o+1;p<=h;p++)delete this.styles[p];this.shiftLineStyles(h,o-h)}else if(this.styles[o]){v=this.styles[o];var x=g-a,y,_;for(p=a;p<g;p++)delete v[p];for(_ in this.styles[o])y=parseInt(_,10),y>=g&&(v[y-x]=v[_],delete v[_])}},shiftLineStyles:function(s,u){var d=c(this.styles);for(var l in this.styles){var o=parseInt(l,10);o>s&&(this.styles[o+u]=d[o],d[o-u]||delete this.styles[o])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(s,u,d,l){var o,a={},h=!1,g=this._unwrappedTextLines[s].length===u;d||(d=1),this.shiftLineStyles(s,d),this.styles[s]&&(o=this.styles[s][u===0?u:u-1]);for(var p in this.styles[s]){var v=parseInt(p,10);v>=u&&(h=!0,a[v-u]=this.styles[s][p],g&&u===0||delete this.styles[s][p])}var x=!1;for(h&&!g&&(this.styles[s+d]=a,x=!0),x&&d--;d>0;)l&&l[d-1]?this.styles[s+d]={0:c(l[d-1])}:o?this.styles[s+d]={0:c(o)}:delete this.styles[s+d],d--;this._forceClearCache=!0},insertCharStyleObject:function(s,u,d,l){this.styles||(this.styles={});var o=this.styles[s],a=o?c(o):{};d||(d=1);for(var h in a){var g=parseInt(h,10);g>=u&&(o[g+d]=a[g],a[g-d]||delete o[g])}if(this._forceClearCache=!0,l){for(;d--;)Object.keys(l[d]).length&&(this.styles[s]||(this.styles[s]={}),this.styles[s][u+d]=c(l[d]));return}if(o)for(var p=o[u?u-1:1];p&&d--;)this.styles[s][u+d]=c(p)},insertNewStyleBlock:function(s,u,d){for(var l=this.get2DCursorLocation(u,!0),o=[0],a=0,h=0;h<s.length;h++)s[h]===`
`?(a++,o[a]=0):o[a]++;o[0]>0&&(this.insertCharStyleObject(l.lineIndex,l.charIndex,o[0],d),d=d&&d.slice(o[0]+1)),a&&this.insertNewlineStyleObject(l.lineIndex,l.charIndex+o[0],a);for(var h=1;h<a;h++)o[h]>0?this.insertCharStyleObject(l.lineIndex+h,0,o[h],d):d&&this.styles[l.lineIndex+h]&&d[0]&&(this.styles[l.lineIndex+h][0]=d[0]),d=d&&d.slice(o[h]+1);o[h]>0&&this.insertCharStyleObject(l.lineIndex+h,0,o[h],d)},setSelectionStartEndWithShift:function(s,u,d){d<=s?(u===s?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=s),this.selectionStart=d):d>s&&d<u?this._selectionDirection==="right"?this.selectionEnd=d:this.selectionStart=d:(u===s?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=u),this.selectionEnd=d)},setSelectionInBoundaries:function(){var s=this.text.length;this.selectionStart>s?this.selectionStart=s:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>s?this.selectionEnd=s:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),e.util.object.extend(e.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(c){if(this.canvas){this.__newClickTime=+new Date;var s=c.pointer;this.isTripleClick(s)&&(this.fire("tripleclick",c),this._stopEvent(c.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=s,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(c){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===c.x&&this.__lastPointer.y===c.y},_stopEvent:function(c){c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(c){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(c.e))},tripleClickHandler:function(c){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(c.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(c){!this.canvas||!this.editable||c.e.button&&c.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(c.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(c){!this.canvas||!this.editable||c.e.button&&c.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(c){if(this.__isMousedown=!1,!(!this.editable||this.group||c.transform&&c.transform.actionPerformed||c.e.button&&c.e.button!==1)){if(this.canvas){var s=this.canvas._activeObject;if(s&&s!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(c.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(c){var s=this.getSelectionStartFromPointer(c),u=this.selectionStart,d=this.selectionEnd;c.shiftKey?this.setSelectionStartEndWithShift(u,d,s):(this.selectionStart=s,this.selectionEnd=s),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(c){for(var s=this.getLocalPointer(c),u=0,d=0,l=0,o=0,a=0,h,g,p=0,v=this._textLines.length;p<v&&l<=s.y;p++)l+=this.getHeightOfLine(p)*this.scaleY,a=p,p>0&&(o+=this._textLines[p-1].length+this.missingNewlineOffset(p-1));h=this._getLineLeftOffset(a),d=h*this.scaleX,g=this._textLines[a],this.direction==="rtl"&&(s.x=this.width*this.scaleX-s.x+d);for(var x=0,y=g.length;x<y&&(u=d,d+=this.__charBounds[a][x].kernedWidth*this.scaleX,d<=s.x);x++)o++;return this._getNewSelectionStartFromOffset(s,u,d,o,y)},_getNewSelectionStartFromOffset:function(c,s,u,d,l){var o=c.x-s,a=u-c.x,h=a>o||a<0?0:1,g=d+h;return this.flipX&&(g=l-g),g>this._text.length&&(g=this._text.length),g}}),e.util.object.extend(e.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=e.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var c=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+c.top+"; left: "+c.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+c.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):e.document.body.appendChild(this.hiddenTextarea),e.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),e.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),e.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),e.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),e.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),e.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(e.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(c){if(this.isEditing){var s=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(c.keyCode in s)this[s[c.keyCode]](c);else if(c.keyCode in this.ctrlKeysMapDown&&(c.ctrlKey||c.metaKey))this[this.ctrlKeysMapDown[c.keyCode]](c);else return;c.stopImmediatePropagation(),c.preventDefault(),c.keyCode>=33&&c.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(c){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(c.keyCode in this.ctrlKeysMapUp&&(c.ctrlKey||c.metaKey))this[this.ctrlKeysMapUp[c.keyCode]](c);else return;c.stopImmediatePropagation(),c.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(c){var s=this.fromPaste;if(this.fromPaste=!1,c&&c.stopPropagation(),!!this.isEditing){var u=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,l=u.length,o,a,h=l-d,g=this.selectionStart,p=this.selectionEnd,v=g!==p,x,y,_;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var w=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),C=g>w.selectionStart;v?(o=this._text.slice(g,p),h+=p-g):l<d&&(C?o=this._text.slice(p+h,p):o=this._text.slice(g,g-h)),a=u.slice(w.selectionEnd-h,w.selectionEnd),o&&o.length&&(a.length&&(x=this.getSelectionStyles(g,g+1,!1),x=a.map(function(){return x[0]})),v?(y=g,_=p):C?(y=p-o.length,_=p):(y=p,_=p+o.length),this.removeStyleFromTo(y,_)),a.length&&(s&&a.join("")===e.copiedText&&!e.disableStyleCopyPaste&&(x=e.copiedTextStyle),this.insertNewStyleBlock(a,g,x)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(c){this.compositionStart=c.target.selectionStart,this.compositionEnd=c.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(e.copiedText=this.getSelectedText(),e.disableStyleCopyPaste?e.copiedTextStyle=null:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(c){return c&&c.clipboardData||e.window.clipboardData},_getWidthBeforeCursor:function(c,s){var u=this._getLineLeftOffset(c),d;return s>0&&(d=this.__charBounds[c][s-1],u+=d.left+d.width),u},getDownCursorOffset:function(c,s){var u=this._getSelectionForOffset(c,s),d=this.get2DCursorLocation(u),l=d.lineIndex;if(l===this._textLines.length-1||c.metaKey||c.keyCode===34)return this._text.length-u;var o=d.charIndex,a=this._getWidthBeforeCursor(l,o),h=this._getIndexOnLine(l+1,a),g=this._textLines[l].slice(o);return g.length+h+1+this.missingNewlineOffset(l)},_getSelectionForOffset:function(c,s){return c.shiftKey&&this.selectionStart!==this.selectionEnd&&s?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(c,s){var u=this._getSelectionForOffset(c,s),d=this.get2DCursorLocation(u),l=d.lineIndex;if(l===0||c.metaKey||c.keyCode===33)return-u;var o=d.charIndex,a=this._getWidthBeforeCursor(l,o),h=this._getIndexOnLine(l-1,a),g=this._textLines[l].slice(0,o),p=this.missingNewlineOffset(l-1);return-this._textLines[l-1].length+h-g.length+(1-p)},_getIndexOnLine:function(c,s){for(var u=this._textLines[c],d=this._getLineLeftOffset(c),l=d,o=0,a,h,g=0,p=u.length;g<p;g++)if(a=this.__charBounds[c][g].width,l+=a,l>s){h=!0;var v=l-a,x=l,y=Math.abs(v-s),_=Math.abs(x-s);o=_<y?g:g-1;break}return h||(o=u.length-1),o},moveCursorDown:function(c){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",c)},moveCursorUp:function(c){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",c)},_moveCursorUpOrDown:function(c,s){var u="get"+c+"CursorOffset",d=this[u](s,this._selectionDirection==="right");s.shiftKey?this.moveCursorWithShift(d):this.moveCursorWithoutShift(d),d!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(c){var s=this._selectionDirection==="left"?this.selectionStart+c:this.selectionEnd+c;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,s),c!==0},moveCursorWithoutShift:function(c){return c<0?(this.selectionStart+=c,this.selectionEnd=this.selectionStart):(this.selectionEnd+=c,this.selectionStart=this.selectionEnd),c!==0},moveCursorLeft:function(c){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",c)},_move:function(c,s,u){var d;if(c.altKey)d=this["findWordBoundary"+u](this[s]);else if(c.metaKey||c.keyCode===35||c.keyCode===36)d=this["findLineBoundary"+u](this[s]);else return this[s]+=u==="Left"?-1:1,!0;if(typeof d<"u"&&this[s]!==d)return this[s]=d,!0},_moveLeft:function(c,s){return this._move(c,s,"Left")},_moveRight:function(c,s){return this._move(c,s,"Right")},moveCursorLeftWithoutShift:function(c){var s=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(s=this._moveLeft(c,"selectionStart")),this.selectionEnd=this.selectionStart,s},moveCursorLeftWithShift:function(c){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(c,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(c,"selectionStart")},moveCursorRight:function(c){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",c)},_moveCursorLeftOrRight:function(c,s){var u="moveCursor"+c+"With";this._currentCursorOpacity=1,s.shiftKey?u+="Shift":u+="outShift",this[u](s)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(c){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(c,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(c,"selectionEnd")},moveCursorRightWithoutShift:function(c){var s=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(s=this._moveRight(c,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,s},removeChars:function(c,s){typeof s>"u"&&(s=c+1),this.removeStyleFromTo(c,s),this._text.splice(c,s-c),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(c,s,u,d){typeof d>"u"&&(d=u),d>u&&this.removeStyleFromTo(u,d);var l=e.util.string.graphemeSplit(c);this.insertNewStyleBlock(l,u,s),this._text=[].concat(this._text.slice(0,u),l,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var c=e.util.toFixed,s=/  +/g;e.util.object.extend(e.Text.prototype,{_toSVG:function(){var u=this._getSVGLeftTopOffsets(),d=this._getSVGTextAndBg(u.textTop,u.textLeft);return this._wrapSVGTextAndBg(d)},toSVG:function(u){return this._createBaseSVGMarkup(this._toSVG(),{reviver:u,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(u){var d=!0,l=this.getSvgTextDecoration(this);return[u.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",l?'text-decoration="'+l+'" ':"",'style="',this.getSvgStyles(d),'"',this.addPaintOrder()," >",u.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(u,d){var l=[],o=[],a=u,h;this._setSVGBg(o);for(var g=0,p=this._textLines.length;g<p;g++)h=this._getLineLeftOffset(g),(this.textBackgroundColor||this.styleHas("textBackgroundColor",g))&&this._setSVGTextLineBg(o,g,d+h,a),this._setSVGTextLineText(l,g,d+h,a),a+=this.getHeightOfLine(g);return{textSpans:l,textBgRects:o}},_createTextCharSpan:function(u,d,l,o){var a=u!==u.trim()||u.match(s),h=this.getSvgSpanStyles(d,a),g=h?'style="'+h+'"':"",p=d.deltaY,v="",x=e.Object.NUM_FRACTION_DIGITS;return p&&(v=' dy="'+c(p,x)+'" '),['<tspan x="',c(l,x),'" y="',c(o,x),'" ',v,g,">",e.util.string.escapeXml(u),"</tspan>"].join("")},_setSVGTextLineText:function(u,d,l,o){var a=this.getHeightOfLine(d),h=this.textAlign.indexOf("justify")!==-1,g,p,v="",x,y,_=0,w=this._textLines[d],C;o+=a*(1-this._fontSizeFraction)/this.lineHeight;for(var S=0,O=w.length-1;S<=O;S++)C=S===O||this.charSpacing,v+=w[S],x=this.__charBounds[d][S],_===0?(l+=x.kernedWidth-x.width,_+=x.width):_+=x.kernedWidth,h&&!C&&this._reSpaceAndTab.test(w[S])&&(C=!0),C||(g=g||this.getCompleteStyleDeclaration(d,S),p=this.getCompleteStyleDeclaration(d,S+1),C=e.util.hasStyleChanged(g,p,!0)),C&&(y=this._getStyleDeclaration(d,S)||{},u.push(this._createTextCharSpan(v,y,l,o)),v="",g=p,l+=_,_=0)},_pushTextBgRect:function(u,d,l,o,a,h){var g=e.Object.NUM_FRACTION_DIGITS;u.push("		<rect ",this._getFillAttributes(d),' x="',c(l,g),'" y="',c(o,g),'" width="',c(a,g),'" height="',c(h,g),`"></rect>
`)},_setSVGTextLineBg:function(u,d,l,o){for(var a=this._textLines[d],h=this.getHeightOfLine(d)/this.lineHeight,g=0,p=0,v,x,y=this.getValueOfPropertyAt(d,0,"textBackgroundColor"),_=0,w=a.length;_<w;_++)v=this.__charBounds[d][_],x=this.getValueOfPropertyAt(d,_,"textBackgroundColor"),x!==y?(y&&this._pushTextBgRect(u,y,l+p,o,g,h),p=v.left,g=v.width,y=x):g+=v.kernedWidth;x&&this._pushTextBgRect(u,x,l+p,o,g,h)},_getFillAttributes:function(u){var d=u&&typeof u=="string"?new e.Color(u):"";return!d||!d.getSource()||d.getAlpha()===1?'fill="'+u+'"':'opacity="'+d.getAlpha()+'" fill="'+d.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(u){for(var d=0,l=0,o=0;o<u;o++)d+=this.getHeightOfLine(o);return l=this.getHeightOfLine(o),{lineTop:d,offset:(this._fontSizeMult-this._fontSizeFraction)*l/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(u){var d=e.Object.prototype.getSvgStyles.call(this,u);return d+" white-space: pre;"}})}(),function(c){var s=c.fabric||(c.fabric={});s.Textbox=s.util.createClass(s.IText,s.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:s.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(u){for(var d=0,l=0,o=0,a={},h=0;h<u.graphemeLines.length;h++)u.graphemeText[o]===`
`&&h>0?(l=0,o++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(u.graphemeText[o])&&h>0&&(l++,o++),a[h]={line:d,offset:l},o+=u.graphemeLines[h].length,l+=u.graphemeLines[h].length;return a},styleHas:function(u,d){if(this._styleMap&&!this.isWrapping){var l=this._styleMap[d];l&&(d=l.line)}return s.Text.prototype.styleHas.call(this,u,d)},isEmptyStyles:function(u){if(!this.styles)return!0;var d=0,l=u+1,o,a,h=!1,g=this._styleMap[u],p=this._styleMap[u+1];g&&(u=g.line,d=g.offset),p&&(l=p.line,h=l===u,o=p.offset),a=typeof u>"u"?this.styles:{line:this.styles[u]};for(var v in a)for(var x in a[v])if(x>=d&&(!h||x<o))for(var y in a[v][x])return!1;return!0},_getStyleDeclaration:function(u,d){if(this._styleMap&&!this.isWrapping){var l=this._styleMap[u];if(!l)return null;u=l.line,d=l.offset+d}return this.callSuper("_getStyleDeclaration",u,d)},_setStyleDeclaration:function(u,d,l){var o=this._styleMap[u];u=o.line,d=o.offset+d,this.styles[u][d]=l},_deleteStyleDeclaration:function(u,d){var l=this._styleMap[u];u=l.line,d=l.offset+d,delete this.styles[u][d]},_getLineStyle:function(u){var d=this._styleMap[u];return!!this.styles[d.line]},_setLineStyle:function(u){var d=this._styleMap[u];this.styles[d.line]={}},_wrapText:function(u,d){var l=[],o;for(this.isWrapping=!0,o=0;o<u.length;o++)l=l.concat(this._wrapLine(u[o],o,d));return this.isWrapping=!1,l},_measureWord:function(u,d,l){var o=0,a,h=!0;l=l||0;for(var g=0,p=u.length;g<p;g++){var v=this._getGraphemeBox(u[g],d,g+l,a,h);o+=v.kernedWidth,a=u[g]}return o},_wrapLine:function(u,d,l,N){var a=0,h=this.splitByGrapheme,g=[],p=[],v=h?s.util.string.graphemeSplit(u):u.split(this._wordJoiners),x="",y=0,_=h?"":" ",w=0,C=0,S=0,O=!0,F=this._getWidthOfCharSpacing(),N=N||0;v.length===0&&v.push([]),l-=N;for(var W=0;W<v.length;W++)x=h?v[W]:s.util.string.graphemeSplit(v[W]),w=this._measureWord(x,d,y),y+=x.length,a+=C+w-F,a>l&&!O?(g.push(p),p=[],a=w,O=!0):a+=F,!O&&!h&&p.push(_),p=p.concat(x),C=h?0:this._measureWord([_],d,y),y++,O=!1,w>S&&(S=w);return W&&g.push(p),S+N>this.dynamicMinWidth&&(this.dynamicMinWidth=S-F+N),g},isEndOfWrapping:function(u){return!this._styleMap[u+1]||this._styleMap[u+1].line!==this._styleMap[u].line},missingNewlineOffset:function(u){return this.splitByGrapheme?this.isEndOfWrapping(u)?1:0:1},_splitTextIntoLines:function(u){for(var d=s.Text.prototype._splitTextIntoLines.call(this,u),l=this._wrapText(d.lines,this.width),o=new Array(l.length),a=0;a<l.length;a++)o[a]=l[a].join("");return d.lines=o,d.graphemeLines=l,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var u={};for(var d in this._styleMap)this._textLines[d]&&(u[this._styleMap[d].line]=1);for(var d in this.styles)u[d]||delete this.styles[d]},toObject:function(u){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(u))}}),s.Textbox.fromObject=function(u,d){var l=s.util.stylesFromArray(u.styles,u.text),o=Object.assign({},u,{styles:l});return s.Object._fromObject("Textbox",o,d,"text")}}(t),function(){var c=e.controlsUtils,s=c.scaleSkewCursorStyleHandler,u=c.scaleCursorStyleHandler,d=c.scalingEqually,l=c.scalingYOrSkewingX,o=c.scalingXOrSkewingY,a=c.scaleOrSkewActionName,h=e.Object.prototype.controls;if(h.ml=new e.Control({x:-.5,y:0,cursorStyleHandler:s,actionHandler:o,getActionName:a}),h.mr=new e.Control({x:.5,y:0,cursorStyleHandler:s,actionHandler:o,getActionName:a}),h.mb=new e.Control({x:0,y:.5,cursorStyleHandler:s,actionHandler:l,getActionName:a}),h.mt=new e.Control({x:0,y:-.5,cursorStyleHandler:s,actionHandler:l,getActionName:a}),h.tl=new e.Control({x:-.5,y:-.5,cursorStyleHandler:u,actionHandler:d}),h.tr=new e.Control({x:.5,y:-.5,cursorStyleHandler:u,actionHandler:d}),h.bl=new e.Control({x:-.5,y:.5,cursorStyleHandler:u,actionHandler:d}),h.br=new e.Control({x:.5,y:.5,cursorStyleHandler:u,actionHandler:d}),h.mtr=new e.Control({x:0,y:-.5,actionHandler:c.rotationWithSnapping,cursorStyleHandler:c.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),e.Textbox){var g=e.Textbox.prototype.controls={};g.mtr=h.mtr,g.tr=h.tr,g.br=h.br,g.tl=h.tl,g.bl=h.bl,g.mt=h.mt,g.mb=h.mb,g.mr=new e.Control({x:.5,y:0,actionHandler:c.changeWidth,cursorStyleHandler:s,actionName:"resizing"}),g.ml=new e.Control({x:-.5,y:0,actionHandler:c.changeWidth,cursorStyleHandler:s,actionName:"resizing"})}}()})(Fe);function Dx({canvas:t}){const e=Ae.useRef(null),r=Ae.useRef(null),[n,i]=Ae.useState([0,0]);Ae.useEffect(()=>(t.current=new Fe.fabric.Canvas(r.current,{backgroundColor:"#f9f9f9"}),()=>{var m;(m=t.current)==null||m.dispose(),t.current=null}),[]);const f=()=>{var c,s;const m=[((c=e.current)==null?void 0:c.clientWidth)||0,((s=e.current)==null?void 0:s.clientHeight)||0];i(m)};return Ae.useEffect(()=>{f();const m=new ResizeObserver(c=>{f()});return m.observe(e.current),()=>{m.unobserve(e.current)}},[]),Ae.useEffect(()=>{var s;const[m,c]=n;(s=t.current)==null||s.setDimensions({width:m,height:c})},[n]),Ae.useEffect(()=>{var l,o,a;let m=!1,c=[0,0];const s=h=>{const g=h.e;g.altKey===!0&&(m=!0,t.current.selection=!1,c=[g.clientX,g.clientY])},u=h=>{var g,p;if(m){const v=h.e,x=(g=t.current)==null?void 0:g.viewportTransform;x[4]+=v.clientX-c[0],x[5]+=v.clientY-c[1],(p=t.current)==null||p.requestRenderAll(),c=[v.clientX,v.clientY]}},d=()=>{var h,g;(g=t.current)==null||g.setViewportTransform((h=t.current)==null?void 0:h.viewportTransform),m=!1,t.current.selection=!0};return(l=t.current)==null||l.on("mouse:down",s),(o=t.current)==null||o.on("mouse:move",u),(a=t.current)==null||a.on("mouse:up",d),()=>{var h,g,p;(h=t.current)==null||h.off("mouse:down",s),(g=t.current)==null||g.off("mouse:move",u),(p=t.current)==null||p.off("mouse:up",d)}},[]),Ce.jsx(Ce.Fragment,{children:Ce.jsx("div",{className:"editor-container",ref:e,children:Ce.jsx("canvas",{className:"editor-content",ref:r})})})}const Jp=Object.seal({fill:"#fff",stroke:"#999",strokeWidth:.5}),bx=Object.seal({stroke:"rgb(0, 255, 128, 0.5)",strokeWidth:4}),Zp=Object.seal({fill:"#999",fontFamily:"sans-serif",fontSize:16,textAlign:"center"}),eg=Object.seal({stroke:"#999",strokeDashArray:[2,4],strokeWidth:2,fill:"transparent"}),Rx=Object.seal({stroke:"rgb(0, 255, 128, 1)",strokeDashArray:[],strokeWidth:4}),Ys=Object.seal({width:30,backgroundColor:"#fff",fill:"#000",fontSize:14,fontFamily:"sans-serif",textAlign:"center"}),tg=Object.seal({fill:"rgba(0, 128, 255)",radius:7}),Mx=(t,e,r,n)=>{const[i]=Ae.useContext(zr);Ae.useEffect(()=>{var c;if(i.seats.size===0)return;const f=t[r],m=e[r];return i.seats.forEach((s,u)=>{const d=m.seats[s],l=f.groups[d]?f.groups[d].color:"#ccc";u.set({fill:l})}),(c=n.current)==null||c.requestRenderAll(),()=>{var s;i.seats.forEach((u,d)=>{d.set({fill:tg.fill})}),(s=n.current)==null||s.requestRenderAll()}},[t,e,i,r])},Gh=Object.seal({hoverCursor:"default",selectable:!1,stroke:"rgb(0, 0, 0, 0.05)",strokeWidth:1}),Lx=(t,e)=>{const[r]=Ae.useContext(Mf),[n]=Ae.useContext(zr);Ae.useEffect(()=>{var c,s,u,d;const[i,f]=[(c=e.current)==null?void 0:c.getWidth(),(s=e.current)==null?void 0:s.getHeight()],m=[];for(let l=0;l<i;l+=t){const o=new Fe.fabric.Line([l,0,l,f],{...Gh});(u=e.current)==null||u.add(o),o.sendToBack(),m.push(o)}for(let l=0;l<f;l+=t){const o=new Fe.fabric.Line([0,l,i,l],{...Gh});(d=e.current)==null||d.add(o),o.sendToBack(),m.push(o)}return()=>{m.forEach(l=>{var o;return(o=e.current)==null?void 0:o.remove(l)})}},[n,r])},Ix=(t,e)=>{const[r]=Ae.useContext(zr),[[n,i]]=t;Ae.useEffect(()=>{var c,s;const f=n===qr.SELECT?1:.3,m=n===qr.SELECT;n!==qr.SELECT&&((c=e.current)==null||c.discardActiveObject()),r.sections.forEach((u,d)=>{d.selectable=m,d.opacity=f;const l=d.getObjects()[0];u===i?l.set({...bx}):l.set({...Jp})}),r.rows.forEach((u,d)=>{d.selectable=m,d.opacity=f;const l=d.getObjects()[0];u===i?l.set({...Rx}):l.set({...eg})}),r.seats.forEach((u,d)=>{d.opacity=f}),(s=e.current)==null||s.requestRenderAll()},[n,i])},Nx={name:"  ",sections:{1:{name:""},2:{name:" 1"}},rows:{"2-1":{number:"1",section:"2"},"2-2":{number:"2",section:"2"},"2-3":{number:"3",section:"2"},"2-4":{number:"4",section:"2"},"2-5":{number:"5",section:"2"}},seats:{"2-1-1":{capacity:1,number:1,linkedSeats:[],row:"2-1"},"2-1-2":{capacity:1,number:2,linkedSeats:[],row:"2-1"},"2-1-3":{capacity:1,number:3,linkedSeats:[],row:"2-1"},"2-1-4":{capacity:1,number:4,linkedSeats:[],row:"2-1"},"2-1-5":{capacity:1,number:5,linkedSeats:[],row:"2-1"},"2-1-6":{capacity:1,number:6,linkedSeats:[],row:"2-1"},"2-1-7":{capacity:1,number:7,linkedSeats:[],row:"2-1"},"2-1-8":{capacity:1,number:8,linkedSeats:[],row:"2-1"},"2-1-9":{capacity:1,number:9,linkedSeats:[],row:"2-1"},"2-1-10":{capacity:1,number:10,linkedSeats:[],row:"2-1"},"2-1-11":{capacity:1,number:11,linkedSeats:[],row:"2-1"},"2-1-12":{capacity:1,number:12,linkedSeats:[],row:"2-1"},"2-1-13":{capacity:1,number:13,linkedSeats:[],row:"2-1"},"2-1-14":{capacity:1,number:14,linkedSeats:[],row:"2-1"},"2-1-15":{capacity:1,number:15,linkedSeats:[],row:"2-1"},"2-1-16":{capacity:1,number:16,linkedSeats:[],row:"2-1"},"2-1-17":{capacity:1,number:17,linkedSeats:[],row:"2-1"},"2-1-18":{capacity:1,number:18,linkedSeats:[],row:"2-1"},"2-2-1":{capacity:1,number:1,linkedSeats:[],row:"2-2"},"2-2-2":{capacity:1,number:2,linkedSeats:[],row:"2-2"},"2-2-3":{capacity:1,number:3,linkedSeats:[],row:"2-2"},"2-2-4":{capacity:1,number:4,linkedSeats:[],row:"2-2"},"2-2-5":{capacity:1,number:5,linkedSeats:[],row:"2-2"},"2-2-6":{capacity:1,number:6,linkedSeats:[],row:"2-2"},"2-2-7":{capacity:1,number:7,linkedSeats:[],row:"2-2"},"2-2-8":{capacity:1,number:8,linkedSeats:[],row:"2-2"},"2-2-9":{capacity:1,number:9,linkedSeats:[],row:"2-2"},"2-2-10":{capacity:1,number:10,linkedSeats:[],row:"2-2"},"2-2-11":{capacity:1,number:11,linkedSeats:[],row:"2-2"},"2-2-12":{capacity:1,number:12,linkedSeats:[],row:"2-2"},"2-2-13":{capacity:1,number:13,linkedSeats:[],row:"2-2"},"2-2-14":{capacity:1,number:14,linkedSeats:[],row:"2-2"},"2-2-15":{capacity:1,number:15,linkedSeats:[],row:"2-2"},"2-2-16":{capacity:1,number:16,linkedSeats:[],row:"2-2"},"2-2-17":{capacity:1,number:17,linkedSeats:[],row:"2-2"},"2-2-18":{capacity:1,number:18,linkedSeats:[],row:"2-2"},"2-3-1":{capacity:1,number:1,linkedSeats:[],row:"2-3"},"2-3-2":{capacity:1,number:2,linkedSeats:[],row:"2-3"},"2-3-3":{capacity:1,number:3,linkedSeats:[],row:"2-3"},"2-3-4":{capacity:1,number:4,linkedSeats:[],row:"2-3"},"2-3-5":{capacity:1,number:5,linkedSeats:[],row:"2-3"},"2-3-6":{capacity:1,number:6,linkedSeats:[],row:"2-3"},"2-3-7":{capacity:1,number:7,linkedSeats:[],row:"2-3"},"2-3-8":{capacity:1,number:8,linkedSeats:[],row:"2-3"},"2-3-9":{capacity:1,number:9,linkedSeats:[],row:"2-3"},"2-3-10":{capacity:1,number:10,linkedSeats:[],row:"2-3"},"2-3-11":{capacity:1,number:11,linkedSeats:[],row:"2-3"},"2-3-12":{capacity:1,number:12,linkedSeats:[],row:"2-3"},"2-3-13":{capacity:1,number:13,linkedSeats:[],row:"2-3"},"2-3-14":{capacity:1,number:14,linkedSeats:[],row:"2-3"},"2-3-15":{capacity:1,number:15,linkedSeats:[],row:"2-3"},"2-3-16":{capacity:1,number:16,linkedSeats:[],row:"2-3"},"2-3-17":{capacity:1,number:17,linkedSeats:[],row:"2-3"},"2-3-18":{capacity:1,number:18,linkedSeats:[],row:"2-3"}}};var jr=(t=>(t.CREATE_ROW="create-row",t.CREATE_SEAT="create-seat",t.CREATE_SECTION="create-section",t.DELETE_ROW="delete-row",t.DELETE_SEAT="delete-seat",t.DELETE_SECTION="delete-section",t.UPDATE_HALL="update-hall",t.UPDATE_ROW="update-row",t.UPDATE_SEAT="update-seat",t.UPDATE_SECTION="update-section",t))(jr||{});const Bx=(t,e)=>{switch(e.type){case"create-row":{if(t.rows[e.id])throw new RangeError(`Can't create new Row. Row with ID "${e.id}" already exists`);if(!e.payload.section)throw new RangeError("Can't create new Row. Section ID is not provided. All rows must exist within sections");if(!t.sections[e.payload.section])throw new RangeError("Can't create new Row. Section with provided Section ID is found. All rows must exist within sections");const r={number:e.payload.number||0,section:e.payload.section};return{...t,rows:{[e.id]:r,...t.rows}}}case"create-seat":{if(t.seats[e.id])throw new RangeError(`Can't create new Seat. Seat with ID "${e.id}" already exists`);if(!e.payload.row)throw new RangeError("Can't create new Seat. Row ID is not provided. All seats must exist within rows");if(!t.rows[e.payload.row])throw new RangeError("Can't create new Seat. Row with provided Row ID is found. All seats must exist within rows");const r={number:e.payload.number||"0",linkedSeats:[],row:e.payload.row};return{...t,seats:{[e.id]:r,...t.seats}}}case"create-section":{if(t.sections[e.id])throw new RangeError(`Can't create new Section. Section with ID "${e.id}" already exists`);const r={name:e.payload.name||""};return{...t,sections:{[e.id]:r,...t.sections}}}case"delete-row":{const{[e.id]:r,...n}=t.rows,i=Object.fromEntries(Object.entries(t.seats).filter(([f,m])=>m.row in n));return{...t,rows:n,seats:i}}case"delete-seat":{const{[e.id]:r,...n}=t.seats;return{...t,seats:n}}case"delete-section":{const{[e.id]:r,...n}=t.sections,i=Object.fromEntries(Object.entries(t.rows).filter(([m,c])=>c.section!==e.id)),f=Object.fromEntries(Object.entries(t.seats).filter(([m,c])=>c.row in i));return{...t,rows:i,seats:f,sections:n}}case"update-hall":{if(!e.payload.name)throw new TypeError("New name for the hall is not provided");return{...t,name:e.payload.name}}case"update-row":{if(!(e.id in t.rows))throw new RangeError(`Cannot update row with ID ${e.id}. No row with given ID is found.`);if(e.payload.number===void 0)throw new TypeError(`Cannot update row ${e.id}. Provided new row number us undefined`);const{[e.id]:r,...n}=t.rows;return{...t,rows:{...n,[e.id]:{...r,number:e.payload.number}}}}case"update-seat":{if(!(e.id in t.seats))throw new RangeError(`No seat with ID ${e.id} is found`);if(e.payload.number===void 0||e.payload.number===null)throw new TypeError(`New seat number must be a string or number but got ${e.payload.number}`);const{[e.id]:r}=t.seats;return{...t,seats:{...t.seats,[e.id]:{...r,number:e.payload.number}}}}case"update-section":{if(!(e.id in t.sections))throw new RangeError(`Cannot update section with ID ${e.id}. No section with given ID is found`);if(e.payload.name===void 0)throw new TypeError(`Cannot update section ${e.id}. No name is provided`);const{[e.id]:r,...n}=t.sections;return{...t,sections:{[e.id]:{name:e.payload.name},...n}}}}throw new Error("Unknown action")},jx=t=>(e,r,n)=>{e.save(),e.translate(r,n),e.strokeRect(-12,-12,24,24),e.fillStyle="#FFF",e.fillRect(-12,-12,24,24),e.fillStyle="#000",e.font="24px sans-serif",e.textBaseline="hanging",e.fillText(t,-12,-12),e.restore()};class rg extends Fe.fabric.Circle{constructor(r){super(r);St(this,"onDelete",null);St(this,"controls",{...Fe.fabric.Group.prototype.controls,delete:new Fe.fabric.Control({actionName:"delete",cursorStyle:"pointer",mouseUpHandler:()=>this.onDelete===null?!1:(this.onDelete(),!0),offsetX:20,offsetY:-20,render:jx(""),sizeX:24,sizeY:24,x:.5,y:-.5})});this.setControlsVisibility({tl:!1,mt:!1,tr:!1,mr:!1,br:!1,mb:!1,bl:!1,ml:!1,mtr:!1}),this.selectable=!1,this.lockMovementX=!0,this.lockMovementY=!0}}class Me{constructor(e=0,r=0){this.x=e,this.y=r}clone(){return new this.constructor(this.x,this.y)}add(e){return new this.constructor(this.x+e.x,this.y+e.y)}subtract(e){return new this.constructor(this.x-e.x,this.y-e.y)}multiply(e){return new this.constructor(this.x*e,this.y*e)}divide(e){return new this.constructor(this.x/e,this.y/e)}equals(e){return this.x===e.x&&this.y===e.y}precisionEquals(e,r){return Math.abs(this.x-e.x)<r&&Math.abs(this.y-e.y)<r}lerp(e,r){const n=1-r;return new this.constructor(this.x*n+e.x*r,this.y*n+e.y*r)}distanceFrom(e){const r=this.x-e.x,n=this.y-e.y;return Math.sqrt(r*r+n*n)}min(e){return new this.constructor(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new this.constructor(Math.max(this.x,e.x),Math.max(this.y,e.y))}transform(e){return new this.constructor(e.a*this.x+e.c*this.y+e.e,e.b*this.x+e.d*this.y+e.f)}toString(){return`point(${this.x},${this.y})`}}class gt{constructor(e=0,r=0){this.x=e,this.y=r}static fromPoints(e,r){return new gt(r.x-e.x,r.y-e.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}magnitude(){return this.x*this.x+this.y*this.y}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}determinant(e){return this.x*e.y-this.y*e.x}unit(){return this.divide(this.length())}add(e){return new this.constructor(this.x+e.x,this.y+e.y)}subtract(e){return new this.constructor(this.x-e.x,this.y-e.y)}multiply(e){return new this.constructor(this.x*e,this.y*e)}divide(e){return new this.constructor(this.x/e,this.y/e)}angleBetween(e){let r=this.dot(e)/(this.length()*e.length());r=Math.max(-1,Math.min(r,1));const n=Math.acos(r);return this.cross(e)<0?-n:n}perp(){return new this.constructor(-this.y,this.x)}perpendicular(e){return this.subtract(this.project(e))}project(e){const r=this.dot(e)/e.dot(e);return e.multiply(r)}transform(e){return new this.constructor(e.a*this.x+e.c*this.y,e.b*this.x+e.d*this.y)}equals(e){return this.x===e.x&&this.y===e.y}precisionEquals(e,r){return Math.abs(this.x-e.x)<r&&Math.abs(this.y-e.y)<r}toString(){return`vector(${this.x},${this.y})`}}class Ut{constructor(e=1,r=0,n=0,i=1,f=0,m=0){this.a=e,this.b=r,this.c=n,this.d=i,this.e=f,this.f=m}static translation(e,r){return new Ut(1,0,0,1,e,r)}static scaling(e){return new Ut(e,0,0,e,0,0)}static scalingAt(e,r){return new Ut(e,0,0,e,r.x-r.x*e,r.y-r.y*e)}static nonUniformScaling(e,r){return new Ut(e,0,0,r,0,0)}static nonUniformScalingAt(e,r,n){return new Ut(e,0,0,r,n.x-n.x*e,n.y-n.y*r)}static rotation(e){const r=Math.cos(e),n=Math.sin(e);return new Ut(r,n,-n,r,0,0)}static rotationAt(e,r){const n=Math.cos(e),i=Math.sin(e);return new Ut(n,i,-i,n,r.x-r.x*n+r.y*i,r.y-r.y*n-r.x*i)}static rotationFromVector(e){const r=e.unit(),n=r.x,i=r.y;return new Ut(n,i,-i,n,0,0)}static xFlip(){return new Ut(-1,0,0,1,0,0)}static yFlip(){return new Ut(1,0,0,-1,0,0)}static xSkew(e){const r=Math.tan(e);return new Ut(1,0,r,1,0,0)}static ySkew(e){const r=Math.tan(e);return new Ut(1,r,0,1,0,0)}multiply(e){return this.isIdentity()?e:e.isIdentity()?this:new this.constructor(this.a*e.a+this.c*e.b,this.b*e.a+this.d*e.b,this.a*e.c+this.c*e.d,this.b*e.c+this.d*e.d,this.a*e.e+this.c*e.f+this.e,this.b*e.e+this.d*e.f+this.f)}inverse(){if(this.isIdentity())return this;const e=this.a*this.d-this.b*this.c;if(e===0)throw new Error("Matrix is not invertible");const r=1/e,n=this.f*this.c-this.e*this.d,i=this.e*this.b-this.f*this.a;return new this.constructor(this.d*r,-this.b*r,-this.c*r,this.a*r,n*r,i*r)}translate(e,r){return new this.constructor(this.a,this.b,this.c,this.d,this.a*e+this.c*r+this.e,this.b*e+this.d*r+this.f)}scale(e){return new this.constructor(this.a*e,this.b*e,this.c*e,this.d*e,this.e,this.f)}scaleAt(e,r){const n=r.x-e*r.x,i=r.y-e*r.y;return new this.constructor(this.a*e,this.b*e,this.c*e,this.d*e,this.a*n+this.c*i+this.e,this.b*n+this.d*i+this.f)}scaleNonUniform(e,r){return new this.constructor(this.a*e,this.b*e,this.c*r,this.d*r,this.e,this.f)}scaleNonUniformAt(e,r,n){const i=n.x-e*n.x,f=n.y-r*n.y;return new this.constructor(this.a*e,this.b*e,this.c*r,this.d*r,this.a*i+this.c*f+this.e,this.b*i+this.d*f+this.f)}rotate(e){const r=Math.cos(e),n=Math.sin(e);return new this.constructor(this.a*r+this.c*n,this.b*r+this.d*n,this.a*-n+this.c*r,this.b*-n+this.d*r,this.e,this.f)}rotateAt(e,r){const n=Math.cos(e),i=Math.sin(e),f=r.x,m=r.y,c=this.a*n+this.c*i,s=this.b*n+this.d*i,u=this.c*n-this.a*i,d=this.d*n-this.b*i;return new this.constructor(c,s,u,d,(this.a-c)*f+(this.c-u)*m+this.e,(this.b-s)*f+(this.d-d)*m+this.f)}rotateFromVector(e){const r=e.unit(),n=r.x,i=r.y;return new this.constructor(this.a*n+this.c*i,this.b*n+this.d*i,this.a*-i+this.c*n,this.b*-i+this.d*n,this.e,this.f)}flipX(){return new this.constructor(-this.a,-this.b,this.c,this.d,this.e,this.f)}flipY(){return new this.constructor(this.a,this.b,-this.c,-this.d,this.e,this.f)}skewX(e){const r=Math.tan(e);return new this.constructor(this.a,this.b,this.c+this.a*r,this.d+this.b*r,this.e,this.f)}skewY(e){const r=Math.tan(e);return new this.constructor(this.a+this.c*r,this.b+this.d*r,this.c,this.d,this.e,this.f)}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.e===0&&this.f===0}isInvertible(){return this.a*this.d-this.b*this.c!==0}getScale(){return{scaleX:Math.sqrt(this.a*this.a+this.c*this.c),scaleY:Math.sqrt(this.b*this.b+this.d*this.d)}}getDecomposition(){const e=(this.a+this.d)*.5,r=(this.a-this.d)*.5,n=(this.b+this.c)*.5,i=(this.b-this.c)*.5,f=Math.sqrt(e*e+i*i),m=Math.sqrt(r*r+n*n),c=f+m,s=f-m,u=Math.atan2(n,r),d=Math.atan2(i,e),l=(d-u)*.5,o=(d+u)*.5;return{translation:this.constructor.translation(this.e,this.f),rotation:this.constructor.rotation(o),scale:this.constructor.nonUniformScaling(c,s),rotation0:this.constructor.rotation(l)}}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}precisionEquals(e,r){return Math.abs(this.a-e.a)<r&&Math.abs(this.b-e.b)<r&&Math.abs(this.c-e.c)<r&&Math.abs(this.d-e.d)<r&&Math.abs(this.e-e.e)<r&&Math.abs(this.f-e.f)<r}toString(){return`matrix(${this.a},${this.b},${this.c},${this.d},${this.e},${this.f})`}}Ut.IDENTITY=new Ut;Ut.IDENTITY.isIdentity=()=>!0;function Zt(t){return typeof t=="number"?t?t<0?-1:1:t===t?t:NaN:NaN}class tt{constructor(...e){this.coefs=[];for(let r=e.length-1;r>=0;r--)this.coefs.push(e[r]);this._variable="t",this._s=0}static interpolate(e,r,n,i,f){if(e.constructor!==Array||r.constructor!==Array)throw new TypeError("xs and ys must be arrays");if(isNaN(n)||isNaN(i)||isNaN(f))throw new TypeError("n, offset, and x must be numbers");let m,c,s=0;const u=new Array(n),d=new Array(n);let l=0,o=Math.abs(f-e[i]);for(m=0;m<n;m++){const a=Math.abs(f-e[i+m]);a<o&&(l=m,o=a),u[m]=d[m]=r[i+m]}c=r[i+l],l--;for(let a=1;a<n;a++){for(m=0;m<n-a;m++){const h=e[i+m]-f,g=e[i+m+a]-f,p=u[m+1]-d[m];let v=h-g;if(v===0)throw new RangeError("Unable to interpolate polynomial. Two numbers in n were identical (to within roundoff)");v=p/v,d[m]=g*v,u[m]=h*v}s=2*(l+1)<n-a?u[l+1]:d[l--],c+=s}return{y:c,dy:s}}static newtonSecantBisection(e,r,n,i,f,m){let c,s=0,u,d=0,l,o,a,h,g;c=e;const v=Math.pow(10,-14),x=typeof f=="number"&&typeof m=="number";if(x){if(f>m)throw new RangeError("Min must be greater than max");if(h=r(f),g=r(m),Zt(h)===Zt(g))throw new RangeError("Y values of bounds must be of opposite sign")}const y=function(){return Math.abs(l)<=v*Math.abs(c)||d===c-l-c};for(let _=0;_<i;_++){if(u=n(c),u===0){if(s===0)throw new RangeError("df(x) is zero");u=s}if(s=u,a=r(c),l=a/u,o=c-l,y())break;if(x){if(Zt(a)===Zt(g))m=c,g=a;else if(Zt(a)===Zt(h))f=c,h=a;else{c=o;break}if(o<f||o>m){if(Zt(h)===Zt(g))break;const w=50,C=.25,S=g-h,O=m-f;if(S===0?l=c-(f+O*.5):Math.abs(S/Math.min(h,g))>w?l=c-(f+O*(.5+(Math.abs(h)<Math.abs(g)?-C:C))):l=c-(f-h/S*O),o=c-l,y())break}}d=c-o,c=o}return c}clone(){const e=new tt;return e.coefs=this.coefs.slice(),e}eval(e){if(isNaN(e))throw new TypeError(`Parameter must be a number. Found '${e}'`);let r=0;for(let n=this.coefs.length-1;n>=0;n--)r=r*e+this.coefs[n];return r}add(e){const r=new tt,n=this.getDegree(),i=e.getDegree(),f=Math.max(n,i);for(let m=0;m<=f;m++){const c=m<=n?this.coefs[m]:0,s=m<=i?e.coefs[m]:0;r.coefs[m]=c+s}return r}multiply(e){const r=new tt;for(let n=0;n<=this.getDegree()+e.getDegree();n++)r.coefs.push(0);for(let n=0;n<=this.getDegree();n++)for(let i=0;i<=e.getDegree();i++)r.coefs[n+i]+=this.coefs[n]*e.coefs[i];return r}divideEqualsScalar(e){for(let r=0;r<this.coefs.length;r++)this.coefs[r]/=e}simplifyEquals(e=1e-12){for(let r=this.getDegree();r>=0&&Math.abs(this.coefs[r])<=e;r--)this.coefs.pop()}removeZerosEquals(e=1e-15){const r=this.coefs,n=10*e*Math.abs(r.reduce((i,f)=>Math.abs(f)>Math.abs(i)?f:i));for(let i=0;i<r.length-1;i++)Math.abs(r[i])<n&&(r[i]=0);return this}monicEquals(){const e=this.coefs;return e[e.length-1]!==1&&this.divideEqualsScalar(e[e.length-1]),this}toString(){const e=[],r=[];for(let i=this.coefs.length-1;i>=0;i--){let f=Math.round(this.coefs[i]*1e3)/1e3;if(f!==0){const m=f<0?" - ":" + ";f=Math.abs(f),i>0&&(f===1?f=this._variable:f+=this._variable),i>1&&(f+="^"+i),r.push(m),e.push(f)}}r[0]=r[0]===" + "?"":"-";let n="";for(let i=0;i<e.length;i++)n+=r[i]+e[i];return n}bisection(e,r,n=1e-6,i=15){let f=this.eval(e),m=this.eval(r),c;if(Math.abs(f)<=n)c=e;else if(Math.abs(m)<=n)c=r;else if(f*m<=0){const s=Math.log(r-e),u=Math.LN10*i,d=Math.ceil((s+u)/Math.LN2);for(let l=0;l<d;l++){c=.5*(e+r);const o=this.eval(c);if(Math.abs(o)<=n)break;o*f<0?(r=c,m=o):(e=c,f=o)}}return c}trapezoid(e,r,n){if(isNaN(e)||isNaN(r)||isNaN(n))throw new TypeError("Parameters must be numbers");const i=r-e;if(n===1){const f=this.eval(e),m=this.eval(r);this._s=.5*i*(f+m)}else{const f=1<<n-2,m=i/f;let c=e+.5*m,s=0;for(let u=0;u<f;u++)s+=this.eval(c),c+=m;this._s=.5*(this._s+i*s/f)}if(isNaN(this._s))throw new TypeError("this._s is NaN");return this._s}simpson(e,r){if(isNaN(e)||isNaN(r))throw new TypeError("Parameters must be numbers");const n=r-e;let i=.5*n*(this.eval(e)+this.eval(r)),f=i,m=4*i/3,c=m,s=i;const u=1e-7;let d=1;for(let l=2;l<=20;l++){const o=n/d;let a=e+.5*o,h=0;for(let g=1;g<=d;g++)h+=this.eval(a),a+=o;if(f=.5*(f+n*h/d),i=f,m=(4*i-s)/3,Math.abs(m-c)<u*Math.abs(c))break;c=m,s=i,d<<=1}return m}romberg(e,r){if(isNaN(e)||isNaN(r))throw new TypeError("Parameters must be numbers");const n=20,i=3,f=1e-6,m=new Array(n+1),c=new Array(n+1);let s={y:0,dy:0};c[0]=1;for(let u=1;u<=n&&(m[u-1]=this.trapezoid(e,r,u),!(u>=i&&(s=tt.interpolate(c,m,i,u-i,0),Math.abs(s.dy)<=f*s.y)));u++)m[u]=m[u-1],c[u]=.25*c[u-1];return s.y}zeroErrorEstimate(e){const r=this,n=1e-15;if(typeof e>"u"){const m=r.bounds();e=Math.max(Math.abs(m.minX),Math.abs(m.maxX))}if(e<.001)return 2*Math.abs(r.eval(n));const i=r.coefs.length-1,f=r.coefs[i];return 10*n*r.coefs.reduce((m,c,s)=>{const u=c/f*Math.pow(e,s);return u>m?u:m},0)}boundsUpperRealFujiwara(){let e=this.coefs;const r=e.length-1,n=e[r];n!==1&&(e=this.coefs.map(u=>u/n));const i=e.map((u,d)=>d<r?Math.pow(Math.abs(d===0?u/2:u),1/(r-d)):u);let f;const m=function(u,d,l){return f(l)&&(u.max<d?(u.nearmax=u.max,u.max=d):u.nearmax<d&&(u.nearmax=d)),u};f=function(u){return u<r&&e[u]<0};const c=i.reduce(m,{max:0,nearmax:0});return f=function(u){return u<r&&(r%2===u%2?e[u]<0:e[u]>0)},{negX:-2*i.reduce(m,{max:0,nearmax:0}).max,posX:2*c.max}}boundsLowerRealFujiwara(){const e=new tt;e.coefs=this.coefs.slice().reverse();const r=e.boundsUpperRealFujiwara();return r.negX=1/r.negX,r.posX=1/r.posX,r}bounds(){const e=this.boundsUpperRealFujiwara(),r={minX:e.negX,maxX:e.posX};return e.negX===0&&e.posX===0||(e.negX===0?r.minX=this.boundsLowerRealFujiwara().posX:e.posX===0&&(r.maxX=this.boundsLowerRealFujiwara().negX),r.minX>r.maxX&&(r.minX=r.maxX=0)),r}boundUpperAbsRouche(){const e=this.coefs,r=e.length-1;return 1+e.reduce((i,f,m)=>m!==r?(f=Math.abs(f),i<f?f:i):i,0)/Math.abs(e[r])}boundLowerAbsRouche(){const e=this.coefs,r=e.reduce((n,i,f)=>f!==0?(i=Math.abs(i),n<i?i:n):n,0);return Math.abs(e[0])/(Math.abs(e[0])+r)}boundsRealLaguerre(){const e=this.coefs,r=e.length-1,n=-e[r-1]/(r*e[r]),i=e[r-1]*e[r-1]-2*r/(r-1)*e[r]*e[r-2];let f=(r-1)/(r*e[r])*Math.sqrt(i);return f<0&&(f=-f),{minX:n-f,maxX:n+f}}countRootsDescartes(){const e=this.coefs,r=e.length-1,n=e.reduce((i,f,m)=>(i.prev_a!==0&&f!==0&&(i.prev_a<0==f>0&&i.pos++,m%2===0!=i.prev_a<0==(m%2===1!=f>0)&&i.neg++),i.prev_a=f,i),{pos:0,neg:0,prev_a:0});return{maxRealPos:n.pos,maxRealNeg:n.neg,minComplex:r-(n.pos+n.neg)}}getDegree(){return this.coefs.length-1}getDerivative(){const e=new tt;for(let r=1;r<this.coefs.length;r++)e.coefs.push(r*this.coefs[r]);return e}getRoots(){let e;switch(this.simplifyEquals(),this.getDegree()){case 0:e=[];break;case 1:e=this.getLinearRoot();break;case 2:e=this.getQuadraticRoots();break;case 3:e=this.getCubicRoots();break;case 4:e=this.getQuarticRoots();break;default:e=[]}return e}getRootsInInterval(e,r){const n=[];function i(f){typeof f=="number"&&n.push(f)}if(this.getDegree()===0)throw new RangeError("Unexpected empty polynomial");if(this.getDegree()===1)i(this.bisection(e,r));else{const m=this.getDerivative().getRootsInInterval(e,r);if(m.length>0){i(this.bisection(e,m[0]));for(let c=0;c<=m.length-2;c++)i(this.bisection(m[c],m[c+1]));i(this.bisection(m[m.length-1],r))}else i(this.bisection(e,r))}return n}getLinearRoot(){const e=[],r=this.coefs[1];return r!==0&&e.push(-this.coefs[0]/r),e}getQuadraticRoots(){const e=[];if(this.getDegree()===2){const r=this.coefs[2],n=this.coefs[1]/r,i=this.coefs[0]/r,f=n*n-4*i;if(f>0){const m=Math.sqrt(f);e.push(.5*(-n+m)),e.push(.5*(-n-m))}else f===0&&e.push(.5*-n)}return e}getCubicRoots(){const e=[];if(this.getDegree()===3){const r=this.coefs[3],n=this.coefs[2]/r,i=this.coefs[1]/r,f=this.coefs[0]/r,m=(3*i-n*n)/3,c=(2*n*n*n-9*i*n+27*f)/27,s=n/3;let u=c*c/4+m*m*m/27;const d=c/2,l=this.zeroErrorEstimate();if(Math.abs(u)<=l&&(u=0),u>0){const o=Math.sqrt(u);let a,h=-d+o;h>=0?a=Math.pow(h,1/3):a=-Math.pow(-h,1/3),h=-d-o,h>=0?a+=Math.pow(h,1/3):a-=Math.pow(-h,1/3),e.push(a-s)}else if(u<0){const o=Math.sqrt(-m/3),a=Math.atan2(Math.sqrt(-u),-d)/3,h=Math.cos(a),g=Math.sin(a),p=Math.sqrt(3);e.push(2*o*h-s),e.push(-o*(h+p*g)-s),e.push(-o*(h-p*g)-s)}else{let o;d>=0?o=-Math.pow(d,1/3):o=Math.pow(-d,1/3),e.push(2*o-s),e.push(-o-s)}}return e}getQuarticRoots(){let e=[];const r=this.getDegree();if(r===4){const n=new tt;n.coefs=this.coefs.slice(),n.divideEqualsScalar(n.coefs[r]);const i=1e-15;Math.abs(n.coefs[0])<10*i*Math.abs(n.coefs[3])&&(n.coefs[0]=0);const f=n.getDerivative(),m=f.getRoots().sort((x,y)=>x-y),c=[],s=m.length-1,u=this.bounds(),d=Math.max(Math.abs(u.minX),Math.abs(u.maxX)),l=this.zeroErrorEstimate(d);for(let x=0;x<=s;x++)c.push(n.eval(m[x]));for(let x=0;x<=s;x++)Math.abs(c[x])<l&&(c[x]=0);let o=0;const a=Math.max(.1*(u.maxX-u.minX)/r,i),h=[],g=[];if(s>-1){for(c[0]!==0?Zt(c[0])!==Zt(n.eval(m[0]-a)-c[0])&&(h.push(m[0]-a),g.push([u.minX,m[0]])):(e.push(m[0],m[0]),o++);o<s;o++)c[o+1]===0?(e.push(m[o+1],m[o+1]),o++):Zt(c[o])!==Zt(c[o+1])&&(h.push((m[o]+m[o+1])/2),g.push([m[o],m[o+1]]));c[s]!==0&&Zt(c[s])!==Zt(n.eval(m[s]+a)-c[s])&&(h.push(m[s]+a),g.push([m[s],u.maxX]))}const p=function(x){return n.eval(x)},v=function(x){return f.eval(x)};if(h.length>0)for(o=0;o<h.length;o++)h[o]=tt.newtonSecantBisection(h[o],p,v,32,g[o][0],g[o][1]);e=e.concat(h)}return e}}class zt{constructor(e,r){this.type=e,this.text=r}typeis(e){return this.type===e}}zt.UNDEFINED=0;zt.COMMAND=1;zt.NUMBER=2;zt.EOD=3;class Ux{constructor(e){e==null&&(e=""),this.setPathData(e)}setPathData(e){if(typeof e!="string")throw new TypeError("The first parameter must be a string");this._pathData=e}getNextToken(){let e=null,r=this._pathData;for(;e===null;)if(r===null||r==="")e=new zt(zt.EOD,"");else if(r.match(/^([ \t\r\n,]+)/))r=r.substr(RegExp.$1.length);else if(r.match(/^([AaCcHhLlMmQqSsTtVvZz])/))e=new zt(zt.COMMAND,RegExp.$1),r=r.substr(RegExp.$1.length);else if(r.match(/^(([-+]?\d+(\.\d*)?|[-+]?\.\d+)([eE][-+]?\d+)?)/))e=new zt(zt.NUMBER,RegExp.$1),r=r.substr(RegExp.$1.length);else throw new SyntaxError(`Unrecognized path data: ${r}`);return this._pathData=r,e}}const oc="BOP";class ci{constructor(){this._lexer=new Ux,this._handler=null}parseData(e){if(typeof e!="string")throw new TypeError(`The first parameter must be a string: ${e}`);this._handler!==null&&typeof this._handler.beginParse=="function"&&this._handler.beginParse();const r=this._lexer;r.setPathData(e);let n=oc,i=null,f=r.getNextToken();for(;f.typeis(zt.EOD)===!1;){let m;const c=[];switch(f.type){case zt.COMMAND:if(n===oc&&f.text!=="M"&&f.text!=="m")throw new SyntaxError(`New paths must begin with a moveto command. Found '${f.text}'`);n=f.text,m=ci.PARAMCOUNT[f.text.toUpperCase()],f=r.getNextToken();break;case zt.NUMBER:if(n===oc)throw new SyntaxError(`New paths must begin with a moveto command. Found '${f.text}'`);m=ci.PARAMCOUNT[n.toUpperCase()];break;default:throw new SyntaxError(`Unrecognized command type: ${f.type}`)}for(let s=0;s<m;s++){switch(f.type){case zt.COMMAND:throw new SyntaxError(`Parameter must be a number. Found '${f.text}'`);case zt.NUMBER:c[s]=parseFloat(f.text);break;case zt.EOD:throw new SyntaxError("Unexpected end of string");default:throw new SyntaxError(`Unrecognized parameter type. Found type '${f.type}'`)}f=r.getNextToken()}if(this._handler!==null){const s=this._handler,u=ci.METHODNAME[n];(n==="a"||n==="A")&&(c[3]=c[3]!==0,c[4]=c[4]!==0),s!==null&&typeof s[u]=="function"&&s[u](...c)}switch(n){case"M":n="L";break;case"m":n="l";break;case"Z":case"z":n="BOP";break}if(f===i)throw new SyntaxError(`Parser stalled on '${f.text}'`);i=f}this._handler!==null&&typeof this._handler.endParse=="function"&&this._handler.endParse()}setHandler(e){this._handler=e}}ci.PARAMCOUNT={A:7,C:6,H:1,L:2,M:2,Q:4,S:4,T:2,V:1,Z:0};ci.METHODNAME={A:"arcAbs",a:"arcRel",C:"curvetoCubicAbs",c:"curvetoCubicRel",H:"linetoHorizontalAbs",h:"linetoHorizontalRel",L:"linetoAbs",l:"linetoRel",M:"movetoAbs",m:"movetoRel",Q:"curvetoQuadraticAbs",q:"curvetoQuadraticRel",S:"curvetoCubicSmoothAbs",s:"curvetoCubicSmoothRel",T:"curvetoQuadraticSmoothAbs",t:"curvetoQuadraticSmoothRel",V:"linetoVerticalAbs",v:"linetoVerticalRel",Z:"closePath",z:"closePath"};const Wx=2*Math.PI;function $h(t,e,r,n,i,f,m){i=i*Math.PI/180;const c=Math.cos(i),s=Math.sin(i),u=1e-6,d=t.subtract(e).multiply(.5),l=d.x*c+d.y*s,o=d.x*-s+d.y*c;r=Math.abs(r),n=Math.abs(n);const a=l*l,h=o*o,g=a/(r*r)+h/(n*n);if(g>1){const ne=Math.sqrt(g);r*=ne,n*=ne}const p=r*r,v=n*n,x=p*h,y=v*a;let _=(p*v-x-y)/(x+y);Math.abs(_)<u&&(_=0);let w=Math.sqrt(_);f===m&&(w=-w);const C=t.add(e).multiply(.5),S=w*r*o/n,O=w*-n*l/r,F=(l-S)/r,N=(l+S)/r,W=(o-O)/n,X=(o+O)/n,Q=new gt(1,0).angleBetween(new gt(F,W));let ae=new gt(F,W).angleBetween(new gt(-N,-X));return m===!1&&(ae-=Wx),[S*c-O*s+C.x,S*s+O*c+C.y,r,n,Q,Q+ae]}class zx{constructor(e){this.shapeCreator=e,this.shapes=[],this.firstX=null,this.firstY=null,this.lastX=null,this.lastY=null,this.lastCommand=null}beginParse(){this.shapes=[],this.firstX=null,this.firstY=null,this.lastX=null,this.lastY=null,this.lastCommand=null}addShape(e){this.shapes.push(e)}arcAbs(e,r,n,i,f,m,c){if(e===0||r===0)this.addShape(this.shapeCreator.line(this.lastX,this.lastY,m,c));else{const s=$h(new Me(this.lastX,this.lastY),new Me(m,c),e,r,n,i,f);this.addShape(this.shapeCreator.arc(...s))}this.lastCommand="A",this.lastX=m,this.lastY=c}arcRel(e,r,n,i,f,m,c){if(e===0||r===0)this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.lastX+m,this.lastY+c));else{const s=$h(new Me(this.lastX,this.lastY),new Me(this.lastX+m,this.lastY+c),e,r,n,i,f);this.addShape(this.shapeCreator.arc(...s))}this.lastCommand="a",this.lastX+=m,this.lastY+=c}curvetoCubicAbs(e,r,n,i,f,m){this.addShape(this.shapeCreator.cubicBezier(this.lastX,this.lastY,e,r,n,i,f,m)),this.lastX=f,this.lastY=m,this.lastCommand="C"}curvetoCubicRel(e,r,n,i,f,m){this.addShape(this.shapeCreator.cubicBezier(this.lastX,this.lastY,this.lastX+e,this.lastY+r,this.lastX+n,this.lastY+i,this.lastX+f,this.lastY+m)),this.lastX+=f,this.lastY+=m,this.lastCommand="c"}linetoHorizontalAbs(e){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,e,this.lastY)),this.lastX=e,this.lastCommand="H"}linetoHorizontalRel(e){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.lastX+e,this.lastY)),this.lastX+=e,this.lastCommand="h"}linetoAbs(e,r){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,e,r)),this.lastX=e,this.lastY=r,this.lastCommand="L"}linetoRel(e,r){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.lastX+e,this.lastY+r)),this.lastX+=e,this.lastY+=r,this.lastCommand="l"}movetoAbs(e,r){this.firstX=e,this.firstY=r,this.lastX=e,this.lastY=r,this.lastCommand="M"}movetoRel(e,r){this.firstX+=e,this.firstY+=r,this.lastX+=e,this.lastY+=r,this.lastCommand="m"}curvetoQuadraticAbs(e,r,n,i){this.addShape(this.shapeCreator.quadraticBezier(this.lastX,this.lastY,e,r,n,i)),this.lastX=n,this.lastY=i,this.lastCommand="Q"}curvetoQuadraticRel(e,r,n,i){this.addShape(this.shapeCreator.quadraticBezier(this.lastX,this.lastY,this.lastX+e,this.lastY+r,this.lastX+n,this.lastY+i)),this.lastX+=n,this.lastY+=i,this.lastCommand="q"}curvetoCubicSmoothAbs(e,r,n,i){let f,m;if(this.lastCommand.match(/^[SsCc]$/)){const c=this.shapes[this.shapes.length-1].args[2];f=2*this.lastX-c.x,m=2*this.lastY-c.y}else f=this.lastX,m=this.lastY;this.addShape(this.shapeCreator.cubicBezier(this.lastX,this.lastY,f,m,e,r,n,i)),this.lastX=n,this.lastY=i,this.lastCommand="S"}curvetoCubicSmoothRel(e,r,n,i){let f,m;if(this.lastCommand.match(/^[SsCc]$/)){const c=this.shapes[this.shapes.length-1].args[2];f=2*this.lastX-c.x,m=2*this.lastY-c.y}else f=this.lastX,m=this.lastY;this.addShape(this.shapeCreator.cubicBezier(this.lastX,this.lastY,f,m,this.lastX+e,this.lastY+r,this.lastX+n,this.lastY+i)),this.lastX+=n,this.lastY+=i,this.lastCommand="s"}curvetoQuadraticSmoothAbs(e,r){let n,i;if(this.lastCommand.match(/^[QqTt]$/)){const f=this.shapes[this.shapes.length-1].args[1];n=2*this.lastX-f.x,i=2*this.lastY-f.y}else n=this.lastX,i=this.lastY;this.addShape(this.shapeCreator.quadraticBezier(this.lastX,this.lastY,n,i,e,r)),this.lastX=e,this.lastY=r,this.lastCommand="T"}curvetoQuadraticSmoothRel(e,r){let n,i;if(this.lastCommand.match(/^[QqTt]$/)){const f=this.shapes[this.shapes.length-1].args[1];n=2*this.lastX-f.x,i=2*this.lastY-f.y}else n=this.lastX,i=this.lastY;this.addShape(this.shapeCreator.quadraticBezier(this.lastX,this.lastY,n,i,this.lastX+e,this.lastY+r)),this.lastX+=e,this.lastY+=r,this.lastCommand="t"}linetoVerticalAbs(e){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.lastX,e)),this.lastY=e,this.lastCommand="V"}linetoVerticalRel(e){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.lastX,this.lastY+e)),this.lastY+=e,this.lastCommand="v"}closePath(){this.addShape(this.shapeCreator.line(this.lastX,this.lastY,this.firstX,this.firstY)),this.lastX=this.firstX,this.lastY=this.firstY,this.lastCommand="z"}}const Jn=Math.PI*.5,ng=new ci;function en(t,e){const r=[];for(const[n,i]of t){let f=null;if(i==="Point2D")f=fu(n,e);else if(i==="Number")f=Kh(n,e);else if(i==="Array<Point2D>"||i==="Point2D[]"){const m=[];for(;e.length>0;)m.push(fu(n,e));m.length>0&&(f=m)}else if(i==="Optional<Number>"||i==="Number?")f=Kh(n,e),f===null&&(f=void 0);else throw new TypeError(`Unrecognized value type: ${i}`);if(f!==null)r.push(f);else throw new TypeError(`Unable to extract value for ${n}`)}return r}function Kh(t,e){let r=null;if(e.length>0){const n=e[0],i=typeof n;if(i==="number")return e.shift();if(i==="object"){for(const f of t)if(f in n&&typeof n[f]=="number"){r=n[f];break}}}return r}function fu(t,e){let r=null;if(e.length>0){const n=e[0],i=typeof n;if(i==="number"){if(e.length>1){const f=e.shift(),m=e.shift();r=new Me(f,m)}}else if(Array.isArray(n)&&n.length>1)if(n.length===2){const[f,m]=e.shift();r=new Me(f,m)}else throw new TypeError(`Unhandled array of length ${n.length}`);else if(i==="object"){if("x"in n&&"y"in n)r=new Me(n.x,n.y),e.shift();else for(const f of t)if(Array.isArray(f)){if(f.every(m=>m in n)){r=new Me(n[f[0]],n[f[1]]);break}}else if(f in n){r=fu([],[n[f]]);break}}}return r}class Le{constructor(e,r){this.name=e,this.args=r}static arc(...e){const n=en([[["center",["centerX","centerY"],["cx","cy"]],"Point2D"],[["radiusX","rx"],"Number"],[["radiusY","ry"],"Number"],[["startRadians"],"Number"],[["endRadians"],"Number"]],e);return new Le(Le.ARC,n)}static quadraticBezier(...e){const n=en([[["p1",["p1x","p1y"]],"Point2D"],[["p2",["p2x","p2y"]],"Point2D"],[["p3",["p3x","p3y"]],"Point2D"]],e);return new Le(Le.QUADRATIC_BEZIER,n)}static cubicBezier(...e){const n=en([[["p1",["p1x","p1y"]],"Point2D"],[["p2",["p2x","p2y"]],"Point2D"],[["p3",["p3x","p3y"]],"Point2D"],[["p4",["p4x","p4y"]],"Point2D"]],e);return new Le(Le.CUBIC_BEZIER,n)}static circle(...e){const n=en([[["center",["centerX","centerY"],["cx","cy"]],"Point2D"],[["radius","r"],"Number"]],e);return new Le(Le.CIRCLE,n)}static ellipse(...e){const n=en([[["center",["centerX","centerY"],["cx","cy"]],"Point2D"],[["radiusX","rx"],"Number"],[["radiusY","ry"],"Number"]],e);return new Le(Le.ELLIPSE,n)}static line(...e){const n=en([[["p1",["p1x","p1y"],["x1","y1"]],"Point2D"],[["p2",["p2x","p2y"],["x2","y2"]],"Point2D"]],e);return new Le(Le.LINE,n)}static path(...e){return ng.parseData(e[0]),new Le(Le.PATH,ig.shapes)}static polygon(...e){const n=en([[[],"Array<Point2D>"]],e.length===1&&Array.isArray(e[0])?e[0]:e);return new Le(Le.POLYGON,n)}static polyline(...e){const n=en([[[],"Array<Point2D>"]],e.length===1&&Array.isArray(e[0])?e[0]:e);return new Le(Le.POLYLINE,n)}static rectangle(...e){const n=en([[["topLeft",["x","y"],["left","top"]],"Point2D"],[["size",["width","height"],["w","h"]],"Point2D"],[["radiusX","rx"],"Optional<Number>"],[["radiusY","ry"],"Optional<Number>"]],e),i=n[0],f=n[1];n[1]=new Me(i.x+f.x,i.y+f.y);const m=new Le(Le.RECTANGLE,n);let c=m.args.pop(),s=m.args.pop();if(s=s===void 0?0:s,c=c===void 0?0:c,s===0&&c===0)return m;const{x:u,y:d}=m.args[0],{x:l,y:o}=m.args[1],a=l-u,h=o-d;s===0&&(s=c),c===0&&(c=s),s>a*.5&&(s=a*.5),c>h*.5&&(c=h*.5);const g=u,p=d,v=u+s,x=d+c,y=l-s,_=o-c,w=l,C=o,S=[Le.arc(v,x,s,c,2*Jn,3*Jn),Le.line(v,p,y,p),Le.arc(y,x,s,c,3*Jn,4*Jn),Le.line(w,x,w,_),Le.arc(y,_,s,c,0,Jn),Le.line(y,C,v,C),Le.arc(v,_,s,c,Jn,2*Jn),Le.line(g,_,g,x)];return new Le(Le.PATH,S)}}Le.ARC="Arc";Le.QUADRATIC_BEZIER="Bezier2";Le.CUBIC_BEZIER="Bezier3";Le.CIRCLE="Circle";Le.ELLIPSE="Ellipse";Le.LINE="Line";Le.PATH="Path";Le.POLYGON="Polygon";Le.POLYLINE="Polyline";Le.RECTANGLE="Rectangle";const ig=new zx(Le);ng.setHandler(ig);const Vs=2*Math.PI,Xx=new gt(1,0);function Qh(t){return t==null}function Hx(t,e){const r=t[0]*e[1]-e[0]*t[1],n=t[0]*e[2]-e[0]*t[2],i=t[0]*e[3]-e[0]*t[3],f=t[0]*e[4]-e[0]*t[4],m=t[0]*e[5]-e[0]*t[5],c=t[1]*e[2]-e[1]*t[2],s=t[1]*e[4]-e[1]*t[4],u=t[1]*e[5]-e[1]*t[5],d=t[2]*e[3]-e[2]*t[3],l=t[3]*e[4]-e[3]*t[4],o=t[3]*e[5]-e[3]*t[5],a=u+l,h=s-d;return new tt(r*c-n*n,r*h+i*c-2*n*f,r*a+i*h-f*f-2*n*m,r*o+i*a-2*f*m,i*o-m*m)}function Yx(t){const e=t%Vs;return e<0?e+Vs:e}function Vx(t,e,r,n,i,f){if(t.points.length===0)return t;const m=new me("No Intersection");f<i&&([i,f]=[f,i]),(i<0||f<0)&&(i+=Vs,f+=Vs);for(const c of t.points){let s=Yx(Xx.angleBetween(gt.fromPoints(e,c)));s<i&&(s+=Vs),i<=s&&s<=f&&m.appendPoint(c)}return m.points.length>0&&(m.status="Intersection"),m}function tn(t){const e=t.slice();return e.push(t[0]),e}class me{constructor(e){this.init(e)}init(e){this.status=e,this.points=[]}static intersect(e,r){let n;if(!Qh(e)&&!Qh(r))if(e.name==="Path")n=me.intersectPathShape(e,r);else if(r.name==="Path")n=me.intersectPathShape(r,e);else if(e.name==="Arc")n=me.intersectArcShape(e,r);else if(r.name==="Arc")n=me.intersectArcShape(r,e);else{let i,f;if(e.name<r.name?(i="intersect"+e.name+r.name,f=e.args.concat(r.args)):(i="intersect"+r.name+e.name,f=r.args.concat(e.args)),!(i in me))throw new TypeError("Intersection not available: "+i);n=me[i].apply(null,f)}else n=new me("No Intersection");return n}static intersectPathShape(e,r){const n=new me("No Intersection");for(const i of e.args){const f=me.intersect(i,r);n.appendPoints(f.points)}return n.points.length>0&&(n.status="Intersection"),n}static intersectArcShape(e,r){const[n,i,f,m,c]=e.args,s=new Le(Le.ELLIPSE,[n,i,f]),u=me.intersect(s,r);return Vx(u,n,i,f,m,c)}static intersectBezier2Bezier2(e,r,n,i,f,m){let c,s;const u=new me("No Intersection");c=r.multiply(-2);const d=e.add(c.add(n));c=e.multiply(-2),s=r.multiply(2);const l=c.add(s),o=new Me(e.x,e.y);c=f.multiply(-2);const a=i.add(c.add(m));c=i.multiply(-2),s=f.multiply(2);const h=c.add(s),g=new Me(i.x,i.y);c=d.x*l.y-l.x*d.y,s=a.x*l.y-l.x*a.y;const p=h.x*l.y-l.x*h.y,v=l.x*(o.y-g.y)+l.y*(-o.x+g.x),x=a.x*d.y-d.x*a.y,y=h.x*d.y-d.x*h.y,_=d.x*(o.y-g.y)+d.y*(-o.x+g.x),C=new tt(-x*x,-2*x*y,c*s-y*y-2*x*_,c*p-2*y*_,c*v-_*_).getRoots();for(const S of C)if(0<=S&&S<=1){const O=new tt(d.x,l.x,o.x-g.x-S*h.x-S*S*a.x);O.simplifyEquals();const F=O.getRoots(),N=new tt(d.y,l.y,o.y-g.y-S*h.y-S*S*a.y);N.simplifyEquals();const W=N.getRoots();if(F.length>0&&W.length>0){e:for(const Q of F)if(0<=Q&&Q<=1){for(let ae=0;ae<W.length;ae++)if(Math.abs(Q-W[ae])<1e-4){u.points.push(a.multiply(S*S).add(h.multiply(S).add(g)));break e}}}}return u.points.length>0&&(u.status="Intersection"),u}static intersectBezier2Bezier3(e,r,n,i,f,m,c){let s,u,d,l;const o=new me("No Intersection");s=r.multiply(-2);const a=e.add(s.add(n));s=e.multiply(-2),u=r.multiply(2);const h=s.add(u),g=new Me(e.x,e.y);s=i.multiply(-1),u=f.multiply(3),d=m.multiply(-3),l=s.add(u.add(d.add(c)));const p=new Me(l.x,l.y);s=i.multiply(3),u=f.multiply(-6),d=m.multiply(3),l=s.add(u.add(d));const v=new Me(l.x,l.y);s=i.multiply(-3),u=f.multiply(3),d=s.add(u);const x=new Me(d.x,d.y),y=new Me(i.x,i.y),_=g.x*g.x,w=g.y*g.y,C=h.x*h.x,S=h.y*h.y,O=a.x*a.x,F=a.y*a.y,N=y.x*y.x,W=y.y*y.y,X=x.x*x.x,Q=x.y*x.y,ae=v.x*v.x,ne=v.y*v.y,J=p.x*p.x,oe=p.y*p.y,k=new tt(-2*a.x*a.y*p.x*p.y+O*oe+F*J,-2*a.x*a.y*v.x*p.y-2*a.x*a.y*v.y*p.x+2*F*v.x*p.x+2*O*v.y*p.y,-2*a.x*x.x*a.y*p.y-2*a.x*a.y*x.y*p.x-2*a.x*a.y*v.x*v.y+2*x.x*F*p.x+F*ae+O*(2*x.y*p.y+ne),2*g.x*a.x*a.y*p.y+2*g.y*a.x*a.y*p.x+h.x*h.y*a.x*p.y+h.x*h.y*a.y*p.x-2*y.x*a.x*a.y*p.y-2*a.x*y.y*a.y*p.x-2*a.x*x.x*a.y*v.y-2*a.x*a.y*x.y*v.x-2*g.x*F*p.x-2*g.y*O*p.y+2*y.x*F*p.x+2*x.x*F*v.x-S*a.x*p.x-C*a.y*p.y+O*(2*y.y*p.y+2*x.y*v.y),2*g.x*a.x*a.y*v.y+2*g.y*a.x*a.y*v.x+h.x*h.y*a.x*v.y+h.x*h.y*a.y*v.x-2*y.x*a.x*a.y*v.y-2*a.x*y.y*a.y*v.x-2*a.x*x.x*a.y*x.y-2*g.x*F*v.x-2*g.y*O*v.y+2*y.x*F*v.x-S*a.x*v.x-C*a.y*v.y+X*F+O*(2*y.y*v.y+Q),2*g.x*a.x*a.y*x.y+2*g.y*a.x*x.x*a.y+h.x*h.y*a.x*x.y+h.x*h.y*x.x*a.y-2*y.x*a.x*a.y*x.y-2*a.x*y.y*x.x*a.y-2*g.x*x.x*F-2*g.y*O*x.y+2*y.x*x.x*F-S*a.x*x.x-C*a.y*x.y+2*O*y.y*x.y,-2*g.x*g.y*a.x*a.y-g.x*h.x*h.y*a.y-g.y*h.x*h.y*a.x+2*g.x*a.x*y.y*a.y+2*g.y*y.x*a.x*a.y+h.x*y.x*h.y*a.y+h.x*h.y*a.x*y.y-2*y.x*a.x*y.y*a.y-2*g.x*y.x*F+g.x*S*a.x+g.y*C*a.y-2*g.y*O*y.y-y.x*S*a.x-C*y.y*a.y+_*F+w*O+N*F+O*W).getRootsInInterval(0,1);for(const D of k){const L=new tt(a.x,h.x,g.x-y.x-D*x.x-D*D*v.x-D*D*D*p.x).getRoots(),E=new tt(a.y,h.y,g.y-y.y-D*x.y-D*D*v.y-D*D*D*p.y).getRoots();if(L.length>0&&E.length>0){e:for(const A of L)if(0<=A&&A<=1){for(let T=0;T<E.length;T++)if(Math.abs(A-E[T])<1e-4){o.points.push(p.multiply(D*D*D).add(v.multiply(D*D).add(x.multiply(D).add(y))));break e}}}}return o.points.length>0&&(o.status="Intersection"),o}static intersectBezier2Circle(e,r,n,i,f){return me.intersectBezier2Ellipse(e,r,n,i,f,f)}static intersectBezier2Ellipse(e,r,n,i,f,m){let c;const s=new me("No Intersection");c=r.multiply(-2);const u=e.add(c.add(n));c=e.multiply(-2);const d=r.multiply(2),l=c.add(d),o=new Me(e.x,e.y),a=f*f,h=m*m,g=new tt(h*u.x*u.x+a*u.y*u.y,2*(h*u.x*l.x+a*u.y*l.y),h*(2*u.x*o.x+l.x*l.x)+a*(2*u.y*o.y+l.y*l.y)-2*(h*i.x*u.x+a*i.y*u.y),2*(h*l.x*(o.x-i.x)+a*l.y*(o.y-i.y)),h*(o.x*o.x+i.x*i.x)+a*(o.y*o.y+i.y*i.y)-2*(h*i.x*o.x+a*i.y*o.y)-a*h).getRoots();for(const p of g)0<=p&&p<=1&&s.points.push(u.multiply(p*p).add(l.multiply(p).add(o)));return s.points.length>0&&(s.status="Intersection"),s}static intersectBezier2Line(e,r,n,i,f){let m;const c=i.min(f),s=i.max(f),u=new me("No Intersection");m=r.multiply(-2);const d=e.add(m.add(n));m=e.multiply(-2);const l=r.multiply(2),o=m.add(l),a=new Me(e.x,e.y),h=new gt(i.y-f.y,f.x-i.x),g=i.x*f.y-f.x*i.y,p=new tt(h.dot(d),h.dot(o),h.dot(a)+g).getRoots();for(const v of p)if(0<=v&&v<=1){const x=e.lerp(r,v),y=r.lerp(n,v),_=x.lerp(y,v);i.x===f.x?c.y<=_.y&&_.y<=s.y&&(u.status="Intersection",u.appendPoint(_)):i.y===f.y?c.x<=_.x&&_.x<=s.x&&(u.status="Intersection",u.appendPoint(_)):c.x<=_.x&&_.x<=s.x&&c.y<=_.y&&_.y<=s.y&&(u.status="Intersection",u.appendPoint(_))}return u}static intersectBezier2Polygon(e,r,n,i){return me.intersectBezier2Polyline(e,r,n,tn(i))}static intersectBezier2Polyline(e,r,n,i){const f=new me("No Intersection"),{length:m}=i;for(let c=0;c<m-1;c++){const s=i[c],u=i[c+1],d=me.intersectBezier2Line(e,r,n,s,u);f.appendPoints(d.points)}return f.points.length>0&&(f.status="Intersection"),f}static intersectBezier2Rectangle(e,r,n,i,f){const m=i.min(f),c=i.max(f),s=new Me(c.x,m.y),u=new Me(m.x,c.y),d=me.intersectBezier2Line(e,r,n,m,s),l=me.intersectBezier2Line(e,r,n,s,c),o=me.intersectBezier2Line(e,r,n,c,u),a=me.intersectBezier2Line(e,r,n,u,m),h=new me("No Intersection");return h.appendPoints(d.points),h.appendPoints(l.points),h.appendPoints(o.points),h.appendPoints(a.points),h.points.length>0&&(h.status="Intersection"),h}static intersectBezier3Bezier3(e,r,n,i,f,m,c,s){let u,d,l,o;const a=new me("No Intersection");u=e.multiply(-1),d=r.multiply(3),l=n.multiply(-3),o=u.add(d.add(l.add(i)));const h=new Me(o.x,o.y);u=e.multiply(3),d=r.multiply(-6),l=n.multiply(3),o=u.add(d.add(l));const g=new Me(o.x,o.y);u=e.multiply(-3),d=r.multiply(3),l=u.add(d);const p=new Me(l.x,l.y),v=new Me(e.x,e.y);u=f.multiply(-1),d=m.multiply(3),l=c.multiply(-3),o=u.add(d.add(l.add(s)));const x=new Me(o.x,o.y);u=f.multiply(3),d=m.multiply(-6),l=c.multiply(3),o=u.add(d.add(l));const y=new Me(o.x,o.y);u=f.multiply(-3),d=m.multiply(3),l=u.add(d);const _=new Me(l.x,l.y),w=new Me(f.x,f.y);u=h.x*g.y-g.x*h.y,d=h.x*p.y-p.x*h.y;const C=h.x*v.y-v.x*h.y+w.x*h.y-h.x*w.y,S=_.x*h.y-h.x*_.y,O=y.x*h.y-h.x*y.y,F=x.x*h.y-h.x*x.y;o=h.x*p.y-p.x*h.y;const N=h.x*v.y+g.x*p.y-p.x*g.y-v.x*h.y+w.x*h.y-h.x*w.y,W=_.x*h.y-h.x*_.y,X=y.x*h.y-h.x*y.y,Q=x.x*h.y-h.x*x.y,ae=g.x*v.y-v.x*g.y+w.x*g.y-g.x*w.y,ne=_.x*g.y-g.x*_.y,J=y.x*g.y-g.x*y.y,oe=x.x*g.y-g.x*x.y,q=h.x*v.y-v.x*h.y+w.x*h.y-h.x*w.y,k=_.x*h.y-h.x*_.y,D=y.x*h.y-h.x*y.y,L=x.x*h.y-h.x*x.y,E=g.x*v.y-v.x*g.y+w.x*g.y-g.x*w.y,b=_.x*g.y-g.x*_.y,A=y.x*g.y-g.x*y.y,T=x.x*g.y-g.x*x.y,R=p.x*v.y-v.x*p.y+w.x*p.y-p.x*w.y,z=_.x*p.y-p.x*_.y,K=y.x*p.y-p.x*y.y,H=x.x*p.y-p.x*x.y,G=new tt(-F*Q*L,-F*Q*D-F*X*L-O*Q*L,-F*Q*k-F*X*D-O*Q*D-F*W*L-O*X*L-S*Q*L,-F*Q*q-F*X*k-O*Q*k-F*W*D-O*X*D-S*Q*D-F*N*L-O*W*L-S*X*L-C*Q*L+d*oe*L+F*o*T-u*oe*T+u*Q*H,-F*X*q-O*Q*q-F*W*k-O*X*k-S*Q*k-F*N*D-O*W*D-S*X*D-C*Q*D+d*oe*D-O*N*L-S*W*L-C*X*L+d*J*L+F*o*A-u*oe*A+O*o*T-u*J*T+u*Q*K+u*X*H,-F*W*q-O*X*q-S*Q*q-F*N*k-O*W*k-S*X*k-C*Q*k+d*oe*k-O*N*D-S*W*D-C*X*D+d*J*D-S*N*L-C*W*L+d*ne*L+F*o*b-u*oe*b+O*o*A-u*J*A+S*o*T-u*ne*T+u*Q*z+u*X*K+u*W*H,-F*N*q-O*W*q-S*X*q-C*Q*q+d*oe*q-O*N*k-S*W*k-C*X*k+d*J*k-S*N*D-C*W*D+d*ne*D-C*N*L+d*ae*L+F*o*E-u*oe*E+O*o*b-u*J*b+S*o*A-u*ne*A+C*o*T-u*ae*T+u*Q*R+u*X*z+u*W*K-d*o*H+u*N*H,-O*N*q-S*W*q-C*X*q+d*J*q-S*N*k-C*W*k+d*ne*k-C*N*D+d*ae*D+O*o*E-u*J*E+S*o*b-u*ne*b+C*o*A-u*ae*A+u*X*R+u*W*z-d*o*K+u*N*K,-S*N*q-C*W*q+d*ne*q-C*N*k+d*ae*k+S*o*E-u*ne*E+C*o*b-u*ae*b+u*W*R-d*o*z+u*N*z,-C*N*q+d*ae*q+C*o*E-u*ae*E-d*o*R+u*N*R);G.simplifyEquals();const ue=G.getRootsInInterval(0,1);for(const le of ue){const ee=new tt(h.x,g.x,p.x,v.x-w.x-le*_.x-le*le*y.x-le*le*le*x.x);ee.simplifyEquals();const Y=ee.getRoots(),ce=new tt(h.y,g.y,p.y,v.y-w.y-le*_.y-le*le*y.y-le*le*le*x.y);ce.simplifyEquals();const se=ce.getRoots();if(Y.length>0&&se.length>0){e:for(const he of Y)if(0<=he&&he<=1){for(let ve=0;ve<se.length;ve++)if(Math.abs(he-se[ve])<1e-4){a.points.push(x.multiply(le*le*le).add(y.multiply(le*le).add(_.multiply(le).add(w))));break e}}}}return a.points.length>0&&(a.status="Intersection"),a}static intersectBezier3Circle(e,r,n,i,f,m){return me.intersectBezier3Ellipse(e,r,n,i,f,m,m)}static intersectBezier3Ellipse(e,r,n,i,f,m,c){let s,u,d,l;const o=new me("No Intersection");s=e.multiply(-1),u=r.multiply(3),d=n.multiply(-3),l=s.add(u.add(d.add(i)));const a=new Me(l.x,l.y);s=e.multiply(3),u=r.multiply(-6),d=n.multiply(3),l=s.add(u.add(d));const h=new Me(l.x,l.y);s=e.multiply(-3),u=r.multiply(3),d=s.add(u);const g=new Me(d.x,d.y),p=new Me(e.x,e.y),v=m*m,x=c*c,_=new tt(a.x*a.x*x+a.y*a.y*v,2*(a.x*h.x*x+a.y*h.y*v),2*(a.x*g.x*x+a.y*g.y*v)+h.x*h.x*x+h.y*h.y*v,2*a.x*x*(p.x-f.x)+2*a.y*v*(p.y-f.y)+2*(h.x*g.x*x+h.y*g.y*v),2*h.x*x*(p.x-f.x)+2*h.y*v*(p.y-f.y)+g.x*g.x*x+g.y*g.y*v,2*g.x*x*(p.x-f.x)+2*g.y*v*(p.y-f.y),p.x*p.x*x-2*p.y*f.y*v-2*p.x*f.x*x+p.y*p.y*v+f.x*f.x*x+f.y*f.y*v-v*x).getRootsInInterval(0,1);for(const w of _)o.points.push(a.multiply(w*w*w).add(h.multiply(w*w).add(g.multiply(w).add(p))));return o.points.length>0&&(o.status="Intersection"),o}static intersectBezier3Line(e,r,n,i,f,m){let c,s,u,d;const l=f.min(m),o=f.max(m),a=new me("No Intersection");c=e.multiply(-1),s=r.multiply(3),u=n.multiply(-3),d=c.add(s.add(u.add(i)));const h=new gt(d.x,d.y);c=e.multiply(3),s=r.multiply(-6),u=n.multiply(3),d=c.add(s.add(u));const g=new gt(d.x,d.y);c=e.multiply(-3),s=r.multiply(3),u=c.add(s);const p=new gt(u.x,u.y),v=new gt(e.x,e.y),x=new gt(f.y-m.y,m.x-f.x),y=f.x*m.y-m.x*f.y,_=new tt(x.dot(h),x.dot(g),x.dot(p),x.dot(v)+y).getRoots();for(const w of _)if(0<=w&&w<=1){const C=e.lerp(r,w),S=r.lerp(n,w),O=n.lerp(i,w),F=C.lerp(S,w),N=S.lerp(O,w),W=F.lerp(N,w);f.x===m.x?l.y<=W.y&&W.y<=o.y&&(a.status="Intersection",a.appendPoint(W)):f.y===m.y?l.x<=W.x&&W.x<=o.x&&(a.status="Intersection",a.appendPoint(W)):l.x<=W.x&&W.x<=o.x&&l.y<=W.y&&W.y<=o.y&&(a.status="Intersection",a.appendPoint(W))}return a}static intersectBezier3Polygon(e,r,n,i,f){return me.intersectBezier3Polyline(e,r,n,i,tn(f))}static intersectBezier3Polyline(e,r,n,i,f){const m=new me("No Intersection"),{length:c}=f;for(let s=0;s<c-1;s++){const u=f[s],d=f[s+1],l=me.intersectBezier3Line(e,r,n,i,u,d);m.appendPoints(l.points)}return m.points.length>0&&(m.status="Intersection"),m}static intersectBezier3Rectangle(e,r,n,i,f,m){const c=f.min(m),s=f.max(m),u=new Me(s.x,c.y),d=new Me(c.x,s.y),l=me.intersectBezier3Line(e,r,n,i,c,u),o=me.intersectBezier3Line(e,r,n,i,u,s),a=me.intersectBezier3Line(e,r,n,i,s,d),h=me.intersectBezier3Line(e,r,n,i,d,c),g=new me("No Intersection");return g.appendPoints(l.points),g.appendPoints(o.points),g.appendPoints(a.points),g.appendPoints(h.points),g.points.length>0&&(g.status="Intersection"),g}static intersectCircleCircle(e,r,n,i){let f;const m=r+i,c=Math.abs(r-i),s=e.distanceFrom(n);if(s>m)f=new me("Outside");else if(s<c)f=new me("Inside");else{f=new me("Intersection");const u=(r*r-i*i+s*s)/(2*s),d=Math.sqrt(r*r-u*u),l=e.lerp(n,u/s),o=d/s;f.points.push(new Me(l.x-o*(n.y-e.y),l.y+o*(n.x-e.x))),f.points.push(new Me(l.x+o*(n.y-e.y),l.y-o*(n.x-e.x)))}return f}static intersectCircleEllipse(e,r,n,i,f){return me.intersectEllipseEllipse(e,r,r,n,i,f)}static intersectCircleLine(e,r,n,i){let f;const m=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y),c=2*((i.x-n.x)*(n.x-e.x)+(i.y-n.y)*(n.y-e.y)),s=e.x*e.x+e.y*e.y+n.x*n.x+n.y*n.y-2*(e.x*n.x+e.y*n.y)-r*r,u=c*c-4*m*s;if(u<0)f=new me("Outside");else if(u===0)f=new me("Tangent");else{const d=Math.sqrt(u),l=(-c+d)/(2*m),o=(-c-d)/(2*m);(l<0||l>1)&&(o<0||o>1)?l<0&&o<0||l>1&&o>1?f=new me("Outside"):f=new me("Inside"):(f=new me("Intersection"),0<=l&&l<=1&&f.points.push(n.lerp(i,l)),0<=o&&o<=1&&f.points.push(n.lerp(i,o)))}return f}static intersectCirclePolygon(e,r,n){return me.intersectCirclePolyline(e,r,tn(n))}static intersectCirclePolyline(e,r,n){const i=new me("No Intersection"),{length:f}=n;let m;for(let c=0;c<f-1;c++){const s=n[c],u=n[c+1];m=me.intersectCircleLine(e,r,s,u),i.appendPoints(m.points)}return i.points.length>0?i.status="Intersection":i.status=m.status,i}static intersectCircleRectangle(e,r,n,i){const f=n.min(i),m=n.max(i),c=new Me(m.x,f.y),s=new Me(f.x,m.y),u=me.intersectCircleLine(e,r,f,c),d=me.intersectCircleLine(e,r,c,m),l=me.intersectCircleLine(e,r,m,s),o=me.intersectCircleLine(e,r,s,f),a=new me("No Intersection");return a.appendPoints(u.points),a.appendPoints(d.points),a.appendPoints(l.points),a.appendPoints(o.points),a.points.length>0?a.status="Intersection":a.status=u.status,a}static intersectEllipseEllipse(e,r,n,i,f,m){const c=[n*n,0,r*r,-2*n*n*e.x,-2*r*r*e.y,n*n*e.x*e.x+r*r*e.y*e.y-r*r*n*n],s=[m*m,0,f*f,-2*m*m*i.x,-2*f*f*i.y,m*m*i.x*i.x+f*f*i.y*i.y-f*f*m*m],d=Hx(c,s).getRoots(),l=.001,o=(c[0]*c[0]+2*c[1]*c[1]+c[2]*c[2])*l,a=(s[0]*s[0]+2*s[1]*s[1]+s[2]*s[2])*l,h=new me("No Intersection");for(let g=0;g<d.length;g++){const v=new tt(c[0],c[3]+d[g]*c[1],c[5]+d[g]*(c[4]+d[g]*c[2])).getRoots();for(let x=0;x<v.length;x++){let y=(c[0]*v[x]+c[1]*d[g]+c[3])*v[x]+(c[2]*d[g]+c[4])*d[g]+c[5];Math.abs(y)<o&&(y=(s[0]*v[x]+s[1]*d[g]+s[3])*v[x]+(s[2]*d[g]+s[4])*d[g]+s[5],Math.abs(y)<a&&h.appendPoint(new Me(v[x],d[g])))}}return h.points.length>0&&(h.status="Intersection"),h}static intersectEllipseLine(e,r,n,i,f){let m;const c=new gt(i.x,i.y),s=gt.fromPoints(i,f),u=new gt(e.x,e.y),d=c.subtract(u),l=new gt(s.x/(r*r),s.y/(n*n)),o=new gt(d.x/(r*r),d.y/(n*n)),a=s.dot(l),h=s.dot(o);e=d.dot(o)-1;const g=h*h-a*e;if(g<0)m=new me("Outside");else if(g>0){const p=Math.sqrt(g),v=(-h-p)/a,x=(-h+p)/a;(v<0||1<v)&&(x<0||1<x)?v<0&&x<0||v>1&&x>1?m=new me("Outside"):m=new me("Inside"):(m=new me("Intersection"),0<=v&&v<=1&&m.appendPoint(i.lerp(f,v)),0<=x&&x<=1&&m.appendPoint(i.lerp(f,x)))}else{const p=-h/a;0<=p&&p<=1?(m=new me("Intersection"),m.appendPoint(i.lerp(f,p))):m=new me("Outside")}return m}static intersectEllipsePolygon(e,r,n,i){return me.intersectEllipsePolyline(e,r,n,tn(i))}static intersectEllipsePolyline(e,r,n,i){const f=new me("No Intersection"),{length:m}=i;for(let c=0;c<m-1;c++){const s=i[c],u=i[c+1],d=me.intersectEllipseLine(e,r,n,s,u);f.appendPoints(d.points)}return f.points.length>0&&(f.status="Intersection"),f}static intersectEllipseRectangle(e,r,n,i,f){const m=i.min(f),c=i.max(f),s=new Me(c.x,m.y),u=new Me(m.x,c.y),d=me.intersectEllipseLine(e,r,n,m,s),l=me.intersectEllipseLine(e,r,n,s,c),o=me.intersectEllipseLine(e,r,n,c,u),a=me.intersectEllipseLine(e,r,n,u,m),h=new me("No Intersection");return h.appendPoints(d.points),h.appendPoints(l.points),h.appendPoints(o.points),h.appendPoints(a.points),h.points.length>0&&(h.status="Intersection"),h}static intersectLineLine(e,r,n,i){let f;const m=(i.x-n.x)*(e.y-n.y)-(i.y-n.y)*(e.x-n.x),c=(r.x-e.x)*(e.y-n.y)-(r.y-e.y)*(e.x-n.x),s=(i.y-n.y)*(r.x-e.x)-(i.x-n.x)*(r.y-e.y);if(s!==0){const u=m/s,d=c/s;0<=u&&u<=1&&0<=d&&d<=1?(f=new me("Intersection"),f.points.push(new Me(e.x+u*(r.x-e.x),e.y+u*(r.y-e.y)))):f=new me("No Intersection")}else m===0||c===0?f=new me("Coincident"):f=new me("Parallel");return f}static intersectLinePolygon(e,r,n){return me.intersectLinePolyline(e,r,tn(n))}static intersectLinePolyline(e,r,n){const i=new me("No Intersection"),{length:f}=n;for(let m=0;m<f-1;m++){const c=n[m],s=n[m+1],u=me.intersectLineLine(e,r,c,s);i.appendPoints(u.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectLineRectangle(e,r,n,i){const f=n.min(i),m=n.max(i),c=new Me(m.x,f.y),s=new Me(f.x,m.y),u=me.intersectLineLine(f,c,e,r),d=me.intersectLineLine(c,m,e,r),l=me.intersectLineLine(m,s,e,r),o=me.intersectLineLine(s,f,e,r),a=new me("No Intersection");return a.appendPoints(u.points),a.appendPoints(d.points),a.appendPoints(l.points),a.appendPoints(o.points),a.points.length>0&&(a.status="Intersection"),a}static intersectPolygonPolygon(e,r){return me.intersectPolylinePolyline(tn(e),tn(r))}static intersectPolygonPolyline(e,r){return me.intersectPolylinePolyline(tn(e),r)}static intersectPolygonRectangle(e,r,n){return me.intersectPolylineRectangle(tn(e),r,n)}static intersectPolylinePolyline(e,r){const n=new me("No Intersection"),{length:i}=e;for(let f=0;f<i-1;f++){const m=e[f],c=e[f+1],s=me.intersectLinePolyline(m,c,r);n.appendPoints(s.points)}return n.points.length>0&&(n.status="Intersection"),n}static intersectPolylineRectangle(e,r,n){const i=r.min(n),f=r.max(n),m=new Me(f.x,i.y),c=new Me(i.x,f.y),s=me.intersectLinePolyline(i,m,e),u=me.intersectLinePolyline(m,f,e),d=me.intersectLinePolyline(f,c,e),l=me.intersectLinePolyline(c,i,e),o=new me("No Intersection");return o.appendPoints(s.points),o.appendPoints(u.points),o.appendPoints(d.points),o.appendPoints(l.points),o.points.length>0&&(o.status="Intersection"),o}static intersectRectangleRectangle(e,r,n,i){const f=e.min(r),m=e.max(r),c=new Me(m.x,f.y),s=new Me(f.x,m.y),u=me.intersectLineRectangle(f,c,n,i),d=me.intersectLineRectangle(c,m,n,i),l=me.intersectLineRectangle(m,s,n,i),o=me.intersectLineRectangle(s,f,n,i),a=new me("No Intersection");return a.appendPoints(u.points),a.appendPoints(d.points),a.appendPoints(l.points),a.appendPoints(o.points),a.points.length>0&&(a.status="Intersection"),a}static intersectRayRay(e,r,n,i){let f;const m=(i.x-n.x)*(e.y-n.y)-(i.y-n.y)*(e.x-n.x),c=(r.x-e.x)*(e.y-n.y)-(r.y-e.y)*(e.x-n.x),s=(i.y-n.y)*(r.x-e.x)-(i.x-n.x)*(r.y-e.y);if(s!==0){const u=m/s;f=new me("Intersection"),f.points.push(new Me(e.x+u*(r.x-e.x),e.y+u*(r.y-e.y)))}else m===0||c===0?f=new me("Coincident"):f=new me("Parallel");return f}appendPoint(e){this.points.push(e)}appendPoints(e){this.points=this.points.concat(e)}}const mi={};mi.pointInCircle=function(t,e,r){return gt.fromPoints(e,t).length()<=r};mi.pointInEllipse=function(t,e,r,n){const i=t.subtract(e);return i.x*i.x/(r*r)+i.y*i.y/(n*n)<=1};mi.pointInPolyline=function(t,e){const{length:r}=e;let n=0,i,f=e[0];for(let m=1;m<=r;m++){const c=e[m%r],s=Math.min(f.y,c.y),u=Math.max(f.y,c.y),d=Math.max(f.x,c.x);f.y!==c.y&&s<t.y&&t.y<=u&&t.x<=d&&(i=(t.y-f.y)*(c.x-f.x)/(c.y-f.y)+f.x,(f.x===c.x||t.x<=i)&&n++),f=c}return n%2===1};mi.pointInPolygon=mi.pointInPolyline;mi.pointInRectangle=function(t,e,r){return e.x<=t.x&&t.x<r.x&&e.y<=t.y&&t.y<r.y};const Zn=(t,e=24)=>(r,n,i)=>{r.save(),r.translate(n,i),r.fillStyle="#FFF",r.strokeRect(-e/2,-e/2,e,e),r.fillRect(-e/2,-e/2,e,e),r.fillStyle="#000",r.font="24px sans-serif",r.textAlign="center",r.textBaseline="hanging",r.fillText(t,0,-e/2-2),r.restore()},qh=(t,e=!1)=>new Fe.fabric.Control({actionName:"moveCorner",actionHandler:(r,n,i,f)=>{const m=n.target.getObjects()[0];return e?(m.path[t][1]=i,m.path[t][2]=f):(m.path[t][3]=i,m.path[t][4]=f),!0},positionHandler:(r,n,i)=>{const f=i.getObjects()[0],m=f.path;let c,s;return e?(c=m[t][1]-f.pathOffset.x,s=m[t][2]-f.pathOffset.y):(c=m[t][3]-f.pathOffset.x,s=m[t][4]-f.pathOffset.y),Fe.fabric.util.transformPoint(new Fe.fabric.Point(c,s),Fe.fabric.util.multiplyTransformMatrices(i.canvas.viewportTransform,i.calcTransformMatrix()))}}),Gx=t=>new Fe.fabric.Control({actionName:"moveQPoint",actionHandler:(e,r,n,i)=>{const f=r.target.getObjects()[0];return f.path[t][1]=n,f.path[t][2]=i,!0},positionHandler:(e,r,n)=>{const i=n.getObjects()[0],f=i.path,m=f[t][1]-i.pathOffset.x,c=f[t][2]-i.pathOffset.y;return Fe.fabric.util.transformPoint(new Fe.fabric.Point(m,c),Fe.fabric.util.multiplyTransformMatrices(n.canvas.viewportTransform,n.calcTransformMatrix()))}});class Vo extends Fe.fabric.Group{constructor(r,n,i){super(r,n,i);St(this,"_textWidth",30);St(this,"_textHeight",14);St(this,"placeholders",[]);St(this,"activePlaceholders",[]);St(this,"onAddSeat",null);St(this,"onDelete",null);St(this,"onNumberChange",null);St(this,"onMoveCaptionLeft",()=>{});St(this,"onMoveCaptionCenter",()=>{});St(this,"onMoveCaptionRight",()=>{});St(this,"controls",{...Fe.fabric.Group.prototype.controls,addSeat:new Fe.fabric.Control({actionName:"addSeat",cursorStyle:"pointer",mouseUpHandler:()=>{var r;return this.renderSeatPlaceholders(),this.setControlsVisibility({addSeat:!1,changeNumber:!1,delete:!1,moveCaptionLeft:!1,moveCaptionCenter:!1,moveCaptionRight:!1,fixAddedSeats:!0}),(r=this.canvas)==null||r.on("mouse:down",this._onSeatPlaceholderClick),!0},offsetX:20,offsetY:0,render:Zn(""),sizeX:24,sizeY:24,x:.5,y:0}),fixAddedSeats:new Fe.fabric.Control({actionName:"addSeat",cursorStyle:"pointer",mouseUpHandler:()=>{var r;return this.removeSeatPlaceholders(),this.setControlsVisibility({addSeat:!0,changeNumber:!0,delete:!0,moveCaptionLeft:!0,moveCaptionCenter:!0,moveCaptionRight:!0,fixAddedSeats:!1}),(r=this.canvas)==null||r.off("mouse:down",this._onSeatPlaceholderClick),!0},offsetX:20,offsetY:0,render:Zn(""),sizeX:24,sizeY:24,x:.5,y:0}),changeNumber:new Fe.fabric.Control({actionName:"addSeat",cursorStyle:"pointer",mouseUpHandler:()=>this.onNumberChange===null?!1:(this.onNumberChange(),!0),offsetX:50,offsetY:0,render:Zn(""),sizeX:24,sizeY:24,x:.5,y:0}),delete:new Fe.fabric.Control({actionName:"delete",cursorStyle:"pointer",mouseUpHandler:()=>this.onDelete===null?!1:(this.onDelete(),!0),offsetX:80,offsetY:0,render:Zn(""),sizeX:24,sizeY:24,x:.5,y:0}),moveCaptionLeft:new Fe.fabric.Control({actionName:"moveCaptionLeft",cursorStyle:"pointer",mouseUpHandler:()=>this.onMoveCaptionLeft===null?!1:(this.onMoveCaptionLeft(this.getEdgeCoordinates("left")),!0),offsetX:-24,offsetY:30,render:Zn("",24),sizeX:24,sizeY:24,x:0,y:.5}),moveCaptionCenter:new Fe.fabric.Control({actionName:"moveCaptionCenter",cursorStyle:"pointer",mouseUpHandler:()=>this.onMoveCaptionCenter===null?!1:(this.onMoveCaptionCenter(this.getEdgeCoordinates("center")),!0),offsetX:0,offsetY:30,render:Zn("",24),sizeX:24,sizeY:24,x:0,y:.5}),moveCaptionRight:new Fe.fabric.Control({actionName:"moveCaptionRight",cursorStyle:"pointer",mouseUpHandler:()=>this.onMoveCaptionRight===null?!1:(this.onMoveCaptionRight(this.getEdgeCoordinates("right")),!0),offsetX:24,offsetY:30,render:Zn("",24),sizeX:24,sizeY:24,x:0,y:.5})});this.setControlsVisibility({tl:!1,mt:!1,tr:!1,mr:!1,br:!1,mb:!1,bl:!1,ml:!1,mtr:!1,fixAddedSeats:!1}),this.selectable=!1,this.lockMovementX=!0,this.lockMovementY=!0;const m=this.getObjects()[0].path;this.cornerStyle="circle",this.cornerStrokeColor="#99c";let c=0,s=0;m==null||m.forEach((u,d)=>{const l=u[0];l==="M"&&(this.controls["c-"+ ++s]=qh(d,d===0)),l==="Q"&&(this.controls["q-"+ ++c]=Gx(d),this.controls["c-"+ ++s]=qh(d))}),this._onSeatPlaceholderClick=this._onSeatPlaceholderClick.bind(this)}set textWidth(r){this._textWidth=r}get textWidth(){return this._textWidth}set textHeight(r){this._textHeight=r}get textHeight(){return this._textHeight}getEdgeCoordinates(r){switch(r){case"left":return new Fe.fabric.Point(this.getBoundingRect().left-this._textWidth/2,this.getBoundingRect().top);case"center":return new Fe.fabric.Point(this.getBoundingRect().left+this.getBoundingRect().width/2-this._textWidth/2,this.getBoundingRect().top+this.getBoundingRect().height/2-this._textHeight/2);case"right":return new Fe.fabric.Point(this.getBoundingRect().left+this.getBoundingRect().width-this._textWidth/2,this.getBoundingRect().top)}throw new TypeError("No valid edge provided")}_onSeatPlaceholderClick(r){const n=this.placeholders.find(f=>f.containsPoint(r.pointer));if(n===void 0)return;const i=this.activePlaceholders.includes(n);i?this.activePlaceholders.splice(this.activePlaceholders.indexOf(n)):this.activePlaceholders.push(n),n.set({fill:i?"rgba(0, 0, 0, 0.1)":"green",stroke:i?"transparent":"rgb(0, 255, 128, 1)",strokeWidth:i?0:2})}renderSeatPlaceholders(){var s;const r=this.getObjects()[0].path,n=r.reduce((u,d)=>{switch(d[0].toUpperCase()){case"M":return u+`${d[0]} ${d[1]},${d[2]} `;case"Q":return u+`${d[0]} ${d[1]},${d[2]} ${d[3]},${d[4]} `}return u},""),i={x:r[0][1],y:r[0][2]},f=100,m=25;let c=1;for(;c<=f;){const u=me.intersect(Le.circle(i,m*c),Le.path(n));if(!u.points.length)break;const d=new Fe.fabric.Circle({left:u.points[0].x-7,top:u.points[0].y-7,radius:7,fill:"rgba(0, 0, 0, 0.1)"});(s=this.canvas)==null||s.add(d),this.placeholders.push(d),c++}}removeSeatPlaceholders(){this.placeholders.forEach(r=>{var n;(n=this.canvas)==null||n.remove(r)}),this.placeholders=[]}}const $x={sections:{1:{path:`
        M600,100
        Q700,100 800,100
        Q800,150 800,200
        Q700,200 600,200
        Q600,150 600,100
      Z`,caption:{left:600,top:142,width:200}},2:{path:`
        M330,210
        Q700,250,1100,210
        Q1115,360 1130,510
        Q700,560,300,510
        Q315,360 330,210
      Z`,caption:{left:300,top:550,width:830}}},rows:{"2-1":{section:"2",path:"M360,250 Q710,290,1060,250",caption:{left:690,top:260}},"2-2":{section:"2",path:"M360,305 Q710,345,1060,305",caption:{left:690,top:315}},"2-3":{section:"2",path:"M360,360 Q710,400,1060,360",caption:{left:690,top:370}},"2-4":{section:"2",path:"M360,415 Q710,455,1060,415",caption:{left:690,top:425}},"2-5":{section:"2",path:"M360,470 Q710,510,1060,470",caption:{left:690,top:480}}},seats:{"2-1-1":{left:353,top:243,row:"2-1"},"2-1-2":{left:393,top:246.9109919454916,row:"2-1"},"2-1-3":{left:433,top:250.18276892326037,row:"2-1"},"2-1-4":{left:473,top:252.9692736904633,row:"2-1"},"2-1-5":{left:512.9999999999999,top:255.31542005780216,row:"2-1"},"2-1-6":{left:553,top:257.2403510013058,row:"2-1"},"2-1-7":{left:593,top:258.751254147522,row:"2-1"},"2-1-8":{left:633,top:259.84819565486214,row:"2-1"},"2-1-9":{left:672.9999999999999,top:260.52625524434063,row:"2-1"},"2-1-10":{left:733,top:260.73760605962235,row:"2-1"},"2-1-11":{left:772.9999999999999,top:260.32223535992273,row:"2-1"},"2-1-12":{left:813,top:259.4423388303485,row:"2-1"},"2-1-13":{left:852.9999999999999,top:258.0775265616851,row:"2-1"},"2-1-14":{left:893,top:256.2039331000181,row:"2-1"},"2-1-15":{left:932.9999999999999,top:253.79388140406337,row:"2-1"},"2-1-16":{left:972.9999999999998,top:250.81541095785218,row:"2-1"},"2-1-17":{left:1012.9999999999997,top:247.2316502602321,row:"2-1"},"2-1-18":{left:1053,top:243,row:"2-1"},"2-2-1":{left:353,top:298,row:"2-2"},"2-2-2":{left:393,top:246.9109919454916+55,row:"2-2"},"2-2-3":{left:433,top:250.18276892326037+55,row:"2-2"},"2-2-4":{left:473,top:252.9692736904633+55,row:"2-2"},"2-2-5":{left:512.9999999999999,top:255.31542005780216+55,row:"2-2"},"2-2-6":{left:553,top:257.2403510013058+55,row:"2-2"},"2-2-7":{left:593,top:258.751254147522+55,row:"2-2"},"2-2-8":{left:633,top:259.84819565486214+55,row:"2-2"},"2-2-9":{left:672.9999999999999,top:260.52625524434063+55,row:"2-2"},"2-2-10":{left:733,top:260.73760605962235+55,row:"2-2"},"2-2-11":{left:772.9999999999999,top:260.32223535992273+55,row:"2-2"},"2-2-12":{left:813,top:259.4423388303485+55,row:"2-2"},"2-2-13":{left:852.9999999999999,top:258.0775265616851+55,row:"2-2"},"2-2-14":{left:893,top:256.2039331000181+55,row:"2-2"},"2-2-15":{left:932.9999999999999,top:253.79388140406337+55,row:"2-2"},"2-2-16":{left:972.9999999999998,top:250.81541095785218+55,row:"2-2"},"2-2-17":{left:1012.9999999999997,top:247.2316502602321+55,row:"2-2"},"2-2-18":{left:1053,top:298,row:"2-2"},"2-3-1":{left:353,top:353,row:"2-3"},"2-3-2":{left:393,top:246.9109919454916+55+55,row:"2-3"},"2-3-3":{left:433,top:250.18276892326037+55+55,row:"2-3"},"2-3-4":{left:473,top:252.9692736904633+55+55,row:"2-3"},"2-3-5":{left:512.9999999999999,top:255.31542005780216+55+55,row:"2-3"},"2-3-6":{left:553,top:257.2403510013058+55+55,row:"2-3"},"2-3-7":{left:593,top:258.751254147522+55+55,row:"2-3"},"2-3-8":{left:633,top:259.84819565486214+55+55,row:"2-3"},"2-3-9":{left:672.9999999999999,top:260.52625524434063+55+55,row:"2-3"},"2-3-10":{left:733,top:260.73760605962235+55+55,row:"2-3"},"2-3-11":{left:772.9999999999999,top:260.32223535992273+55+55,row:"2-3"},"2-3-12":{left:813,top:259.4423388303485+55+55,row:"2-3"},"2-3-13":{left:852.9999999999999,top:258.0775265616851+55+55,row:"2-3"},"2-3-14":{left:893,top:256.2039331000181+55+55,row:"2-3"},"2-3-15":{left:932.9999999999999,top:253.79388140406337+55+55,row:"2-3"},"2-3-16":{left:972.9999999999998,top:250.81541095785218+55+55,row:"2-3"},"2-3-17":{left:1012.9999999999997,top:247.2316502602321+55+55,row:"2-3"},"2-3-18":{left:1053,top:353,row:"2-3"}}};var un=(t=>(t.CREATE_ROW="create-row",t.CREATE_SEAT="create-seat",t.CREATE_SECTION="create-section",t.DELETE_ROW="delete-row",t.DELETE_SEAT="delete-seat",t.DELETE_SECTION="delete-section",t.UPDATE_ROW="update-row",t.UPDATE_SECTION="update-section",t))(un||{});const Kx=(t,e)=>{switch(e.type){case"create-row":{if(t.rows[e.id])throw new RangeError(`Can't create new Row. Row with ID "${e.id}" already exists`);if(!e.payload.section)throw new RangeError("Can't create new Row. Section ID is not provided. All rows must exist within sections");if(!t.sections[e.payload.section])throw new RangeError("Can't create new Row. Section with provided Section ID is not found. All rows must exist within sections");if(!e.payload.path)throw new TypeError("Can't create a Row without given path");const r={path:e.payload.path||"",section:e.payload.section||"",caption:{left:e.payload.captionLeft!==void 0?e.payload.captionLeft:0,top:e.payload.captionTop!==void 0?e.payload.captionTop:0}};return{...t,rows:{[e.id]:r,...t.rows}}}case"create-seat":{if(t.seats[e.id])throw new RangeError(`Can't create new Seat. Seat with ID "${e.id}" already exists`);if(!e.payload.row)throw new RangeError("Can't create new Seat. Row ID is not provided. All seats must exist within rows");if(!t.rows[e.payload.row])throw new RangeError("Can't create new Seat. Row with provided Row ID is found. All seats must exist within rows");const r={left:e.payload.left||0,top:e.payload.top||0,row:e.payload.row};return{...t,seats:{[e.id]:r,...t.seats}}}case"create-section":{if(t.sections[e.id])throw new RangeError(`Can't create new Section. Section with ID "${e.id}" already exists`);const r={path:e.payload.path||"",caption:{left:e.payload.captionLeft||0,top:e.payload.captionTop||0,width:e.payload.captionWidth||0}};return{...t,sections:{[e.id]:r,...t.sections}}}case"delete-row":{const{[e.id]:r,...n}=t.rows,i=Object.fromEntries(Object.entries(t.seats).filter(([f,m])=>m.row in n));return{...t,rows:n,seats:i}}case"delete-seat":{const{[e.id]:r,...n}=t.seats;return{...t,seats:n}}case"delete-section":{const{[e.id]:r,...n}=t.sections,i=Object.fromEntries(Object.entries(t.rows).filter(([m,c])=>c.section!==e.id)),f=Object.fromEntries(Object.entries(t.seats).filter(([m,c])=>c.row in i));return{rows:i,sections:n,seats:f}}case"update-row":{if(!(e.id in t.rows))throw new RangeError(`No row with ID ${e.id} found.`);const{[e.id]:r,...n}=t.rows,i={...r,path:e.payload.path||r.path,caption:{left:e.payload.captionLeft!==void 0?e.payload.captionLeft:r.caption.left,top:e.payload.captionTop!==void 0?e.payload.captionTop:r.caption.top}};return{...t,rows:{...n,[e.id]:i}}}case"update-section":{if(!(e.id in t.sections))throw new RangeError(`No section with ID ${e.id} found.`);const{[e.id]:r,...n}=t.sections,i={...r,path:e.payload.path||r.path,caption:{...r.caption,left:e.payload.captionLeft!==void 0?e.payload.captionLeft:r.caption.left,top:e.payload.captionTop!==void 0?e.payload.captionTop:r.caption.top}};return{...t,sections:{...n,[e.id]:i}}}}throw new Error("Unknown action")},lc=t=>(e,r,n)=>{e.save(),e.translate(r,n),e.strokeRect(-12,-12,24,24),e.fillStyle="#FFF",e.fillRect(-12,-12,24,24),e.fillStyle="#000",e.font="24px sans-serif",e.textBaseline="hanging",e.fillText(t,-12,-12),e.restore()},Qx=(t,e=!1)=>new Fe.fabric.Control({actionName:"moveCorner",actionHandler:(r,n,i,f)=>{const m=n.target.getObjects()[0];return m.path[t][3]=i,m.path[t][4]=f,e&&(m.path[0][1]=i,m.path[0][2]=f),!0},positionHandler:(r,n,i)=>{const f=i.getObjects()[0],m=f.path,c=m[t][3]-f.pathOffset.x,s=m[t][4]-f.pathOffset.y;return Fe.fabric.util.transformPoint(new Fe.fabric.Point(c,s),Fe.fabric.util.multiplyTransformMatrices(i.canvas.viewportTransform,i.calcTransformMatrix()))}}),qx=t=>new Fe.fabric.Control({actionName:"moveQPoint",actionHandler:(e,r,n,i)=>{const f=r.target.getObjects()[0];return f.path[t][1]=n,f.path[t][2]=i,!0},positionHandler:(e,r,n)=>{const i=n.getObjects()[0],f=i.path,m=f[t][1]-i.pathOffset.x,c=f[t][2]-i.pathOffset.y;return Fe.fabric.util.transformPoint(new Fe.fabric.Point(m,c),Fe.fabric.util.multiplyTransformMatrices(n.canvas.viewportTransform,n.calcTransformMatrix()))}});class hf extends Fe.fabric.Group{constructor(r,n,i){super(r,n,i);St(this,"onAddRow",null);St(this,"onDelete",null);St(this,"onRename",null);St(this,"controls",{...Fe.fabric.Group.prototype.controls,addRow:new Fe.fabric.Control({actionName:"addRow",cursorStyle:"pointer",mouseUpHandler:()=>this.onAddRow===null?!1:(this.onAddRow(),!0),offsetX:0,offsetY:20,render:lc(""),sizeX:24,sizeY:24,x:0,y:.5}),rename:new Fe.fabric.Control({actionName:"rename",cursorStyle:"pointer",mouseUpHandler:()=>this.onRename===null?!1:(this.onRename(),!0),offsetX:23,offsetY:0,render:lc(""),sizeX:24,sizeY:24,x:.5,y:-.5}),delete:new Fe.fabric.Control({actionName:"delete",cursorStyle:"pointer",mouseUpHandler:()=>this.onDelete===null?!1:(this.onDelete(),!0),offsetX:20,offsetY:30,render:lc(""),sizeX:24,sizeY:24,x:.5,y:-.5})});this.setControlsVisibility({tl:!1,mt:!1,tr:!1,mr:!1,br:!1,mb:!1,bl:!1,ml:!1,mtr:!1}),this.selectable=!1,this.lockMovementX=!0,this.lockMovementY=!0;const m=this.getObjects()[0].path;this.cornerStyle="circle",this.cornerStrokeColor="#99c";let c=0,s=0;m==null||m.forEach((u,d)=>{u[0]==="Q"&&(this.controls["q-"+ ++c]=qx(d),this.controls["c-"+ ++s]=Qx(d,m[d+1]!==void 0&&m[d+1][0].toUpperCase()==="Z"))})}}var qr=(t=>(t.CREATE_ROW="create-row",t.CREATE_SEAT="create-seat",t.CREATE_SECTION="create-section",t.SELECT="select",t))(qr||{});const Jx=20;function Zx({canvas:t,nameContainer:e}){const[[r,n],i]=Ae.useState(["select",null]),[f]=Ae.useState(Jx),[m,c]=Ae.useState(null),s=Ae.useContext(Sn),[u,d]=s.hallData,[,l]=s.hallVisualData,[o]=Ae.useContext(zr);Lx(f,t),ry([[r,n],i],f,t),ey([[r,n],i],f,t),ty([m,c]),Ix([[r,n],i],t),Ae.useEffect(function(){var x;const v=y=>{if(!(y.target instanceof Vo))return;const _=y.target,w=o.rows.get(_),C=prompt("   ",u.rows[w].number.toString());C!==null&&d({type:jr.UPDATE_ROW,id:w,payload:{number:C}})};return(x=t.current)==null||x.on("mouse:dblclick",v),function(){var y;(y=t.current)==null||y.off("mouse:dblclick",v)}},[o]),Ae.useEffect(function(){const v=(x,y)=>{l({type:un.UPDATE_ROW,id:y,payload:{captionLeft:x.x,captionTop:x.y}})};return o.rows.forEach((x,y)=>{y.onMoveCaptionCenter=_=>v(_,x),y.onMoveCaptionLeft=_=>v(_,x),y.onMoveCaptionRight=_=>v(_,x)}),function(){o.rows.forEach((x,y)=>{y.onMoveCaptionLeft=null,y.onMoveCaptionCenter=null,y.onMoveCaptionRight=null})}},[o]),Ae.useEffect(function(){var y,_,w;const v=()=>{c(null)},x=()=>{var S,O;const C=(S=t.current)==null?void 0:S.getActiveObject();if(((O=t.current)==null?void 0:O.getActiveObject())instanceof rg){c(C);return}c(null)};return(y=t.current)==null||y.on("selection:created",x),(_=t.current)==null||_.on("selection:updated",x),(w=t.current)==null||w.on("selection:cleared",v),function(){var C,S,O;(C=t.current)==null||C.off("selection:created",x),(S=t.current)==null||S.off("selection:updated",x),(O=t.current)==null||O.off("selection:cleared",v)}},[o]),Ae.useEffect(function(){var x;const v=y=>{if(!(y.target instanceof hf))return;const C=y.target.getObjects()[0].path.reduce((S,O)=>{switch(O[0].toUpperCase()){case"M":return S+`${O[0]} ${O[1]},${O[2]} `;case"Q":return S+`${O[0]} ${O[1]},${O[2]} ${O[3]},${O[4]} `;case"Z":return S+O[0]}return S},"");l({type:un.UPDATE_SECTION,id:o.sections.get(y.target),payload:{path:C}})};return(x=t.current)==null||x.on("object:modified",v),function(){var y;(y=t.current)==null||y.off("object:modified",v)}},[o]),Ae.useEffect(function(){var x;const v=y=>{if(!(y.target instanceof Vo))return;const C=y.target.getObjects()[0].path.reduce((S,O)=>{switch(O[0].toUpperCase()){case"M":return S+`${O[0]} ${O[1]},${O[2]} `;case"Q":return S+`${O[0]} ${O[1]},${O[2]} ${O[3]},${O[4]} `}return S},"");l({type:un.UPDATE_ROW,id:o.rows.get(y.target),payload:{path:C}})};return(x=t.current)==null||x.on("object:modified",v),function(){var y;(y=t.current)==null||y.off("object:modified",v)}},[o]),Ae.useEffect(function(){return function(){var v;(v=t.current)==null||v.discardActiveObject()}},[]);const a=()=>{i([r==="select"?"create-section":"select",null])},h=()=>{const p=prompt("   ",u.name);p===null||p.trim()===""||d({type:jr.UPDATE_HALL,id:"",payload:{name:p.trim()}})},g=()=>{const p=prompt("   ",u.seats[o.seats.get(m)].number.toString());p!==null&&(d({type:jr.UPDATE_SEAT,id:o.seats.get(m),payload:{number:p}}),c(null))};return Ce.jsxs(Ce.Fragment,{children:[m!==null?Ce.jsx("div",{className:"active-seat-popup",style:{left:m.getBoundingRect().left+m.getBoundingRect().width/2,top:m.getBoundingRect().top},children:Ce.jsx("button",{onClick:g,className:"active-seat-number-change",children:u.seats[o.seats.get(m)].number})}):null,e.current!==null?ff.createPortal(Ce.jsx("button",{className:"scheme-name-edit",onClick:h,children:""}),e.current):null,Ce.jsx("div",{className:"editor-controls edit-controls",children:Ce.jsx("button",{className:`edit-controls-button ${r==="select"?"":"edit-controls-button-active"}`,onClick:a,children:"+"})})]})}const sg=(t,e=!0)=>{const[r,...n]=t;let i=r,f=[];for(const c of n){const s={x:(c.x+i.x)/2,y:(c.y+i.y)/2};f.push(`Q${s.x},${s.y} ${c.x},${c.y}`),i=c}return[`M${r.x},${r.y}`,...f,e?"Z":""].join(" ").trim()},Gs=(t,e="")=>{const r=Object.keys(t),n=`${e?`${e}-`:""}${(r.length+1).toString()}`;return r.reduce((f,m)=>{if(f!==m)return f;let c=0;const s=new RegExp(`(${e}-)?(\\d+)`).exec(m);return s!==null&&(c=parseInt(s[2])),`${e?`${e}-`:""}${c+1}`},n)},ey=(t,e,r)=>{const{hallData:n,hallVisualData:i}=Ae.useContext(Sn),[f,m]=n,[,c]=i,[[s,u],d]=t,[l]=Ae.useContext(zr);Ae.useEffect(()=>(l.rows.forEach((o,a)=>{a.selectable=!0,a.onDelete=()=>{m({id:o,payload:{},type:jr.DELETE_ROW}),c({id:o,payload:{},type:un.DELETE_ROW})},a.onAddSeat=()=>{d([qr.CREATE_SEAT,o])},a.onNumberChange=()=>{const h=prompt("   ",f.rows[o].number);if(h===null)return!1;m({type:jr.UPDATE_ROW,id:o,payload:{number:h.trim()}})}}),()=>{l.rows.forEach((o,a)=>{a.selectable=!1})}),[l]),Ae.useEffect(()=>{var v,x;if(s!==qr.CREATE_ROW)return;let o=[],a=null,h=null;const g=y=>{var C,S;h!==null&&((C=r.current)==null||C.remove(h),h=null);const[_,w]=[Math.round(y.absolutePointer.x/e)*e,Math.round(y.absolutePointer.y/e)*e];if(o.length===0)h=new Fe.fabric.Circle({left:_-10,top:w-10,radius:10,fill:"rgb(0, 255, 128, 1)",selectable:!1});else{const O=o.slice(-1)[0];h=new Fe.fabric.Line([O.x,O.y,_,w],{stroke:"rgb(0, 255, 128, 0.5)",strokeWidth:2,selectable:!1})}(S=r.current)==null||S.add(h)},p=y=>{var X,Q,ae;a!==null&&((X=r.current)==null||X.remove(a),a=null);const[_,w]=[Math.round(y.absolutePointer.x/e)*e,Math.round(y.absolutePointer.y/e)*e];o.push({x:_,y:w});const C=o[0],S=o.slice(-2)[0]||o[0],O=o.slice(-1)[0]||o[0],F=new Fe.fabric.Polyline(o,{stroke:"rgba(0, 255, 0, 0.3)",fill:"transparent",strokeWidth:3,selectable:!1}),N=new Fe.fabric.Circle({left:S.x-3,top:S.y-3,radius:3,stroke:"#ccc",fill:"transparent",selectable:!1,strokeWidth:.5}),W=new Fe.fabric.Circle({left:O.x-3,top:O.y-3,radius:3,stroke:"green",fill:"transparent",selectable:!1,strokeWidth:.5});if(a=new Fe.fabric.Group([F,N,W]),(Q=r.current)==null||Q.add(a),W.intersectsWithObject(N)&&o.length>1){const ne=sg(o.slice(0),!1);o=[],(ae=r.current)==null||ae.remove(a,N,W),a=null;const J=Gs(f.rows,u),oe=Object.entries(f.rows).filter(([q,k])=>k.section===u).length+1;m({id:J,type:jr.CREATE_ROW,payload:{section:u,number:oe}}),c({id:J,type:un.CREATE_ROW,payload:{captionLeft:C.x+(O.x-C.x)/2-Ys.width/2,captionTop:C.y+(O.y-C.y)/2-Ys.fontSize/2,section:u,path:ne}}),d([qr.SELECT,null])}};return(v=r.current)==null||v.on("mouse:down",p),(x=r.current)==null||x.on("mouse:move",g),()=>{var y,_,w;(y=r.current)==null||y.off("mouse:down",p),(_=r.current)==null||_.off("mouse:move",g),h!==null&&((w=r.current)==null||w.remove(h))}},[s])},ty=(t,e,r,n)=>{const[i,f]=t,[m]=Ae.useContext(zr),{hallData:c,hallVisualData:s}=Ae.useContext(Sn),[,u]=c,[,d]=s;Ae.useEffect(()=>(m.seats.forEach((l,o)=>{o.selectable=!0,o.onDelete=()=>{f(null),u({id:l,payload:{},type:jr.DELETE_SEAT}),d({id:l,payload:{},type:un.DELETE_SEAT})}}),()=>{m.seats.forEach((l,o)=>{o.selectable=!1})}),[m])},ag=(t,e=10,r=()=>{})=>{let n=[],i=null,f=null;const m=s=>{f!==null&&(t.remove(f),f=null);const[u,d]=[Math.round(s.absolutePointer.x/e)*e,Math.round(s.absolutePointer.y/e)*e];if(n.length===0)f=new Fe.fabric.Circle({left:u-10,top:d-10,radius:10,fill:"rgb(0, 255, 128, 1)",selectable:!1});else{const l=n.slice(-1)[0];f=new Fe.fabric.Line([l.x,l.y,u,d],{stroke:"rgb(0, 255, 128, 0.5)",strokeWidth:2,selectable:!1})}t.add(f)},c=s=>{i!==null&&(t.remove(i),i=null);const[u,d]=[Math.round(s.absolutePointer.x/e)*e,Math.round(s.absolutePointer.y/e)*e];n.push({x:u,y:d});const l=n[0],o=n.slice(-1)[0],a=new Fe.fabric.Polyline(n,{stroke:"#ccc",fill:"rgba(0, 255, 0, 0.3)",strokeWidth:1,selectable:!1}),h=new Fe.fabric.Circle({left:l.x-10,top:l.y-10,radius:10,stroke:"#ccc",fill:"transparent",selectable:!1,strokeWidth:.5}),g=new Fe.fabric.Circle({left:o.x-3,top:o.y-3,radius:3,stroke:"green",fill:"transparent",selectable:!1,strokeWidth:.5});i=new Fe.fabric.Group([a,h,g]),t.add(i),g.intersectsWithObject(h)&&n.length>1&&(t.remove(i,h,g),r(n))};return t.on("mouse:down",c),t.on("mouse:move",m),()=>{f!==null&&t.remove(f),i!==null&&t.remove(i),t.off("mouse:down",c),t.off("mouse:move",m)}},ry=(t,e,r)=>{const[[n],i]=t,{hallData:f,hallVisualData:m}=Ae.useContext(Sn),[c,s]=f,[,u]=m,[d]=Ae.useContext(zr);Ae.useEffect(()=>(d.sections.forEach((l,o)=>{o.selectable=!0,o.onDelete=()=>{s({id:l,payload:{},type:jr.DELETE_SECTION}),u({id:l,payload:{},type:un.DELETE_SECTION})},o.onAddRow=()=>{i([qr.CREATE_ROW,l])},o.onRename=()=>{const a=prompt("   ",c.sections[l].name);if(a===null)return!1;s({type:jr.UPDATE_SECTION,id:l,payload:{name:a.trim()}})}}),()=>{d.sections.forEach((l,o)=>{o.selectable=!1})}),[d]),Ae.useEffect(()=>{if(n!==qr.CREATE_SECTION)return;const l=ag(r.current,e,o=>{var v,x,y,_,w,C;o[o.length-1]=o[0];const a=sg(o,!0),h=Gs(c.sections),g=` ${Object.entries(c.sections).length}`,p=new Fe.fabric.Path(a);(v=r.current)==null||v.add(p),s({id:h,type:jr.CREATE_SECTION,payload:{name:g}}),u({id:h,type:un.CREATE_SECTION,payload:{path:a,captionLeft:(x=p.aCoords)==null?void 0:x.bl.x,captionTop:((y=p.aCoords)==null?void 0:y.bl.y)+Zp.fontSize/2,captionWidth:((_=p.aCoords)==null?void 0:_.br.x)-((w=p.aCoords)==null?void 0:w.bl.x)}}),(C=r.current)==null||C.remove(p),i([qr.SELECT,null])});return()=>{l()}},[n])},ny=t=>{const e=Ae.useContext(Sn),[r]=e.hallData,[n]=e.hallVisualData,[i,f]=Ae.useContext(zr);Ae.useEffect(()=>{var o,a,h,g;(o=t.current)==null||o.clear();const m=new Map,c=new Map,s=new Map,u=n.sections,d=n.rows,l=n.seats;for(const[p,v]of Object.entries(u)){const x=[],y=r.sections[p],_=new Fe.fabric.Path(v.path);if(_.set({...Jp,objectCaching:!1}),x.push(_),y.name){const C=new Fe.fabric.Textbox(`${y.name}`,{...Zp,...v.caption});x.push(C)}const w=new hf(x,{objectCaching:!1});(a=t.current)==null||a.add(w),m.set(w,p)}for(const[p,v]of Object.entries(d)){const x=[],y=r.rows[p],_=new Fe.fabric.Path(v.path,{objectCaching:!1});if(_.set({...eg}),x.push(_),y.number){const C=new Fe.fabric.Textbox(`${y.number}`,{...Ys,...v.caption});x.push(C)}const w=new Vo(x,{objectCaching:!1});w.textWidth=Ys.width,w.textHeight=Ys.fontSize,(h=t.current)==null||h.add(w),c.set(w,p)}for(const[p,v]of Object.entries(l)){const x=new rg({...tg,...v});(g=t.current)==null||g.add(x),s.set(x,p)}f({type:W1.REWRITE,payload:{sections:m,rows:c,seats:s}})},[r,n])},iy=t=>{const e=Ae.useContext(Sn),[r]=e.hallData,[n]=Ae.useContext(zr);Ae.useEffect(()=>{var f;if(n.seats.size===0)return;const i=m=>{var o,a;const c=m.target,s=[],u=[],d=[];if(m.target===null&&s.push(...Object.keys(r.rows)),m.target instanceof hf){const h=n.sections.get(c);s.push(...Object.entries(r.rows).filter(([g,p])=>p.section===h).map(([g,p])=>g))}if(m.target instanceof Vo){const h=n.rows.get(c);s.push(h)}s.forEach(h=>{u.push(...Object.entries(r.seats).filter(([g,p])=>p.row===h).map(([g,p])=>g))}),n.seats.forEach((h,g)=>{u.includes(h)&&d.push(g)});const l=new Fe.fabric.ActiveSelection;(o=t.current)==null||o.add(l),l.add(...d),(a=t.current)==null||a.setActiveObject(l)};return(f=t.current)==null||f.on("mouse:dblclick",i),n.seats.forEach((m,c)=>{c.selectable=!0,c.setControlsVisibility({delete:!1})}),()=>{var m,c;n.seats.forEach((s,u)=>{u.selectable=!1,u.setControlsVisibility({delete:!0})}),(m=t.current)==null||m.requestRenderAll(),(c=t.current)==null||c.off("mouse:dblclick",i)}},[n])};function sy({canvas:t,nameContainer:e}){const r=Ae.useContext(Sn),[n]=r.hallData,[i,f]=Ae.useContext(Mf),m=()=>{var d;const u=(d=t.current)==null?void 0:d.getActiveObject();u.type==="activeSelection"&&(u.hasControls=!1,u.lockMovementX=!0,u.lockMovementY=!0)},c=()=>{f(i+.1)},s=()=>{f(i-.1)};return Ae.useEffect(()=>{var u;(u=t.current)==null||u.setZoom(i)},[i]),Ae.useEffect(()=>{var u;return(u=t.current)==null||u.on("selection:created",m),()=>{var d;(d=t.current)==null||d.off("selection:created",m)}},[]),ny(t),Ce.jsxs(Ce.Fragment,{children:[Ce.jsxs("div",{className:"editor-controls resize-controls",children:[Ce.jsx("button",{className:"resize-controls-button resize-controls-plus",onClick:c,children:"+"}),Ce.jsx("button",{className:"resize-controls-button resize-controls-minus",onClick:s,children:""})]}),e.current!==null?ff.createPortal(Ce.jsx("div",{className:"scheme-name",children:n.name}),e.current):null]})}const ay={1:{name:" ",groups:{"1-1":{color:"rgb(31, 173, 173)",price:1250},"1-2":{color:"rgb(71, 133, 133)",price:1450},"1-3":{color:"rgb(204, 204, 0)",price:1650},"1-4":{color:"rgb(173, 173, 31)",price:1850},"1-5":{color:"rgb(133, 133, 71)",price:1950},"1-6":{color:"rgb(204, 102, 0)",price:2050},"1-7":{color:"rgb(173, 102, 31)",price:2250},"1-8":{color:"rgb(133, 102, 71)",price:2350},"1-9":{color:"rgb(204, 0, 0)",price:2550},"1-10":{color:"rgb(173, 31, 31)",price:3050},"1-11":{color:"rgb(133, 71, 71)",price:2750}}},2:{name:" ",groups:{}}};var rn=(t=>(t.COPY_SCHEME="copy-scheme",t.CREATE_SCHEME="create-scheme",t.CREATE_GROUP="create-group",t.DELETE_SCHEME="delete-scheme",t.DELETE_GROUP="delete-group",t.RENAME_SCHEME="rename-scheme",t.UPDATE_GROUP_PRICE="set-price",t.UPDATE_GROUP_COLOR="set-color",t))(rn||{});const oy=(t,e)=>{switch(e.type){case"create-scheme":{if(e.id in t)throw new RangeError(`Cannot create a price group in a scheme with ID ${e.id} as scheme with given ID doesn't exist`);return{...t,[e.id]:{name:e.payload.name||"",groups:{}}}}case"copy-scheme":{if(e.id===void 0||e.id===null)throw new TypeError(`ID of new scheme is expected but found ${e.id}.`);if(e.id in t)throw new RangeError(`Scheme with passed ID ${e.id} already exist. Cannot copy scheme.`);if(!(e.payload.schemeID in t))throw new RangeError("Cannot create a copy of a scheme action.payload.schemeID. No scheme with given ID found");const{[e.payload.schemeID]:r}=t,n={name:e.payload.name?e.payload.name:r.name,groups:{}};for(const[i,f]of Object.entries(r.groups)){const m=i.replace(`${e.payload.schemeID}-`,`${e.id}-`);n.groups[m]=JSON.parse(JSON.stringify(f))}return{...t,[e.id]:n}}case"create-group":{const{[e.id]:r,...n}=t;if(!(e.id in t))throw new RangeError(`Cannot create a price group in a scheme with ID ${e.id} as scheme with given ID doesn't exist`);if(e.payload.groupID===void 0||e.payload.groupID.trim()==="")throw new TypeError("Cannot create a group without ID");if(e.payload.groupID in t[e.id].groups)throw new RangeError(`Cannot create a group with ID ${e.payload.groupID} as group with given ID already exists`);return{...n,[e.id]:{...r,groups:{...r.groups,[e.payload.groupID]:{color:e.payload.color||"",price:e.payload.price||0}}}}}case"delete-scheme":{const{[e.id]:r,...n}=t;return{...n}}case"delete-group":{if(e.payload.groupID===void 0)return t;const{[e.id]:r,...n}=t,{[e.payload.groupID]:i,...f}=r.groups;return{...n,[e.id]:{name:r.name,groups:f}}}case"rename-scheme":{if(!(e.id in t))throw new RangeError(`Cannot rename scheme with ID ${e.id}. Scheme with given ID is not found`);const{[e.id]:r,...n}=t;return{...n,[e.id]:{...r,name:e.payload.name||""}}}case"set-price":{if(e.payload.groupID===void 0)return t;if(!(e.id in t))throw new RangeError(`Cannot update price group, as price scheme with ID ${e.id} is not found`);if(!(e.payload.groupID in t[e.id].groups))throw new RangeError(`Cannot update price group with ID ${e.payload.groupID}. Group with given ID is not found`);const{[e.id]:r,...n}=t,{...i}=r.groups;for(const[m]of Object.entries(i))m===e.payload.groupID&&(i[m].price=e.payload.price||0);return{...n,[e.id]:{...r,groups:i}}}case"set-color":{if(e.payload.groupID===void 0)return t;if(!(e.id in t))throw new RangeError(`Cannot update price group, as price scheme with ID ${e.id} is not found`);if(!(e.payload.groupID in t[e.id].groups))throw new RangeError(`Cannot update price group with ID ${e.payload.groupID}. Group with given ID is not found`);const{[e.id]:r,...n}=t,{...i}=r.groups;for(const[m]of Object.entries(i))m===e.payload.groupID&&(i[m].color=e.payload.color||"");return{...n,[e.id]:{...r,groups:i}}}}throw new TypeError},ly={1:{seats:{}},2:{seats:{}}};var Di=(t=>(t.COPY_SCHEME="copy-scheme",t.CREATE_SCHEME="create-scheme",t.DELETE_SCHEME="delete-scheme",t.DELETE_GROUP="delete-group",t.UPDATE_SEATS="update-seats",t))(Di||{});const cy=(t,e)=>{switch(e.type){case"copy-scheme":{if(e.id===void 0||e.id===null)throw new TypeError(`ID of new scheme is expected but found ${e.id}.`);if(!(e.payload.schemeID in t))throw new RangeError(`Cannot copy scheme with ID ${e.payload.schemeID} as scheme with this ID doesn't exist`);if(e.id in t)throw new RangeError(`Cannot copy a scheme into group with ID ${e.id} as group with given ID already exists`);const{[e.payload.schemeID]:r}=t,n={seats:{}};for(const[i,f]of Object.entries(r.seats)){const m=f.replace(`${e.payload.schemeID}-`,`${e.id}-`);n.seats[i]=m}return{...t,[e.id]:n}}case"create-scheme":{if(e.id in t)throw new RangeError(`Cannot create new price group with ID ${e.id} as group with given ID already exists`);return{...t,[e.id]:{seats:{}}}}case"delete-scheme":{const{[e.id]:r,...n}=t;return{...n}}case"delete-group":{if(!(e.id in t))return{...t};const{[e.id]:r,...n}=t,i={};for(const[m,c]of Object.entries(r.seats))c!==e.payload.groupID&&(i[m]=c);return{...n,[e.id]:{seats:i}}}case"update-seats":{const r={...t[e.id]};if(!(e.id in t))throw new RangeError(`Price scheme with ID ${e.id} is not found`);const n={...r};if(e.payload.groupID===null)for(const i of e.payload.seats)i in n.seats&&delete n.seats[i];else for(const i of e.payload.seats)n.seats[i]=e.payload.groupID;return{...t,[e.id]:n}}}throw new TypeError(`Unexpected action type "${e.type}"`)};function uy({palette:t,onColorClick:e,onCloseClick:r}){return Ce.jsxs("div",{className:"color-picker",children:[Ce.jsx("button",{onClick:()=>r(),className:"color-picker-close",children:""}),t.map((n,i)=>Ce.jsx("button",{onClick:()=>e(n),style:{color:n},className:"color-picker-value",children:""},`color-${i}`))]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Go={};Go.version="0.18.5";var og=1252,fy=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lg=function(t){fy.indexOf(t)!=-1&&(og=t)};function hy(){lg(1252)}var va=function(t){lg(t)};function dy(){va(1200),hy()}function py(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var eo=function(e){return String.fromCharCode(e)},Jh=function(e){return String.fromCharCode(e)},ri,bn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xa(t){for(var e="",r=0,n=0,i=0,f=0,m=0,c=0,s=0,u=0;u<t.length;)r=t.charCodeAt(u++),f=r>>2,n=t.charCodeAt(u++),m=(r&3)<<4|n>>4,i=t.charCodeAt(u++),c=(n&15)<<2|i>>6,s=i&63,isNaN(n)?c=s=64:isNaN(i)&&(s=64),e+=bn.charAt(f)+bn.charAt(m)+bn.charAt(c)+bn.charAt(s);return e}function xn(t){var e="",r=0,n=0,i=0,f=0,m=0,c=0,s=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)f=bn.indexOf(t.charAt(u++)),m=bn.indexOf(t.charAt(u++)),r=f<<2|m>>4,e+=String.fromCharCode(r),c=bn.indexOf(t.charAt(u++)),n=(m&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),s=bn.indexOf(t.charAt(u++)),i=(c&3)<<6|s,s!==64&&(e+=String.fromCharCode(i));return e}var Xe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),wn=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function vi(t){return Xe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Zh(t){return Xe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Lr=function(e){return Xe?wn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cl(t){if(typeof ArrayBuffer>"u")return Lr(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ka(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function gy(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Dt=Xe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:wn(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(f){return Array.isArray(f)?f:[].slice.call(f)}))};function my(t){for(var e=[],r=0,n=t.length+250,i=vi(t.length+255),f=0;f<t.length;++f){var m=t.charCodeAt(f);if(m<128)i[r++]=m;else if(m<2048)i[r++]=192|m>>6&31,i[r++]=128|m&63;else if(m>=55296&&m<57344){m=(m&1023)+64;var c=t.charCodeAt(++f)&1023;i[r++]=240|m>>8&7,i[r++]=128|m>>2&63,i[r++]=128|c>>6&15|(m&3)<<4,i[r++]=128|c&63}else i[r++]=224|m>>12&15,i[r++]=128|m>>6&63,i[r++]=128|m&63;r>n&&(e.push(i.slice(0,r)),r=0,i=vi(65535),n=65530)}return e.push(i.slice(0,r)),Dt(e)}var $s=/\u0000/g,to=/[\u0001-\u0006]/g;function Ji(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Ir(t,e){var r=""+t;return r.length>=e?r:ft("0",e-r.length)+r}function df(t,e){var r=""+t;return r.length>=e?r:ft(" ",e-r.length)+r}function $o(t,e){var r=""+t;return r.length>=e?r:r+ft(" ",e-r.length)}function vy(t,e){var r=""+Math.round(t);return r.length>=e?r:ft("0",e-r.length)+r}function xy(t,e){var r=""+t;return r.length>=e?r:ft("0",e-r.length)+r}var e0=Math.pow(2,32);function ki(t,e){if(t>e0||t<-e0)return vy(t,e);var r=Math.round(t);return xy(r,e)}function Ko(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var t0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yy(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},r0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_y={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qo(t,e,r){for(var n=t<0?-1:1,i=t*n,f=0,m=1,c=0,s=1,u=0,d=0,l=Math.floor(i);u<e&&(l=Math.floor(i),c=l*m+f,d=l*u+s,!(i-l<5e-8));)i=1/(i-l),f=m,m=c,s=u,u=d;if(d>e&&(u>e?(d=s,c=f):(d=u,c=m)),!r)return[0,n*c,d];var o=Math.floor(n*c/d);return[o,n*c-o*d,d]}function ro(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),f=0,m=[],c={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)m=r?[1317,10,29]:[1900,2,29],f=3;else if(n===0)m=r?[1317,8,29]:[1900,1,0],f=6;else{n>60&&--n;var s=new Date(1900,0,1);s.setDate(s.getDate()+n-1),m=[s.getFullYear(),s.getMonth()+1,s.getDate()],f=s.getDay(),n<60&&(f=(f+6)%7),r&&(f=Ay(s,m))}return c.y=m[0],c.m=m[1],c.d=m[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=f,c}var cg=new Date(1899,11,31,0,0,0),wy=cg.getTime(),Sy=new Date(1900,2,1,0,0,0);function ug(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Sy&&(r+=24*60*60*1e3),(r-(wy+(t.getTimezoneOffset()-cg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function pf(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Cy(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ty(t){var e=t<0?12:11,r=pf(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Ey(t){var e=pf(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Oy(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Ty(t):e===10?r=t.toFixed(10).substr(0,12):r=Ey(t),pf(Cy(r.toUpperCase()))}function hu(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Oy(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Hn(14,ug(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Ay(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function ky(t,e,r,n){var i="",f=0,m=0,c=r.y,s,u=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:s=c%100,u=2;break;default:s=c%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:s=r.m,u=e.length;break;case 3:return cc[r.m-1][1];case 5:return cc[r.m-1][0];default:return cc[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:s=r.d,u=e.length;break;case 3:return t0[r.q][0];default:return t0[r.q][1]}break;case 104:switch(e.length){case 1:case 2:s=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:s=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:s=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Ir(r.S,e.length):(n>=2?m=n===3?1e3:100:m=n===1?10:1,f=Math.round(m*(r.S+r.u)),f>=60*m&&(f=0),e==="s"?f===0?"0":""+f/m:(i=Ir(f,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":s=r.D*24+r.H;break;case"[m]":case"[mm]":s=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":s=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:s=c,u=1;break}var d=u>0?Ir(s,u):"";return d}function Rn(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var fg=/%/g;function Py(t,e,r){var n=e.replace(fg,""),i=e.length-n.length;return fn(t,n,r*Math.pow(10,2*i))+ft("%",i)}function Fy(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hg(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+hg(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var f=Math.floor(Math.log(e)*Math.LOG10E)%i;if(f<0&&(f+=i),r=(e/Math.pow(10,f)).toPrecision(n+1+(i+f)%i),r.indexOf("e")===-1){var m=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(m-r.length+f):r+="E+"+(m-f);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,s,u,d){return s+u+d.substr(0,(i+f)%i)+"."+d.substr(f)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dg=/# (\?+)( ?)\/( ?)(\d+)/;function Dy(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),f=Math.floor(i/n),m=i-f*n,c=n;return r+(f===0?"":""+f)+" "+(m===0?ft(" ",t[1].length+1+t[4].length):df(m,t[1].length)+t[2]+"/"+t[3]+Ir(c,t[4].length))}function by(t,e,r){return r+(e===0?"":""+e)+ft(" ",t[1].length+2+t[4].length)}var pg=/^#*0*\.([0#]+)/,gg=/\).*[0#]/,mg=/\(###\) ###\\?-####/;function Gt(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function n0(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function i0(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ry(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function My(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function _r(t,e,r){if(t.charCodeAt(0)===40&&!e.match(gg)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_r("n",n,r):"("+_r("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Fy(t,e,r);if(e.indexOf("%")!==-1)return Py(t,e,r);if(e.indexOf("E")!==-1)return hg(e,r);if(e.charCodeAt(0)===36)return"$"+_r(t,e.substr(e.charAt(1)==" "?2:1),r);var i,f,m,c,s=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+ki(s,e.length);if(e.match(/^[#?]+$/))return i=ki(r,0),i==="0"&&(i=""),i.length>e.length?i:Gt(e.substr(0,e.length-i.length))+i;if(f=e.match(dg))return Dy(f,s,u);if(e.match(/^#+0+$/))return u+ki(s,e.length-e.indexOf("0"));if(f=e.match(pg))return i=n0(r,f[1].length).replace(/^([^\.]+)$/,"$1."+Gt(f[1])).replace(/\.$/,"."+Gt(f[1])).replace(/\.(\d*)$/,function(h,g){return"."+g+ft("0",Gt(f[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),f=e.match(/^(0*)\.(#*)$/))return u+n0(s,f[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=e.match(/^#{1,3},##0(\.?)$/))return u+Rn(ki(s,0));if(f=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_r(t,e,-r):Rn(""+(Math.floor(r)+Ry(r,f[1].length)))+"."+Ir(i0(r,f[1].length),f[1].length);if(f=e.match(/^#,#*,#0/))return _r(t,e.replace(/^#,#*,/,""),r);if(f=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ji(_r(t,e.replace(/[\\-]/g,""),r)),m=0,Ji(Ji(e.replace(/\\/g,"")).replace(/[0#]/g,function(h){return m<i.length?i.charAt(m++):h==="0"?"0":""}));if(e.match(mg))return i=_r(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(f=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(f[4].length,7),c=Qo(s,Math.pow(10,m)-1,!1),i=""+u,d=fn("n",f[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+f[2]+"/"+f[3],d=$o(c[2],m),d.length<f[4].length&&(d=Gt(f[4].substr(f[4].length-d.length))+d),i+=d,i;if(f=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(Math.max(f[1].length,f[4].length),7),c=Qo(s,Math.pow(10,m)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?df(c[1],m)+f[2]+"/"+f[3]+$o(c[2],m):ft(" ",2*m+1+f[2].length+f[3].length));if(f=e.match(/^[#0?]+$/))return i=ki(r,0),e.length<=i.length?i:Gt(e.substr(0,e.length-i.length))+i;if(f=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),m=i.indexOf(".");var l=e.indexOf(".")-m,o=e.length-i.length-l;return Gt(e.substr(0,l)+i+e.substr(e.length-o))}if(f=e.match(/^00,000\.([#0]*0)$/))return m=i0(r,f[1].length),r<0?"-"+_r(t,e,-r):Rn(My(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Ir(0,3-h.length):"")+h})+"."+Ir(m,f[1].length);switch(e){case"###,##0.00":return _r(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var a=Rn(ki(s,0));return a!=="0"?u+a:"";case"###,###.00":return _r(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _r(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Ly(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Iy(t,e,r){var n=e.replace(fg,""),i=e.length-n.length;return fn(t,n,r*Math.pow(10,2*i))+ft("%",i)}function vg(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vg(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var f=Math.floor(Math.log(e)*Math.LOG10E)%i;if(f<0&&(f+=i),r=(e/Math.pow(10,f)).toPrecision(n+1+(i+f)%i),!r.match(/[Ee]/)){var m=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(m-r.length+f):r+="E+"+(m-f),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,s,u,d){return s+u+d.substr(0,(i+f)%i)+"."+d.substr(f)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Yr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(gg)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Yr("n",n,r):"("+Yr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Ly(t,e,r);if(e.indexOf("%")!==-1)return Iy(t,e,r);if(e.indexOf("E")!==-1)return vg(e,r);if(e.charCodeAt(0)===36)return"$"+Yr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,f,m,c,s=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Ir(s,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Gt(e.substr(0,e.length-i.length))+i;if(f=e.match(dg))return by(f,s,u);if(e.match(/^#+0+$/))return u+Ir(s,e.length-e.indexOf("0"));if(f=e.match(pg))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Gt(f[1])).replace(/\.$/,"."+Gt(f[1])),i=i.replace(/\.(\d*)$/,function(h,g){return"."+g+ft("0",Gt(f[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),f=e.match(/^(0*)\.(#*)$/))return u+(""+s).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,f[1].length?"0.":".");if(f=e.match(/^#{1,3},##0(\.?)$/))return u+Rn(""+s);if(f=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Yr(t,e,-r):Rn(""+r)+"."+ft("0",f[1].length);if(f=e.match(/^#,#*,#0/))return Yr(t,e.replace(/^#,#*,/,""),r);if(f=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ji(Yr(t,e.replace(/[\\-]/g,""),r)),m=0,Ji(Ji(e.replace(/\\/g,"")).replace(/[0#]/g,function(h){return m<i.length?i.charAt(m++):h==="0"?"0":""}));if(e.match(mg))return i=Yr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(f=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(f[4].length,7),c=Qo(s,Math.pow(10,m)-1,!1),i=""+u,d=fn("n",f[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+f[2]+"/"+f[3],d=$o(c[2],m),d.length<f[4].length&&(d=Gt(f[4].substr(f[4].length-d.length))+d),i+=d,i;if(f=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return m=Math.min(Math.max(f[1].length,f[4].length),7),c=Qo(s,Math.pow(10,m)-1,!0),u+(c[0]||(c[1]?"":"0"))+" "+(c[1]?df(c[1],m)+f[2]+"/"+f[3]+$o(c[2],m):ft(" ",2*m+1+f[2].length+f[3].length));if(f=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Gt(e.substr(0,e.length-i.length))+i;if(f=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(f[2].length,10)).replace(/([^0])0+$/,"$1"),m=i.indexOf(".");var l=e.indexOf(".")-m,o=e.length-i.length-l;return Gt(e.substr(0,l)+i+e.substr(e.length-o))}if(f=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Yr(t,e,-r):Rn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?Ir(0,3-h.length):"")+h})+"."+Ir(0,f[1].length);switch(e){case"###,###":case"##,###":case"#,###":var a=Rn(""+s);return a!=="0"?u+a:"";default:if(e.match(/\.[0#?]*$/))return Yr(t,e.slice(0,e.lastIndexOf(".")),r)+Gt(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function fn(t,e,r){return(r|0)===r?Yr(t,e,r):_r(t,e,r)}function Ny(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var xg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yg(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Ko(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(xg))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function By(t,e,r,n){for(var i=[],f="",m=0,c="",s="t",u,d,l,o="H";m<t.length;)switch(c=t.charAt(m)){case"G":if(!Ko(t,m))throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"G",v:"General"},m+=7;break;case'"':for(f="";(l=t.charCodeAt(++m))!==34&&m<t.length;)f+=String.fromCharCode(l);i[i.length]={t:"t",v:f},++m;break;case"\\":var a=t.charAt(++m),h=a==="("||a===")"?a:"t";i[i.length]={t:h,v:a},++m;break;case"_":i[i.length]={t:"t",v:" "},m+=2;break;case"@":i[i.length]={t:"T",v:e},++m;break;case"B":case"b":if(t.charAt(m+1)==="1"||t.charAt(m+1)==="2"){if(u==null&&(u=ro(e,r,t.charAt(m+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(m,2)},s=c,m+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=ro(e,r),u==null))return"";for(f=c;++m<t.length&&t.charAt(m).toLowerCase()===c;)f+=c;c==="m"&&s.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=o),i[i.length]={t:c,v:f},s=c;break;case"A":case"a":case"":var g={t:c,v:c};if(u==null&&(u=ro(e,r)),t.substr(m,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",o="h",m+=3):t.substr(m,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",m+=5,o="h"):t.substr(m,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",m+=5,o="h"):(g.t="t",++m),u==null&&g.t==="T")return"";i[i.length]=g,s=c;break;case"[":for(f=c;t.charAt(m++)!=="]"&&m<t.length;)f+=t.charAt(m);if(f.slice(-1)!=="]")throw'unterminated "[" block: |'+f+"|";if(f.match(xg)){if(u==null&&(u=ro(e,r),u==null))return"";i[i.length]={t:"Z",v:f.toLowerCase()},s=f.charAt(1)}else f.indexOf("$")>-1&&(f=(f.match(/\$([^-\[\]]*)/)||[])[1]||"$",yg(t)||(i[i.length]={t:"t",v:f}));break;case".":if(u!=null){for(f=c;++m<t.length&&(c=t.charAt(m))==="0";)f+=c;i[i.length]={t:"s",v:f};break}case"0":case"#":for(f=c;++m<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(m))>-1;)f+=c;i[i.length]={t:"n",v:f};break;case"?":for(f=c;t.charAt(++m)===c;)f+=c;i[i.length]={t:c,v:f},s=c;break;case"*":++m,(t.charAt(m)==" "||t.charAt(m)=="*")&&++m;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++m;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(f=c;m<t.length&&"0123456789".indexOf(t.charAt(++m))>-1;)f+=t.charAt(m);i[i.length]={t:"D",v:f};break;case" ":i[i.length]={t:c,v:c},++m;break;case"$":i[i.length]={t:"t",v:"$"},++m;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"t",v:c},++m;break}var p=0,v=0,x;for(m=i.length-1,s="t";m>=0;--m)switch(i[m].t){case"h":case"H":i[m].t=o,s="h",p<1&&(p=1);break;case"s":(x=i[m].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":s=i[m].t;break;case"m":s==="s"&&(i[m].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[m].v.match(/[Hh]/)&&(p=1),p<2&&i[m].v.match(/[Mm]/)&&(p=2),p<3&&i[m].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",_;for(m=0;m<i.length;++m)switch(i[m].t){case"t":case"T":case" ":case"D":break;case"X":i[m].v="",i[m].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[m].v=ky(i[m].t.charCodeAt(0),i[m].v,u,v),i[m].t="t";break;case"n":case"?":for(_=m+1;i[_]!=null&&((c=i[_].t)==="?"||c==="D"||(c===" "||c==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[m].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[m].v+=i[_].v,i[_]={v:"",t:";"},++_;y+=i[m].v,m=_-1;break;case"G":i[m].t="t",i[m].v=hu(e,r);break}var w="",C,S;if(y.length>0){y.charCodeAt(0)==40?(C=e<0&&y.charCodeAt(0)===45?-e:e,S=fn("n",y,C)):(C=e<0&&n>1?-e:e,S=fn("n",y,C),C<0&&i[0]&&i[0].t=="t"&&(S=S.substr(1),i[0].v="-"+i[0].v)),_=S.length-1;var O=i.length;for(m=0;m<i.length;++m)if(i[m]!=null&&i[m].t!="t"&&i[m].v.indexOf(".")>-1){O=m;break}var F=i.length;if(O===i.length&&S.indexOf("E")===-1){for(m=i.length-1;m>=0;--m)i[m]==null||"n?".indexOf(i[m].t)===-1||(_>=i[m].v.length-1?(_-=i[m].v.length,i[m].v=S.substr(_+1,i[m].v.length)):_<0?i[m].v="":(i[m].v=S.substr(0,_+1),_=-1),i[m].t="t",F=m);_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v)}else if(O!==i.length&&S.indexOf("E")===-1){for(_=S.indexOf(".")-1,m=O;m>=0;--m)if(!(i[m]==null||"n?".indexOf(i[m].t)===-1)){for(d=i[m].v.indexOf(".")>-1&&m===O?i[m].v.indexOf(".")-1:i[m].v.length-1,w=i[m].v.substr(d+1);d>=0;--d)_>=0&&(i[m].v.charAt(d)==="0"||i[m].v.charAt(d)==="#")&&(w=S.charAt(_--)+w);i[m].v=w,i[m].t="t",F=m}for(_>=0&&F<i.length&&(i[F].v=S.substr(0,_+1)+i[F].v),_=S.indexOf(".")+1,m=O;m<i.length;++m)if(!(i[m]==null||"n?(".indexOf(i[m].t)===-1&&m!==O)){for(d=i[m].v.indexOf(".")>-1&&m===O?i[m].v.indexOf(".")+1:0,w=i[m].v.substr(0,d);d<i[m].v.length;++d)_<S.length&&(w+=S.charAt(_++));i[m].v=w,i[m].t="t",F=m}}}for(m=0;m<i.length;++m)i[m]!=null&&"n?".indexOf(i[m].t)>-1&&(C=n>1&&e<0&&m>0&&i[m-1].v==="-"?-e:e,i[m].v=fn(i[m].t,i[m].v,C),i[m].t="t");var N="";for(m=0;m!==i.length;++m)i[m]!=null&&(N+=i[m].v);return N}var s0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a0(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function jy(t,e){var r=Ny(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var f=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,f];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var m=r[0].match(s0),c=r[1].match(s0);return a0(e,m)?[n,r[0]]:a0(e,c)?[n,r[1]]:[n,r[m!=null&&c!=null?2:1]]}return[n,f]}function Hn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[t],n==null&&(n=r.table&&r.table[r0[t]]||ht[r0[t]]),n==null&&(n=_y[t]||"General");break}if(Ko(n,0))return hu(e,r);e instanceof Date&&(e=ug(e,r.date1904));var i=jy(n,e);if(Ko(i[1]))return hu(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return By(i[1],e,r,i[0])}function _g(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ht[r]==null){e<0&&(e=r);continue}if(ht[r]==t){e=r;break}}e<0&&(e=391)}return ht[e]=t,e}function Tl(t){for(var e=0;e!=392;++e)t[e]!==void 0&&_g(t[e],e)}function El(){ht=yy()}var wg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Uy(t){var e=typeof t=="number"?ht[t]:t;return e=e.replace(wg,"(\\d+)"),new RegExp("^"+e+"$")}function Wy(t,e,r){var n=-1,i=-1,f=-1,m=-1,c=-1,s=-1;(e.match(wg)||[]).forEach(function(l,o){var a=parseInt(r[o+1],10);switch(l.toLowerCase().charAt(0)){case"y":n=a;break;case"d":f=a;break;case"h":m=a;break;case"s":s=a;break;case"m":m>=0?c=a:i=a;break}}),s>=0&&c==-1&&i>=0&&(c=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(f>=1?f:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(m>=0?m:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2);return m==-1&&c==-1&&s==-1?u:n==-1&&i==-1&&f==-1?d:u+"T"+d}var zy=function(){var t={};t.version="1.2.0";function e(){for(var S=0,O=new Array(256),F=0;F!=256;++F)S=F,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,O[F]=S;return typeof Int32Array<"u"?new Int32Array(O):O}var r=e();function n(S){var O=0,F=0,N=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)W[N]=S[N];for(N=0;N!=256;++N)for(F=S[N],O=256+N;O<4096;O+=256)F=W[O]=F>>>8^S[F&255];var X=[];for(N=1;N!=16;++N)X[N-1]=typeof Int32Array<"u"?W.subarray(N*256,N*256+256):W.slice(N*256,N*256+256);return X}var i=n(r),f=i[0],m=i[1],c=i[2],s=i[3],u=i[4],d=i[5],l=i[6],o=i[7],a=i[8],h=i[9],g=i[10],p=i[11],v=i[12],x=i[13],y=i[14];function _(S,O){for(var F=O^-1,N=0,W=S.length;N<W;)F=F>>>8^r[(F^S.charCodeAt(N++))&255];return~F}function w(S,O){for(var F=O^-1,N=S.length-15,W=0;W<N;)F=y[S[W++]^F&255]^x[S[W++]^F>>8&255]^v[S[W++]^F>>16&255]^p[S[W++]^F>>>24]^g[S[W++]]^h[S[W++]]^a[S[W++]]^o[S[W++]]^l[S[W++]]^d[S[W++]]^u[S[W++]]^s[S[W++]]^c[S[W++]]^m[S[W++]]^f[S[W++]]^r[S[W++]];for(N+=15;W<N;)F=F>>>8^r[(F^S[W++])&255];return~F}function C(S,O){for(var F=O^-1,N=0,W=S.length,X=0,Q=0;N<W;)X=S.charCodeAt(N++),X<128?F=F>>>8^r[(F^X)&255]:X<2048?(F=F>>>8^r[(F^(192|X>>6&31))&255],F=F>>>8^r[(F^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,Q=S.charCodeAt(N++)&1023,F=F>>>8^r[(F^(240|X>>8&7))&255],F=F>>>8^r[(F^(128|X>>2&63))&255],F=F>>>8^r[(F^(128|Q>>6&15|(X&3)<<4))&255],F=F>>>8^r[(F^(128|Q&63))&255]):(F=F>>>8^r[(F^(224|X>>12&15))&255],F=F>>>8^r[(F^(128|X>>6&63))&255],F=F>>>8^r[(F^(128|X&63))&255]);return~F}return t.table=r,t.bstr=_,t.buf=w,t.str=C,t}(),Qe=function(){var e={};e.version="1.2.1";function r(P,B){for(var M=P.split("/"),I=B.split("/"),j=0,U=0,te=Math.min(M.length,I.length);j<te;++j){if(U=M[j].length-I[j].length)return U;if(M[j]!=I[j])return M[j]<I[j]?-1:1}return M.length-I.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(0,B+1)}function i(P){if(P.charAt(P.length-1)=="/")return i(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(B+1)}function f(P,B){typeof B=="string"&&(B=new Date(B));var M=B.getHours();M=M<<6|B.getMinutes(),M=M<<5|B.getSeconds()>>>1,P.write_shift(2,M);var I=B.getFullYear()-1980;I=I<<4|B.getMonth()+1,I=I<<5|B.getDate(),P.write_shift(2,I)}function m(P){var B=P.read_shift(2)&65535,M=P.read_shift(2)&65535,I=new Date,j=M&31;M>>>=5;var U=M&15;M>>>=4,I.setMilliseconds(0),I.setFullYear(M+1980),I.setMonth(U-1),I.setDate(j);var te=B&31;B>>>=5;var de=B&63;return B>>>=6,I.setHours(B),I.setMinutes(de),I.setSeconds(te<<1),I}function c(P){fr(P,0);for(var B={},M=0;P.l<=P.length-4;){var I=P.read_shift(2),j=P.read_shift(2),U=P.l+j,te={};switch(I){case 21589:M=P.read_shift(1),M&1&&(te.mtime=P.read_shift(4)),j>5&&(M&2&&(te.atime=P.read_shift(4)),M&4&&(te.ctime=P.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break}P.l=U,B[I]=te}return B}var s;function u(){return s||(s={})}function d(P,B){if(P[0]==80&&P[1]==75)return Nf(P,B);if((P[0]|32)==109&&(P[1]|32)==105)return Q1(P,B);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var M=3,I=512,j=0,U=0,te=0,de=0,Z=0,re=[],ie=P.slice(0,512);fr(ie,0);var xe=l(ie);switch(M=xe[0],M){case 3:I=512;break;case 4:I=4096;break;case 0:if(xe[1]==0)return Nf(P,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}I!==512&&(ie=P.slice(0,I),fr(ie,28));var Te=P.slice(0,I);o(ie,M);var Oe=ie.read_shift(4,"i");if(M===3&&Oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Oe);ie.l+=4,te=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),de=ie.read_shift(4,"i"),j=ie.read_shift(4,"i"),Z=ie.read_shift(4,"i"),U=ie.read_shift(4,"i");for(var _e=-1,Ee=0;Ee<109&&(_e=ie.read_shift(4,"i"),!(_e<0));++Ee)re[Ee]=_e;var Ie=a(P,I);p(Z,U,Ie,I,re);var it=x(Ie,te,re,I);it[te].name="!Directory",j>0&&de!==Q&&(it[de].name="!MiniFAT"),it[re[0]].name="!FAT",it.fat_addrs=re,it.ssz=I;var st={},Nt=[],xs=[],ys=[];y(te,it,Ie,Nt,j,st,xs,de),h(xs,ys,Nt),Nt.shift();var _s={FileIndex:xs,FullPaths:ys};return B&&B.raw&&(_s.raw={header:Te,sectors:Ie}),_s}function l(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(ae,"Header Signature: "),P.l+=16;var B=P.read_shift(2,"u");return[P.read_shift(2,"u"),B]}function o(P,B){var M=9;switch(P.l+=2,M=P.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function a(P,B){for(var M=Math.ceil(P.length/B)-1,I=[],j=1;j<M;++j)I[j-1]=P.slice(j*B,(j+1)*B);return I[M-1]=P.slice(M*B),I}function h(P,B,M){for(var I=0,j=0,U=0,te=0,de=0,Z=M.length,re=[],ie=[];I<Z;++I)re[I]=ie[I]=I,B[I]=M[I];for(;de<ie.length;++de)I=ie[de],j=P[I].L,U=P[I].R,te=P[I].C,re[I]===I&&(j!==-1&&re[j]!==j&&(re[I]=re[j]),U!==-1&&re[U]!==U&&(re[I]=re[U])),te!==-1&&(re[te]=I),j!==-1&&I!=re[I]&&(re[j]=re[I],ie.lastIndexOf(j)<de&&ie.push(j)),U!==-1&&I!=re[I]&&(re[U]=re[I],ie.lastIndexOf(U)<de&&ie.push(U));for(I=1;I<Z;++I)re[I]===I&&(U!==-1&&re[U]!==U?re[I]=re[U]:j!==-1&&re[j]!==j&&(re[I]=re[j]));for(I=1;I<Z;++I)if(P[I].type!==0){if(de=I,de!=re[de])do de=re[de],B[I]=B[de]+"/"+B[I];while(de!==0&&re[de]!==-1&&de!=re[de]);re[I]=-1}for(B[0]+="/",I=1;I<Z;++I)P[I].type!==2&&(B[I]+="/")}function g(P,B,M){for(var I=P.start,j=P.size,U=[],te=I;M&&j>0&&te>=0;)U.push(B.slice(te*X,te*X+X)),j-=X,te=ni(M,te*4);return U.length===0?fe(0):Dt(U).slice(0,P.size)}function p(P,B,M,I,j){var U=Q;if(P===Q){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var te=M[P],de=(I>>>2)-1;if(!te)return;for(var Z=0;Z<de&&(U=ni(te,Z*4))!==Q;++Z)j.push(U);p(ni(te,I-4),B-1,M,I,j)}}function v(P,B,M,I,j){var U=[],te=[];j||(j=[]);var de=I-1,Z=0,re=0;for(Z=B;Z>=0;){j[Z]=!0,U[U.length]=Z,te.push(P[Z]);var ie=M[Math.floor(Z*4/I)];if(re=Z*4&de,I<4+re)throw new Error("FAT boundary crossed: "+Z+" 4 "+I);if(!P[ie])break;Z=ni(P[ie],re)}return{nodes:U,data:p0([te])}}function x(P,B,M,I){var j=P.length,U=[],te=[],de=[],Z=[],re=I-1,ie=0,xe=0,Te=0,Oe=0;for(ie=0;ie<j;++ie)if(de=[],Te=ie+B,Te>=j&&(Te-=j),!te[Te]){Z=[];var _e=[];for(xe=Te;xe>=0;){_e[xe]=!0,te[xe]=!0,de[de.length]=xe,Z.push(P[xe]);var Ee=M[Math.floor(xe*4/I)];if(Oe=xe*4&re,I<4+Oe)throw new Error("FAT boundary crossed: "+xe+" 4 "+I);if(!P[Ee]||(xe=ni(P[Ee],Oe),_e[xe]))break}U[Te]={nodes:de,data:p0([Z])}}return U}function y(P,B,M,I,j,U,te,de){for(var Z=0,re=I.length?2:0,ie=B[P].data,xe=0,Te=0,Oe;xe<ie.length;xe+=128){var _e=ie.slice(xe,xe+128);fr(_e,64),Te=_e.read_shift(2),Oe=yf(_e,0,Te-re),I.push(Oe);var Ee={name:Oe,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ie=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ie!==0&&(Ee.ct=_(_e,_e.l-8));var it=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);it!==0&&(Ee.mt=_(_e,_e.l-8)),Ee.start=_e.read_shift(4,"i"),Ee.size=_e.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=Q,Ee.name=""),Ee.type===5?(Z=Ee.start,j>0&&Z!==Q&&(B[Z].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",B[Ee.start]===void 0&&(B[Ee.start]=v(M,Ee.start,B.fat_addrs,B.ssz)),B[Ee.start].name=Ee.name,Ee.content=B[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:Z!==Q&&Ee.start!==Q&&B[Z]&&(Ee.content=g(Ee,B[Z].data,(B[de]||{}).data))),Ee.content&&fr(Ee.content,0),U[Oe]=Ee,te.push(Ee)}}function _(P,B){return new Date((dr(P,B+4)/1e7*Math.pow(2,32)+dr(P,B)/1e7-11644473600)*1e3)}function w(P,B){return u(),d(s.readFileSync(P),B)}function C(P,B){var M=B&&B.type;switch(M||Xe&&Buffer.isBuffer(P)&&(M="buffer"),M||"base64"){case"file":return w(P,B);case"base64":return d(Lr(xn(P)),B);case"binary":return d(Lr(P),B)}return d(P,B)}function S(P,B){var M=B||{},I=M.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=I+"/",P.FileIndex[0]={name:I,type:5}),M.CLSID&&(P.FileIndex[0].clsid=M.CLSID),O(P)}function O(P){var B="Sh33tJ5";if(!Qe.find(P,"/"+B)){var M=fe(4);M[0]=55,M[1]=M[3]=50,M[2]=54,P.FileIndex.push({name:B,type:2,content:M,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+B),F(P)}}function F(P,B){S(P);for(var M=!1,I=!1,j=P.FullPaths.length-1;j>=0;--j){var U=P.FileIndex[j];switch(U.type){case 0:I?M=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:I=!0,isNaN(U.R*U.L*U.C)&&(M=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!B)){var te=new Date(1987,1,19),de=0,Z=Object.create?Object.create(null):{},re=[];for(j=0;j<P.FullPaths.length;++j)Z[P.FullPaths[j]]=!0,P.FileIndex[j].type!==0&&re.push([P.FullPaths[j],P.FileIndex[j]]);for(j=0;j<re.length;++j){var ie=n(re[j][0]);I=Z[ie],I||(re.push([ie,{name:i(ie).replace("/",""),type:1,clsid:J,ct:te,mt:te,content:null}]),Z[ie]=!0)}for(re.sort(function(Oe,_e){return r(Oe[0],_e[0])}),P.FullPaths=[],P.FileIndex=[],j=0;j<re.length;++j)P.FullPaths[j]=re[j][0],P.FileIndex[j]=re[j][1];for(j=0;j<re.length;++j){var xe=P.FileIndex[j],Te=P.FullPaths[j];if(xe.name=i(Te).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||J,j===0)xe.C=re.length>1?1:-1,xe.size=0,xe.type=5;else if(Te.slice(-1)=="/"){for(de=j+1;de<re.length&&n(P.FullPaths[de])!=Te;++de);for(xe.C=de>=re.length?-1:de,de=j+1;de<re.length&&n(P.FullPaths[de])!=n(Te);++de);xe.R=de>=re.length?-1:de,xe.type=1}else n(P.FullPaths[j+1]||"")==n(Te)&&(xe.R=j+1),xe.type=2}}}function N(P,B){var M=B||{};if(M.fileType=="mad")return q1(P,M);switch(F(P),M.fileType){case"zip":return H1(P,M)}var I=function(Oe){for(var _e=0,Ee=0,Ie=0;Ie<Oe.FileIndex.length;++Ie){var it=Oe.FileIndex[Ie];if(it.content){var st=it.content.length;st>0&&(st<4096?_e+=st+63>>6:Ee+=st+511>>9)}}for(var Nt=Oe.FullPaths.length+3>>2,xs=_e+7>>3,ys=_e+127>>7,_s=xs+Ee+Nt+ys,qn=_s+127>>7,Rl=qn<=109?0:Math.ceil((qn-109)/127);_s+qn+Rl+127>>7>qn;)Rl=++qn<=109?0:Math.ceil((qn-109)/127);var Zr=[1,Rl,qn,ys,Nt,Ee,_e,0];return Oe.FileIndex[0].size=_e<<6,Zr[7]=(Oe.FileIndex[0].start=Zr[0]+Zr[1]+Zr[2]+Zr[3]+Zr[4]+Zr[5])+(Zr[6]+7>>3),Zr}(P),j=fe(I[7]<<9),U=0,te=0;{for(U=0;U<8;++U)j.write_shift(1,ne[U]);for(U=0;U<8;++U)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),U=0;U<3;++U)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,I[2]),j.write_shift(4,I[0]+I[1]+I[2]+I[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,I[3]?I[0]+I[1]+I[2]-1:Q),j.write_shift(4,I[3]),j.write_shift(-4,I[1]?I[0]-1:Q),j.write_shift(4,I[1]),U=0;U<109;++U)j.write_shift(-4,U<I[2]?I[1]+U:-1)}if(I[1])for(te=0;te<I[1];++te){for(;U<236+te*127;++U)j.write_shift(-4,U<I[2]?I[1]+U:-1);j.write_shift(-4,te===I[1]-1?Q:te+1)}var de=function(Oe){for(te+=Oe;U<te-1;++U)j.write_shift(-4,U+1);Oe&&(++U,j.write_shift(-4,Q))};for(te=U=0,te+=I[1];U<te;++U)j.write_shift(-4,oe.DIFSECT);for(te+=I[2];U<te;++U)j.write_shift(-4,oe.FATSECT);de(I[3]),de(I[4]);for(var Z=0,re=0,ie=P.FileIndex[0];Z<P.FileIndex.length;++Z)ie=P.FileIndex[Z],ie.content&&(re=ie.content.length,!(re<4096)&&(ie.start=te,de(re+511>>9)));for(de(I[6]+7>>3);j.l&511;)j.write_shift(-4,oe.ENDOFCHAIN);for(te=U=0,Z=0;Z<P.FileIndex.length;++Z)ie=P.FileIndex[Z],ie.content&&(re=ie.content.length,!(!re||re>=4096)&&(ie.start=te,de(re+63>>6)));for(;j.l&511;)j.write_shift(-4,oe.ENDOFCHAIN);for(U=0;U<I[4]<<2;++U){var xe=P.FullPaths[U];if(!xe||xe.length===0){for(Z=0;Z<17;++Z)j.write_shift(4,0);for(Z=0;Z<3;++Z)j.write_shift(4,-1);for(Z=0;Z<12;++Z)j.write_shift(4,0);continue}ie=P.FileIndex[U],U===0&&(ie.start=ie.size?ie.start-1:Q);var Te=U===0&&M.root||ie.name;if(re=2*(Te.length+1),j.write_shift(64,Te,"utf16le"),j.write_shift(2,re),j.write_shift(1,ie.type),j.write_shift(1,ie.color),j.write_shift(-4,ie.L),j.write_shift(-4,ie.R),j.write_shift(-4,ie.C),ie.clsid)j.write_shift(16,ie.clsid,"hex");else for(Z=0;Z<4;++Z)j.write_shift(4,0);j.write_shift(4,ie.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,ie.start),j.write_shift(4,ie.size),j.write_shift(4,0)}for(U=1;U<P.FileIndex.length;++U)if(ie=P.FileIndex[U],ie.size>=4096)if(j.l=ie.start+1<<9,Xe&&Buffer.isBuffer(ie.content))ie.content.copy(j,j.l,0,ie.size),j.l+=ie.size+511&-512;else{for(Z=0;Z<ie.size;++Z)j.write_shift(1,ie.content[Z]);for(;Z&511;++Z)j.write_shift(1,0)}for(U=1;U<P.FileIndex.length;++U)if(ie=P.FileIndex[U],ie.size>0&&ie.size<4096)if(Xe&&Buffer.isBuffer(ie.content))ie.content.copy(j,j.l,0,ie.size),j.l+=ie.size+63&-64;else{for(Z=0;Z<ie.size;++Z)j.write_shift(1,ie.content[Z]);for(;Z&63;++Z)j.write_shift(1,0)}if(Xe)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function W(P,B){var M=P.FullPaths.map(function(Z){return Z.toUpperCase()}),I=M.map(function(Z){var re=Z.split("/");return re[re.length-(Z.slice(-1)=="/"?2:1)]}),j=!1;B.charCodeAt(0)===47?(j=!0,B=M[0].slice(0,-1)+B):j=B.indexOf("/")!==-1;var U=B.toUpperCase(),te=j===!0?M.indexOf(U):I.indexOf(U);if(te!==-1)return P.FileIndex[te];var de=!U.match(to);for(U=U.replace($s,""),de&&(U=U.replace(to,"!")),te=0;te<M.length;++te)if((de?M[te].replace(to,"!"):M[te]).replace($s,"")==U||(de?I[te].replace(to,"!"):I[te]).replace($s,"")==U)return P.FileIndex[te];return null}var X=64,Q=-2,ae="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(P,B,M){u();var I=N(P,M);s.writeFileSync(B,I)}function k(P){for(var B=new Array(P.length),M=0;M<P.length;++M)B[M]=String.fromCharCode(P[M]);return B.join("")}function D(P,B){var M=N(P,B);switch(B&&B.type||"buffer"){case"file":return u(),s.writeFileSync(B.filename,M),M;case"binary":return typeof M=="string"?M:k(M);case"base64":return xa(typeof M=="string"?M:k(M));case"buffer":if(Xe)return Buffer.isBuffer(M)?M:wn(M);case"array":return typeof M=="string"?Lr(M):M}return M}var L;function E(P){try{var B=P.InflateRaw,M=new B;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)L=P;else throw new Error("zlib does not expose bytesRead")}catch(I){console.error("cannot use native zlib: "+(I.message||I))}}function b(P,B){if(!L)return Lf(P,B);var M=L.InflateRaw,I=new M,j=I._processChunk(P.slice(P.l),I._finishFlushFlag);return P.l+=I.bytesRead,j}function A(P){return L?L.deflateRawSync(P):Xr(P)}var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function K(P){var B=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(B>>16|B>>8|B)&255}for(var H=typeof Uint8Array<"u",G=H?new Uint8Array(256):[],ue=0;ue<256;++ue)G[ue]=K(ue);function le(P,B){var M=G[P&255];return B<=8?M>>>8-B:(M=M<<8|G[P>>8&255],B<=16?M>>>16-B:(M=M<<8|G[P>>16&255],M>>>24-B))}function ee(P,B){var M=B&7,I=B>>>3;return(P[I]|(M<=6?0:P[I+1]<<8))>>>M&3}function Y(P,B){var M=B&7,I=B>>>3;return(P[I]|(M<=5?0:P[I+1]<<8))>>>M&7}function ce(P,B){var M=B&7,I=B>>>3;return(P[I]|(M<=4?0:P[I+1]<<8))>>>M&15}function se(P,B){var M=B&7,I=B>>>3;return(P[I]|(M<=3?0:P[I+1]<<8))>>>M&31}function V(P,B){var M=B&7,I=B>>>3;return(P[I]|(M<=1?0:P[I+1]<<8))>>>M&127}function he(P,B,M){var I=B&7,j=B>>>3,U=(1<<M)-1,te=P[j]>>>I;return M<8-I||(te|=P[j+1]<<8-I,M<16-I)||(te|=P[j+2]<<16-I,M<24-I)||(te|=P[j+3]<<24-I),te&U}function ve(P,B,M){var I=B&7,j=B>>>3;return I<=5?P[j]|=(M&7)<<I:(P[j]|=M<<I&255,P[j+1]=(M&7)>>8-I),B+3}function Re(P,B,M){var I=B&7,j=B>>>3;return M=(M&1)<<I,P[j]|=M,B+1}function Pe(P,B,M){var I=B&7,j=B>>>3;return M<<=I,P[j]|=M&255,M>>>=8,P[j+1]=M,B+8}function pe(P,B,M){var I=B&7,j=B>>>3;return M<<=I,P[j]|=M&255,M>>>=8,P[j+1]=M&255,P[j+2]=M>>>8,B+16}function De(P,B){var M=P.length,I=2*M>B?2*M:B+5,j=0;if(M>=B)return P;if(Xe){var U=Zh(I);if(P.copy)P.copy(U);else for(;j<P.length;++j)U[j]=P[j];return U}else if(H){var te=new Uint8Array(I);if(te.set)te.set(P);else for(;j<M;++j)te[j]=P[j];return te}return P.length=I,P}function be(P){for(var B=new Array(P),M=0;M<P;++M)B[M]=0;return B}function Be(P,B,M){var I=1,j=0,U=0,te=0,de=0,Z=P.length,re=H?new Uint16Array(32):be(32);for(U=0;U<32;++U)re[U]=0;for(U=Z;U<M;++U)P[U]=0;Z=P.length;var ie=H?new Uint16Array(Z):be(Z);for(U=0;U<Z;++U)re[j=P[U]]++,I<j&&(I=j),ie[U]=0;for(re[0]=0,U=1;U<=I;++U)re[U+16]=de=de+re[U-1]<<1;for(U=0;U<Z;++U)de=P[U],de!=0&&(ie[U]=re[de+16]++);var xe=0;for(U=0;U<Z;++U)if(xe=P[U],xe!=0)for(de=le(ie[U],I)>>I-xe,te=(1<<I+4-xe)-1;te>=0;--te)B[de|te<<xe]=xe&15|U<<4;return I}var Ke=H?new Uint16Array(512):be(512),Ue=H?new Uint16Array(32):be(32);if(!H){for(var nt=0;nt<512;++nt)Ke[nt]=0;for(nt=0;nt<32;++nt)Ue[nt]=0}(function(){for(var P=[],B=0;B<32;B++)P.push(5);Be(P,Ue,32);var M=[];for(B=0;B<=143;B++)M.push(8);for(;B<=255;B++)M.push(9);for(;B<=279;B++)M.push(7);for(;B<=287;B++)M.push(8);Be(M,Ke,288)})();var ct=function(){for(var B=H?new Uint8Array(32768):[],M=0,I=0;M<z.length-1;++M)for(;I<z[M+1];++I)B[I]=M;for(;I<32768;++I)B[I]=29;var j=H?new Uint8Array(259):[];for(M=0,I=0;M<R.length-1;++M)for(;I<R[M+1];++I)j[I]=M;function U(de,Z){for(var re=0;re<de.length;){var ie=Math.min(65535,de.length-re),xe=re+ie==de.length;for(Z.write_shift(1,+xe),Z.write_shift(2,ie),Z.write_shift(2,~ie&65535);ie-- >0;)Z[Z.l++]=de[re++]}return Z.l}function te(de,Z){for(var re=0,ie=0,xe=H?new Uint16Array(32768):[];ie<de.length;){var Te=Math.min(65535,de.length-ie);if(Te<10){for(re=ve(Z,re,+(ie+Te==de.length)),re&7&&(re+=8-(re&7)),Z.l=re/8|0,Z.write_shift(2,Te),Z.write_shift(2,~Te&65535);Te-- >0;)Z[Z.l++]=de[ie++];re=Z.l*8;continue}re=ve(Z,re,+(ie+Te==de.length)+2);for(var Oe=0;Te-- >0;){var _e=de[ie];Oe=(Oe<<5^_e)&32767;var Ee=-1,Ie=0;if((Ee=xe[Oe])&&(Ee|=ie&-32768,Ee>ie&&(Ee-=32768),Ee<ie))for(;de[Ee+Ie]==de[ie+Ie]&&Ie<250;)++Ie;if(Ie>2){_e=j[Ie],_e<=22?re=Pe(Z,re,G[_e+1]>>1)-1:(Pe(Z,re,3),re+=5,Pe(Z,re,G[_e-23]>>5),re+=3);var it=_e<8?0:_e-4>>2;it>0&&(pe(Z,re,Ie-R[_e]),re+=it),_e=B[ie-Ee],re=Pe(Z,re,G[_e]>>3),re-=3;var st=_e<4?0:_e-2>>1;st>0&&(pe(Z,re,ie-Ee-z[_e]),re+=st);for(var Nt=0;Nt<Ie;++Nt)xe[Oe]=ie&32767,Oe=(Oe<<5^de[ie])&32767,++ie;Te-=Ie-1}else _e<=143?_e=_e+48:re=Re(Z,re,1),re=Pe(Z,re,G[_e]),xe[Oe]=ie&32767,++ie}re=Pe(Z,re,0)-1}return Z.l=(re+7)/8|0,Z.l}return function(Z,re){return Z.length<8?U(Z,re):te(Z,re)}}();function Xr(P){var B=fe(50+Math.floor(P.length*1.1)),M=ct(P,B);return B.slice(0,M)}var Cn=H?new Uint16Array(32768):be(32768),lr=H?new Uint16Array(32768):be(32768),Ma=H?new Uint16Array(128):be(128),vs=1,La=1;function Dl(P,B){var M=se(P,B)+257;B+=5;var I=se(P,B)+1;B+=5;var j=ce(P,B)+4;B+=4;for(var U=0,te=H?new Uint8Array(19):be(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,re=H?new Uint8Array(8):be(8),ie=H?new Uint8Array(8):be(8),xe=te.length,Te=0;Te<j;++Te)te[T[Te]]=U=Y(P,B),Z<U&&(Z=U),re[U]++,B+=3;var Oe=0;for(re[0]=0,Te=1;Te<=Z;++Te)ie[Te]=Oe=Oe+re[Te-1]<<1;for(Te=0;Te<xe;++Te)(Oe=te[Te])!=0&&(de[Te]=ie[Oe]++);var _e=0;for(Te=0;Te<xe;++Te)if(_e=te[Te],_e!=0){Oe=G[de[Te]]>>8-_e;for(var Ee=(1<<7-_e)-1;Ee>=0;--Ee)Ma[Oe|Ee<<_e]=_e&7|Te<<3}var Ie=[];for(Z=1;Ie.length<M+I;)switch(Oe=Ma[V(P,B)],B+=Oe&7,Oe>>>=3){case 16:for(U=3+ee(P,B),B+=2,Oe=Ie[Ie.length-1];U-- >0;)Ie.push(Oe);break;case 17:for(U=3+Y(P,B),B+=3;U-- >0;)Ie.push(0);break;case 18:for(U=11+V(P,B),B+=7;U-- >0;)Ie.push(0);break;default:Ie.push(Oe),Z<Oe&&(Z=Oe);break}var it=Ie.slice(0,M),st=Ie.slice(M);for(Te=M;Te<286;++Te)it[Te]=0;for(Te=I;Te<30;++Te)st[Te]=0;return vs=Be(it,Cn,286),La=Be(st,lr,30),B}function z1(P,B){if(P[0]==3&&!(P[1]&3))return[vi(B),2];for(var M=0,I=0,j=Zh(B||1<<18),U=0,te=j.length>>>0,de=0,Z=0;!(I&1);){if(I=Y(P,M),M+=3,I>>>1)I>>1==1?(de=9,Z=5):(M=Dl(P,M),de=vs,Z=La);else{M&7&&(M+=8-(M&7));var re=P[M>>>3]|P[(M>>>3)+1]<<8;if(M+=32,re>0)for(!B&&te<U+re&&(j=De(j,U+re),te=j.length);re-- >0;)j[U++]=P[M>>>3],M+=8;continue}for(;;){!B&&te<U+32767&&(j=De(j,U+32767),te=j.length);var ie=he(P,M,de),xe=I>>>1==1?Ke[ie]:Cn[ie];if(M+=xe&15,xe>>>=4,!(xe>>>8&255))j[U++]=xe;else{if(xe==256)break;xe-=257;var Te=xe<8?0:xe-4>>2;Te>5&&(Te=0);var Oe=U+R[xe];Te>0&&(Oe+=he(P,M,Te),M+=Te),ie=he(P,M,Z),xe=I>>>1==1?Ue[ie]:lr[ie],M+=xe&15,xe>>>=4;var _e=xe<4?0:xe-2>>1,Ee=z[xe];for(_e>0&&(Ee+=he(P,M,_e),M+=_e),!B&&te<Oe&&(j=De(j,Oe+100),te=j.length);U<Oe;)j[U]=j[U-Ee],++U}}}return B?[j,M+7>>>3]:[j.slice(0,U),M+7>>>3]}function Lf(P,B){var M=P.slice(P.l||0),I=z1(M,B);return P.l+=I[1],I[0]}function If(P,B){if(P)typeof console<"u"&&console.error(B);else throw new Error(B)}function Nf(P,B){var M=P;fr(M,0);var I=[],j=[],U={FileIndex:I,FullPaths:j};S(U,{root:B.root});for(var te=M.length-4;(M[te]!=80||M[te+1]!=75||M[te+2]!=5||M[te+3]!=6)&&te>=0;)--te;M.l=te+4,M.l+=4;var de=M.read_shift(2);M.l+=6;var Z=M.read_shift(4);for(M.l=Z,te=0;te<de;++te){M.l+=20;var re=M.read_shift(4),ie=M.read_shift(4),xe=M.read_shift(2),Te=M.read_shift(2),Oe=M.read_shift(2);M.l+=8;var _e=M.read_shift(4),Ee=c(M.slice(M.l+xe,M.l+xe+Te));M.l+=xe+Te+Oe;var Ie=M.l;M.l=_e+4,X1(M,re,ie,U,Ee),M.l=Ie}return U}function X1(P,B,M,I,j){P.l+=2;var U=P.read_shift(2),te=P.read_shift(2),de=m(P);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Z=P.read_shift(4),re=P.read_shift(4),ie=P.read_shift(4),xe=P.read_shift(2),Te=P.read_shift(2),Oe="",_e=0;_e<xe;++_e)Oe+=String.fromCharCode(P[P.l++]);if(Te){var Ee=c(P.slice(P.l,P.l+Te));(Ee[21589]||{}).mt&&(de=Ee[21589].mt),((j||{})[21589]||{}).mt&&(de=j[21589].mt)}P.l+=Te;var Ie=P.slice(P.l,P.l+re);switch(te){case 8:Ie=b(P,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+te)}var it=!1;U&8&&(Z=P.read_shift(4),Z==134695760&&(Z=P.read_shift(4),it=!0),re=P.read_shift(4),ie=P.read_shift(4)),re!=B&&If(it,"Bad compressed size: "+B+" != "+re),ie!=M&&If(it,"Bad uncompressed size: "+M+" != "+ie),bl(I,Oe,Ie,{unsafe:!0,mt:de})}function H1(P,B){var M=B||{},I=[],j=[],U=fe(1),te=M.compression?8:0,de=0,Z=0,re=0,ie=0,xe=0,Te=P.FullPaths[0],Oe=Te,_e=P.FileIndex[0],Ee=[],Ie=0;for(Z=1;Z<P.FullPaths.length;++Z)if(Oe=P.FullPaths[Z].slice(Te.length),_e=P.FileIndex[Z],!(!_e.size||!_e.content||Oe=="Sh33tJ5")){var it=ie,st=fe(Oe.length);for(re=0;re<Oe.length;++re)st.write_shift(1,Oe.charCodeAt(re)&127);st=st.slice(0,st.l),Ee[xe]=zy.buf(_e.content,0);var Nt=_e.content;te==8&&(Nt=A(Nt)),U=fe(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,de),U.write_shift(2,te),_e.mt?f(U,_e.mt):U.write_shift(4,0),U.write_shift(-4,Ee[xe]),U.write_shift(4,Nt.length),U.write_shift(4,_e.content.length),U.write_shift(2,st.length),U.write_shift(2,0),ie+=U.length,I.push(U),ie+=st.length,I.push(st),ie+=Nt.length,I.push(Nt),U=fe(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,de),U.write_shift(2,te),U.write_shift(4,0),U.write_shift(-4,Ee[xe]),U.write_shift(4,Nt.length),U.write_shift(4,_e.content.length),U.write_shift(2,st.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,it),Ie+=U.l,j.push(U),Ie+=st.length,j.push(st),++xe}return U=fe(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,xe),U.write_shift(2,xe),U.write_shift(4,Ie),U.write_shift(4,ie),U.write_shift(2,0),Dt([Dt(I),Dt(j),U])}var Ia={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Y1(P,B){if(P.ctype)return P.ctype;var M=P.name||"",I=M.match(/\.([^\.]+)$/);return I&&Ia[I[1]]||B&&(I=(M=B).match(/[\.\\]([^\.\\])+$/),I&&Ia[I[1]])?Ia[I[1]]:"application/octet-stream"}function V1(P){for(var B=xa(P),M=[],I=0;I<B.length;I+=76)M.push(B.slice(I,I+76));return M.join(`\r
`)+`\r
`}function G1(P){var B=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ie=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],I=B.split(`\r
`),j=0;j<I.length;++j){var U=I[j];if(U.length==0){M.push("");continue}for(var te=0;te<U.length;){var de=76,Z=U.slice(te,te+de);Z.charAt(de-1)=="="?de--:Z.charAt(de-2)=="="?de-=2:Z.charAt(de-3)=="="&&(de-=3),Z=U.slice(te,te+de),te+=de,te<U.length&&(Z+="="),M.push(Z)}}return M.join(`\r
`)}function $1(P){for(var B=[],M=0;M<P.length;++M){for(var I=P[M];M<=P.length&&I.charAt(I.length-1)=="=";)I=I.slice(0,I.length-1)+P[++M];B.push(I)}for(var j=0;j<B.length;++j)B[j]=B[j].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Lr(B.join(`\r
`))}function K1(P,B,M){for(var I="",j="",U="",te,de=0;de<10;++de){var Z=B[de];if(!Z||Z.match(/^\s*$/))break;var re=Z.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":I=re[2].trim();break;case"content-type":U=re[2].trim();break;case"content-transfer-encoding":j=re[2].trim();break}}switch(++de,j.toLowerCase()){case"base64":te=Lr(xn(B.slice(de).join("")));break;case"quoted-printable":te=$1(B.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var ie=bl(P,I.slice(M.length),te,{unsafe:!0});U&&(ie.ctype=U)}function Q1(P,B){if(k(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=B&&B.root||"",I=(Xe&&Buffer.isBuffer(P)?P.toString("binary"):k(P)).split(`\r
`),j=0,U="";for(j=0;j<I.length;++j)if(U=I[j],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),M||(M=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),U.slice(0,M.length)!=M););var te=(I[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var de="--"+(te[1]||""),Z=[],re=[],ie={FileIndex:Z,FullPaths:re};S(ie);var xe,Te=0;for(j=0;j<I.length;++j){var Oe=I[j];Oe!==de&&Oe!==de+"--"||(Te++&&K1(ie,I.slice(xe,j),M),xe=j)}return ie}function q1(P,B){var M=B||{},I=M.boundary||"SheetJS";I="------="+I;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+I.slice(2)+'"',"","",""],U=P.FullPaths[0],te=U,de=P.FileIndex[0],Z=1;Z<P.FullPaths.length;++Z)if(te=P.FullPaths[Z].slice(U.length),de=P.FileIndex[Z],!(!de.size||!de.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var re=de.content,ie=Xe&&Buffer.isBuffer(re)?re.toString("binary"):k(re),xe=0,Te=Math.min(1024,ie.length),Oe=0,_e=0;_e<=Te;++_e)(Oe=ie.charCodeAt(_e))>=32&&Oe<128&&++xe;var Ee=xe>=Te*4/5;j.push(I),j.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+te),j.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),j.push("Content-Type: "+Y1(de,te)),j.push(""),j.push(Ee?G1(ie):V1(ie))}return j.push(I+`--\r
`),j.join(`\r
`)}function J1(P){var B={};return S(B,P),B}function bl(P,B,M,I){var j=I&&I.unsafe;j||S(P);var U=!j&&Qe.find(P,B);if(!U){var te=P.FullPaths[0];B.slice(0,te.length)==te?te=B:(te.slice(-1)!="/"&&(te+="/"),te=(te+B).replace("//","/")),U={name:i(B),type:2},P.FileIndex.push(U),P.FullPaths.push(te),j||Qe.utils.cfb_gc(P)}return U.content=M,U.size=M?M.length:0,I&&(I.CLSID&&(U.clsid=I.CLSID),I.mt&&(U.mt=I.mt),I.ct&&(U.ct=I.ct)),U}function Z1(P,B){S(P);var M=Qe.find(P,B);if(M){for(var I=0;I<P.FileIndex.length;++I)if(P.FileIndex[I]==M)return P.FileIndex.splice(I,1),P.FullPaths.splice(I,1),!0}return!1}function em(P,B,M){S(P);var I=Qe.find(P,B);if(I){for(var j=0;j<P.FileIndex.length;++j)if(P.FileIndex[j]==I)return P.FileIndex[j].name=i(M),P.FullPaths[j]=M,!0}return!1}function tm(P){F(P,!0)}return e.find=W,e.read=C,e.parse=d,e.write=D,e.writeFile=q,e.utils={cfb_new:J1,cfb_add:bl,cfb_del:Z1,cfb_mov:em,cfb_gc:tm,ReadShift:Qs,CheckField:jg,prep_blob:fr,bconcat:Dt,use_zlib:E,_deflateRaw:Xr,_inflateRaw:Lf,consts:oe},e}();function Xy(t){return typeof t=="string"?Cl(t):Array.isArray(t)?gy(t):t}function Pa(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cl(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ln(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Xy(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var f=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),chrome.downloads.download({url:f,filename:t,saveAs:!0});var m=document.createElement("a");if(m.download!=null)return m.download=t,m.href=f,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(f)},6e4),f}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=ka(e)),c.write(e),c.close(),e}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("cannot save file "+t)}function It(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function o0(t,e){for(var r=[],n=It(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function gf(t){for(var e=[],r=It(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ol(t){for(var e=[],r=It(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function Hy(t){for(var e=[],r=It(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var qo=new Date(1899,11,30,0,0,0);function ar(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=qo.getTime()+(t.getTimezoneOffset()-qo.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Sg=new Date,Yy=qo.getTime()+(Sg.getTimezoneOffset()-qo.getTimezoneOffset())*6e4,l0=Sg.getTimezoneOffset();function Cg(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Yy),e.getTimezoneOffset()!==l0&&e.setTime(e.getTime()+(e.getTimezoneOffset()-l0)*6e4),e}var c0=new Date("2017-02-19T19:06:09.000Z"),Tg=isNaN(c0.getFullYear())?new Date("2/19/17"):c0,Vy=Tg.getFullYear()==2017;function Qt(t,e){var r=new Date(t);if(Vy)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Tg.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],f=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(f=new Date(f.getTime()-f.getTimezoneOffset()*60*1e3)),f}function Al(t,e){if(Xe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ln(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ln(py(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ln(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ln(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(f){return r[f]||f})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function or(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=or(t[r]));return e}function ft(t,e){for(var r="";r.length<e;)r+=t;return r}function hn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,f){return r=-r,f}),!isNaN(e=Number(n)))?e/r:e}var Gy=["january","february","march","april","may","june","july","august","september","october","november","december"];function ya(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),f=e.getDate();if(isNaN(f))return r;var m=t.toLowerCase();if(m.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(m=m.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),m.length>3&&Gy.indexOf(m)==-1)return r}else if(m.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||f>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Ne(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Xe?n=wn(r):n=my(r),Qe.utils.cfb_add(t,e,n)}Qe.utils.cfb_add(t,e,r)}else t.file(e,r)}function mf(){return Qe.utils.cfb_new()}var xt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$y={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vf=gf($y),xf=/[&<>'"]/g,Ky=/[\u0000-\u0008\u000b-\u001f]/g;function Ve(t){var e=t+"";return e.replace(xf,function(r){return vf[r]}).replace(Ky,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function u0(t){return Ve(t).replace(/ /g,"_x0020_")}var Eg=/[\u0000-\u001f]/g;function Qy(t){var e=t+"";return e.replace(xf,function(r){return vf[r]}).replace(/\n/g,"<br/>").replace(Eg,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function qy(t){var e=t+"";return e.replace(xf,function(r){return vf[r]}).replace(Eg,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function Jy(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zy(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uc(t){for(var e="",r=0,n=0,i=0,f=0,m=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){m=(n&31)<<6,m|=i&63,e+=String.fromCharCode(m);continue}if(f=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|f&63);continue}m=t.charCodeAt(r++),c=((n&7)<<18|(i&63)<<12|(f&63)<<6|m&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function f0(t){var e=vi(2*t.length),r,n,i=1,f=0,m=0,c;for(n=0;n<t.length;n+=i)i=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),i=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,m=55296+(r>>>10&1023),r=56320+(r&1023)),m!==0&&(e[f++]=m&255,e[f++]=m>>>8,m=0),e[f++]=r%256,e[f++]=r>>>8;return e.slice(0,f).toString("ucs2")}function h0(t){return wn(t,"binary").toString("utf8")}var no="foo bar baz",Ks=Xe&&(h0(no)==uc(no)&&h0||f0(no)==uc(no)&&f0)||uc,ln=Xe?function(t){return wn(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},e2=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Og=/(^\s|\s$|\n)/;function bt(t,e){return"<"+t+(e.match(Og)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function _a(t){return It(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function we(t,e,r){return"<"+t+(r!=null?_a(r):"")+(e!=null?(e.match(Og)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function du(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function t2(t,e){switch(typeof t){case"string":var r=we("vt:lpwstr",Ve(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return we((t|0)==t?"vt:i4":"vt:r8",Ve(String(t)));case"boolean":return we("vt:bool",t?"true":"false")}if(t instanceof Date)return we("vt:filetime",du(t));throw new Error("Unable to serialize "+t)}var Tt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ds=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function r2(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,f=5;f>=0;--f)i=i*256+t[e+f];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function n2(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,f=0,m=n?-e:e;isFinite(m)?m==0?i=f=0:(i=Math.floor(Math.log(m)/Math.LN2),f=m*Math.pow(2,52-i),i<=-1023&&(!isFinite(f)||f<Math.pow(2,52))?i=-1022:(f-=Math.pow(2,52),i+=1023)):(i=2047,f=isNaN(e)?26985:0);for(var c=0;c<=5;++c,f/=256)t[r+c]=f&255;t[r+6]=(i&15)<<4|f&15,t[r+7]=i>>4|n}var d0=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,f=t[0][n].length;i<f;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},p0=Xe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:wn(e)})):d0(t)}:d0,g0=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ls(t,i)));return n.join("").replace($s,"")},yf=Xe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace($s,""):g0(t,e,r)}:g0,m0=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Ag=Xe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):m0(t,e,r)}:m0,v0=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(bi(t,i)));return n.join("")},Fa=Xe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):v0(e,r,n)}:v0,kg=function(t,e){var r=dr(t,e);return r>0?Fa(t,e+4,e+4+r-1):""},Pg=kg,Fg=function(t,e){var r=dr(t,e);return r>0?Fa(t,e+4,e+4+r-1):""},Dg=Fg,bg=function(t,e){var r=2*dr(t,e);return r>0?Fa(t,e+4,e+4+r-1):""},Rg=bg,Mg=function(e,r){var n=dr(e,r);return n>0?yf(e,r+4,r+4+n):""},Lg=Mg,Ig=function(t,e){var r=dr(t,e);return r>0?Fa(t,e+4,e+4+r):""},Ng=Ig,Bg=function(t,e){return r2(t,e)},Jo=Bg,_f=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Xe&&(Pg=function(e,r){if(!Buffer.isBuffer(e))return kg(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Dg=function(e,r){if(!Buffer.isBuffer(e))return Fg(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Rg=function(e,r){if(!Buffer.isBuffer(e))return bg(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Lg=function(e,r){if(!Buffer.isBuffer(e))return Mg(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Ng=function(e,r){if(!Buffer.isBuffer(e))return Ig(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Jo=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Bg(e,r)},_f=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var bi=function(t,e){return t[e]},Ls=function(t,e){return t[e+1]*256+t[e]},i2=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},dr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ni=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},s2=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Qs(t,e){var r="",n,i,f=[],m,c,s,u;switch(e){case"dbcs":if(u=this.l,Xe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(s=0;s<t;++s)r+=String.fromCharCode(Ls(this,u)),u+=2;t*=2;break;case"utf8":r=Fa(this,this.l,this.l+t);break;case"utf16le":t*=2,r=yf(this,this.l,this.l+t);break;case"wstr":return Qs.call(this,t,"dbcs");case"lpstr-ansi":r=Pg(this,this.l),t=4+dr(this,this.l);break;case"lpstr-cp":r=Dg(this,this.l),t=4+dr(this,this.l);break;case"lpwstr":r=Rg(this,this.l),t=4+2*dr(this,this.l);break;case"lpp4":t=4+dr(this,this.l),r=Lg(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+dr(this,this.l),r=Ng(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(m=bi(this,this.l+t++))!==0;)f.push(eo(m));r=f.join("");break;case"_wstr":for(t=0,r="";(m=Ls(this,this.l+t))!==0;)f.push(eo(m)),t+=2;t+=2,r=f.join("");break;case"dbcs-cont":for(r="",u=this.l,s=0;s<t;++s){if(this.lens&&this.lens.indexOf(u)!==-1)return m=bi(this,u),this.l=u+1,c=Qs.call(this,t-s,m?"dbcs-cont":"sbcs-cont"),f.join("")+c;f.push(eo(Ls(this,u))),u+=2}r=f.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,s=0;s!=t;++s){if(this.lens&&this.lens.indexOf(u)!==-1)return m=bi(this,u),this.l=u+1,c=Qs.call(this,t-s,m?"dbcs-cont":"sbcs-cont"),f.join("")+c;f.push(eo(bi(this,u))),u+=1}r=f.join("");break;default:switch(t){case 1:return n=bi(this,this.l),this.l++,n;case 2:return n=(e==="i"?i2:Ls)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ni:s2)(this,this.l),this.l+=4,n):(i=dr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Jo(this,this.l):i=Jo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Ag(this,this.l,t);break}}return this.l+=t,r}var a2=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},o2=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},l2=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function c2(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)l2(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var f=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var m=e.charCodeAt(i);this[this.l++]=m&255,this[this.l++]=m>>8}for(;this.l<f;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,a2(this,e,this.l);break;case 8:if(n=8,r==="f"){n2(this,e,this.l);break}case 16:break;case-4:n=4,o2(this,e,this.l);break}return this.l+=n,this}function jg(t,e){var r=Ag(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function fr(t,e){t.l=e,t.read_shift=Qs,t.chk=jg,t.write_shift=c2}function Jr(t,e){t.l+=e}function fe(t){var e=vi(t);return fr(e,0),e}function sr(){var t=[],e=Xe?256:2048,r=function(u){var d=fe(u);return fr(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},f=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},m=function(){return i(),Dt(t)},c=function(u){i(),n=u,n.l==null&&(n.l=n.length),f(e)};return{next:f,push:c,end:m,_bufs:t}}function ge(t,e,r,n){var i=+e,f;if(!isNaN(i)){n||(n=rE[i].p||(r||[]).length||0),f=1+(i>=128?1:0)+1,n>=128&&++f,n>=16384&&++f,n>=2097152&&++f;var m=t.next(f);i<=127?m.write_shift(1,i):(m.write_shift(1,(i&127)+128),m.write_shift(1,i>>7));for(var c=0;c!=4;++c)if(n>=128)m.write_shift(1,(n&127)+128),n>>=7;else{m.write_shift(1,n);break}n>0&&_f(r)&&t.push(r)}}function qs(t,e,r){var n=or(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function x0(t,e,r){var n=or(t);return n.s=qs(n.s,e.s,r),n.e=qs(n.e,e.s,r),n}function Js(t,e){if(t.cRel&&t.c<0)for(t=or(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=or(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=$e(t);return!t.cRel&&t.cRel!=null&&(r=h2(r)),!t.rRel&&t.rRel!=null&&(r=u2(r)),r}function fc(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Xt(t.s.c)+":"+(t.e.cRel?"":"$")+Xt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mt(t.s.r)+":"+(t.e.rRel?"":"$")+Mt(t.e.r):Js(t.s,e.biff)+":"+Js(t.e,e.biff)}function wf(t){return parseInt(f2(t),10)-1}function Mt(t){return""+(t+1)}function u2(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function f2(t){return t.replace(/\$(\d+)$/,"$1")}function Sf(t){for(var e=d2(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Xt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function h2(t){return t.replace(/^([A-Z])/,"$$$1")}function d2(t){return t.replace(/^\$([A-Z])/,"$1")}function p2(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Et(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function $e(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function vr(t){var e=t.indexOf(":");return e==-1?{s:Et(t),e:Et(t)}:{s:Et(t.slice(0,e)),e:Et(t.slice(e+1))}}function vt(t,e){return typeof e>"u"||typeof e=="number"?vt(t.s,t.e):(typeof t!="string"&&(t=$e(t)),typeof e!="string"&&(e=$e(e)),t==e?t:t+":"+e)}function et(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,f=t.length;for(r=0;n<f&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<f&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===f||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=f&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=f&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function y0(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Hn(t.z,r?ar(e):e)}catch{}try{return t.w=Hn((t.XF||{}).numFmtId||(r?14:0),r?ar(e):e)}catch{return""+e}}function yn(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Da[t.v]||t.v:e==null?y0(t,t.v):y0(t,e))}function Si(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Ug(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,f=t||(i?[]:{}),m=0,c=0;if(f&&n.origin!=null){if(typeof n.origin=="number")m=n.origin;else{var s=typeof n.origin=="string"?Et(n.origin):n.origin;m=s.r,c=s.c}f["!ref"]||(f["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(f["!ref"]){var d=et(f["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),m==-1&&(u.e.r=m=d.e.r+1)}for(var l=0;l!=e.length;++l)if(e[l]){if(!Array.isArray(e[l]))throw new Error("aoa_to_sheet expects an array of arrays");for(var o=0;o!=e[l].length;++o)if(!(typeof e[l][o]>"u")){var a={v:e[l][o]},h=m+l,g=c+o;if(u.s.r>h&&(u.s.r=h),u.s.c>g&&(u.s.c=g),u.e.r<h&&(u.e.r=h),u.e.c<g&&(u.e.c=g),e[l][o]&&typeof e[l][o]=="object"&&!Array.isArray(e[l][o])&&!(e[l][o]instanceof Date))a=e[l][o];else if(Array.isArray(a.v)&&(a.f=e[l][o][1],a.v=a.v[0]),a.v===null)if(a.f)a.t="n";else if(n.nullError)a.t="e",a.v=0;else if(n.sheetStubs)a.t="z";else continue;else typeof a.v=="number"?a.t="n":typeof a.v=="boolean"?a.t="b":a.v instanceof Date?(a.z=n.dateNF||ht[14],n.cellDates?(a.t="d",a.w=Hn(a.z,ar(a.v))):(a.t="n",a.v=ar(a.v),a.w=Hn(a.z,a.v))):a.t="s";if(i)f[h]||(f[h]=[]),f[h][g]&&f[h][g].z&&(a.z=f[h][g].z),f[h][g]=a;else{var p=$e({c:g,r:h});f[p]&&f[p].z&&(a.z=f[p].z),f[p]=a}}}return u.s.c<1e7&&(f["!ref"]=vt(u)),f}function ps(t,e){return Ug(null,t,e)}function g2(t){return t.read_shift(4,"i")}function Ur(t,e){return e||(e=fe(4)),e.write_shift(4,t),e}function Ht(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ot(t,e){var r=!1;return e==null&&(r=!0,e=fe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function m2(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function v2(t,e){return e||(e=fe(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Cf(t,e){var r=t.l,n=t.read_shift(1),i=Ht(t),f=[],m={t:i,h:i};if(n&1){for(var c=t.read_shift(4),s=0;s!=c;++s)f.push(m2(t));m.r=f}else m.r=[{ich:0,ifnt:0}];return t.l=r+e,m}function x2(t,e){var r=!1;return e==null&&(r=!0,e=fe(15+4*t.t.length)),e.write_shift(1,0),Ot(t.t,e),r?e.slice(0,e.l):e}var y2=Cf;function _2(t,e){var r=!1;return e==null&&(r=!0,e=fe(23+4*t.t.length)),e.write_shift(1,1),Ot(t.t,e),e.write_shift(4,1),v2({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function kr(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ci(t,e){return e==null&&(e=fe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Ti(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ei(t,e){return e==null&&(e=fe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var w2=Ht,Wg=Ot;function Tf(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Zo(t,e){var r=!1;return e==null&&(r=!0,e=fe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var S2=Ht,pu=Tf,Ef=Zo;function zg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Jo([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ni(e,0)>>2;return r?i/100:i}function Xg(t,e){e==null&&(e=fe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Hg(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function C2(t,e){return e||(e=fe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Oi=Hg,gs=C2;function ms(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function xi(t,e){return(e||fe(8)).write_shift(8,t,"f")}function T2(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),f=t.read_shift(2,"i"),m=t.read_shift(1),c=t.read_shift(1),s=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=R2[i];u&&(e.rgb=F0(u));break;case 2:e.rgb=F0([m,c,s]);break;case 3:e.theme=i;break}return f!=0&&(e.tint=f>0?f/32767:f/32768),e}function el(t,e){if(e||(e=fe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function E2(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function O2(t,e){e||(e=fe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var Yg=2,cr=3,io=11,tl=19,so=64,A2=65,k2=71,P2=4108,F2=4126,Ft=80,_0={1:{n:"CodePage",t:Yg},2:{n:"Category",t:Ft},3:{n:"PresentationFormat",t:Ft},4:{n:"ByteCount",t:cr},5:{n:"LineCount",t:cr},6:{n:"ParagraphCount",t:cr},7:{n:"SlideCount",t:cr},8:{n:"NoteCount",t:cr},9:{n:"HiddenCount",t:cr},10:{n:"MultimediaClipCount",t:cr},11:{n:"ScaleCrop",t:io},12:{n:"HeadingPairs",t:P2},13:{n:"TitlesOfParts",t:F2},14:{n:"Manager",t:Ft},15:{n:"Company",t:Ft},16:{n:"LinksUpToDate",t:io},17:{n:"CharacterCount",t:cr},19:{n:"SharedDoc",t:io},22:{n:"HyperlinksChanged",t:io},23:{n:"AppVersion",t:cr,p:"version"},24:{n:"DigSig",t:A2},26:{n:"ContentType",t:Ft},27:{n:"ContentStatus",t:Ft},28:{n:"Language",t:Ft},29:{n:"Version",t:Ft},255:{},2147483648:{n:"Locale",t:tl},2147483651:{n:"Behavior",t:tl},1919054434:{}},w0={1:{n:"CodePage",t:Yg},2:{n:"Title",t:Ft},3:{n:"Subject",t:Ft},4:{n:"Author",t:Ft},5:{n:"Keywords",t:Ft},6:{n:"Comments",t:Ft},7:{n:"Template",t:Ft},8:{n:"LastAuthor",t:Ft},9:{n:"RevNumber",t:Ft},10:{n:"EditTime",t:so},11:{n:"LastPrinted",t:so},12:{n:"CreatedDate",t:so},13:{n:"ModifiedDate",t:so},14:{n:"PageCount",t:cr},15:{n:"WordCount",t:cr},16:{n:"CharCount",t:cr},17:{n:"Thumbnail",t:k2},18:{n:"Application",t:Ft},19:{n:"DocSecurity",t:cr},255:{},2147483648:{n:"Locale",t:tl},2147483651:{n:"Behavior",t:tl},1919054434:{}};function D2(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var b2=D2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),R2=or(b2),Da={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},M2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ao={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Gg(t,e){var r=Hy(M2),n=[],i;n[n.length]=xt,n[n.length]=we("Types",null,{xmlns:Tt.CT,"xmlns:xsd":Tt.xsd,"xmlns:xsi":Tt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(s){return we("Default",null,{Extension:s[0],ContentType:s[1]})}));var f=function(s){t[s]&&t[s].length>0&&(i=t[s][0],n[n.length]=we("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ao[s][e.bookType]||ao[s].xlsx}))},m=function(s){(t[s]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:ao[s][e.bookType]||ao[s].xlsx})})},c=function(s){(t[s]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[s][0]})})};return f("workbooks"),m("sheets"),m("charts"),c("themes"),["strs","styles"].forEach(f),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),m("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $g(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Zi(t){var e=[xt,we("Relationships",null,{xmlns:Tt.RELS})];return It(t["!id"]).forEach(function(r){e[e.length]=we("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ye(t,e,r,n,i,f){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,f?i.TargetMode=f:[ze.HLINK,ze.XPATH,ze.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function L2(t){var e=[xt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function S0(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function I2(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function N2(t){var e=[xt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(S0(t[r][0],t[r][1])),e.push(I2("",t[r][0]));return e.push(S0("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Kg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Go.version+"</meta:generator></office:meta></office:document-meta>"}var ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function hc(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ve(e),n[n.length]=r?we(t,e,r):bt(t,e))}function Qg(t,e){var r=e||{},n=[xt,we("cp:coreProperties",null,{"xmlns:cp":Tt.CORE_PROPS,"xmlns:dc":Tt.dc,"xmlns:dcterms":Tt.dcterms,"xmlns:dcmitype":Tt.dcmitype,"xmlns:xsi":Tt.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&hc("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:du(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&hc("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:du(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var f=0;f!=ui.length;++f){var m=ui[f],c=r.Props&&r.Props[m[1]]!=null?r.Props[m[1]]:t?t[m[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&hc(m[0],c,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var es=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],qg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Jg(t){var e=[],r=we;return t||(t={}),t.Application="SheetJS",e[e.length]=xt,e[e.length]=we("Properties",null,{xmlns:Tt.EXT_PROPS,"xmlns:vt":Tt.vt}),es.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ve(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ve(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Zg(t){var e=[xt,we("Properties",null,{xmlns:Tt.CUST_PROPS,"xmlns:vt":Tt.vt})];if(!t)return e.join("");var r=1;return It(t).forEach(function(i){++r,e[e.length]=we("property",t2(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ve(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var C0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function B2(t,e){var r=[];return It(C0).map(function(n){for(var i=0;i<ui.length;++i)if(ui[i][1]==n)return ui[i];for(i=0;i<es.length;++i)if(es[i][1]==n)return es[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(bt(C0[n[1]]||n[1],i))}}),we("DocumentProperties",r.join(""),{xmlns:hr.o})}function j2(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&It(t).forEach(function(f){if(Object.prototype.hasOwnProperty.call(t,f)){for(var m=0;m<ui.length;++m)if(f==ui[m][1])return;for(m=0;m<es.length;++m)if(f==es[m][1])return;for(m=0;m<r.length;++m)if(f==r[m])return;var c=t[f],s="string";typeof c=="number"?(s="float",c=String(c)):c===!0||c===!1?(s="boolean",c=c?"1":"0"):c=String(c),i.push(we(u0(f),c,{"dt:dt":s}))}}),e&&It(e).forEach(function(f){if(Object.prototype.hasOwnProperty.call(e,f)&&!(t&&Object.prototype.hasOwnProperty.call(t,f))){var m=e[f],c="string";typeof m=="number"?(c="float",m=String(m)):m===!0||m===!1?(c="boolean",m=m?"1":"0"):m instanceof Date?(c="dateTime.tz",m=m.toISOString()):m=String(m),i.push(we(u0(f),m,{"dt:dt":c}))}}),"<"+n+' xmlns="'+hr.o+'">'+i.join("")+"</"+n+">"}function U2(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var f=n/Math.pow(2,32)|0;f>0&&(n=n%Math.pow(2,32),i+=f);var m=fe(8);return m.write_shift(4,n),m.write_shift(4,i),m}function T0(t,e){var r=fe(4),n=fe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=fe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=U2(e);break;case 31:case 80:for(n=fe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Dt([r,n])}var e1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function W2(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function E0(t,e,r){var n=fe(8),i=[],f=[],m=8,c=0,s=fe(8),u=fe(8);if(s.write_shift(4,2),s.write_shift(4,1200),u.write_shift(4,1),f.push(s),i.push(u),m+=8+s.length,!e){u=fe(8),u.write_shift(4,0),i.unshift(u);var d=[fe(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var l=t[c][0];for(s=fe(8+2*(l.length+1)+(l.length%2?0:2)),s.write_shift(4,c+2),s.write_shift(4,l.length+1),s.write_shift(0,l,"dbcs");s.l!=s.length;)s.write_shift(1,0);d.push(s)}s=Dt(d),f.unshift(s),m+=8+s.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(e1.indexOf(t[c][0])>-1||qg.indexOf(t[c][0])>-1)&&t[c][1]!=null){var o=t[c][1],a=0;if(e){a=+e[t[c][0]];var h=r[a];if(h.p=="version"&&typeof o=="string"){var g=o.split(".");o=(+g[0]<<16)+(+g[1]||0)}s=T0(h.t,o)}else{var p=W2(o);p==-1&&(p=31,o=String(o)),s=T0(p,o)}f.push(s),u=fe(8),u.write_shift(4,e?a:2+c),i.push(u),m+=8+s.length}var v=8*(f.length+1);for(c=0;c<f.length;++c)i[c].write_shift(4,v),v+=f[c].length;return n.write_shift(4,m),n.write_shift(4,f.length),Dt([n].concat(i).concat(f))}function O0(t,e,r,n,i,f){var m=fe(i?68:48),c=[m];m.write_shift(2,65534),m.write_shift(2,0),m.write_shift(4,842412599),m.write_shift(16,Qe.utils.consts.HEADER_CLSID,"hex"),m.write_shift(4,i?2:1),m.write_shift(16,e,"hex"),m.write_shift(4,i?68:48);var s=E0(t,r,n);if(c.push(s),i){var u=E0(i,null,null);m.write_shift(16,f,"hex"),m.write_shift(4,68+s.length),c.push(u)}return Dt(c)}function z2(t,e){e||(e=fe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function X2(t,e){return t.read_shift(e)===1}function $t(t,e){return e||(e=fe(2)),e.write_shift(2,+!!t),e}function t1(t){return t.read_shift(2,"u")}function wr(t,e){return e||(e=fe(2)),e.write_shift(2,t),e}function r1(t,e,r){return r||(r=fe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function n1(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var f=t.read_shift(1);f&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var m=n?t.read_shift(n,i):"";return m}function H2(t){var e=t.t||"",r=fe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=fe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Dt(i)}function Y2(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function V2(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Y2(t,n,r)}function G2(t,e,r){if(r.biff>5)return V2(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function i1(t,e,r){return r||(r=fe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function A0(t,e){e||(e=fe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function $2(t){var e=fe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),f=i>-1?31:23;switch(n.charAt(0)){case"#":f=28;break;case".":f&=-3;break}e.write_shift(4,2),e.write_shift(4,f);var m=[8,6815827,6619237,4849780,83];for(r=0;r<m.length;++r)e.write_shift(4,m[r]);if(f==28)n=n.slice(1),A0(n,e);else if(f&2){for(m="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<m.length;++r)e.write_shift(1,parseInt(m[r],16));var c=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),f&8&&A0(i>-1?n.slice(i+1):"",e)}else{for(m="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<m.length;++r)e.write_shift(1,parseInt(m[r],16));for(var s=0;n.slice(s*3,s*3+3)=="../"||n.slice(s*3,s*3+3)=="..\\";)++s;for(e.write_shift(2,s),e.write_shift(4,n.length-3*s+1),r=0;r<n.length-3*s;++r)e.write_shift(1,n.charCodeAt(r+3*s)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function yi(t,e,r,n){return n||(n=fe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function K2(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),f=t.read_shift(n,"i"),m=t.read_shift(n,"i");return[i,f,m]}function Q2(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function s1(t,e){return e||(e=fe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Of(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var f=fe(i);return f.write_shift(2,n),f.write_shift(2,e),i>4&&f.write_shift(2,29282),i>6&&f.write_shift(2,1997),i>8&&(f.write_shift(2,49161),f.write_shift(2,1),f.write_shift(2,1798),f.write_shift(2,0)),f}function q2(t,e){var r=!e||e.biff==8,n=fe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function J2(t,e){var r=!e||e.biff>=8?2:1,n=fe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Z2(t,e){var r=fe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=H2(t[i]);var f=Dt([r].concat(n));return f.parts=[r.length].concat(n.map(function(m){return m.length})),f}function e_(){var t=fe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function t_(t){var e=fe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function r_(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,f=fe(i);return f.write_shift(2,(t.sz||12)*20),f.write_shift(4,0),f.write_shift(2,400),f.write_shift(4,0),f.write_shift(2,0),f.write_shift(1,r.length),n||f.write_shift(1,1),f.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),f}function n_(t,e,r,n){var i=fe(10);return yi(t,e,n,i),i.write_shift(4,r),i}function i_(t,e,r,n,i){var f=!i||i.biff==8,m=fe(8+ +f+(1+f)*r.length);return yi(t,e,n,m),m.write_shift(2,r.length),f&&m.write_shift(1,1),m.write_shift((1+f)*r.length,r,f?"utf16le":"sbcs"),m}function s_(t,e,r,n){var i=r&&r.biff==5;n||(n=fe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var f=n.length>n.l?n.slice(0,n.l):n;return f.l==null&&(f.l=f.length),f}function a_(t,e){var r=e.biff==8||!e.biff?4:2,n=fe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function k0(t,e,r,n){var i=r&&r.biff==5;n||(n=fe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var f=0;return t.numFmtId>0&&i&&(f|=1024),n.write_shift(4,f),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function o_(t){var e=fe(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function l_(t,e,r,n,i,f){var m=fe(8);return yi(t,e,n,m),r1(r,f,m),m}function c_(t,e,r,n){var i=fe(14);return yi(t,e,n,i),xi(r,i),i}function u_(t,e,r){if(r.biff<8)return f_(t,e,r);for(var n=[],i=t.l+e,f=t.read_shift(r.biff>8?4:2);f--!==0;)n.push(K2(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function f_(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=n1(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function h_(t){var e=fe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)s1(t[r],e);return e}function d_(t){var e=fe(24),r=Et(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Dt([e,$2(t[1])])}function p_(t){var e=t[1].Tooltip,r=fe(10+2*(e.length+1));r.write_shift(2,2048);var n=Et(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function g_(t){return t||(t=fe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function m_(t,e,r){if(!r.cellStyles)return Jr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),f=t.read_shift(n),m=t.read_shift(n),c=t.read_shift(n),s=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:f,w:m,ixfe:c,flags:s};return(r.biff>=5||!r.biff)&&(u.level=s>>8&7),u}function v_(t,e){var r=fe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function x_(t){for(var e=fe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function y_(t,e,r){var n=fe(15);return Ra(n,t,e),n.write_shift(8,r,"f"),n}function __(t,e,r){var n=fe(9);return Ra(n,t,e),n.write_shift(2,r),n}var w_=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=gf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,s){var u=[],d=vi(1);switch(s.type){case"base64":d=Lr(xn(c));break;case"binary":d=Lr(c);break;case"buffer":case"array":d=c;break}fr(d,0);var l=d.read_shift(1),o=!!(l&136),a=!1,h=!1;switch(l){case 2:break;case 3:break;case 48:a=!0,o=!0;break;case 49:a=!0,o=!0;break;case 131:break;case 139:break;case 140:h=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+l.toString(16))}var g=0,p=521;l==2&&(g=d.read_shift(2)),d.l+=3,l!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),l!=2&&(p=d.read_shift(2));var v=d.read_shift(2),x=s.codepage||1252;l!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(x=t[d[d.l]]),d.l+=1,d.l+=2),h&&(d.l+=36);for(var y=[],_={},w=Math.min(d.length,l==2?521:p-10-(a?264:0)),C=h?32:11;d.l<w&&d[d.l]!=13;)switch(_={},_.name=ri.utils.decode(x,d.slice(d.l,d.l+C)).replace(/[\u0000\r\n].*$/g,""),d.l+=C,_.type=String.fromCharCode(d.read_shift(1)),l!=2&&!h&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),l==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&y.push(_),l!=2&&(d.l+=h?13:14),_.type){case"B":(!a||_.len!=8)&&s.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":s.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=p-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=p;var S=0,O=0;for(u[0]=[],O=0;O!=y.length;++O)u[0][O]=y[O].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++S]=[],O=0,O=0;O!=y.length;++O){var F=d.slice(d.l,d.l+y[O].len);d.l+=y[O].len,fr(F,0);var N=ri.utils.decode(x,F);switch(y[O].type){case"C":N.trim().length&&(u[S][O]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[S][O]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[S][O]=N;break;case"F":u[S][O]=parseFloat(N.trim());break;case"+":case"I":u[S][O]=h?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[S][O]=!0;break;case"N":case"F":u[S][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+l.toString(16));u[S][O]="##MEMO##"+(h?parseInt(N.trim(),10):F.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[S][O]=+N||0);break;case"@":u[S][O]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[S][O]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[S][O]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][O]=-F.read_shift(-8,"f");break;case"B":if(a&&y[O].len==8){u[S][O]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[O].len;break;case"0":if(y[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[O].type)}}}if(l!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),s.DBF=y,u}function n(c,s){var u=s||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ps(r(c,u),u);return d["!cols"]=u.DBF.map(function(l){return{wch:l.len,DBF:l}}),delete u.DBF,d}function i(c,s){try{return Si(n(c,s),s)}catch(u){if(s&&s.WTF)throw u}return{SheetNames:[],Sheets:{}}}var f={B:8,C:250,L:1,D:8,"?":0,"":0};function m(c,s){var u=s||{};if(+u.codepage>=0&&va(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=sr(),l=al(c,{header:1,raw:!0,cellDates:!0}),o=l[0],a=l.slice(1),h=c["!cols"]||[],g=0,p=0,v=0,x=1;for(g=0;g<o.length;++g){if(((h[g]||{}).DBF||{}).name){o[g]=h[g].DBF.name,++v;continue}if(o[g]!=null){if(++v,typeof o[g]=="number"&&(o[g]=o[g].toString(10)),typeof o[g]!="string")throw new Error("DBF Invalid column name "+o[g]+" |"+typeof o[g]+"|");if(o.indexOf(o[g])!==g){for(p=0;p<1024;++p)if(o.indexOf(o[g]+"_"+p)==-1){o[g]+="_"+p;break}}}}var y=et(c["!ref"]),_=[],w=[],C=[];for(g=0;g<=y.e.c-y.s.c;++g){var S="",O="",F=0,N=[];for(p=0;p<a.length;++p)a[p][g]!=null&&N.push(a[p][g]);if(N.length==0||o[g]==null){_[g]="?";continue}for(p=0;p<N.length;++p){switch(typeof N[p]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=N[p]instanceof Date?"D":"C";break;default:O="C"}F=Math.max(F,String(N[p]).length),S=S&&S!=O?"C":O}F>250&&(F=250),O=((h[g]||{}).DBF||{}).type,O=="C"&&h[g].DBF.len>F&&(F=h[g].DBF.len),S=="B"&&O=="N"&&(S="N",C[g]=h[g].DBF.dec,F=h[g].DBF.len),w[g]=S=="C"||O=="N"?F:f[S]||0,x+=w[g],_[g]=S}var W=d.next(32);for(W.write_shift(4,318902576),W.write_shift(4,a.length),W.write_shift(2,296+32*v),W.write_shift(2,x),g=0;g<4;++g)W.write_shift(4,0);for(W.write_shift(4,0|(+e[og]||3)<<8),g=0,p=0;g<o.length;++g)if(o[g]!=null){var X=d.next(32),Q=(o[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,Q,"sbcs"),X.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),X.write_shift(4,p),X.write_shift(1,w[g]||f[_[g]]||0),X.write_shift(1,C[g]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),p+=w[g]||f[_[g]]||0}var ae=d.next(264);for(ae.write_shift(4,13),g=0;g<65;++g)ae.write_shift(4,0);for(g=0;g<a.length;++g){var ne=d.next(x);for(ne.write_shift(1,0),p=0;p<o.length;++p)if(o[p]!=null)switch(_[p]){case"L":ne.write_shift(1,a[g][p]==null?63:a[g][p]?84:70);break;case"B":ne.write_shift(8,a[g][p]||0,"f");break;case"N":var J="0";for(typeof a[g][p]=="number"&&(J=a[g][p].toFixed(C[p]||0)),v=0;v<w[p]-J.length;++v)ne.write_shift(1,32);ne.write_shift(1,J,"sbcs");break;case"D":a[g][p]?(ne.write_shift(4,("0000"+a[g][p].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(a[g][p].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+a[g][p].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(a[g][p]!=null?a[g][p]:"").slice(0,w[p]);for(ne.write_shift(1,oe,"sbcs"),v=0;v<w[p]-oe.length;++v)ne.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:m}}(),S_=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+It(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(o,a){var h=t[a];return typeof h=="number"?Jh(h):h},n=function(o,a,h){var g=a.charCodeAt(0)-32<<4|h.charCodeAt(0)-48;return g==59?o:Jh(g)};t["|"]=254;function i(o,a){switch(a.type){case"base64":return f(xn(o),a);case"binary":return f(o,a);case"buffer":return f(Xe&&Buffer.isBuffer(o)?o.toString("binary"):ka(o),a);case"array":return f(Al(o),a)}throw new Error("Unrecognized type "+a.type)}function f(o,a){var h=o.split(/[\n\r]+/),g=-1,p=-1,v=0,x=0,y=[],_=[],w=null,C={},S=[],O=[],F=[],N=0,W;for(+a.codepage>=0&&va(+a.codepage);v!==h.length;++v){N=0;var X=h[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Q=X.replace(/;;/g,"\0").split(";").map(function(T){return T.replace(/\u0000/g,";")}),ae=Q[0],ne;if(X.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&_.push(X.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,oe=!1,q=!1,k=!1,D=-1,L=-1;for(x=1;x<Q.length;++x)switch(Q[x].charAt(0)){case"A":break;case"X":p=parseInt(Q[x].slice(1))-1,oe=!0;break;case"Y":for(g=parseInt(Q[x].slice(1))-1,oe||(p=0),W=y.length;W<=g;++W)y[W]=[];break;case"K":ne=Q[x].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(hn(ne))?isNaN(ya(ne).getDate())||(ne=Qt(ne)):(ne=hn(ne),w!==null&&yg(w)&&(ne=Cg(ne))),J=!0;break;case"E":k=!0;var E=_w(Q[x].slice(1),{r:g,c:p});y[g][p]=[y[g][p],E];break;case"S":q=!0,y[g][p]=[y[g][p],"S5S"];break;case"G":break;case"R":D=parseInt(Q[x].slice(1))-1;break;case"C":L=parseInt(Q[x].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+X)}if(J&&(y[g][p]&&y[g][p].length==2?y[g][p][0]=ne:y[g][p]=ne,w=null),q){if(k)throw new Error("SYLK shared formula cannot have own formula");var b=D>-1&&y[D][L];if(!b||!b[1])throw new Error("SYLK shared formula cannot find base");y[g][p][1]=ww(b[1],{r:g-D,c:p-L})}break;case"F":var A=0;for(x=1;x<Q.length;++x)switch(Q[x].charAt(0)){case"X":p=parseInt(Q[x].slice(1))-1,++A;break;case"Y":for(g=parseInt(Q[x].slice(1))-1,W=y.length;W<=g;++W)y[W]=[];break;case"M":N=parseInt(Q[x].slice(1))/20;break;case"F":break;case"G":break;case"P":w=_[parseInt(Q[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=Q[x].slice(1).split(" "),W=parseInt(F[0],10);W<=parseInt(F[1],10);++W)N=parseInt(F[2],10),O[W-1]=N===0?{hidden:!0}:{wch:N},Af(O[W-1]);break;case"C":p=parseInt(Q[x].slice(1))-1,O[p]||(O[p]={});break;case"R":g=parseInt(Q[x].slice(1))-1,S[g]||(S[g]={}),N>0?(S[g].hpt=N,S[g].hpx=u1(N)):N===0&&(S[g].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+X)}A<1&&(w=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+X)}}return S.length>0&&(C["!rows"]=S),O.length>0&&(C["!cols"]=O),a&&a.sheetRows&&(y=y.slice(0,a.sheetRows)),[y,C]}function m(o,a){var h=i(o,a),g=h[0],p=h[1],v=ps(g,a);return It(p).forEach(function(x){v[x]=p[x]}),v}function c(o,a){return Si(m(o,a),a)}function s(o,a,h,g){var p="C;Y"+(h+1)+";X"+(g+1)+";K";switch(o.t){case"n":p+=o.v||0,o.f&&!o.F&&(p+=";E"+Pf(o.f,{r:h,c:g}));break;case"b":p+=o.v?"TRUE":"FALSE";break;case"e":p+=o.w||o.v;break;case"d":p+='"'+(o.w||o.v)+'"';break;case"s":p+='"'+o.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return p}function u(o,a){a.forEach(function(h,g){var p="F;W"+(g+1)+" "+(g+1)+" ";h.hidden?p+="0":(typeof h.width=="number"&&!h.wpx&&(h.wpx=rl(h.width)),typeof h.wpx=="number"&&!h.wch&&(h.wch=nl(h.wpx)),typeof h.wch=="number"&&(p+=Math.round(h.wch))),p.charAt(p.length-1)!=" "&&o.push(p)})}function d(o,a){a.forEach(function(h,g){var p="F;";h.hidden?p+="M0;":h.hpt?p+="M"+20*h.hpt+";":h.hpx&&(p+="M"+20*il(h.hpx)+";"),p.length>2&&o.push(p+"R"+(g+1))})}function l(o,a){var h=["ID;PWXL;N;E"],g=[],p=et(o["!ref"]),v,x=Array.isArray(o),y=`\r
`;h.push("P;PGeneral"),h.push("F;P0;DG0G8;M255"),o["!cols"]&&u(h,o["!cols"]),o["!rows"]&&d(h,o["!rows"]),h.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var _=p.s.r;_<=p.e.r;++_)for(var w=p.s.c;w<=p.e.c;++w){var C=$e({r:_,c:w});v=x?(o[_]||[])[w]:o[C],!(!v||v.v==null&&(!v.f||v.F))&&g.push(s(v,o,_,w))}return h.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:c,to_sheet:m,from_sheet:l}}(),C_=function(){function t(f,m){switch(m.type){case"base64":return e(xn(f),m);case"binary":return e(f,m);case"buffer":return e(Xe&&Buffer.isBuffer(f)?f.toString("binary"):ka(f),m);case"array":return e(Al(f),m)}throw new Error("Unrecognized type "+m.type)}function e(f,m){for(var c=f.split(`
`),s=-1,u=-1,d=0,l=[];d!==c.length;++d){if(c[d].trim()==="BOT"){l[++s]=[],u=0;continue}if(!(s<0)){var o=c[d].trim().split(","),a=o[0],h=o[1];++d;for(var g=c[d]||"";(g.match(/["]/g)||[]).length&1&&d<c.length-1;)g+=`
`+c[++d];switch(g=g.trim(),+a){case-1:if(g==="BOT"){l[++s]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?l[s][u]=!0:g==="FALSE"?l[s][u]=!1:isNaN(hn(h))?isNaN(ya(h).getDate())?l[s][u]=h:l[s][u]=Qt(h):l[s][u]=hn(h),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),l[s][u++]=g!==""?g:null;break}if(g==="EOD")break}}return m&&m.sheetRows&&(l=l.slice(0,m.sheetRows)),l}function r(f,m){return ps(t(f,m),m)}function n(f,m){return Si(r(f,m),m)}var i=function(){var f=function(s,u,d,l,o){s.push(u),s.push(d+","+l),s.push('"'+o.replace(/"/g,'""')+'"')},m=function(s,u,d,l){s.push(u+","+d),s.push(u==1?'"'+l.replace(/"/g,'""')+'"':l)};return function(s){var u=[],d=et(s["!ref"]),l,o=Array.isArray(s);f(u,"TABLE",0,1,"sheetjs"),f(u,"VECTORS",0,d.e.r-d.s.r+1,""),f(u,"TUPLES",0,d.e.c-d.s.c+1,""),f(u,"DATA",0,0,"");for(var a=d.s.r;a<=d.e.r;++a){m(u,-1,0,"BOT");for(var h=d.s.c;h<=d.e.c;++h){var g=$e({r:a,c:h});if(l=o?(s[a]||[])[h]:s[g],!l){m(u,1,0,"");continue}switch(l.t){case"n":var p=l.w;!p&&l.v!=null&&(p=l.v),p==null?l.f&&!l.F?m(u,1,0,"="+l.f):m(u,1,0,""):m(u,0,p,"V");break;case"b":m(u,0,l.v?1:0,l.v?"TRUE":"FALSE");break;case"s":m(u,1,0,isNaN(l.v)?l.v:'="'+l.v+'"');break;case"d":l.w||(l.w=Hn(l.z||ht[14],ar(Qt(l.v)))),m(u,0,l.w,"V");break;default:m(u,1,0,"")}}}m(u,-1,0,"EOD");var v=`\r
`,x=u.join(v);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),a1=function(){function t(l){return l.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(l){return l.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(l,o){for(var a=l.split(`
`),h=-1,g=-1,p=0,v=[];p!==a.length;++p){var x=a[p].trim().split(":");if(x[0]==="cell"){var y=Et(x[1]);if(v.length<=y.r)for(h=v.length;h<=y.r;++h)v[h]||(v[h]=[]);switch(h=y.r,g=y.c,x[2]){case"t":v[h][g]=t(x[3]);break;case"v":v[h][g]=+x[3];break;case"vtf":var _=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[h][g]=!!+x[4];break;default:v[h][g]=+x[4];break}x[2]=="vtf"&&(v[h][g]=[v[h][g],_])}}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function n(l,o){return ps(r(l,o),o)}function i(l,o){return Si(n(l,o),o)}var f=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),m=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),s="--SocialCalcSpreadsheetControlSave--";function u(l){if(!l||!l["!ref"])return"";for(var o=[],a=[],h,g="",p=vr(l["!ref"]),v=Array.isArray(l),x=p.s.r;x<=p.e.r;++x)for(var y=p.s.c;y<=p.e.c;++y)if(g=$e({r:x,c:y}),h=v?(l[x]||[])[y]:l[g],!(!h||h.v==null||h.t==="z")){switch(a=["cell",g,"t"],h.t){case"s":case"str":a.push(e(h.v));break;case"n":h.f?(a[2]="vtf",a[3]="n",a[4]=h.v,a[5]=e(h.f)):(a[2]="v",a[3]=h.v);break;case"b":a[2]="vt"+(h.f?"f":"c"),a[3]="nl",a[4]=h.v?"1":"0",a[5]=e(h.f||(h.v?"TRUE":"FALSE"));break;case"d":var _=ar(Qt(h.v));a[2]="vtc",a[3]="nd",a[4]=""+_,a[5]=h.w||Hn(h.z||ht[14],_);break;case"e":continue}o.push(a.join(":"))}return o.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),o.push("valueformat:1:text-wiki"),o.join(`
`)}function d(l){return[f,m,c,m,u(l),s].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),T_=function(){function t(d,l,o,a,h){h.raw?l[o][a]=d:d===""||(d==="TRUE"?l[o][a]=!0:d==="FALSE"?l[o][a]=!1:isNaN(hn(d))?isNaN(ya(d).getDate())?l[o][a]=d:l[o][a]=Qt(d):l[o][a]=hn(d))}function e(d,l){var o=l||{},a=[];if(!d||d.length===0)return a;for(var h=d.split(/[\r\n]/),g=h.length-1;g>=0&&h[g].length===0;)--g;for(var p=10,v=0,x=0;x<=g;++x)v=h[x].indexOf(" "),v==-1?v=h[x].length:v++,p=Math.max(p,v);for(x=0;x<=g;++x){a[x]=[];var y=0;for(t(h[x].slice(0,p).trim(),a,x,y,o),y=1;y<=(h[x].length-p)/10+1;++y)t(h[x].slice(p+(y-1)*10,p+y*10).trim(),a,x,y,o)}return o.sheetRows&&(a=a.slice(0,o.sheetRows)),a}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var l={},o=!1,a=0,h=0;a<d.length;++a)(h=d.charCodeAt(a))==34?o=!o:!o&&h in r&&(l[h]=(l[h]||0)+1);h=[];for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&h.push([l[a],a]);if(!h.length){l=n;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&h.push([l[a],a])}return h.sort(function(g,p){return g[0]-p[0]||n[g[1]]-n[p[1]]}),r[h.pop()[1]]||44}function f(d,l){var o=l||{},a="",h=o.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(a=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(a=d.charAt(4),d=d.slice(6)):a=i(d.slice(0,1024)):o&&o.FS?a=o.FS:a=i(d.slice(0,1024));var p=0,v=0,x=0,y=0,_=0,w=a.charCodeAt(0),C=!1,S=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=o.dateNF!=null?Uy(o.dateNF):null;function N(){var W=d.slice(y,_),X={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)X.t="z";else if(o.raw)X.t="s",X.v=W;else if(W.trim().length===0)X.t="s",X.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(X.t="s",X.v=W.slice(2,-1).replace(/""/g,'"')):Sw(W)?(X.t="n",X.f=W.slice(1)):(X.t="s",X.v=W);else if(W=="TRUE")X.t="b",X.v=!0;else if(W=="FALSE")X.t="b",X.v=!1;else if(!isNaN(x=hn(W)))X.t="n",o.cellText!==!1&&(X.w=W),X.v=x;else if(!isNaN(ya(W).getDate())||F&&W.match(F)){X.z=o.dateNF||ht[14];var Q=0;F&&W.match(F)&&(W=Wy(W,o.dateNF,W.match(F)||[]),Q=1),o.cellDates?(X.t="d",X.v=Qt(W,Q)):(X.t="n",X.v=ar(Qt(W,Q))),o.cellText!==!1&&(X.w=Hn(X.z,X.v instanceof Date?ar(X.v):X.v)),o.cellNF||delete X.z}else X.t="s",X.v=W;if(X.t=="z"||(o.dense?(h[p]||(h[p]=[]),h[p][v]=X):h[$e({c:v,r:p})]=X),y=_+1,O=d.charCodeAt(y),g.e.c<v&&(g.e.c=v),g.e.r<p&&(g.e.r=p),S==w)++v;else if(v=0,++p,o.sheetRows&&o.sheetRows<=p)return!0}e:for(;_<d.length;++_)switch(S=d.charCodeAt(_)){case 34:O===34&&(C=!C);break;case w:case 10:case 13:if(!C&&N())break e;break}return _-y>0&&N(),h["!ref"]=vt(g),h}function m(d,l){return!(l&&l.PRN)||l.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?f(d,l):ps(e(d,l),l)}function c(d,l){var o="",a=l.type=="string"?[0,0,0,0]:IE(d,l);switch(l.type){case"base64":o=xn(d);break;case"binary":o=d;break;case"buffer":l.codepage==65001?o=d.toString("utf8"):l.codepage&&typeof ri<"u"?o=ri.utils.decode(l.codepage,d):o=Xe&&Buffer.isBuffer(d)?d.toString("binary"):ka(d);break;case"array":o=Al(d);break;case"string":o=d;break;default:throw new Error("Unrecognized type "+l.type)}return a[0]==239&&a[1]==187&&a[2]==191?o=Ks(o.slice(3)):l.type!="string"&&l.type!="buffer"&&l.codepage==65001?o=Ks(o):l.type=="binary"&&typeof ri<"u"&&l.codepage&&(o=ri.utils.decode(l.codepage,ri.utils.encode(28591,o))),o.slice(0,19)=="socialcalc:version:"?a1.to_sheet(l.type=="string"?o:Ks(o),l):m(o,l)}function s(d,l){return Si(c(d,l),l)}function u(d){for(var l=[],o=et(d["!ref"]),a,h=Array.isArray(d),g=o.s.r;g<=o.e.r;++g){for(var p=[],v=o.s.c;v<=o.e.c;++v){var x=$e({r:g,c:v});if(a=h?(d[g]||[])[v]:d[x],!a||a.v==null){p.push("          ");continue}for(var y=(a.w||(yn(a),a.w)||"").slice(0,10);y.length<10;)y+=" ";p.push(y+(v===0?" ":""))}l.push(p.join(""))}return l.join(`
`)}return{to_workbook:s,to_sheet:c,from_sheet:u}}(),P0=function(){function t(E,b,A){if(E){fr(E,E.l||0);for(var T=A.Enum||D;E.l<E.length;){var R=E.read_shift(2),z=T[R]||T[65535],K=E.read_shift(2),H=E.l+K,G=z.f&&z.f(E,K,A);if(E.l=H,b(G,z,R))return}}}function e(E,b){switch(b.type){case"base64":return r(Lr(xn(E)),b);case"binary":return r(Lr(E),b);case"buffer":case"array":return r(E,b)}throw"Unsupported type "+b.type}function r(E,b){if(!E)return E;var A=b||{},T=A.dense?[]:{},R="Sheet1",z="",K=0,H={},G=[],ue=[],le={s:{r:0,c:0},e:{r:0,c:0}},ee=A.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)A.Enum=D,t(E,function(V,he,ve){switch(ve){case 0:A.vers=V,V>=4096&&(A.qpro=!0);break;case 6:le=V;break;case 204:V&&(z=V);break;case 222:z=V;break;case 15:case 51:A.qpro||(V[1].v=V[1].v.slice(1));case 13:case 14:case 16:ve==14&&(V[2]&112)==112&&(V[2]&15)>1&&(V[2]&15)<15&&(V[1].z=A.dateNF||ht[14],A.cellDates&&(V[1].t="d",V[1].v=Cg(V[1].v))),A.qpro&&V[3]>K&&(T["!ref"]=vt(le),H[R]=T,G.push(R),T=A.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},K=V[3],R=z||"Sheet"+(K+1),z="");var Re=A.dense?(T[V[0].r]||[])[V[0].c]:T[$e(V[0])];if(Re){Re.t=V[1].t,Re.v=V[1].v,V[1].z!=null&&(Re.z=V[1].z),V[1].f!=null&&(Re.f=V[1].f);break}A.dense?(T[V[0].r]||(T[V[0].r]=[]),T[V[0].r][V[0].c]=V[1]):T[$e(V[0])]=V[1];break}},A);else if(E[2]==26||E[2]==14)A.Enum=L,E[2]==14&&(A.qpro=!0,E.l=0),t(E,function(V,he,ve){switch(ve){case 204:R=V;break;case 22:V[1].v=V[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(V[3]>K&&(T["!ref"]=vt(le),H[R]=T,G.push(R),T=A.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},K=V[3],R="Sheet"+(K+1)),ee>0&&V[0].r>=ee)break;A.dense?(T[V[0].r]||(T[V[0].r]=[]),T[V[0].r][V[0].c]=V[1]):T[$e(V[0])]=V[1],le.e.c<V[0].c&&(le.e.c=V[0].c),le.e.r<V[0].r&&(le.e.r=V[0].r);break;case 27:V[14e3]&&(ue[V[14e3][0]]=V[14e3][1]);break;case 1537:ue[V[0]]=V[1],V[0]==K&&(R=V[1]);break}},A);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(T["!ref"]=vt(le),H[z||R]=T,G.push(z||R),!ue.length)return{SheetNames:G,Sheets:H};for(var Y={},ce=[],se=0;se<ue.length;++se)H[G[se]]?(ce.push(ue[se]||G[se]),Y[ue[se]]=H[ue[se]]||H[G[se]]):(ce.push(ue[se]),Y[ue[se]]={"!ref":"A1"});return{SheetNames:ce,Sheets:Y}}function n(E,b){var A=b||{};if(+A.codepage>=0&&va(+A.codepage),A.type=="string")throw new Error("Cannot write WK1 to JS string");var T=sr(),R=et(E["!ref"]),z=Array.isArray(E),K=[];Se(T,0,f(1030)),Se(T,6,s(R));for(var H=Math.min(R.e.r,8191),G=R.s.r;G<=H;++G)for(var ue=Mt(G),le=R.s.c;le<=R.e.c;++le){G===R.s.r&&(K[le]=Xt(le));var ee=K[le]+ue,Y=z?(E[G]||[])[le]:E[ee];if(!(!Y||Y.t=="z"))if(Y.t=="n")(Y.v|0)==Y.v&&Y.v>=-32768&&Y.v<=32767?Se(T,13,a(G,le,Y.v)):Se(T,14,g(G,le,Y.v));else{var ce=yn(Y);Se(T,15,l(G,le,ce.slice(0,239)))}}return Se(T,1),T.end()}function i(E,b){var A=b||{};if(+A.codepage>=0&&va(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var T=sr();Se(T,0,m(E));for(var R=0,z=0;R<E.SheetNames.length;++R)(E.Sheets[E.SheetNames[R]]||{})["!ref"]&&Se(T,27,k(E.SheetNames[R],z++));var K=0;for(R=0;R<E.SheetNames.length;++R){var H=E.Sheets[E.SheetNames[R]];if(!(!H||!H["!ref"])){for(var G=et(H["!ref"]),ue=Array.isArray(H),le=[],ee=Math.min(G.e.r,8191),Y=G.s.r;Y<=ee;++Y)for(var ce=Mt(Y),se=G.s.c;se<=G.e.c;++se){Y===G.s.r&&(le[se]=Xt(se));var V=le[se]+ce,he=ue?(H[Y]||[])[se]:H[V];if(!(!he||he.t=="z"))if(he.t=="n")Se(T,23,N(Y,se,K,he.v));else{var ve=yn(he);Se(T,22,S(Y,se,K,ve.slice(0,239)))}}++K}}return Se(T,1),T.end()}function f(E){var b=fe(2);return b.write_shift(2,E),b}function m(E){var b=fe(26);b.write_shift(2,4096),b.write_shift(2,4),b.write_shift(4,0);for(var A=0,T=0,R=0,z=0;z<E.SheetNames.length;++z){var K=E.SheetNames[z],H=E.Sheets[K];if(!(!H||!H["!ref"])){++R;var G=vr(H["!ref"]);A<G.e.r&&(A=G.e.r),T<G.e.c&&(T=G.e.c)}}return A>8191&&(A=8191),b.write_shift(2,A),b.write_shift(1,R),b.write_shift(1,T),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(1,1),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(4,0),b}function c(E,b,A){var T={s:{c:0,r:0},e:{c:0,r:0}};return b==8&&A.qpro?(T.s.c=E.read_shift(1),E.l++,T.s.r=E.read_shift(2),T.e.c=E.read_shift(1),E.l++,T.e.r=E.read_shift(2),T):(T.s.c=E.read_shift(2),T.s.r=E.read_shift(2),b==12&&A.qpro&&(E.l+=2),T.e.c=E.read_shift(2),T.e.r=E.read_shift(2),b==12&&A.qpro&&(E.l+=2),T.s.c==65535&&(T.s.c=T.e.c=T.s.r=T.e.r=0),T)}function s(E){var b=fe(8);return b.write_shift(2,E.s.c),b.write_shift(2,E.s.r),b.write_shift(2,E.e.c),b.write_shift(2,E.e.r),b}function u(E,b,A){var T=[{c:0,r:0},{t:"n",v:0},0,0];return A.qpro&&A.vers!=20768?(T[0].c=E.read_shift(1),T[3]=E.read_shift(1),T[0].r=E.read_shift(2),E.l+=2):(T[2]=E.read_shift(1),T[0].c=E.read_shift(2),T[0].r=E.read_shift(2)),T}function d(E,b,A){var T=E.l+b,R=u(E,b,A);if(R[1].t="s",A.vers==20768){E.l++;var z=E.read_shift(1);return R[1].v=E.read_shift(z,"utf8"),R}return A.qpro&&E.l++,R[1].v=E.read_shift(T-E.l,"cstr"),R}function l(E,b,A){var T=fe(7+A.length);T.write_shift(1,255),T.write_shift(2,b),T.write_shift(2,E),T.write_shift(1,39);for(var R=0;R<T.length;++R){var z=A.charCodeAt(R);T.write_shift(1,z>=128?95:z)}return T.write_shift(1,0),T}function o(E,b,A){var T=u(E,b,A);return T[1].v=E.read_shift(2,"i"),T}function a(E,b,A){var T=fe(7);return T.write_shift(1,255),T.write_shift(2,b),T.write_shift(2,E),T.write_shift(2,A,"i"),T}function h(E,b,A){var T=u(E,b,A);return T[1].v=E.read_shift(8,"f"),T}function g(E,b,A){var T=fe(13);return T.write_shift(1,255),T.write_shift(2,b),T.write_shift(2,E),T.write_shift(8,A,"f"),T}function p(E,b,A){var T=E.l+b,R=u(E,b,A);if(R[1].v=E.read_shift(8,"f"),A.qpro)E.l=T;else{var z=E.read_shift(2);_(E.slice(E.l,E.l+z),R),E.l+=z}return R}function v(E,b,A){var T=b&32768;return b&=-32769,b=(T?E:0)+(b>=8192?b-16384:b),(T?"":"$")+(A?Xt(b):Mt(b))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(E,b){fr(E,0);for(var A=[],T=0,R="",z="",K="",H="";E.l<E.length;){var G=E[E.l++];switch(G){case 0:A.push(E.read_shift(8,"f"));break;case 1:z=v(b[0].c,E.read_shift(2),!0),R=v(b[0].r,E.read_shift(2),!1),A.push(z+R);break;case 2:{var ue=v(b[0].c,E.read_shift(2),!0),le=v(b[0].r,E.read_shift(2),!1);z=v(b[0].c,E.read_shift(2),!0),R=v(b[0].r,E.read_shift(2),!1),A.push(ue+le+":"+z+R)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:A.push("("+A.pop()+")");break;case 5:A.push(E.read_shift(2));break;case 6:{for(var ee="";G=E[E.l++];)ee+=String.fromCharCode(G);A.push('"'+ee.replace(/"/g,'""')+'"')}break;case 8:A.push("-"+A.pop());break;case 23:A.push("+"+A.pop());break;case 22:A.push("NOT("+A.pop()+")");break;case 20:case 21:H=A.pop(),K=A.pop(),A.push(["AND","OR"][G-20]+"("+K+","+H+")");break;default:if(G<32&&y[G])H=A.pop(),K=A.pop(),A.push(K+y[G]+H);else if(x[G]){if(T=x[G][1],T==69&&(T=E[E.l++]),T>A.length){console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+A.join("|")+"|");return}var Y=A.slice(-T);A.length-=T,A.push(x[G][0]+"("+Y.join(",")+")")}else return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16))}}A.length==1?b[1].f=""+A[0]:console.error("WK1 bad formula parse |"+A.join("|")+"|")}function w(E){var b=[{c:0,r:0},{t:"n",v:0},0];return b[0].r=E.read_shift(2),b[3]=E[E.l++],b[0].c=E[E.l++],b}function C(E,b){var A=w(E);return A[1].t="s",A[1].v=E.read_shift(b-4,"cstr"),A}function S(E,b,A,T){var R=fe(6+T.length);R.write_shift(2,E),R.write_shift(1,A),R.write_shift(1,b),R.write_shift(1,39);for(var z=0;z<T.length;++z){var K=T.charCodeAt(z);R.write_shift(1,K>=128?95:K)}return R.write_shift(1,0),R}function O(E,b){var A=w(E);A[1].v=E.read_shift(2);var T=A[1].v>>1;if(A[1].v&1)switch(T&7){case 0:T=(T>>3)*5e3;break;case 1:T=(T>>3)*500;break;case 2:T=(T>>3)/20;break;case 3:T=(T>>3)/200;break;case 4:T=(T>>3)/2e3;break;case 5:T=(T>>3)/2e4;break;case 6:T=(T>>3)/16;break;case 7:T=(T>>3)/64;break}return A[1].v=T,A}function F(E,b){var A=w(E),T=E.read_shift(4),R=E.read_shift(4),z=E.read_shift(2);if(z==65535)return T===0&&R===3221225472?(A[1].t="e",A[1].v=15):T===0&&R===3489660928?(A[1].t="e",A[1].v=42):A[1].v=0,A;var K=z&32768;return z=(z&32767)-16446,A[1].v=(1-K*2)*(R*Math.pow(2,z+32)+T*Math.pow(2,z)),A}function N(E,b,A,T){var R=fe(14);if(R.write_shift(2,E),R.write_shift(1,A),R.write_shift(1,b),T==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var z=0,K=0,H=0,G=0;return T<0&&(z=1,T=-T),K=Math.log2(T)|0,T/=Math.pow(2,K-31),G=T>>>0,G&2147483648||(T/=2,++K,G=T>>>0),T-=G,G|=2147483648,G>>>=0,T*=Math.pow(2,32),H=T>>>0,R.write_shift(4,H),R.write_shift(4,G),K+=16383+(z?32768:0),R.write_shift(2,K),R}function W(E,b){var A=F(E);return E.l+=b-14,A}function X(E,b){var A=w(E),T=E.read_shift(4);return A[1].v=T>>6,A}function Q(E,b){var A=w(E),T=E.read_shift(8,"f");return A[1].v=T,A}function ae(E,b){var A=Q(E);return E.l+=b-10,A}function ne(E,b){return E[E.l+b-1]==0?E.read_shift(b,"cstr"):""}function J(E,b){var A=E[E.l++];A>b-1&&(A=b-1);for(var T="";T.length<A;)T+=String.fromCharCode(E[E.l++]);return T}function oe(E,b,A){if(!(!A.qpro||b<21)){var T=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var R=E.read_shift(b-21,"cstr");return[T,R]}}function q(E,b){for(var A={},T=E.l+b;E.l<T;){var R=E.read_shift(2);if(R==14e3){for(A[R]=[0,""],A[R][0]=E.read_shift(2);E[E.l];)A[R][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return A}function k(E,b){var A=fe(5+E.length);A.write_shift(2,14e3),A.write_shift(2,b);for(var T=0;T<E.length;++T){var R=E.charCodeAt(T);A[A.l++]=R>127?95:R}return A[A.l++]=0,A}var D={0:{n:"BOF",f:t1},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:o},14:{n:"NUMBER",f:h},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:p},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},L={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:C},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),E_=/^\s|\s$|[\t\n\r]/;function o1(t,e){if(!e.bookSST)return"";var r=[xt];r[r.length]=we("sst",null,{xmlns:ds[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],f="<si>";i.r?f+=i.r:(f+="<t",i.t||(i.t=""),i.t.match(E_)&&(f+=' xml:space="preserve"'),f+=">"+Ve(i.t)+"</t>"),f+="</si>",r[r.length]=f}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function O_(t){return[t.read_shift(4),t.read_shift(4)]}function A_(t,e){return e||(e=fe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var k_=x2;function P_(t){var e=sr();ge(e,159,A_(t));for(var r=0;r<t.length;++r)ge(e,19,k_(t[r]));return ge(e,160),e.end()}function F_(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function l1(t){var e=0,r,n=F_(t),i=n.length+1,f,m,c,s,u;for(r=vi(i),r[0]=n.length,f=1;f!=i;++f)r[f]=n[f-1];for(f=i-1;f>=0;--f)m=r[f],c=e&16384?1:0,s=e<<1&32767,u=c|s,e=u^m;return e^52811}var D_=function(){function t(i,f){switch(f.type){case"base64":return e(xn(i),f);case"binary":return e(i,f);case"buffer":return e(Xe&&Buffer.isBuffer(i)?i.toString("binary"):ka(i),f);case"array":return e(Al(i),f)}throw new Error("Unrecognized type "+f.type)}function e(i,f){var m=f||{},c=m.dense?[]:{},s=i.match(/\\trowd.*?\\row\b/g);if(!s.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:s.length-1}};return s.forEach(function(d,l){Array.isArray(c)&&(c[l]=[]);for(var o=/\\\w+\b/g,a=0,h,g=-1;h=o.exec(d);){switch(h[0]){case"\\cell":var p=d.slice(a,o.lastIndex-h[0].length);if(p[0]==" "&&(p=p.slice(1)),++g,p.length){var v={v:p,t:"s"};Array.isArray(c)?c[l][g]=v:c[$e({r:l,c:g})]=v}break}a=o.lastIndex}g>u.e.c&&(u.e.c=g)}),c["!ref"]=vt(u),c}function r(i,f){return Si(t(i,f),f)}function n(i){for(var f=["{\\rtf1\\ansi"],m=et(i["!ref"]),c,s=Array.isArray(i),u=m.s.r;u<=m.e.r;++u){f.push("\\trowd\\trautofit1");for(var d=m.s.c;d<=m.e.c;++d)f.push("\\cellx"+(d+1));for(f.push("\\pard\\intbl"),d=m.s.c;d<=m.e.c;++d){var l=$e({r:u,c:d});c=s?(i[u]||[])[d]:i[l],!(!c||c.v==null&&(!c.f||c.F))&&(f.push(" "+(c.w||(yn(c),c.w))),f.push("\\cell"))}f.push("\\pard\\intbl\\row")}return f.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function F0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var b_=6,dn=b_;function rl(t){return Math.floor((t+Math.round(128/dn)/256)*dn)}function nl(t){return Math.floor((t-5)/dn*100+.5)/100}function gu(t){return Math.round((t*dn+5)/dn*256)/256}function Af(t){t.width?(t.wpx=rl(t.width),t.wch=nl(t.wpx),t.MDW=dn):t.wpx?(t.wch=nl(t.wpx),t.width=gu(t.wch),t.MDW=dn):typeof t.wch=="number"&&(t.width=gu(t.wch),t.wpx=rl(t.width),t.MDW=dn),t.customWidth&&delete t.customWidth}var R_=96,c1=R_;function il(t){return t*96/c1}function u1(t){return t*c1/96}function M_(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=we("numFmt",null,{numFmtId:n,formatCode:Ve(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=we("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function L_(t){var e=[];return e[e.length]=we("cellXfs",null),t.forEach(function(r){e[e.length]=we("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=we("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function f1(t,e){var r=[xt,we("styleSheet",null,{xmlns:ds[0],"xmlns:vt":Tt.vt})],n;return t.SSF&&(n=M_(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=L_(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function I_(t,e){var r=t.read_shift(2),n=Ht(t);return[r,n]}function N_(t,e,r){r||(r=fe(6+4*e.length)),r.write_shift(2,t),Ot(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function B_(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=E2(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var f=t.read_shift(2);switch(f===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var m=t.read_shift(1);m!=0&&(n.underline=m);var c=t.read_shift(1);c>0&&(n.family=c);var s=t.read_shift(1);switch(s>0&&(n.charset=s),t.l++,n.color=T2(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ht(t),n}function j_(t,e){e||(e=fe(25+4*32)),e.write_shift(2,t.sz*20),O2(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),el(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),Ot(t.name,e),e.length>e.l?e.slice(0,e.l):e}var U_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],dc,W_=Jr;function D0(t,e){e||(e=fe(4*3+8*7+16*1)),dc||(dc=gf(U_));var r=dc[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(el({auto:1},e),el({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function z_(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function h1(t,e,r){r||(r=fe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ps(t,e){return e||(e=fe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var X_=Jr;function H_(t,e){return e||(e=fe(51)),e.write_shift(1,0),Ps(null,e),Ps(null,e),Ps(null,e),Ps(null,e),Ps(null,e),e.length>e.l?e.slice(0,e.l):e}function Y_(t,e){return e||(e=fe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),Zo(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function V_(t,e,r){var n=fe(2052);return n.write_shift(4,t),Zo(e,n),Zo(r,n),n.length>n.l?n.slice(0,n.l):n}function G_(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ge(t,615,Ur(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ge(t,44,N_(i,e[i]))}),ge(t,616))}}function $_(t){var e=1;ge(t,611,Ur(e)),ge(t,43,j_({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ge(t,612)}function K_(t){var e=2;ge(t,603,Ur(e)),ge(t,45,D0({patternType:"none"})),ge(t,45,D0({patternType:"gray125"})),ge(t,604)}function Q_(t){var e=1;ge(t,613,Ur(e)),ge(t,46,H_()),ge(t,614)}function q_(t){var e=1;ge(t,626,Ur(e)),ge(t,47,h1({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ge(t,627)}function J_(t,e){ge(t,617,Ur(e.length)),e.forEach(function(r){ge(t,47,h1(r,0))}),ge(t,618)}function Z_(t){var e=1;ge(t,619,Ur(e)),ge(t,48,Y_({xfId:0,builtinId:0,name:"Normal"})),ge(t,620)}function ew(t){var e=0;ge(t,505,Ur(e)),ge(t,506)}function tw(t){var e=0;ge(t,508,V_(e,"TableStyleMedium9","PivotStyleMedium4")),ge(t,509)}function rw(t,e){var r=sr();return ge(r,278),G_(r,t.SSF),$_(r),K_(r),Q_(r),q_(r),J_(r,e.cellXfs),Z_(r),ew(r),tw(r),ge(r,279),r.end()}function d1(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[xt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function nw(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ht(t)}}function iw(t){var e=fe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ot(t.name,e),e.slice(0,e.l)}function sw(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function aw(t){var e=fe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function ow(t,e){var r=fe(8+2*e.length);return r.write_shift(4,t),Ot(e,r),r.slice(0,r.l)}function lw(t){return t.l+=4,t.read_shift(4)!=0}function cw(t,e){var r=fe(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function uw(){var t=sr();return ge(t,332),ge(t,334,Ur(1)),ge(t,335,iw({name:"XLDAPR",version:12e4,flags:3496657072})),ge(t,336),ge(t,339,ow(1,"XLDAPR")),ge(t,52),ge(t,35,Ur(514)),ge(t,4096,Ur(0)),ge(t,4097,wr(1)),ge(t,36),ge(t,53),ge(t,340),ge(t,337,cw(1,!0)),ge(t,51,aw([[1,0]])),ge(t,338),ge(t,333),t.end()}function p1(){var t=[xt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function fw(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=$e(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Yi=1024;function g1(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[we("xml",null,{"xmlns:v":hr.v,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:mv":hr.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Yi<t*1e3;)Yi+=1e3;return e.forEach(function(f){var m=Et(f[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var s=c.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=we("v:fill",s,c),d={on:"t",obscured:"t"};++Yi,i=i.concat(["<v:shape"+_a({id:"_x0000_s"+Yi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(f[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,we("v:shadow",null,d),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bt("x:Anchor",[m.c+1,0,m.r+1,0,m.c+3,20,m.r+5,20].join(",")),bt("x:AutoFill","False"),bt("x:Row",String(m.r)),bt("x:Column",String(m.c)),f[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function m1(t){var e=[xt,we("comments",null,{xmlns:ds[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var f=Ve(i.a);r.indexOf(f)==-1&&(r.push(f),e.push("<author>"+f+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,f=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(s){s.a&&(i=r.indexOf(Ve(s.a))),f.push(s.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),f.length<=1)e.push(bt("t",Ve(f[0]||"")));else{for(var m=`Comment:
    `+f[0]+`
`,c=1;c<f.length;++c)m+=`Reply:
    `+f[c]+`
`;e.push(bt("t",Ve(m)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function hw(t,e,r){var n=[xt,we("ThreadedComments",null,{xmlns:Tt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var f="";(i[1]||[]).forEach(function(m,c){if(!m.T){delete m.ID;return}m.a&&e.indexOf(m.a)==-1&&e.push(m.a);var s={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?f=s.id:s.parentId=f,m.ID=s.id,m.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(m.a)).slice(-12)+"}"),n.push(we("threadedComment",bt("text",m.t||""),s))})}),n.push("</ThreadedComments>"),n.join("")}function dw(t){var e=[xt,we("personList",null,{xmlns:Tt.TCMNT,"xmlns:x":ds[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function pw(t){var e={};e.iauthor=t.read_shift(4);var r=Oi(t);return e.rfx=r.s,e.ref=$e(r.s),t.l+=16,e}function gw(t,e){return e==null&&(e=fe(36)),e.write_shift(4,t[1].iauthor),gs(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var mw=Ht;function vw(t){return Ot(t.slice(0,54))}function xw(t){var e=sr(),r=[];return ge(e,628),ge(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ge(e,632,vw(i.a)))})}),ge(e,631),ge(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var f={s:Et(n[0]),e:Et(n[0])};ge(e,635,gw([f,i])),i.t&&i.t.length>0&&ge(e,637,_2(i)),ge(e,636),delete i.iauthor})}),ge(e,634),ge(e,629),e.end()}function yw(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Qe.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var v1=["xlsb","xlsm","xlam","biff8","xla"],_w=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,f,m){var c=!1,s=!1;f.length==0?s=!0:f.charAt(0)=="["&&(s=!0,f=f.slice(1,-1)),m.length==0?c=!0:m.charAt(0)=="["&&(c=!0,m=m.slice(1,-1));var u=f.length>0?parseInt(f,10)|0:0,d=m.length>0?parseInt(m,10)|0:0;return c?d+=e.c:--d,s?u+=e.r:--u,i+(c?"":"$")+Xt(d)+(s?"":"$")+Mt(u)}return function(i,f){return e=f,i.replace(t,r)}}(),kf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Pf=function(){return function(e,r){return e.replace(kf,function(n,i,f,m,c,s){var u=Sf(m)-(f?0:r.c),d=wf(s)-(c?0:r.r),l=d==0?"":c?d+1:"["+d+"]",o=u==0?"":f?u+1:"["+u+"]";return i+"R"+l+"C"+o})}}();function ww(t,e){return t.replace(kf,function(r,n,i,f,m,c){return n+(i=="$"?i+f:Xt(Sf(f)+e.c))+(m=="$"?m+c:Mt(wf(c)+e.r))})}function Sw(t){return t.length!=1}function pt(t){t.l+=1}function Yn(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function x1(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return y1(t);r.biff==12&&(n=4)}var i=t.read_shift(n),f=t.read_shift(n),m=Yn(t,2),c=Yn(t,2);return{s:{r:i,c:m[0],cRel:m[1],rRel:m[2]},e:{r:f,c:c[0],cRel:c[1],rRel:c[2]}}}function y1(t){var e=Yn(t,2),r=Yn(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Cw(t,e,r){if(r.biff<8)return y1(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),f=Yn(t,2),m=Yn(t,2);return{s:{r:n,c:f[0],cRel:f[1],rRel:f[2]},e:{r:i,c:m[0],cRel:m[1],rRel:m[2]}}}function _1(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Tw(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Yn(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Tw(t){var e=Yn(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Ew(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Ow(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Aw(t);var i=t.read_shift(n>=12?4:2),f=t.read_shift(2),m=(f&16384)>>14,c=(f&32768)>>15;if(f&=16383,c==1)for(;i>524287;)i-=1048576;if(m==1)for(;f>8191;)f=f-16384;return{r:i,c:f,cRel:m,rRel:c}}function Aw(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function kw(t,e,r){var n=(t[t.l++]&96)>>5,i=x1(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Pw(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),f=8;if(r)switch(r.biff){case 5:t.l+=12,f=6;break;case 12:f=12;break}var m=x1(t,f,r);return[n,i,m]}function Fw(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Dw(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),f=8;if(r)switch(r.biff){case 5:t.l+=12,f=6;break;case 12:f=12;break}return t.l+=f,[n,i]}function bw(t,e,r){var n=(t[t.l++]&96)>>5,i=Cw(t,e-1,r);return[n,i]}function Rw(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function b0(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Mw(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],f=0;f<=n;++f)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function Lw(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Iw(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Nw(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Bw(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function w1(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function jw(t){return t.read_shift(2),w1(t)}function Uw(t){return t.read_shift(2),w1(t)}function Ww(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=_1(t,0,r);return[n,i]}function zw(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Ow(t,0,r);return[n,i]}function Xw(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var f=_1(t,0,r);return[n,i,f]}function Hw(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[HS[i],T1[i],n]}function Yw(t,e,r){var n=t[t.l++],i=t.read_shift(1),f=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Vw(t);return[i,(f[0]===0?T1:XS)[f[1]]]}function Vw(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Gw(t,e,r){t.l+=r&&r.biff==2?3:4}function $w(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Kw(t){return t.l++,Da[t.read_shift(1)]}function Qw(t){return t.l++,t.read_shift(2)}function qw(t){return t.l++,t.read_shift(1)!==0}function Jw(t){return t.l++,ms(t)}function Zw(t,e,r){return t.l++,n1(t,e-1,r)}function eS(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=X2(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Da[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=ms(t);break;case 2:r[1]=G2(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function tS(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],f=0;f!=n;++f)i.push((r.biff==12?Oi:Q2)(t));return i}function rS(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var f=0,m=[];f!=n&&(m[f]=[]);++f)for(var c=0;c!=i;++c)m[f][c]=eS(t,r.biff);return m}function nS(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,f=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,f]}function iS(t,e,r){if(r.biff==5)return sS(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),f=t.read_shift(4);return[n,i,f]}function sS(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function aS(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function oS(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function lS(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function cS(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),f=4;if(r)switch(r.biff){case 5:f=15;break;case 12:f=6;break}return t.l+=f,[n,i]}var uS=Jr,fS=Jr,hS=Jr;function ba(t,e,r){return t.l+=2,[Ew(t)]}function Ff(t){return t.l+=6,[]}var dS=ba,pS=Ff,gS=Ff,mS=ba;function S1(t){return t.l+=2,[t1(t),t.read_shift(2)&1]}var vS=ba,xS=S1,yS=Ff,_S=ba,wS=ba,SS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function CS(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),f=t.read_shift(2),m=SS[r>>2&31];return{ixti:e,coltype:r&3,rt:m,idx:n,c:i,C:f}}function TS(t){return t.l+=2,[t.read_shift(4)]}function ES(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function OS(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function AS(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function kS(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function PS(t){return t.l+=4,[0,0]}var R0={1:{n:"PtgExp",f:$w},2:{n:"PtgTbl",f:hS},3:{n:"PtgAdd",f:pt},4:{n:"PtgSub",f:pt},5:{n:"PtgMul",f:pt},6:{n:"PtgDiv",f:pt},7:{n:"PtgPower",f:pt},8:{n:"PtgConcat",f:pt},9:{n:"PtgLt",f:pt},10:{n:"PtgLe",f:pt},11:{n:"PtgEq",f:pt},12:{n:"PtgGe",f:pt},13:{n:"PtgGt",f:pt},14:{n:"PtgNe",f:pt},15:{n:"PtgIsect",f:pt},16:{n:"PtgUnion",f:pt},17:{n:"PtgRange",f:pt},18:{n:"PtgUplus",f:pt},19:{n:"PtgUminus",f:pt},20:{n:"PtgPercent",f:pt},21:{n:"PtgParen",f:pt},22:{n:"PtgMissArg",f:pt},23:{n:"PtgStr",f:Zw},26:{n:"PtgSheet",f:ES},27:{n:"PtgEndSheet",f:OS},28:{n:"PtgErr",f:Kw},29:{n:"PtgBool",f:qw},30:{n:"PtgInt",f:Qw},31:{n:"PtgNum",f:Jw},32:{n:"PtgArray",f:Rw},33:{n:"PtgFunc",f:Hw},34:{n:"PtgFuncVar",f:Yw},35:{n:"PtgName",f:nS},36:{n:"PtgRef",f:Ww},37:{n:"PtgArea",f:kw},38:{n:"PtgMemArea",f:aS},39:{n:"PtgMemErr",f:uS},40:{n:"PtgMemNoMem",f:fS},41:{n:"PtgMemFunc",f:oS},42:{n:"PtgRefErr",f:lS},43:{n:"PtgAreaErr",f:Fw},44:{n:"PtgRefN",f:zw},45:{n:"PtgAreaN",f:bw},46:{n:"PtgMemAreaN",f:AS},47:{n:"PtgMemNoMemN",f:kS},57:{n:"PtgNameX",f:iS},58:{n:"PtgRef3d",f:Xw},59:{n:"PtgArea3d",f:Pw},60:{n:"PtgRefErr3d",f:cS},61:{n:"PtgAreaErr3d",f:Dw},255:{}},FS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},DS={1:{n:"PtgElfLel",f:S1},2:{n:"PtgElfRw",f:_S},3:{n:"PtgElfCol",f:dS},6:{n:"PtgElfRwV",f:wS},7:{n:"PtgElfColV",f:mS},10:{n:"PtgElfRadical",f:vS},11:{n:"PtgElfRadicalS",f:yS},13:{n:"PtgElfColS",f:pS},15:{n:"PtgElfColSV",f:gS},16:{n:"PtgElfRadicalLel",f:xS},25:{n:"PtgList",f:CS},29:{n:"PtgSxName",f:TS},255:{}},bS={0:{n:"PtgAttrNoop",f:PS},1:{n:"PtgAttrSemi",f:Bw},2:{n:"PtgAttrIf",f:Iw},4:{n:"PtgAttrChoose",f:Mw},8:{n:"PtgAttrGoto",f:Lw},16:{n:"PtgAttrSum",f:Gw},32:{n:"PtgAttrBaxcel",f:b0},33:{n:"PtgAttrBaxcel",f:b0},64:{n:"PtgAttrSpace",f:jw},65:{n:"PtgAttrSpaceSemi",f:Uw},128:{n:"PtgAttrIfError",f:Nw},255:{}};function RS(t,e,r,n){if(n.biff<8)return Jr(t,e);for(var i=t.l+e,f=[],m=0;m!==r.length;++m)switch(r[m][0]){case"PtgArray":r[m][1]=rS(t,0,n),f.push(r[m][1]);break;case"PtgMemArea":r[m][2]=tS(t,r[m][1],n),f.push(r[m][2]);break;case"PtgExp":n&&n.biff==12&&(r[m][1][1]=t.read_shift(4),f.push(r[m][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[m][0]}return e=i-t.l,e!==0&&f.push(Jr(t,e)),f}function MS(t,e,r){for(var n=t.l+e,i,f,m=[];n!=t.l;)e=n-t.l,f=t[t.l],i=R0[f]||R0[FS[f]],(f===24||f===25)&&(i=(f===24?DS:bS)[t[t.l+1]]),!i||!i.f?Jr(t,e):m.push([i.n,i.f(t,e,r)]);return m}function LS(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],f=0;f<n.length;++f){var m=n[f];if(m)switch(m[0]){case 2:i.push('"'+m[1].replace(/"/g,'""')+'"');break;default:i.push(m[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var IS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function NS(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function C1(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(f){return f.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function M0(t,e,r){var n=C1(t,e,r);return n=="#REF"?n:NS(n,r)}function cs(t,e,r,n,i){var f=i&&i.biff||8,m={s:{c:0,r:0},e:{c:0,r:0}},c=[],s,u,d,l=0,o=0,a,h="";if(!t[0]||!t[0][0])return"";for(var g=-1,p="",v=0,x=t[0].length;v<x;++v){var y=t[0][v];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=c.pop(),u=c.pop(),g>=0){switch(t[0][g][1][0]){case 0:p=ft(" ",t[0][g][1][1]);break;case 1:p=ft("\r",t[0][g][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}u=u+p,g=-1}c.push(u+IS[y[0]]+s);break;case"PtgIsect":s=c.pop(),u=c.pop(),c.push(u+" "+s);break;case"PtgUnion":s=c.pop(),u=c.pop(),c.push(u+","+s);break;case"PtgRange":s=c.pop(),u=c.pop(),c.push(u+":"+s);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=qs(y[1][1],m,i),c.push(Js(d,f));break;case"PtgRefN":d=r?qs(y[1][1],r,i):y[1][1],c.push(Js(d,f));break;case"PtgRef3d":l=y[1][1],d=qs(y[1][2],m,i),h=M0(n,l,i),c.push(h+"!"+Js(d,f));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],w=y[1][1];_||(_=0),_&=127;var C=_==0?[]:c.slice(-_);c.length-=_,w==="User"&&(w=C.shift()),c.push(w+"("+C.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(y[1]);break;case"PtgAreaN":a=x0(y[1][1],r?{s:r}:m,i),c.push(fc(a,i));break;case"PtgArea":a=x0(y[1][1],m,i),c.push(fc(a,i));break;case"PtgArea3d":l=y[1][1],a=y[1][2],h=M0(n,l,i),c.push(h+"!"+fc(a,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":o=y[1][2];var S=(n.names||[])[o-1]||(n[0]||[])[o],O=S?S.Name:"SH33TJSNAME"+String(o);O&&O.slice(0,6)=="_xlfn."&&!i.xlfn&&(O=O.slice(6)),c.push(O);break;case"PtgNameX":var F=y[1][1];o=y[1][2];var N;if(i.biff<=5)F<0&&(F=-F),n[F]&&(N=n[F][o]);else{var W="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][o]&&n[F][o].itab>0&&(W=n.SheetNames[n[F][o].itab-1]+"!"):W=n.SheetNames[o-1]+"!"),n[F]&&n[F][o])W+=n[F][o].Name;else if(n[0]&&n[0][o])W+=n[0][o].Name;else{var X=(C1(n,F,i)||"").split(";;");X[o-1]?W=X[o-1]:W+="SH33TJSERRX"}c.push(W);break}N||(N={Name:"SH33TJSERRY"}),c.push(N.Name);break;case"PtgParen":var Q="(",ae=")";if(g>=0){switch(p="",t[0][g][1][0]){case 2:Q=ft(" ",t[0][g][1][1])+Q;break;case 3:Q=ft("\r",t[0][g][1][1])+Q;break;case 4:ae=ft(" ",t[0][g][1][1])+ae;break;case 5:ae=ft("\r",t[0][g][1][1])+ae;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}c.push(Q+c.pop()+ae);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[$e(d)]){var J=n.sharedf[$e(d)];c.push(cs(J,m,ne,n,i))}else{var oe=!1;for(s=0;s!=n.arrayf.length;++s)if(u=n.arrayf[s],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){c.push(cs(u[1],m,ne,n,i)),oe=!0;break}oe||c.push(y[1])}break;case"PtgArray":c.push("{"+LS(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&q.indexOf(t[0][v][0])==-1){y=t[0][g];var k=!0;switch(y[1][0]){case 4:k=!1;case 0:p=ft(" ",y[1][1]);break;case 5:k=!1;case 1:p=ft("\r",y[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((k?p:"")+c.pop()+(k?"":p)),g=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function BS(t){if(t==null){var e=fe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return xi(t);return xi(0)}function jS(t,e,r,n,i){var f=yi(e,r,i),m=BS(t.v),c=fe(6),s=33;c.write_shift(2,s),c.write_shift(4,0);for(var u=fe(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var l=Dt([f,m,c,u]);return l}function kl(t,e,r){var n=t.read_shift(4),i=MS(t,n,r),f=t.read_shift(4),m=f>0?RS(t,f,i,r):null;return[i,m]}var US=kl,Pl=kl,WS=kl,zS=kl,XS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},T1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},HS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function YS(t){var e="of:="+t.replace(kf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function VS(t){return t.replace(/\./,"!")}var Zs=typeof Map<"u";function Df(t,e,r){var n=0,i=t.length;if(r){if(Zs?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var f=Zs?r.get(e):r[e];n<f.length;++n)if(t[f[n]].t===e)return t.Count++,f[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Zs?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Fl(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(dn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=nl(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=gu(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function E1(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Qn(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,f=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){_g(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=f;++i)if(t[i].numFmtId===n)return i;return t[f]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},f}function GS(t,e,r){if(t&&t["!ref"]){var n=et(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function $S(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+vt(t[r])+'"/>';return e+"</mergeCells>"}function KS(t,e,r,n,i){var f=!1,m={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var s=e.SheetNames[r];try{e.Workbook&&(s=e.Workbook.Sheets[r].CodeName||s)}catch{}f=!0,m.codeName=ln(Ve(s))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),c=(c||"")+we("outlinePr",null,u)}!f&&!c||(i[i.length]=we("sheetPr",c,m))}var QS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],qS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function JS(t){var e={sheet:1};return QS.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),qS.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=l1(t.password).toString(16).toUpperCase()),we("sheetProtection",null,e)}function ZS(t){return E1(t),we("pageMargins",null,t)}function eC(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=we("col",null,Fl(i,n)));return r[r.length]="</cols>",r.join("")}function tC(t,e,r,n){var i=typeof t.ref=="string"?t.ref:vt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var f=r.Workbook.Names,m=vr(i);m.s.r==m.e.r&&(m.e.r=vr(e["!ref"]).e.r,i=vt(m));for(var c=0;c<f.length;++c){var s=f[c];if(s.Name=="_xlnm._FilterDatabase"&&s.Sheet==n){s.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return c==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),we("autoFilter",null,{ref:i})}function rC(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,i),{})}function nC(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",f=t.t,m=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Da[t.v];break;case"d":n&&n.cellDates?i=Qt(t.v,-1).toISOString():(t=or(t),t.t="n",i=""+(t.v=ar(Qt(t.v)))),typeof t.z>"u"&&(t.z=ht[14]);break;default:i=t.v;break}var c=bt("v",Ve(i)),s={r:e},u=Qn(n.cellXfs,t,n);switch(u!==0&&(s.s=u),t.t){case"n":break;case"d":s.t="d";break;case"b":s.t="b";break;case"e":s.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=bt("v",""+Df(n.Strings,t.v,n.revStrings)),s.t="s";break}s.t="str";break}if(t.t!=f&&(t.t=f,t.v=m),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=we("f",Ve(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(s.cm=1),we("c",c,s)}function iC(t,e,r,n){var i=[],f=[],m=et(t["!ref"]),c="",s,u="",d=[],l=0,o=0,a=t["!rows"],h=Array.isArray(t),g={r:u},p,v=-1;for(o=m.s.c;o<=m.e.c;++o)d[o]=Xt(o);for(l=m.s.r;l<=m.e.r;++l){for(f=[],u=Mt(l),o=m.s.c;o<=m.e.c;++o){s=d[o]+u;var x=h?(t[l]||[])[o]:t[s];x!==void 0&&(c=nC(x,s,t,e))!=null&&f.push(c)}(f.length>0||a&&a[l])&&(g={r:u},a&&a[l]&&(p=a[l],p.hidden&&(g.hidden=1),v=-1,p.hpx?v=il(p.hpx):p.hpt&&(v=p.hpt),v>-1&&(g.ht=v,g.customHeight=1),p.level&&(g.outlineLevel=p.level)),i[i.length]=we("row",f.join(""),g))}if(a)for(;l<a.length;++l)a&&a[l]&&(g={r:l+1},p=a[l],p.hidden&&(g.hidden=1),v=-1,p.hpx?v=il(p.hpx):p.hpt&&(v=p.hpt),v>-1&&(g.ht=v,g.customHeight=1),p.level&&(g.outlineLevel=p.level),i[i.length]=we("row","",g));return i.join("")}function O1(t,e,r,n){var i=[xt,we("worksheet",null,{xmlns:ds[0],"xmlns:r":Tt.r})],f=r.SheetNames[t],m=0,c="",s=r.Sheets[f];s==null&&(s={});var u=s["!ref"]||"A1",d=et(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=vt(d)}n||(n={}),s["!comments"]=[];var l=[];KS(s,r,t,e,i),i[i.length]=we("dimension",null,{ref:u}),i[i.length]=rC(s,e,t,r),e.sheetFormat&&(i[i.length]=we("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),s["!cols"]!=null&&s["!cols"].length>0&&(i[i.length]=eC(s,s["!cols"])),i[m=i.length]="<sheetData/>",s["!links"]=[],s["!ref"]!=null&&(c=iC(s,e),c.length>0&&(i[i.length]=c)),i.length>m+1&&(i[i.length]="</sheetData>",i[m]=i[m].replace("/>",">")),s["!protect"]&&(i[i.length]=JS(s["!protect"])),s["!autofilter"]!=null&&(i[i.length]=tC(s["!autofilter"],s,r,t)),s["!merges"]!=null&&s["!merges"].length>0&&(i[i.length]=$S(s["!merges"]));var o=-1,a,h=-1;return s["!links"].length>0&&(i[i.length]="<hyperlinks>",s["!links"].forEach(function(g){g[1].Target&&(a={ref:g[0]},g[1].Target.charAt(0)!="#"&&(h=Ye(n,-1,Ve(g[1].Target).replace(/#.*$/,""),ze.HLINK),a["r:id"]="rId"+h),(o=g[1].Target.indexOf("#"))>-1&&(a.location=Ve(g[1].Target.slice(o+1))),g[1].Tooltip&&(a.tooltip=Ve(g[1].Tooltip)),i[i.length]=we("hyperlink",null,a))}),i[i.length]="</hyperlinks>"),delete s["!links"],s["!margins"]!=null&&(i[i.length]=ZS(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=bt("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:u}))),l.length>0&&(h=Ye(n,-1,"../drawings/drawing"+(t+1)+".xml",ze.DRAW),i[i.length]=we("drawing",null,{"r:id":"rId"+h}),s["!drawing"]=l),s["!comments"].length>0&&(h=Ye(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ze.VML),i[i.length]=we("legacyDrawing",null,{"r:id":"rId"+h}),s["!legacy"]=h),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function sC(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var f=t.read_shift(1);return t.l=n,f&7&&(r.level=f&7),f&16&&(r.hidden=!0),f&32&&(r.hpt=i/20),r}function aC(t,e,r){var n=fe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var f=320;i.hpx?f=il(i.hpx)*20:i.hpt&&(f=i.hpt*20),n.write_shift(2,f),n.write_shift(1,0);var m=0;i.level&&(m|=i.level),i.hidden&&(m|=16),(i.hpx||i.hpt)&&(m|=32),n.write_shift(1,m),n.write_shift(1,0);var c=0,s=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var l=-1,o=-1,a=d<<10;a<d+1<<10;++a){u.c=a;var h=Array.isArray(r)?(r[u.r]||[])[u.c]:r[$e(u)];h&&(l<0&&(l=a),o=a)}l<0||(++c,n.write_shift(4,l),n.write_shift(4,o))}var g=n.l;return n.l=s,n.write_shift(4,c),n.l=g,n.length>n.l?n.slice(0,n.l):n}function oC(t,e,r,n){var i=aC(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ge(t,0,i)}var lC=Oi,cC=gs;function uC(){}function fC(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=w2(t),r}function hC(t,e,r){r==null&&(r=fe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return el({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Wg(t,r),r.slice(0,r.l)}function dC(t){var e=kr(t);return[e]}function pC(t,e,r){return r==null&&(r=fe(8)),Ci(e,r)}function gC(t){var e=Ti(t);return[e]}function mC(t,e,r){return r==null&&(r=fe(4)),Ei(e,r)}function vC(t){var e=kr(t),r=t.read_shift(1);return[e,r,"b"]}function xC(t,e,r){return r==null&&(r=fe(9)),Ci(e,r),r.write_shift(1,t.v?1:0),r}function yC(t){var e=Ti(t),r=t.read_shift(1);return[e,r,"b"]}function _C(t,e,r){return r==null&&(r=fe(5)),Ei(e,r),r.write_shift(1,t.v?1:0),r}function wC(t){var e=kr(t),r=t.read_shift(1);return[e,r,"e"]}function SC(t,e,r){return r==null&&(r=fe(9)),Ci(e,r),r.write_shift(1,t.v),r}function CC(t){var e=Ti(t),r=t.read_shift(1);return[e,r,"e"]}function TC(t,e,r){return r==null&&(r=fe(8)),Ei(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function EC(t){var e=kr(t),r=t.read_shift(4);return[e,r,"s"]}function OC(t,e,r){return r==null&&(r=fe(12)),Ci(e,r),r.write_shift(4,e.v),r}function AC(t){var e=Ti(t),r=t.read_shift(4);return[e,r,"s"]}function kC(t,e,r){return r==null&&(r=fe(8)),Ei(e,r),r.write_shift(4,e.v),r}function PC(t){var e=kr(t),r=ms(t);return[e,r,"n"]}function FC(t,e,r){return r==null&&(r=fe(16)),Ci(e,r),xi(t.v,r),r}function DC(t){var e=Ti(t),r=ms(t);return[e,r,"n"]}function bC(t,e,r){return r==null&&(r=fe(12)),Ei(e,r),xi(t.v,r),r}function RC(t){var e=kr(t),r=zg(t);return[e,r,"n"]}function MC(t,e,r){return r==null&&(r=fe(12)),Ci(e,r),Xg(t.v,r),r}function LC(t){var e=Ti(t),r=zg(t);return[e,r,"n"]}function IC(t,e,r){return r==null&&(r=fe(8)),Ei(e,r),Xg(t.v,r),r}function NC(t){var e=kr(t),r=Cf(t);return[e,r,"is"]}function BC(t){var e=kr(t),r=Ht(t);return[e,r,"str"]}function jC(t,e,r){return r==null&&(r=fe(12+4*t.v.length)),Ci(e,r),Ot(t.v,r),r.length>r.l?r.slice(0,r.l):r}function UC(t){var e=Ti(t),r=Ht(t);return[e,r,"str"]}function WC(t,e,r){return r==null&&(r=fe(8+4*t.v.length)),Ei(e,r),Ot(t.v,r),r.length>r.l?r.slice(0,r.l):r}function zC(t,e,r){var n=t.l+e,i=kr(t);i.r=r["!row"];var f=t.read_shift(1),m=[i,f,"b"];if(r.cellFormula){t.l+=2;var c=Pl(t,n-t.l,r);m[3]=cs(c,null,i,r.supbooks,r)}else t.l=n;return m}function XC(t,e,r){var n=t.l+e,i=kr(t);i.r=r["!row"];var f=t.read_shift(1),m=[i,f,"e"];if(r.cellFormula){t.l+=2;var c=Pl(t,n-t.l,r);m[3]=cs(c,null,i,r.supbooks,r)}else t.l=n;return m}function HC(t,e,r){var n=t.l+e,i=kr(t);i.r=r["!row"];var f=ms(t),m=[i,f,"n"];if(r.cellFormula){t.l+=2;var c=Pl(t,n-t.l,r);m[3]=cs(c,null,i,r.supbooks,r)}else t.l=n;return m}function YC(t,e,r){var n=t.l+e,i=kr(t);i.r=r["!row"];var f=Ht(t),m=[i,f,"str"];if(r.cellFormula){t.l+=2;var c=Pl(t,n-t.l,r);m[3]=cs(c,null,i,r.supbooks,r)}else t.l=n;return m}var VC=Oi,GC=gs;function $C(t,e){return e==null&&(e=fe(4)),e.write_shift(4,t),e}function KC(t,e){var r=t.l+e,n=Oi(t),i=Tf(t),f=Ht(t),m=Ht(t),c=Ht(t);t.l=r;var s={rfx:n,relId:i,loc:f,display:c};return m&&(s.Tooltip=m),s}function QC(t,e){var r=fe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));gs({s:Et(t[0]),e:Et(t[0])},r),Ef("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Ot(i||"",r),Ot(t[1].Tooltip||"",r),Ot("",r),r.slice(0,r.l)}function qC(){}function JC(t,e,r){var n=t.l+e,i=Hg(t),f=t.read_shift(1),m=[i];if(m[2]=f,r.cellFormula){var c=US(t,n-t.l,r);m[1]=c}else t.l=n;return m}function ZC(t,e,r){var n=t.l+e,i=Oi(t),f=[i];if(r.cellFormula){var m=zS(t,n-t.l,r);f[1]=m,t.l=n}else t.l=n;return f}function eT(t,e,r){r==null&&(r=fe(18));var n=Fl(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var A1=["left","right","top","bottom","header","footer"];function tT(t){var e={};return A1.forEach(function(r){e[r]=ms(t)}),e}function rT(t,e){return e==null&&(e=fe(6*8)),E1(t),A1.forEach(function(r){xi(t[r],e)}),e}function nT(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function iT(t,e,r){r==null&&(r=fe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function sT(t){var e=fe(24);return e.write_shift(4,4),e.write_shift(4,1),gs(t,e),e}function aT(t,e){return e==null&&(e=fe(16*4+2)),e.write_shift(2,t.password?l1(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function oT(){}function lT(){}function cT(t,e,r,n,i,f,m){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=or(e),e.z=e.z||ht[14],e.v=ar(Qt(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var s={r,c:n};switch(s.s=Qn(i.cellXfs,e,i),e.l&&f["!links"].push([$e(s),e.l]),e.c&&f["!comments"].push([$e(s),e.c]),e.t){case"s":case"str":return i.bookSST?(c=Df(i.Strings,e.v,i.revStrings),s.t="s",s.v=c,m?ge(t,18,kC(e,s)):ge(t,7,OC(e,s))):(s.t="str",m?ge(t,17,WC(e,s)):ge(t,6,jC(e,s))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?m?ge(t,13,IC(e,s)):ge(t,2,MC(e,s)):m?ge(t,16,bC(e,s)):ge(t,5,FC(e,s)),!0;case"b":return s.t="b",m?ge(t,15,_C(e,s)):ge(t,4,xC(e,s)),!0;case"e":return s.t="e",m?ge(t,14,TC(e,s)):ge(t,3,SC(e,s)),!0}return m?ge(t,12,mC(e,s)):ge(t,1,pC(e,s)),!0}function uT(t,e,r,n){var i=et(e["!ref"]||"A1"),f,m="",c=[];ge(t,145);var s=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=u;++d){m=Mt(d),oC(t,e,i,d);var l=!1;if(d<=i.e.r)for(var o=i.s.c;o<=i.e.c;++o){d===i.s.r&&(c[o]=Xt(o)),f=c[o]+m;var a=s?(e[d]||[])[o]:e[f];if(!a){l=!1;continue}l=cT(t,a,d,o,n,e,l)}}ge(t,146)}function fT(t,e){!e||!e["!merges"]||(ge(t,177,$C(e["!merges"].length)),e["!merges"].forEach(function(r){ge(t,176,GC(r))}),ge(t,178))}function hT(t,e){!e||!e["!cols"]||(ge(t,390),e["!cols"].forEach(function(r,n){r&&ge(t,60,eT(n,r))}),ge(t,391))}function dT(t,e){!e||!e["!ref"]||(ge(t,648),ge(t,649,sT(et(e["!ref"]))),ge(t,650))}function pT(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Ye(r,-1,n[1].Target.replace(/#.*$/,""),ze.HLINK);ge(t,494,QC(n,i))}}),delete e["!links"]}function gT(t,e,r,n){if(e["!comments"].length>0){var i=Ye(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ze.VML);ge(t,551,Ef("rId"+i)),e["!legacy"]=i}}function mT(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],f=typeof i.ref=="string"?i.ref:vt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var m=r.Workbook.Names,c=vr(f);c.s.r==c.e.r&&(c.e.r=vr(e["!ref"]).e.r,f=vt(c));for(var s=0;s<m.length;++s){var u=m[s];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+f;break}}s==m.length&&m.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+f}),ge(t,161,gs(et(f))),ge(t,162)}}function vT(t,e,r){ge(t,133),ge(t,137,iT(e,r)),ge(t,138),ge(t,134)}function xT(t,e){e["!protect"]&&ge(t,535,aT(e["!protect"]))}function yT(t,e,r,n){var i=sr(),f=r.SheetNames[t],m=r.Sheets[f]||{},c=f;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var s=et(m["!ref"]||"A1");if(s.e.c>16383||s.e.r>1048575){if(e.WTF)throw new Error("Range "+(m["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");s.e.c=Math.min(s.e.c,16383),s.e.r=Math.min(s.e.c,1048575)}return m["!links"]=[],m["!comments"]=[],ge(i,129),(r.vbaraw||m["!outline"])&&ge(i,147,hC(c,m["!outline"])),ge(i,148,cC(s)),vT(i,m,r.Workbook),hT(i,m),uT(i,m,t,e),xT(i,m),mT(i,m,r,t),fT(i,m),pT(i,m,n),m["!margins"]&&ge(i,476,rT(m["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&dT(i,m),gT(i,m,t,n),ge(i,130),i.end()}function _T(t,e){t.l+=10;var r=Ht(t);return{name:r}}var wT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ST(t){return!t.Workbook||!t.Workbook.WBProps?"false":Zy(t.Workbook.WBProps.date1904)?"true":"false"}var CT="][*?/\\".split("");function k1(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return CT.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function TT(t,e,r){t.forEach(function(n,i){k1(n);for(var f=0;f<i;++f)if(n==t[f])throw new Error("Duplicate Sheet Name: "+n);if(r){var m=e&&e[i]&&e[i].CodeName||n;if(m.charCodeAt(0)==95&&m.length>22)throw new Error("Bad Code Name: Worksheet"+m)}})}function ET(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];TT(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)GS(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function P1(t){var e=[xt];e[e.length]=we("workbook",null,{xmlns:ds[0],"xmlns:r":Tt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(wT.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=we("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],f=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",f=0;f!=t.SheetNames.length&&!(!i[f]||!i[f].Hidden);++f);f==t.SheetNames.length&&(f=0),e[e.length]='<workbookView firstSheet="'+f+'" activeTab="'+f+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",f=0;f!=t.SheetNames.length;++f){var m={name:Ve(t.SheetNames[f].slice(0,31))};if(m.sheetId=""+(f+1),m["r:id"]="rId"+(f+1),i[f])switch(i[f].Hidden){case 1:m.state="hidden";break;case 2:m.state="veryHidden";break}e[e.length]=we("sheet",null,m)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var s={name:c.Name};c.Comment&&(s.comment=c.Comment),c.Sheet!=null&&(s.localSheetId=""+c.Sheet),c.Hidden&&(s.hidden="1"),c.Ref&&(e[e.length]=we("definedName",Ve(c.Ref),s))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function OT(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=pu(t),r.name=Ht(t),r}function AT(t,e){return e||(e=fe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Ef(t.strRelID,e),Ot(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function kT(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Ht(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function PT(t,e){e||(e=fe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Wg(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function FT(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),f=S2(t),m=WS(t,0,r),c=Tf(t);t.l=n;var s={Name:f,Ptg:m};return i<268435455&&(s.Sheet=i),c&&(s.Comment=c),s}function DT(t,e){ge(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ge(t,156,AT(i))}ge(t,144)}function bT(t,e){e||(e=fe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ot("SheetJS",e),Ot(Go.version,e),Ot(Go.version,e),Ot("7262",e),e.length>e.l?e.slice(0,e.l):e}function RT(t,e){e||(e=fe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function MT(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,f=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&f==-1&&(f=n);f>i||(ge(t,135),ge(t,158,RT(i)),ge(t,136))}}function LT(t,e){var r=sr();return ge(r,131),ge(r,128,bT()),ge(r,153,PT(t.Workbook&&t.Workbook.WBProps||null)),MT(r,t),DT(r,t),ge(r,132),r.end()}function IT(t,e,r){return(e.slice(-4)===".bin"?LT:P1)(t)}function NT(t,e,r,n,i){return(e.slice(-4)===".bin"?yT:O1)(t,r,n,i)}function BT(t,e,r){return(e.slice(-4)===".bin"?rw:f1)(t,r)}function jT(t,e,r){return(e.slice(-4)===".bin"?P_:o1)(t,r)}function UT(t,e,r){return(e.slice(-4)===".bin"?xw:m1)(t)}function WT(t){return(t.slice(-4)===".bin"?uw:p1)()}function zT(t,e){var r=[];return t.Props&&r.push(B2(t.Props,e)),t.Custprops&&r.push(j2(t.Props,t.Custprops)),r.join("")}function XT(){return""}function HT(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var f=[];f.push(we("NumberFormat",null,{"ss:Format":Ve(ht[n.numFmtId])}));var m={"ss:ID":"s"+(21+i)};r.push(we("Style",f.join(""),m))}),we("Styles",r.join(""))}function F1(t){return we("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Pf(t.Ref,{r:0,c:0})})}function YT(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(F1(i)))}return we("Names",r.join(""))}function VT(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,f=[],m=0;m<i.length;++m){var c=i[m];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||f.push(F1(c)))}return f.join("")}function GT(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(we("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(we("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(we("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var f=0;f<r&&!(n.Workbook.Sheets[f]&&!n.Workbook.Sheets[f].Hidden);++f);f==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(bt("ProtectContents","True")),t["!protect"].objects&&i.push(bt("ProtectObjects","True")),t["!protect"].scenarios&&i.push(bt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(bt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(bt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(m){t["!protect"][m[0]]&&i.push("<"+m[1]+"/>")})),i.length==0?"":we("WorksheetOptions",i.join(""),{xmlns:hr.x})}function $T(t){return t.map(function(e){var r=Jy(e.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":e.a})}).join("")}function KT(t,e,r,n,i,f,m){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+Ve(Pf(t.f,m))),t.F&&t.F.slice(0,e.length)==e){var s=Et(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(s.r==m.r?"":"["+(s.r-m.r)+"]")+"C"+(s.c==m.c?"":"["+(s.c-m.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=Ve(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=Ve(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=m.c||u[d].s.r!=m.r||(u[d].e.c>u[d].s.c&&(c["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(c["ss:MergeDown"]=u[d].e.r-u[d].s.r));var l="",o="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":l="Number",o=String(t.v);break;case"b":l="Boolean",o=t.v?"1":"0";break;case"e":l="Error",o=Da[t.v];break;case"d":l="DateTime",o=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ht[14]);break;case"s":l="String",o=qy(t.v||"");break}var a=Qn(n.cellXfs,t,n);c["ss:StyleID"]="s"+(21+a),c["ss:Index"]=m.c+1;var h=t.v!=null?o:"",g=t.t=="z"?"":'<Data ss:Type="'+l+'">'+h+"</Data>";return(t.c||[]).length>0&&(g+=$T(t.c)),we("Cell",g,c)}function QT(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=u1(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qT(t,e,r,n){if(!t["!ref"])return"";var i=et(t["!ref"]),f=t["!merges"]||[],m=0,c=[];t["!cols"]&&t["!cols"].forEach(function(p,v){Af(p);var x=!!p.width,y=Fl(v,p),_={"ss:Index":v+1};x&&(_["ss:Width"]=rl(y.width)),p.hidden&&(_["ss:Hidden"]="1"),c.push(we("Column",null,_))});for(var s=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var d=[QT(u,(t["!rows"]||[])[u])],l=i.s.c;l<=i.e.c;++l){var o=!1;for(m=0;m!=f.length;++m)if(!(f[m].s.c>l)&&!(f[m].s.r>u)&&!(f[m].e.c<l)&&!(f[m].e.r<u)){(f[m].s.c!=l||f[m].s.r!=u)&&(o=!0);break}if(!o){var a={r:u,c:l},h=$e(a),g=s?(t[u]||[])[l]:t[h];d.push(KT(g,h,t,e,r,n,a))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function JT(t,e,r){var n=[],i=r.SheetNames[t],f=r.Sheets[i],m=f?VT(f,e,t,r):"";return m.length>0&&n.push("<Names>"+m+"</Names>"),m=f?qT(f,e,t,r):"",m.length>0&&n.push("<Table>"+m+"</Table>"),n.push(GT(f,e,t,r)),n.join("")}function ZT(t,e){e||(e={}),t.SSF||(t.SSF=or(ht)),t.SSF&&(El(),Tl(t.SSF),e.revssf=Ol(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Qn(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(zT(t,e)),r.push(XT()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(we("Worksheet",JT(n,e,t),{"ss:Name":Ve(t.SheetNames[n])}));return r[2]=HT(t,e),r[3]=YT(t),xt+we("Workbook",r.join(""),{xmlns:hr.ss,"xmlns:o":hr.o,"xmlns:x":hr.x,"xmlns:ss":hr.ss,"xmlns:dt":hr.dt,"xmlns:html":hr.html})}var pc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function eE(t,e){var r=[],n=[],i=[],f=0,m,c=o0(_0,"n"),s=o0(w0,"n");if(t.Props)for(m=It(t.Props),f=0;f<m.length;++f)(Object.prototype.hasOwnProperty.call(c,m[f])?r:Object.prototype.hasOwnProperty.call(s,m[f])?n:i).push([m[f],t.Props[m[f]]]);if(t.Custprops)for(m=It(t.Custprops),f=0;f<m.length;++f)Object.prototype.hasOwnProperty.call(t.Props||{},m[f])||(Object.prototype.hasOwnProperty.call(c,m[f])?r:Object.prototype.hasOwnProperty.call(s,m[f])?n:i).push([m[f],t.Custprops[m[f]]]);var u=[];for(f=0;f<i.length;++f)e1.indexOf(i[f][0])>-1||qg.indexOf(i[f][0])>-1||i[f][1]!=null&&u.push(i[f]);n.length&&Qe.utils.cfb_add(e,"/SummaryInformation",O0(n,pc.SI,s,w0)),(r.length||u.length)&&Qe.utils.cfb_add(e,"/DocumentSummaryInformation",O0(r,pc.DSI,c,_0,u.length?u:null,pc.UDI))}function tE(t,e){var r=e||{},n=Qe.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qe.utils.cfb_add(n,i,D1(t,r)),r.biff==8&&(t.Props||t.Custprops)&&eE(t,n),r.biff==8&&t.vbaraw&&yw(n,Qe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var rE={0:{f:sC},1:{f:dC},2:{f:RC},3:{f:wC},4:{f:vC},5:{f:PC},6:{f:BC},7:{f:EC},8:{f:YC},9:{f:HC},10:{f:zC},11:{f:XC},12:{f:gC},13:{f:LC},14:{f:CC},15:{f:yC},16:{f:DC},17:{f:UC},18:{f:AC},19:{f:Cf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FT},40:{},42:{},43:{f:B_},44:{f:I_},45:{f:W_},46:{f:X_},47:{f:z_},48:{},49:{f:g2},50:{},51:{f:sw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:m_},62:{f:NC},63:{f:fw},64:{f:oT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fC},148:{f:lC,p:16},151:{f:qC},152:{},153:{f:kT},154:{},155:{},156:{f:OT},157:{},158:{},159:{T:1,f:O_},160:{T:-1},161:{T:1,f:Oi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:VC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nw},336:{T:-1},337:{f:lw,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:u_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:JC},427:{f:ZC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:mw},633:{T:1},634:{T:-1},635:{T:1,f:pw},636:{T:-1},637:{f:y2},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_T},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Se(t,e,r,n){var i=e;if(!isNaN(i)){var f=n||(r||[]).length||0,m=t.next(4);m.write_shift(2,i),m.write_shift(2,f),f>0&&_f(r)&&t.push(r)}}function nE(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return Se(t,e,r,i);var f=e;if(!isNaN(f)){for(var m=r.parts||[],c=0,s=0,u=0;u+(m[c]||8224)<=8224;)u+=m[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,f),d.write_shift(2,u),t.push(r.slice(s,s+u)),s+=u;s<i;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(m[c]||8224)<=8224;)u+=m[c]||8224,c++;d.write_shift(2,u),t.push(r.slice(s,s+u)),s+=u}}}function Ra(t,e,r){return t||(t=fe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function iE(t,e,r,n){var i=fe(9);return Ra(i,t,e),r1(r,n||"b",i),i}function sE(t,e,r){var n=fe(8+2*r.length);return Ra(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function aE(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?ar(Qt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Se(t,2,__(r,n,i)):Se(t,3,y_(r,n,i));return;case"b":case"e":Se(t,5,iE(r,n,e.v,e.t));return;case"s":case"str":Se(t,4,sE(r,n,(e.v||"").slice(0,255)));return}Se(t,1,Ra(null,r,n))}function oE(t,e,r,n){var i=Array.isArray(e),f=et(e["!ref"]||"A1"),m,c="",s=[];if(f.e.c>255||f.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,16383),m=vt(f)}for(var u=f.s.r;u<=f.e.r;++u){c=Mt(u);for(var d=f.s.c;d<=f.e.c;++d){u===f.s.r&&(s[d]=Xt(d)),m=s[d]+c;var l=i?(e[u]||[])[d]:e[m];l&&aE(t,l,u,d)}}}function lE(t,e){for(var r=e||{},n=sr(),i=0,f=0;f<t.SheetNames.length;++f)t.SheetNames[f]==r.sheet&&(i=f);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(n,r.biff==4?1033:r.biff==3?521:9,Of(t,16,r)),oE(n,t.Sheets[t.SheetNames[i]],i,r),Se(n,10),n.end()}function cE(t,e,r){Se(t,49,r_({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function uE(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Se(t,1054,s_(i,e[i],r))})}function fE(t,e){var r=fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(t,2151,r),r=fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s1(et(e["!ref"]||"A1"),r),r.write_shift(4,4),Se(t,2152,r)}function hE(t,e){for(var r=0;r<16;++r)Se(t,224,k0({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Se(t,224,k0(n,0,e))})}function dE(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Se(t,440,d_(n)),n[1].Tooltip&&Se(t,2048,p_(n))}delete e["!links"]}function pE(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Se(t,125,v_(Fl(i,n),i))})}}function gE(t,e,r,n,i){var f=16+Qn(i.cellXfs,e,i);if(e.v==null&&!e.bf){Se(t,513,yi(r,n,f));return}if(e.bf)Se(t,6,jS(e,r,n,i,f));else switch(e.t){case"d":case"n":var m=e.t=="d"?ar(Qt(e.v)):e.v;Se(t,515,c_(r,n,m,f));break;case"b":case"e":Se(t,517,l_(r,n,e.v,f,i,e.t));break;case"s":case"str":if(i.bookSST){var c=Df(i.Strings,e.v,i.revStrings);Se(t,253,n_(r,n,c,f))}else Se(t,516,i_(r,n,(e.v||"").slice(0,255),f,i));break;default:Se(t,513,yi(r,n,f))}}function mE(t,e,r){var n=sr(),i=r.SheetNames[t],f=r.Sheets[i]||{},m=(r||{}).Workbook||{},c=(m.Sheets||[])[t]||{},s=Array.isArray(f),u=e.biff==8,d,l="",o=[],a=et(f["!ref"]||"A1"),h=u?65536:16384;if(a.e.c>255||a.e.r>=h){if(e.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,h-1)}Se(n,2057,Of(r,16,e)),Se(n,13,wr(1)),Se(n,12,wr(100)),Se(n,15,$t(!0)),Se(n,17,$t(!1)),Se(n,16,xi(.001)),Se(n,95,$t(!0)),Se(n,42,$t(!1)),Se(n,43,$t(!1)),Se(n,130,wr(1)),Se(n,128,o_([0,0])),Se(n,131,$t(!1)),Se(n,132,$t(!1)),u&&pE(n,f["!cols"]),Se(n,512,a_(a,e)),u&&(f["!links"]=[]);for(var g=a.s.r;g<=a.e.r;++g){l=Mt(g);for(var p=a.s.c;p<=a.e.c;++p){g===a.s.r&&(o[p]=Xt(p)),d=o[p]+l;var v=s?(f[g]||[])[p]:f[d];v&&(gE(n,v,g,p,e),u&&v.l&&f["!links"].push([d,v.l]))}}var x=c.CodeName||c.name||i;return u&&Se(n,574,t_((m.Views||[])[0])),u&&(f["!merges"]||[]).length&&Se(n,229,h_(f["!merges"])),u&&dE(n,f),Se(n,442,i1(x)),u&&fE(n,f),Se(n,10),n.end()}function vE(t,e,r){var n=sr(),i=(t||{}).Workbook||{},f=i.Sheets||[],m=i.WBProps||{},c=r.biff==8,s=r.biff==5;if(Se(n,2057,Of(t,5,r)),r.bookType=="xla"&&Se(n,135),Se(n,225,c?wr(1200):null),Se(n,193,z2(2)),s&&Se(n,191),s&&Se(n,192),Se(n,226),Se(n,92,q2("SheetJS",r)),Se(n,66,wr(c?1200:1252)),c&&Se(n,353,wr(0)),c&&Se(n,448),Se(n,317,x_(t.SheetNames.length)),c&&t.vbaraw&&Se(n,211),c&&t.vbaraw){var u=m.CodeName||"ThisWorkbook";Se(n,442,i1(u))}Se(n,156,wr(17)),Se(n,25,$t(!1)),Se(n,18,$t(!1)),Se(n,19,wr(0)),c&&Se(n,431,$t(!1)),c&&Se(n,444,wr(0)),Se(n,61,e_()),Se(n,64,$t(!1)),Se(n,141,wr(0)),Se(n,34,$t(ST(t)=="true")),Se(n,14,$t(!0)),c&&Se(n,439,$t(!1)),Se(n,218,wr(0)),cE(n,t,r),uE(n,t.SSF,r),hE(n,r),c&&Se(n,352,$t(!1));var d=n.end(),l=sr();c&&Se(l,140,g_()),c&&r.Strings&&nE(l,252,Z2(r.Strings)),Se(l,10);var o=l.end(),a=sr(),h=0,g=0;for(g=0;g<t.SheetNames.length;++g)h+=(c?12:11)+(c?2:1)*t.SheetNames[g].length;var p=d.length+h+o.length;for(g=0;g<t.SheetNames.length;++g){var v=f[g]||{};Se(a,133,J2({pos:p,hs:v.Hidden||0,dt:0,name:t.SheetNames[g]},r)),p+=e[g].length}var x=a.end();if(h!=x.length)throw new Error("BS8 "+h+" != "+x.length);var y=[];return d.length&&y.push(d),x.length&&y.push(x),o.length&&y.push(o),Dt(y)}function xE(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=or(ht)),t&&t.SSF&&(El(),Tl(t.SSF),r.revssf=Ol(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,bf(r),r.cellXfs=[],Qn(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=mE(i,r,t);return n.unshift(vE(t,n,r)),Dt(n)}function D1(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=vr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var f=e||{};switch(f.biff||2){case 8:case 5:return xE(t,e);case 4:case 3:case 2:return lE(t,e)}throw new Error("invalid type "+f.bookType+" for BIFF")}function yE(t,e,r,n){for(var i=t["!merges"]||[],f=[],m=e.s.c;m<=e.e.c;++m){for(var c=0,s=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>m)&&!(i[u].e.r<r||i[u].e.c<m)){if(i[u].s.r<r||i[u].s.c<m){c=-1;break}c=i[u].e.r-i[u].s.r+1,s=i[u].e.c-i[u].s.c+1;break}if(!(c<0)){var d=$e({r,c:m}),l=n.dense?(t[r]||[])[m]:t[d],o=l&&l.v!=null&&(l.h||Qy(l.w||(yn(l),l.w)||""))||"",a={};c>1&&(a.rowspan=c),s>1&&(a.colspan=s),n.editable?o='<span contenteditable="true">'+o+"</span>":l&&(a["data-t"]=l&&l.t||"z",l.v!=null&&(a["data-v"]=l.v),l.z!=null&&(a["data-z"]=l.z),l.l&&(l.l.Target||"#").charAt(0)!="#"&&(o='<a href="'+l.l.Target+'">'+o+"</a>")),a.id=(n.id||"sjs")+"-"+d,f.push(we("td",o,a))}}var h="<tr>";return h+f.join("")+"</tr>"}var _E='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',wE="</body></html>";function SE(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function b1(t,e){var r=e||{},n=r.header!=null?r.header:_E,i=r.footer!=null?r.footer:wE,f=[n],m=vr(t["!ref"]);r.dense=Array.isArray(t),f.push(SE(t,m,r));for(var c=m.s.r;c<=m.e.r;++c)f.push(yE(t,m,c,r));return f.push("</table>"+i),f.join("")}function R1(t,e,r){var n=r||{},i=0,f=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var m=typeof n.origin=="string"?Et(n.origin):n.origin;i=m.r,f=m.c}var c=e.getElementsByTagName("tr"),s=Math.min(n.sheetRows||1e7,c.length),u={s:{r:0,c:0},e:{r:i,c:f}};if(t["!ref"]){var d=vr(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var l=[],o=0,a=t["!rows"]||(t["!rows"]=[]),h=0,g=0,p=0,v=0,x=0,y=0;for(t["!cols"]||(t["!cols"]=[]);h<c.length&&g<s;++h){var _=c[h];if(L0(_)){if(n.display)continue;a[g]={hidden:!0}}var w=_.children;for(p=v=0;p<w.length;++p){var C=w[p];if(!(n.display&&L0(C))){var S=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):e2(C.innerHTML),O=C.getAttribute("data-z")||C.getAttribute("z");for(o=0;o<l.length;++o){var F=l[o];F.s.c==v+f&&F.s.r<g+i&&g+i<=F.e.r&&(v=F.e.c+1-f,o=-1)}y=+C.getAttribute("colspan")||1,((x=+C.getAttribute("rowspan")||1)>1||y>1)&&l.push({s:{r:g+i,c:v+f},e:{r:g+i+(x||1)-1,c:v+f+(y||1)-1}});var N={t:"s",v:S},W=C.getAttribute("data-t")||C.getAttribute("t")||"";S!=null&&(S.length==0?N.t=W||"z":n.raw||S.trim().length==0||W=="s"||(S==="TRUE"?N={t:"b",v:!0}:S==="FALSE"?N={t:"b",v:!1}:isNaN(hn(S))?isNaN(ya(S).getDate())||(N={t:"d",v:Qt(S)},n.cellDates||(N={t:"n",v:ar(N.v)}),N.z=n.dateNF||ht[14]):N={t:"n",v:hn(S)})),N.z===void 0&&O!=null&&(N.z=O);var X="",Q=C.getElementsByTagName("A");if(Q&&Q.length)for(var ae=0;ae<Q.length&&!(Q[ae].hasAttribute("href")&&(X=Q[ae].getAttribute("href"),X.charAt(0)!="#"));++ae);X&&X.charAt(0)!="#"&&(N.l={Target:X}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][v+f]=N):t[$e({c:v+f,r:g+i})]=N,u.e.c<v+f&&(u.e.c=v+f),v+=y}}++g}return l.length&&(t["!merges"]=(t["!merges"]||[]).concat(l)),u.e.r=Math.max(u.e.r,g-1+i),t["!ref"]=vt(u),g>=s&&(t["!fullref"]=vt((u.e.r=c.length-h+g-1+i,u))),t}function M1(t,e){var r=e||{},n=r.dense?[]:{};return R1(n,t,e)}function CE(t,e){return Si(M1(t,e),e)}function L0(t){var e="",r=TE(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function TE(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var EE=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+_a({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return xt+e}}(),I0=function(){var t=function(f){return Ve(f).replace(/  +/g,function(m){return'<text:s text:c="'+m.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(f,m,c){var s=[];s.push('      <table:table table:name="'+Ve(m.SheetNames[c])+`" table:style-name="ta1">
`);var u=0,d=0,l=vr(f["!ref"]||"A1"),o=f["!merges"]||[],a=0,h=Array.isArray(f);if(f["!cols"])for(d=0;d<=l.e.c;++d)s.push("        <table:table-column"+(f["!cols"][d]?' table:style-name="co'+f["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",p=f["!rows"]||[];for(u=0;u<l.s.r;++u)g=p[u]?' table:style-name="ro'+p[u].ods+'"':"",s.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=l.e.r;++u){for(g=p[u]?' table:style-name="ro'+p[u].ods+'"':"",s.push("        <table:table-row"+g+`>
`),d=0;d<l.s.c;++d)s.push(e);for(;d<=l.e.c;++d){var v=!1,x={},y="";for(a=0;a!=o.length;++a)if(!(o[a].s.c>d)&&!(o[a].s.r>u)&&!(o[a].e.c<d)&&!(o[a].e.r<u)){(o[a].s.c!=d||o[a].s.r!=u)&&(v=!0),x["table:number-columns-spanned"]=o[a].e.c-o[a].s.c+1,x["table:number-rows-spanned"]=o[a].e.r-o[a].s.r+1;break}if(v){s.push(r);continue}var _=$e({r:u,c:d}),w=h?(f[u]||[])[d]:f[_];if(w&&w.f&&(x["table:formula"]=Ve(YS(w.f)),w.F&&w.F.slice(0,_.length)==_)){var C=vr(w.F);x["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,x["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(!w){s.push(e);continue}switch(w.t){case"b":y=w.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=w.v?"true":"false";break;case"n":y=w.w||String(w.v||0),x["office:value-type"]="float",x["office:value"]=w.v||0;break;case"s":case"str":y=w.v==null?"":w.v,x["office:value-type"]="string";break;case"d":y=w.w||Qt(w.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Qt(w.v).toISOString(),x["table:style-name"]="ce1";break;default:s.push(e);continue}var S=t(y);if(w.l&&w.l.Target){var O=w.l.Target;O=O.charAt(0)=="#"?"#"+VS(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),S=we("text:a",S,{"xlink:href":O.replace(/&/g,"&amp;")})}s.push("          "+we("table:table-cell",we("text:p",S,{}),x)+`
`)}s.push(`        </table:table-row>
`)}return s.push(`      </table:table>
`),s.join("")},i=function(f,m){f.push(` <office:automatic-styles>
`),f.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),f.push(`   <number:month number:style="long"/>
`),f.push(`   <number:text>/</number:text>
`),f.push(`   <number:day number:style="long"/>
`),f.push(`   <number:text>/</number:text>
`),f.push(`   <number:year/>
`),f.push(`  </number:date-style>
`);var c=0;m.SheetNames.map(function(u){return m.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var l=u["!cols"][d];if(l.width==null&&l.wpx==null&&l.wch==null)continue;Af(l),l.ods=c;var o=u["!cols"][d].wpx+"px";f.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),f.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+`"/>
`),f.push(`  </style:style>
`),++c}}});var s=0;m.SheetNames.map(function(u){return m.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=s;var l=u["!rows"][d].hpx+"px";f.push('  <style:style style:name="ro'+s+`" style:family="table-row">
`),f.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+l+`"/>
`),f.push(`  </style:style>
`),++s}}}),f.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),f.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),f.push(`  </style:style>
`),f.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),f.push(` </office:automatic-styles>
`)};return function(m,c){var s=[xt],u=_a({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=_a({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(s.push("<office:document"+u+d+`>
`),s.push(Kg().replace(/office:document-meta/g,"office:meta"))):s.push("<office:document-content"+u+`>
`),i(s,m),s.push(`  <office:body>
`),s.push(`    <office:spreadsheet>
`);for(var l=0;l!=m.SheetNames.length;++l)s.push(n(m.Sheets[m.SheetNames[l]],m,l));return s.push(`    </office:spreadsheet>
`),s.push(`  </office:body>
`),c.bookType=="fods"?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")}}();function L1(t,e){if(e.bookType=="fods")return I0(t,e);var r=mf(),n="",i=[],f=[];return n="mimetype",Ne(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ne(r,n,I0(t,e)),i.push([n,"text/xml"]),f.push([n,"ContentFile"]),n="styles.xml",Ne(r,n,EE(t,e)),i.push([n,"text/xml"]),f.push([n,"StylesFile"]),n="meta.xml",Ne(r,n,xt+Kg()),i.push([n,"text/xml"]),f.push([n,"MetadataFile"]),n="manifest.rdf",Ne(r,n,N2(f)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ne(r,n,L2(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function sl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function OE(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Lr(ln(t))}function AE(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Vn(t){var e=t.reduce(function(i,f){return i+f.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function kE(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var f=0;i>=1;++f,i/=256)t[e+f]=i&255;t[e+15]|=r>=0?0:128}function wa(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function He(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function ts(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function yt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=wa(t,r),f=i&7;i=Math.floor(i/8);var m=0,c;if(i==0)break;switch(f){case 0:{for(var s=r[0];t[r[0]++]>=128;);c=t.slice(s,r[0])}break;case 5:m=4,c=t.slice(r[0],r[0]+m),r[0]+=m;break;case 1:m=8,c=t.slice(r[0],r[0]+m),r[0]+=m;break;case 2:m=wa(t,r),c=t.slice(r[0],r[0]+m),r[0]+=m;break;case 3:case 4:default:throw new Error("PB Type ".concat(f," for Field ").concat(i," at offset ").concat(n))}var u={data:c,type:f};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function kt(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(He(n*8+i.type)),i.type==2&&e.push(He(i.data.length)),e.push(i.data))})}),Vn(e)}function Fr(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=wa(t,n),f=yt(t.slice(n[0],n[0]+i));n[0]+=i;var m={id:ts(f[1][0].data),messages:[]};f[2].forEach(function(c){var s=yt(c.data),u=ts(s[3][0].data);m.messages.push({meta:s,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=f[3])!=null&&e[0]&&(m.merge=ts(f[3][0].data)>>>0>0),r.push(m)}return r}function Pi(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:He(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:He(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(m){i.push(m.data),m.meta[3]=[{type:0,data:He(m.data.length)}],n[2].push({data:kt(m.meta),type:2})});var f=kt(n);e.push(He(f.length)),e.push(f),i.forEach(function(m){return e.push(m)})}),Vn(e)}function PE(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=wa(e,r),i=[];r[0]<e.length;){var f=e[r[0]]&3;if(f==0){var m=e[r[0]++]>>2;if(m<60)++m;else{var c=m-59;m=e[r[0]],c>1&&(m|=e[r[0]+1]<<8),c>2&&(m|=e[r[0]+2]<<16),c>3&&(m|=e[r[0]+3]<<24),m>>>=0,m++,r[0]+=c}i.push(e.slice(r[0],r[0]+m)),r[0]+=m;continue}else{var s=0,u=0;if(f==1?(u=(e[r[0]]>>2&7)+4,s=(e[r[0]++]&224)<<3,s|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,f==2?(s=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(s=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Vn(i)],s==0)throw new Error("Invalid offset 0");if(s>i[0].length)throw new Error("Invalid offset beyond length");if(u>=s)for(i.push(i[0].slice(-s)),u-=s;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-s,-s+u))}}var d=Vn(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Dr(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(PE(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Vn(e)}function Fi(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var f=He(n),m=f.length;e.push(f),n<=60?(m++,e.push(new Uint8Array([n-1<<2]))):n<=256?(m+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(m+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(m+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(m+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),m+=n,i[0]=0,i[1]=m&255,i[2]=m>>8&255,i[3]=m>>16&255,r+=n}return Vn(e)}function gc(t,e){var r=new Uint8Array(32),n=sl(r),i=12,f=0;switch(r[0]=5,t.t){case"n":r[1]=2,kE(r,i,t.v),f|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),f|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),f|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,f,!0),r.slice(0,i)}function mc(t,e){var r=new Uint8Array(32),n=sl(r),i=12,f=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),f|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),f|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),f|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,f,!0),r.slice(0,i)}function En(t){var e=yt(t);return wa(e[1][0].data)}function FE(t,e,r){var n,i,f,m;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var c=((m=(f=t[8])==null?void 0:f[0])==null?void 0:m.data)&&ts(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var s=0,u=sl(t[7][0].data),d=0,l=[],o=sl(t[4][0].data),a=0,h=[],g=0;g<e.length;++g){if(e[g]==null){u.setUint16(g*2,65535,!0),o.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),o.setUint16(g*2,a,!0);var p,v;switch(typeof e[g]){case"string":p=gc({t:"s",v:e[g]},r),v=mc({t:"s",v:e[g]},r);break;case"number":p=gc({t:"n",v:e[g]},r),v=mc({t:"n",v:e[g]},r);break;case"boolean":p=gc({t:"b",v:e[g]},r),v=mc({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}l.push(p),d+=p.length,h.push(v),a+=v.length,++s}for(t[2][0].data=He(s);g<t[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),o.setUint16(g*2,65535,!0);return t[6][0].data=Vn(l),t[3][0].data=Vn(h),s}function DE(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=vr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(vt(n)));var f=al(r,{range:n,header:1}),m=["~Sh33tJ5~"];f.forEach(function(b){return b.forEach(function(A){typeof A=="string"&&m.push(A)})});var c={},s=[],u=Qe.read(e.numbers,{type:"base64"});u.FileIndex.map(function(b,A){return[b,u.FullPaths[A]]}).forEach(function(b){var A=b[0],T=b[1];if(A.type==2&&A.name.match(/\.iwa/)){var R=A.content,z=Dr(R),K=Fr(z);K.forEach(function(H){s.push(H.id),c[H.id]={deps:[],location:T,type:ts(H.messages[0].meta[1][0].data)}})}}),s.sort(function(b,A){return b-A});var d=s.filter(function(b){return b>1}).map(function(b){return[b,He(b)]});u.FileIndex.map(function(b,A){return[b,u.FullPaths[A]]}).forEach(function(b){var A=b[0];if(b[1],!!A.name.match(/\.iwa/)){var T=Fr(Dr(A.content));T.forEach(function(R){R.messages.forEach(function(z){d.forEach(function(K){R.messages.some(function(H){return ts(H.meta[1][0].data)!=11006&&AE(H.data,K[1])})&&c[K[0]].deps.push(R.id)})})})}});for(var l=Qe.find(u,c[1].location),o=Fr(Dr(l.content)),a,h=0;h<o.length;++h){var g=o[h];g.id==1&&(a=g)}var p=En(yt(a.messages[0].data)[1][0].data);for(l=Qe.find(u,c[p].location),o=Fr(Dr(l.content)),h=0;h<o.length;++h)g=o[h],g.id==p&&(a=g);for(p=En(yt(a.messages[0].data)[2][0].data),l=Qe.find(u,c[p].location),o=Fr(Dr(l.content)),h=0;h<o.length;++h)g=o[h],g.id==p&&(a=g);for(p=En(yt(a.messages[0].data)[2][0].data),l=Qe.find(u,c[p].location),o=Fr(Dr(l.content)),h=0;h<o.length;++h)g=o[h],g.id==p&&(a=g);var v=yt(a.messages[0].data);{v[6][0].data=He(n.e.r+1),v[7][0].data=He(n.e.c+1);var x=En(v[46][0].data),y=Qe.find(u,c[x].location),_=Fr(Dr(y.content));{for(var w=0;w<_.length&&_[w].id!=x;++w);if(_[w].id!=x)throw"Bad ColumnRowUIDMapArchive";var C=yt(_[w].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var S=0;S<=n.e.c;++S){var O=[];O[1]=O[2]=[{type:0,data:He(S+420690)}],C[1].push({type:2,data:kt(O)}),C[2].push({type:0,data:He(S)}),C[3].push({type:0,data:He(S)})}C[4]=[],C[5]=[],C[6]=[];for(var F=0;F<=n.e.r;++F)O=[],O[1]=O[2]=[{type:0,data:He(F+726270)}],C[4].push({type:2,data:kt(O)}),C[5].push({type:0,data:He(F)}),C[6].push({type:0,data:He(F)});_[w].messages[0].data=kt(C)}y.content=Fi(Pi(_)),y.size=y.content.length,delete v[46];var N=yt(v[4][0].data);{N[7][0].data=He(n.e.r+1);var W=yt(N[1][0].data),X=En(W[2][0].data);y=Qe.find(u,c[X].location),_=Fr(Dr(y.content));{if(_[0].id!=X)throw"Bad HeaderStorageBucket";var Q=yt(_[0].messages[0].data);for(F=0;F<f.length;++F){var ae=yt(Q[2][0].data);ae[1][0].data=He(F),ae[4][0].data=He(f[F].length),Q[2][F]={type:Q[2][0].type,data:kt(ae)}}_[0].messages[0].data=kt(Q)}y.content=Fi(Pi(_)),y.size=y.content.length;var ne=En(N[2][0].data);y=Qe.find(u,c[ne].location),_=Fr(Dr(y.content));{if(_[0].id!=ne)throw"Bad HeaderStorageBucket";for(Q=yt(_[0].messages[0].data),S=0;S<=n.e.c;++S)ae=yt(Q[2][0].data),ae[1][0].data=He(S),ae[4][0].data=He(n.e.r+1),Q[2][S]={type:Q[2][0].type,data:kt(ae)};_[0].messages[0].data=kt(Q)}y.content=Fi(Pi(_)),y.size=y.content.length;var J=En(N[4][0].data);(function(){for(var b=Qe.find(u,c[J].location),A=Fr(Dr(b.content)),T,R=0;R<A.length;++R){var z=A[R];z.id==J&&(T=z)}var K=yt(T.messages[0].data);{K[3]=[];var H=[];m.forEach(function(le,ee){H[1]=[{type:0,data:He(ee)}],H[2]=[{type:0,data:He(1)}],H[3]=[{type:2,data:OE(le)}],K[3].push({type:2,data:kt(H)})})}T.messages[0].data=kt(K);var G=Pi(A),ue=Fi(G);b.content=ue,b.size=b.content.length})();var oe=yt(N[3][0].data);{var q=oe[1][0];delete oe[2];var k=yt(q.data);{var D=En(k[2][0].data);(function(){for(var b=Qe.find(u,c[D].location),A=Fr(Dr(b.content)),T,R=0;R<A.length;++R){var z=A[R];z.id==D&&(T=z)}var K=yt(T.messages[0].data);{delete K[6],delete oe[7];var H=new Uint8Array(K[5][0].data);K[5]=[];for(var G=0,ue=0;ue<=n.e.r;++ue){var le=yt(H);G+=FE(le,f[ue],m),le[1][0].data=He(ue),K[5].push({data:kt(le),type:2})}K[1]=[{type:0,data:He(n.e.c+1)}],K[2]=[{type:0,data:He(n.e.r+1)}],K[3]=[{type:0,data:He(G)}],K[4]=[{type:0,data:He(n.e.r+1)}]}T.messages[0].data=kt(K);var ee=Pi(A),Y=Fi(ee);b.content=Y,b.size=b.content.length})()}q.data=kt(k)}N[3][0].data=kt(oe)}v[4][0].data=kt(N)}a.messages[0].data=kt(v);var L=Pi(o),E=Fi(L);return l.content=E,l.size=l.content.length,u}function bE(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function bf(t){bE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function RE(t,e){return e.bookType=="ods"?L1(t,e):e.bookType=="numbers"?DE(t,e):e.bookType=="xlsb"?ME(t,e):LE(t,e)}function ME(t,e){Yi=1024,t&&!t.SSF&&(t.SSF=or(ht)),t&&t.SSF&&(El(),Tl(t.SSF),e.revssf=Ol(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Zs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=v1.indexOf(e.bookType)>-1,i=Vg();bf(e=e||{});var f=mf(),m="",c=0;if(e.cellXfs=[],Qn(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),m="docProps/core.xml",Ne(f,m,Qg(t.Props,e)),i.coreprops.push(m),Ye(e.rels,2,m,ze.CORE_PROPS),m="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var s=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&s.push(t.SheetNames[u]);t.Props.SheetNames=s}for(t.Props.Worksheets=t.Props.SheetNames.length,Ne(f,m,Jg(t.Props)),i.extprops.push(m),Ye(e.rels,3,m,ze.EXT_PROPS),t.Custprops!==t.Props&&It(t.Custprops||{}).length>0&&(m="docProps/custom.xml",Ne(f,m,Zg(t.Custprops)),i.custprops.push(m),Ye(e.rels,4,m,ze.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},l=t.Sheets[t.SheetNames[c-1]],o=(l||{})["!type"]||"sheet";switch(o){case"chart":default:m="xl/worksheets/sheet"+c+"."+r,Ne(f,m,NT(c-1,m,e,t,d)),i.sheets.push(m),Ye(e.wbrels,-1,"worksheets/sheet"+c+"."+r,ze.WS[0])}if(l){var a=l["!comments"],h=!1,g="";a&&a.length>0&&(g="xl/comments"+c+"."+r,Ne(f,g,UT(a,g)),i.comments.push(g),Ye(d,-1,"../comments"+c+"."+r,ze.CMNT),h=!0),l["!legacy"]&&h&&Ne(f,"xl/drawings/vmlDrawing"+c+".vml",g1(c,l["!comments"])),delete l["!comments"],delete l["!legacy"]}d["!id"].rId1&&Ne(f,$g(m),Zi(d))}return e.Strings!=null&&e.Strings.length>0&&(m="xl/sharedStrings."+r,Ne(f,m,jT(e.Strings,m,e)),i.strs.push(m),Ye(e.wbrels,-1,"sharedStrings."+r,ze.SST)),m="xl/workbook."+r,Ne(f,m,IT(t,m)),i.workbooks.push(m),Ye(e.rels,1,m,ze.WB),m="xl/theme/theme1.xml",Ne(f,m,d1(t.Themes,e)),i.themes.push(m),Ye(e.wbrels,-1,"theme/theme1.xml",ze.THEME),m="xl/styles."+r,Ne(f,m,BT(t,m,e)),i.styles.push(m),Ye(e.wbrels,-1,"styles."+r,ze.STY),t.vbaraw&&n&&(m="xl/vbaProject.bin",Ne(f,m,t.vbaraw),i.vba.push(m),Ye(e.wbrels,-1,"vbaProject.bin",ze.VBA)),m="xl/metadata."+r,Ne(f,m,WT(m)),i.metadata.push(m),Ye(e.wbrels,-1,"metadata."+r,ze.XLMETA),Ne(f,"[Content_Types].xml",Gg(i,e)),Ne(f,"_rels/.rels",Zi(e.rels)),Ne(f,"xl/_rels/workbook."+r+".rels",Zi(e.wbrels)),delete e.revssf,delete e.ssf,f}function LE(t,e){Yi=1024,t&&!t.SSF&&(t.SSF=or(ht)),t&&t.SSF&&(El(),Tl(t.SSF),e.revssf=Ol(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Zs?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=v1.indexOf(e.bookType)>-1,i=Vg();bf(e=e||{});var f=mf(),m="",c=0;if(e.cellXfs=[],Qn(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),m="docProps/core.xml",Ne(f,m,Qg(t.Props,e)),i.coreprops.push(m),Ye(e.rels,2,m,ze.CORE_PROPS),m="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var s=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&s.push(t.SheetNames[u]);t.Props.SheetNames=s}t.Props.Worksheets=t.Props.SheetNames.length,Ne(f,m,Jg(t.Props)),i.extprops.push(m),Ye(e.rels,3,m,ze.EXT_PROPS),t.Custprops!==t.Props&&It(t.Custprops||{}).length>0&&(m="docProps/custom.xml",Ne(f,m,Zg(t.Custprops)),i.custprops.push(m),Ye(e.rels,4,m,ze.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var l={"!id":{}},o=t.Sheets[t.SheetNames[c-1]],a=(o||{})["!type"]||"sheet";switch(a){case"chart":default:m="xl/worksheets/sheet"+c+"."+r,Ne(f,m,O1(c-1,e,t,l)),i.sheets.push(m),Ye(e.wbrels,-1,"worksheets/sheet"+c+"."+r,ze.WS[0])}if(o){var h=o["!comments"],g=!1,p="";if(h&&h.length>0){var v=!1;h.forEach(function(x){x[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(p="xl/threadedComments/threadedComment"+c+"."+r,Ne(f,p,hw(h,d,e)),i.threadedcomments.push(p),Ye(l,-1,"../threadedComments/threadedComment"+c+"."+r,ze.TCMNT)),p="xl/comments"+c+"."+r,Ne(f,p,m1(h)),i.comments.push(p),Ye(l,-1,"../comments"+c+"."+r,ze.CMNT),g=!0}o["!legacy"]&&g&&Ne(f,"xl/drawings/vmlDrawing"+c+".vml",g1(c,o["!comments"])),delete o["!comments"],delete o["!legacy"]}l["!id"].rId1&&Ne(f,$g(m),Zi(l))}return e.Strings!=null&&e.Strings.length>0&&(m="xl/sharedStrings."+r,Ne(f,m,o1(e.Strings,e)),i.strs.push(m),Ye(e.wbrels,-1,"sharedStrings."+r,ze.SST)),m="xl/workbook."+r,Ne(f,m,P1(t)),i.workbooks.push(m),Ye(e.rels,1,m,ze.WB),m="xl/theme/theme1.xml",Ne(f,m,d1(t.Themes,e)),i.themes.push(m),Ye(e.wbrels,-1,"theme/theme1.xml",ze.THEME),m="xl/styles."+r,Ne(f,m,f1(t,e)),i.styles.push(m),Ye(e.wbrels,-1,"styles."+r,ze.STY),t.vbaraw&&n&&(m="xl/vbaProject.bin",Ne(f,m,t.vbaraw),i.vba.push(m),Ye(e.wbrels,-1,"vbaProject.bin",ze.VBA)),m="xl/metadata."+r,Ne(f,m,p1()),i.metadata.push(m),Ye(e.wbrels,-1,"metadata."+r,ze.XLMETA),d.length>1&&(m="xl/persons/person.xml",Ne(f,m,dw(d)),i.people.push(m),Ye(e.wbrels,-1,"persons/person.xml",ze.PEOPLE)),Ne(f,"[Content_Types].xml",Gg(i,e)),Ne(f,"_rels/.rels",Zi(e.rels)),Ne(f,"xl/_rels/workbook."+r+".rels",Zi(e.wbrels)),delete e.revssf,delete e.ssf,f}function IE(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=xn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function I1(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Pa(e.file,Qe.write(t,{type:Xe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Qe.write(t,e)}function NE(t,e){var r=or(e||{}),n=RE(t,r);return BE(n,r)}function BE(t,e){var r={},n=Xe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Qe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Cl(i))}return e.password&&typeof encrypt_agile<"u"?I1(encrypt_agile(i,e.password),e):e.type==="file"?Pa(e.file,i):e.type=="string"?Ks(i):i}function jE(t,e){var r=e||{},n=tE(t,r);return I1(n,r)}function Vr(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return xa(ln(n));case"binary":return ln(n);case"string":return t;case"file":return Pa(e.file,n,"utf8");case"buffer":return Xe?wn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Vr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function UE(t,e){switch(e.type){case"base64":return xa(t);case"binary":return t;case"string":return t;case"file":return Pa(e.file,t,"binary");case"buffer":return Xe?wn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function oo(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?xa(r):e.type=="string"?Ks(r):r;case"file":return Pa(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function N1(t,e){dy(),ET(t);var r=or(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=N1(t,r);return r.type="array",Cl(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Vr(ZT(t,r),r);case"slk":case"sylk":return Vr(S_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Vr(b1(t.Sheets[t.SheetNames[i]],r),r);case"txt":return UE(B1(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Vr(Rf(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Vr(C_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return oo(w_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Vr(T_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Vr(D_.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Vr(a1.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Vr(L1(t,r),r);case"wk1":return oo(P0.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return oo(P0.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),oo(D1(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),jE(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NE(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function WE(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function zE(t,e,r){var n=r||{};return n.type="file",n.file=e,WE(n),N1(t,n)}function XE(t,e,r,n,i,f,m,c){var s=Mt(r),u=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),l=!0,o=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(o,"__rowNum__",{value:r,enumerable:!1})}catch{o.__rowNum__=r}else o.__rowNum__=r;if(!m||t[r])for(var a=e.s.c;a<=e.e.c;++a){var h=m?t[r][a]:t[n[a]+s];if(h===void 0||h.t===void 0){if(u===void 0)continue;f[a]!=null&&(o[f[a]]=u);continue}var g=h.v;switch(h.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(f[a]!=null){if(g==null)if(h.t=="e"&&g===null)o[f[a]]=null;else if(u!==void 0)o[f[a]]=u;else if(d&&g===null)o[f[a]]=null;else continue;else o[f[a]]=d&&(h.t!=="n"||h.t==="n"&&c.rawNumbers!==!1)?g:yn(h,g,c);g!=null&&(l=!1)}}return{row:o,isempty:l}}function al(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,f=[],m=0,c="",s={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":s=et(d);break;case"number":s=et(t["!ref"]),s.s.r=d;break;default:s=d}n>0&&(i=0);var l=Mt(s.s.r),o=[],a=[],h=0,g=0,p=Array.isArray(t),v=s.s.r,x=0,y={};p&&!t[v]&&(t[v]=[]);var _=u.skipHidden&&t["!cols"]||[],w=u.skipHidden&&t["!rows"]||[];for(x=s.s.c;x<=s.e.c;++x)if(!(_[x]||{}).hidden)switch(o[x]=Xt(x),r=p?t[v][x]:t[o[x]+l],n){case 1:f[x]=x-s.s.c;break;case 2:f[x]=o[x];break;case 3:f[x]=u.header[x-s.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=m=yn(r,null,u),g=y[m]||0,!g)y[m]=1;else{do c=m+"_"+g++;while(y[c]);y[m]=g,y[c]=1}f[x]=c}for(v=s.s.r+i;v<=s.e.r;++v)if(!(w[v]||{}).hidden){var C=XE(t,s,v,o,n,f,p,u);(C.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(a[h++]=C.row)}return a.length=h,a}var N0=/"/g;function HE(t,e,r,n,i,f,m,c){for(var s=!0,u=[],d="",l=Mt(r),o=e.s.c;o<=e.e.c;++o)if(n[o]){var a=c.dense?(t[r]||[])[o]:t[n[o]+l];if(a==null)d="";else if(a.v!=null){s=!1,d=""+(c.rawNumbers&&a.t=="n"?a.v:yn(a,null,c));for(var h=0,g=0;h!==d.length;++h)if((g=d.charCodeAt(h))===i||g===f||g===34||c.forceQuotes){d='"'+d.replace(N0,'""')+'"';break}d=="ID"&&(d='"ID"')}else a.f!=null&&!a.F?(s=!1,d="="+a.f,d.indexOf(",")>=0&&(d='"'+d.replace(N0,'""')+'"')):d="";u.push(d)}return c.blankrows===!1&&s?null:u.join(m)}function Rf(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=et(t["!ref"]),f=n.FS!==void 0?n.FS:",",m=f.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,s=c.charCodeAt(0),u=new RegExp((f=="|"?"\\|":f)+"+$"),d="",l=[];n.dense=Array.isArray(t);for(var o=n.skipHidden&&t["!cols"]||[],a=n.skipHidden&&t["!rows"]||[],h=i.s.c;h<=i.e.c;++h)(o[h]||{}).hidden||(l[h]=Xt(h));for(var g=0,p=i.s.r;p<=i.e.r;++p)(a[p]||{}).hidden||(d=HE(t,i,p,l,m,s,f,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?c:"")+d)));return delete n.dense,r.join("")}function B1(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Rf(t,e);return r}function YE(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=et(t["!ref"]),f="",m=[],c,s=[],u=Array.isArray(t);for(c=i.s.c;c<=i.e.c;++c)m[c]=Xt(c);for(var d=i.s.r;d<=i.e.r;++d)for(f=Mt(d),c=i.s.c;c<=i.e.c;++c)if(e=m[c]+f,r=u?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}s[s.length]=e+"="+n}return s}function j1(t,e,r){var n=r||{},i=+!n.skipHeader,f=t||{},m=0,c=0;if(f&&n.origin!=null)if(typeof n.origin=="number")m=n.origin;else{var s=typeof n.origin=="string"?Et(n.origin):n.origin;m=s.r,c=s.c}var u,d={s:{c:0,r:0},e:{c,r:m+e.length-1+i}};if(f["!ref"]){var l=et(f["!ref"]);d.e.c=Math.max(d.e.c,l.e.c),d.e.r=Math.max(d.e.r,l.e.r),m==-1&&(m=l.e.r+1,d.e.r=m+e.length-1+i)}else m==-1&&(m=0,d.e.r=e.length-1+i);var o=n.header||[],a=0;e.forEach(function(g,p){It(g).forEach(function(v){(a=o.indexOf(v))==-1&&(o[a=o.length]=v);var x=g[v],y="z",_="",w=$e({c:c+a,r:m+p+i});u=Sa(f,w),x&&typeof x=="object"&&!(x instanceof Date)?f[w]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",n.cellDates||(y="n",x=ar(x)),_=n.dateNF||ht[14]):x===null&&n.nullError&&(y="e",x=0),u?(u.t=y,u.v=x,delete u.w,delete u.R,_&&(u.z=_)):f[w]=u={t:y,v:x},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,c+o.length-1);var h=Mt(m);if(i)for(a=0;a<o.length;++a)f[Xt(a+c)+h]={t:"s",v:o[a]};return f["!ref"]=vt(d),f}function VE(t,e){return j1(null,t,e)}function Sa(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Et(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Sa(t,$e(e)):Sa(t,$e({r:e,c:r||0}))}function GE(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function $E(){return{SheetNames:[],Sheets:{}}}function KE(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var f=r.match(/(^.*?)(\d+)$/);i=f&&+f[2]||0;var m=f&&f[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=m+i)!=-1;++i);}if(k1(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function QE(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=GE(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function qE(t,e){return t.z=e,t}function U1(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function JE(t,e,r){return U1(t,"#"+e,r)}function ZE(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function eO(t,e,r,n){for(var i=typeof e!="string"?e:et(e),f=typeof e=="string"?e:vt(e),m=i.s.r;m<=i.e.r;++m)for(var c=i.s.c;c<=i.e.c;++c){var s=Sa(t,m,c);s.t="n",s.F=f,delete s.v,m==i.s.r&&c==i.s.c&&(s.f=r,n&&(s.D=!0))}return t}var lo={encode_col:Xt,encode_row:Mt,encode_cell:$e,encode_range:vt,decode_col:Sf,decode_row:wf,split_cell:p2,decode_cell:Et,decode_range:vr,format_cell:yn,sheet_add_aoa:Ug,sheet_add_json:j1,sheet_add_dom:R1,aoa_to_sheet:ps,json_to_sheet:VE,table_to_sheet:M1,table_to_book:CE,sheet_to_csv:Rf,sheet_to_txt:B1,sheet_to_json:al,sheet_to_html:b1,sheet_to_formulae:YE,sheet_to_row_object_array:al,sheet_get_cell:Sa,book_new:$E,book_append_sheet:KE,book_set_sheet_visibility:QE,cell_set_number_format:qE,cell_set_hyperlink:U1,cell_set_internal_link:JE,cell_add_comment:ZE,sheet_set_array_formula:eO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const tO="default",Fs=(t,e)=>Object.entries(t.seats).filter(([,r])=>r===e).length,B0=(t,e)=>Object.entries(e.seats).reduce((r,[,n])=>r+=t.groups[n].price,0),vc=["darkolivegreen","saddlebrown","midnightblue","slategray","darkred","olive","green","mediumseagreen","rosybrown","teal","peru","yellowgreen","darkblue","limegreen","goldenrod","darkseagreen","purple","maroon3","red","darkturquoise","darkorange","gold","slateblue","mediumblue","burlywood","lime","mediumspringgreen","deepskyblue","purple3","lightcoral","greenyellow","tomato","orchid","fuchsia","khaki","cornflower","plum","powderblue","deeppink","aquamarine"],rO=(t,e=-1)=>{let r=e+1;for(;r>=t.length;)r-=t.length;return r};function nO({canvas:t}){const[e]=Ae.useContext(zr),r=Ae.useContext(Sn),[n]=r.hallData,[i,f]=Ae.useReducer(cy,ly),[m,c]=Ae.useReducer(oy,ay),[s,u]=Ae.useState(tO),[d,l]=Ae.useState(Object.keys(m)[0]),[o,a]=Ae.useState(null),h=m[d],g=i[d],p=rO(vc,Object.entries(h.groups).length-1),v=new Intl.NumberFormat("ru-RU",{currency:"RUB",style:"currency"}),x=()=>{u(s==="default"?"select-scheme":"default")},y=J=>{l(J)},_=()=>{const J=prompt("  "," ");if(J===null||J.trim()==="")return;const oe=Gs(m);c({type:rn.CREATE_SCHEME,id:oe,payload:{name:J.trim()}}),f({type:Di.CREATE_SCHEME,id:oe,payload:{}})},w=J=>{confirm("    ?")&&(c({type:rn.DELETE_SCHEME,id:J,payload:{}}),f({type:Di.DELETE_SCHEME,id:J,payload:{}}))},C=J=>{const oe=prompt("   ",`${m[J].name}-`);if(oe===null||oe.trim()==="")return;const q=Gs(m);c({type:rn.COPY_SCHEME,id:q,payload:{name:oe.trim(),schemeID:J}}),f({type:Di.COPY_SCHEME,id:q,payload:{schemeID:J}})},S=J=>{const oe=prompt("   ",m[J].name);oe===null||oe.trim()===""||c({type:rn.RENAME_SCHEME,id:J,payload:{name:oe.trim()}})},O=J=>{a(J),u("pick-color")},F=J=>{c({type:rn.UPDATE_GROUP_COLOR,id:d,payload:{groupID:o,color:J}}),u("default"),a(null)},N=J=>{const oe=prompt("  ",h.groups[J].price.toString());oe===null||oe.trim()===""||c({type:rn.UPDATE_GROUP_PRICE,id:d,payload:{groupID:J,price:parseFloat(oe)}})},W=J=>{confirm("    ?")&&(c({type:rn.DELETE_GROUP,id:d,payload:{groupID:J}}),f({type:Di.DELETE_GROUP,id:d,payload:{groupID:J}}))},X=()=>{const J=prompt("  ","0");if(J===null||J.trim()==="")return;const oe=Gs(h.groups,d),q=vc[p];c({type:rn.CREATE_GROUP,id:d,payload:{groupID:oe,price:parseFloat(J),color:q}})},Q=J=>{var D;const oe=(D=t.current)==null?void 0:D.getActiveObject();if(oe==null)return;let q=[];oe.type==="activeSelection"?q.push(...oe.getObjects()):q.push(oe);const k=[];e.seats.forEach((L,E)=>{q.includes(E)&&k.push(L)}),f({type:Di.UPDATE_SEATS,id:d,payload:{seats:k,groupID:J}})},ae=()=>{u(s==="select-seats"?"default":"select-seats")},ne=()=>{const J=Object.entries(h.groups).filter(([k])=>Fs(g,k)>0).map(([k,D])=>[D.price,Object.keys(g.seats).map(L=>{const E=n.seats[L],b=n.rows[E.row];return`${n.sections[b.section].name}, ${b.number}-${E.number}`}).join(", "),Fs(g,k),Fs(g,k)*D.price]);J.push(["","",Object.entries(g.seats).length,B0(h,g)]);const oe=lo.json_to_sheet(J);lo.sheet_add_aoa(oe,[["","","",""]],{origin:"A1"});const q=lo.book_new();lo.book_append_sheet(q,oe,"List1"),zE(q,`${h.name}.xlsx`)};return Mx(m,i,d,t),iy(t),Ae.useEffect(function(){if(s!=="select-seats")return;const oe=ag(t.current,1,q=>{var D,L;const k=new Fe.fabric.ActiveSelection;(D=t.current)==null||D.add(k),e.seats.forEach((E,b)=>{mi.pointInPolygon({x:b.left,y:b.top},q)&&k.add(b)}),(L=t.current)==null||L.setActiveObject(k),u("default")});return function(){oe()}},[s]),Ce.jsxs(Ce.Fragment,{children:[s==="pick-color"?Ce.jsx(uy,{palette:vc,onColorClick:J=>F(J),onCloseClick:()=>u("default")}):null,Ce.jsxs("div",{className:"price-schemes",children:[Ce.jsxs("div",{className:"price-schemes-current",children:[Ce.jsx("span",{className:"price-schemes-current-name",children:h.name}),Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:x,className:"price-schemes-dropdown",children:s==="select-scheme"?"":""})]}),Ce.jsxs("ul",{className:`price-schemes-list${s==="select-scheme"?" price-schemes-list-active":""}`,children:[Object.entries(m).map(([J,oe])=>Ce.jsxs("li",{className:"price-schemes-list-item",children:[Ce.jsx("button",{onClick:()=>y(J),className:`price-schemes-list-item-control price-schemes-list-item-name${J===d?" price-schemes-list-item-name-active":""}`,children:oe.name}),Ce.jsx("button",{onClick:()=>S(J),className:"price-schemes-list-item-control price-schemes-list-item-rename",children:""}),Ce.jsx("button",{onClick:()=>C(J),className:"price-schemes-list-item-control price-schemes-list-item-rename",children:""}),Ce.jsx("button",{disabled:J===d,onClick:()=>w(J),className:"price-schemes-list-item-control price-schemes-list-item-delete",children:""})]},`price-scheme-${J}`)),Ce.jsx("li",{className:"price-schemes-list-item",children:Ce.jsx("button",{onClick:_,className:"price-schemes-list-item-control price-schemes-list-item-new",children:"  "})})]}),Ce.jsxs("table",{className:"price-schemes-prices",children:[Ce.jsxs("tbody",{children:[Object.entries(h.groups).map(([J,oe])=>Ce.jsxs("tr",{children:[Ce.jsx("td",{children:Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:()=>O(J),className:"price-color",style:{color:oe.color},children:""})}),Ce.jsx("td",{className:"price-value-container",children:Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:()=>N(J),className:"price-value",children:v.format(oe.price)})}),Ce.jsx("td",{children:Ce.jsx("span",{className:"price-amount",children:Fs(g,J)})}),Ce.jsx("td",{children:Ce.jsx("span",{className:"price-total",children:v.format(Fs(g,J)*oe.price)})}),Ce.jsx("td",{children:Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:()=>W(J),className:"price-delete",children:""})})]},`price-table-${J}`)),Ce.jsxs("tr",{children:[Ce.jsx("td",{children:Ce.jsx("button",{disabled:!0,className:"price-color",style:{color:"#ccc"},children:""})}),Ce.jsx("td",{colSpan:4,children:Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:X,className:"price-value",children:"  "})})]})]}),Ce.jsx("tfoot",{children:Ce.jsxs("tr",{className:"prices-total",children:[Ce.jsx("td",{}),Ce.jsxs("td",{className:"prices-total-seats",colSpan:2,children:[Object.entries(g.seats).length," / ",e.seats.size]}),Ce.jsx("td",{children:Ce.jsx("span",{className:"price-total",children:v.format(B0(h,g))})}),Ce.jsx("td",{})]})})]}),Ce.jsx("div",{className:"prices-schemes-export",children:Ce.jsx("button",{className:"prices-schemes-export-control",onClick:ne,children:"  Excel"})})]}),Ce.jsxs("div",{className:"prices",children:[Ce.jsx("button",{onClick:()=>Q(null),className:"prices-item",style:{color:"#999"},children:""}),Object.entries(m[d].groups).map(([J,oe])=>Ce.jsx("button",{disabled:!["default","select-scheme"].includes(s),onClick:()=>Q(J),className:"prices-item",style:{color:oe.color},children:v.format(oe.price)},`price-${J}`))]}),Ce.jsx("div",{className:"editor-controls edit-controls",children:Ce.jsx("button",{className:`edit-controls-button ${s==="select-seats"?"edit-controls-button-active":""}`,onClick:ae,children:s!=="select-seats"?"":"+"})})]})}var W1=(t=>(t.REWRITE="rewrite",t))(W1||{});const iO=(t,e)=>{switch(e.type){case"rewrite":{const{rows:r,seats:n,sections:i}=e.payload;return{rows:r,seats:n,sections:i}}}},Mf=Ae.createContext(null),Sn=Ae.createContext(null),zr=Ae.createContext(null),sO="scheme";function aO(){const t={hallData:Ae.useReducer(Bx,Nx),hallVisualData:Ae.useReducer(Kx,$x)},e=Ae.useReducer(iO,{rows:new Map,seats:new Map,sections:new Map}),r=Ae.useRef(null),n=Ae.useRef(null),[i,f]=Ae.useState(1),[m,c]=Ae.useState(sO),s=()=>{c("scheme")},u=()=>{c("prices")};return Ce.jsxs(Ce.Fragment,{children:[Ce.jsxs("main",{className:"editor",children:[Ce.jsx("div",{className:"name-container",ref:n}),Ce.jsx(Sn.Provider,{value:t,children:Ce.jsx(zr.Provider,{value:e,children:Ce.jsxs(Mf.Provider,{value:[i,f],children:[Ce.jsx(Dx,{canvas:r}),Ce.jsx(sy,{canvas:r,nameContainer:n}),m==="scheme"?Ce.jsx(Zx,{canvas:r,nameContainer:n}):Ce.jsx(nO,{canvas:r})]})})})]}),Ce.jsxs("div",{className:"mode-switch",children:[Ce.jsx("button",{onClick:s,className:`mode-switch-control ${m==="scheme"?"mode-switch-control-active":""}`,children:""}),Ce.jsx("button",{onClick:u,className:`mode-switch-control ${m==="prices"?"mode-switch-control-active":""}`,children:""})]})]})}xc.createRoot(document.getElementById("root")).render(Ce.jsx(Ae.StrictMode,{children:Ce.jsx(aO,{})}));
